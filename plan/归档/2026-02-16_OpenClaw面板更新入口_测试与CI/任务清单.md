# 任务清单

## 1. 准备阶段
- [x] 1.1 阅读现有规格 | 验收：`plan/规格/OpenClaw面板.md` 已确认
- [x] 1.2 确认无冲突进行中任务 | 验收：`plan/` 目录检查完成

## 2. 实现阶段
- [x] 2.1 新增更新 API | 验收：支持版本检查/升级/回滚
- [x] 2.2 前端新增更新管理区块 | 验收：可一键触发检查、升级、回滚
- [x] 2.3 补单元测试 | 验收：核心版本与回滚逻辑有测试覆盖
- [x] 2.4 补回归测试 | 验收：关键接口行为可回放验证
- [x] 2.5 补 CI/CD 工作流 | 验收：CI 跑检查与测试，CD 可构建发布镜像

## 3. 验证阶段
- [x] 3.1 本地测试通过 | 验收：`npm run test:unit && npm run test:regression && npm run check`
- [x] 3.2 容器联调通过 | 验收：升级失败自动回滚可复现
- [x] 3.3 页面联调通过 | 验收：按钮交互与反馈完整

## 4. 收尾阶段
- [x] 4.1 更新规格文档 | 验收：`plan/规格/OpenClaw面板.md` 同步更新管理能力
- [ ] 4.2 归档任务目录 | 验收：移动到 `plan/归档/`

## 经验记录
### 步骤 2 完成记录
- 实际情况：更新 API 采用 inspect + run 重建容器，避免容器内 compose 路径歧义
- 遇到问题：初版重建未保留 compose labels，导致 `compose ps` 丢失网关容器
- 技术债：后续可补“更新前预检查（磁盘空间/镜像可达性）”提升可观测性

### 步骤 3 完成记录
- 实际情况：已完成 API 实测（检查更新、回滚）与真实容器状态回查
- 遇到问题：Windows/WSL 下请求默认 content-type 触发 415，已改为显式 JSON 调用
- 技术债：目前未引入端到端浏览器自动化测试（Playwright），后续可按需要增加
