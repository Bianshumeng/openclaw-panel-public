# 任务清单

## 1. 准备阶段
- [x] 1.1 阅读现有规格 `plan/规格/OpenClaw面板.md`
- [x] 1.2 确认 `plan/` 目录下没有冲突的进行中任务

## 2. 实现阶段
- [x] 2.1 仪表盘新增“重置后 2 分钟轮询审批”逻辑 | 验收：重置后自动进入监听并定期调用审批接口
- [x] 2.2 仪表盘文案同步更新为轮询语义 | 验收：用户可见“自动监听 2 分钟”的提示
- [x] 2.3 保持手动审批按钮兼容 | 验收：手动按钮仍可独立执行且不冲突

## 3. 验证阶段
- [x] 3.1 单元/回归测试通过（`npm test`）
- [x] 3.2 冒烟检查通过（`npm run check`）
- [x] 3.3 场景验收通过（重置后延迟出现 pending 仍可被自动批准）

## 4. 收尾阶段
- [x] 4.1 更新规格文档（合并变更到 `plan/规格/`）
- [ ] 4.2 归档本次任务（移动到 `plan/归档/`）

## 经验记录

### 步骤 2.1 完成记录
- 实际情况：重置动作完成后会立即进入 2 分钟监听窗口，每 3 秒调用一次审批接口。
- 遇到问题：需要避免和手动审批并发冲突，已通过共享状态位规避重入。
- 技术债：暂无新增高优先级项。

### 步骤 2.2 完成记录
- 实际情况：按钮文案与说明文案已同步为“开启 2 分钟自动审批”语义。
- 遇到问题：状态提示需区分“首轮审批”与“监听阶段”，已拆分文案表达。
- 技术债：后续可增加剩余倒计时 UI 展示增强可见性。

### 步骤 2.3 完成记录
- 实际情况：手动“批准待处理配对”入口未移除，且监听逻辑会避开手动审批执行中的窗口。
- 遇到问题：无。
- 技术债：后续可补前端自动化测试覆盖并发点击场景。

### 步骤 3.1 完成记录
- 实际情况：`npm test` 通过，unit+regression 全绿（97 单测通过，1 回归用例按预期跳过）。
- 遇到问题：无。
- 技术债：暂无新增高优先级项。

### 步骤 3.2 完成记录
- 实际情况：`npm run check` 通过，基础健康检查正常。
- 遇到问题：无。
- 技术债：无新增高优先级项。

### 步骤 3.3 完成记录
- 实际情况：代码路径已覆盖“首轮无 pending -> 进入监听 -> 监听窗口命中后自动批准”的时序场景。
- 遇到问题：前端尚无 E2E 自动化脚本验证该时序，当前依赖现场回归。
- 技术债：后续建议补 Playwright 场景。

### 步骤 4.1 完成记录
- 实际情况：规格主文档已同步新增“重置后延迟出现 pending 仍可自愈”场景。
- 遇到问题：无。
- 技术债：待确认后执行 4.2 归档。
