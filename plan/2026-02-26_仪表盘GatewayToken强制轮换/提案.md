# 仪表盘 Gateway Token 强制轮换

创建时间：2026-02-26 05:02:00

## 为什么做

Boot UI 出现 `unauthorized: gateway token mismatch` 时，现有“一键自动配置 Gateway Token”会复用旧 Token，无法稳定完成修复闭环。

## 改什么

- 后端 `/api/gateway/token/sync` 改为每次点击都强制生成新 Token 并写回真实配置文件。
- 仪表盘文案与按钮语义改为“重置 Token”，明确该操作会轮换令牌。
- 增加 `gateway-token` 单元测试，锁定“强制轮换、不复用旧值”的行为。

## 影响范围

- 涉及模块：`src/server.js`、`src/gateway-token.js`、`public/pages/dashboard.html`、`public/js/pages/model-dashboard-page.js`、`test/unit/gateway-token.test.js`
- 涉及接口：`POST /api/gateway/token/sync`
- 风险等级：L1

## 不做什么（边界）

- 本次不实现自动把新 Token 注入第三方 Control UI（仍由用户在 Control UI 粘贴更新）。
- 本次不改设备配对审批策略与网关重启策略。
- 本次不调整 OpenClaw 上游鉴权机制，仅修复面板侧运维动作。
