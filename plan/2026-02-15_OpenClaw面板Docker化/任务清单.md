# 任务清单

## 1. 准备阶段
- [x] 1.1 确认当前环境可用 Docker/Compose | 验收：`docker --version`、`docker compose version`
- [x] 1.2 梳理现有 systemd/journal 依赖点 | 验收：定位服务控制与日志读取模块

## 2. 实现阶段
- [x] 2.1 新增容器构建文件 | 验收：`Dockerfile` 可构建面板镜像
- [x] 2.2 新增 compose 编排 | 验收：`openclaw + panel` 双容器可启动
- [x] 2.3 运行时抽象改造 | 验收：支持 `runtime.mode=systemd|docker`
- [x] 2.4 日志源扩展 | 验收：支持 `docker logs` 实时流与摘要
- [x] 2.5 部署脚本与参数模板 | 验收：模板机可一键启动/升级/回滚

## 3. 验证阶段
- [x] 3.1 面板接口回归通过 | 验收：`/api/settings`、`/api/service/*`、`/api/logs/*`
- [x] 3.2 容器联调通过 | 验收：配置写入、启停、日志均可用
- [x] 3.3 回滚演练通过 | 验收：升级失败后可恢复上个标签

## 4. 收尾阶段
- [x] 4.1 更新规格文档 | 验收：`plan/规格/OpenClaw面板.md` 同步 runtime 与部署模式
- [ ] 4.2 归档任务目录 | 验收：移动到 `plan/归档/`

## 经验记录
### 步骤 1 完成记录
- 实际情况：当前开发环境已具备 Docker 与 Compose，可直接在本机联调
- 遇到问题：无
- 技术债：后续需补“多 Bot 驱动层”抽象，当前先聚焦 OpenClaw

### 步骤 3 完成记录
- 实际情况：已完成 `pull -> build -> up` 实容器联调，`openclaw-gateway` 与 `openclaw-panel` 均为运行态
- 遇到问题：GHCR 拉取偶发 `EOF`，已在部署脚本补充拉取重试机制
- 技术债：Windows + WSL 环境运行 Bash 脚本时存在 compose 项目名兼容噪音，生产 Debian 不受影响
