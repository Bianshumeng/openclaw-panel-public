# OpenClaw 面板 Docker 化改造

创建时间：2026-02-15 00:00:00

## 为什么做
当前面板依赖宿主机 `systemd + journalctl`，不利于模板机标准化交付与一键升级。需要改为容器化部署，并为后续“受控版本更新”打基础。

## 改什么
- 引入 `docker-compose` 编排，采用双容器结构：`openclaw` + `panel`
- 面板运行模式从 `systemd` 抽象为 `runtime`，新增 `docker` 运行时实现
- 日志来源新增 `docker`，支持读取 OpenClaw 容器日志
- 提供模板机可复用部署脚本（启动、升级、回滚）
- 保持现有可视化配置能力与页面交互不变

## 影响范围
- 涉及模块：`src/systemd.js`、`src/logs.js`、`src/panel-config.js`、`src/server.js`
- 新增文件：`docker-compose.yml`、`Dockerfile`、`deploy/*.sh`、文档
- 风险等级：L2

## 不做什么（边界）
- 本阶段不做多 Bot 编排界面（只保证 OpenClaw 跑通）
- 本阶段不做完整在线升级 UI（先预留更新通道与版本清单结构）
- 不直接追上游 `latest` 作为生产默认版本

## 验证（必填）
- `docker compose up -d` 后面板可访问、配置可读写
- 面板可控制 OpenClaw 容器启停与状态
- 面板可读取 OpenClaw 容器日志
- 失败演练：模拟升级失败后可回滚到上一个镜像标签

## 回滚（必填）
- 回滚触发条件：启动失败、健康检查失败、关键配置写入异常
- 回滚步骤：恢复上一版本镜像标签并 `docker compose up -d`
