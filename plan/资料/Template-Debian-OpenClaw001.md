# Template-Debian-OpenClaw001（VM 100）模板机档案

最后更新：2026-02-11

## 1. 目标/用途

- 作为 **Debian 13 Golden Image**，后续通过 **Linked Clone** 快速批量开通小鸡（目标规格：4C / 4G / 30G）。
- 运行场景：浏览器自动化（OpenClaw）、Node.js 脚本、Docker 容器。
- 性能要求：CPU 必须用 **`host`**（透传 AVX2 等指令集）。

## 2. 所属节点/环境

| 项目 | 值 |
|---|---|
| 物理宿主机 | Hetzner（德国机房） |
| 节点名 | `9900K-1` |
| 宿主机 CPU | i9-9900K |
| PVE UI 版本（从截图） | 9.1.5 |

## 3. VM 硬件配置（已创建）

| 配置项 | 参数 | 备注 |
|---|---|---|
| VMID / 名称 | `100` / `Template-Debian-OpenClaw001` | 模板机 |
| 机型 / BIOS | `i440fx` / `SeaBIOS` | 兼容优先 |
| CPU | 4 Cores / `host` | 必须 `host` |
| 内存 | 4096 MiB | 可配合 Ballooning |
| 磁盘 | 30G（SCSI0） | 开启 Discard/TRIM |
| 控制器 | `VirtIO SCSI single` | IO 性能优先 |
| QEMU Guest Agent | Enabled | 需在系统内安装 `qemu-guest-agent` 后才会运行 |
| 网卡 | VirtIO | 连接 `vmbr0` |

## 4. 网络（NAT：共享公网 IPv4 + 独立端口）

> 关键点：**小鸡没有独立公网 IPv4**；但每台小鸡必须有一个**固定内网 IP（10.10.10.x）**，宿主机才能把 `公网IP:端口` 转发到对应小鸡。

### 4.1 内网段（统一一个网段）

| 项目 | 值 |
|---|---|
| 虚拟网桥 | `vmbr0` |
| 网关（宿主机） | `10.10.10.1/24` |
| 地址获取方式 | 不用 DHCP：全部静态分配 |
| 本模板机内网 IP（确认） | `10.10.10.100/24` |

### 4.2 端口分配（计划）

| 项目 | 值 |
|---|---|
| 入口 | 共享公网 IPv4 + 每台小鸡独立端口段 |
| 每台小鸡端口数 | 50（由分配脚本执行） |
| 示例（SSH） | `公网IPv4:<分配端口>` → `10.10.10.100:22`（实际端口号以脚本分配为准） |
| 出口 | 计划：IPv4 入站 / IPv6 出站（由大哥的 WG + 策略路由方案实现） |

## 5. 隔离要求（强制）

- **小鸡之间必须完全隔离（east-west 禁止）**：默认不允许 `10.10.10.x ↔ 10.10.10.y` 互通。
- 允许的最小通信：小鸡 → 网关（`10.10.10.1`）用于 NAT/DNS/必要服务。
- 具体落地方式：PVE Firewall 或宿主机 `nftables/iptables` 规则（待实施/验收）。

## 6. 当前安装状态（写档时）

- Debian 13 安装进行中；安装器已出现 **DHCP 获取失败**（符合“无 DHCP + 静态内网”的预期）。
- 下一步在安装器网络配置中手动填写静态地址：`10.10.10.100/24`，网关 `10.10.10.1`（DNS 以宿主机实际配置为准）。

