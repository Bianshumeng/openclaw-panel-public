import{createRequire as e}from"node:module";const t=e(import.meta.url);var r,i=Object.create,n=Object.defineProperty,s=Object.getOwnPropertyDescriptor,a=Object.getOwnPropertyNames,o=Object.getPrototypeOf,l=Object.prototype.hasOwnProperty,c=(r=function(e){if(typeof t<"u")return t.apply(this,arguments);throw Error('Dynamic require of "'+e+'" is not supported')},typeof t<"u"?t:typeof Proxy<"u"?new Proxy(r,{get:(e,r)=>(typeof t<"u"?t:e)[r]}):r),u=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),d=(e,t,r)=>(r=null!=e?i(o(e)):{},((e,t,r,i)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let r of a(t))!l.call(e,r)&&void 0!==r&&n(e,r,{get:()=>t[r],enumerable:!(i=s(t,r))||i.enumerable});return e})(!t&&e&&e.__esModule?r:n(r,"default",{value:e,enumerable:!0}),e)),p=u((e,t)=>{t.exports=function(e){var t=new e,r=t;return{get:function(){var i=t;return i.next?t=i.next:(t=new e,r=t),i.next=null,i},release:function(e){r.next=e,r=e}}}}),h=u((e,t)=>{var r=p();function i(e,t,i){if("function"==typeof e&&(i=t,t=e,e=null),!(i>=1))throw new Error("fastqueue concurrency must be equal to or greater than 1");var a=r(s),o=null,l=null,c=0,u=null,d={push:function(r,s){var h=a.get();h.context=e,h.release=p,h.value=r,h.callback=s||n,h.errorHandler=u,c>=i||d.paused?l?(l.next=h,l=h):(o=h,l=h,d.saturated()):(c++,t.call(e,h.value,h.worked))},drain:n,saturated:n,pause:function(){d.paused=!0},paused:!1,get concurrency(){return i},set concurrency(e){if(!(e>=1))throw new Error("fastqueue concurrency must be equal to or greater than 1");if(i=e,!d.paused)for(;o&&c<i;)c++,p()},running:function(){return c},resume:function(){if(d.paused){if(d.paused=!1,null===o)return c++,void p();for(;o&&c<i;)c++,p()}},idle:function(){return 0===c&&0===d.length()},length:function(){for(var e=o,t=0;e;)e=e.next,t++;return t},getQueue:function(){for(var e=o,t=[];e;)t.push(e.value),e=e.next;return t},unshift:function(r,s){var h=a.get();h.context=e,h.release=p,h.value=r,h.callback=s||n,h.errorHandler=u,c>=i||d.paused?o?(h.next=o,o=h):(o=h,l=h,d.saturated()):(c++,t.call(e,h.value,h.worked))},empty:n,kill:function(){o=null,l=null,d.drain=n},killAndDrain:function(){o=null,l=null,d.drain(),d.drain=n},error:function(e){u=e},abort:function(){var e=o;for(o=null,l=null;e;){var t=e.next,r=e.callback,i=e.errorHandler,s=e.value,a=e.context;e.value=null,e.callback=n,e.errorHandler=null,i&&i(new Error("abort"),s),r.call(a,new Error("abort")),e.release(e),e=t}d.drain=n}};return d;function p(r){r&&a.release(r);var n=o;n&&c<=i?d.paused?c--:(l===o&&(l=null),o=n.next,n.next=null,t.call(e,n.value,n.worked),null===l&&d.empty()):0===--c&&d.drain()}}function n(){}function s(){this.value=null,this.callback=n,this.next=null,this.release=n,this.context=null,this.errorHandler=null;var e=this;this.worked=function(t,r){var i=e.callback,s=e.errorHandler,a=e.value;e.value=null,e.callback=n,e.errorHandler&&s(t,a),i.call(e.context,t,r),e.release(e)}}t.exports=i,t.exports.promise=function(e,t,r){"function"==typeof e&&(r=t,t=e,e=null);var s=i(e,function(e,r){t.call(this,e).then(function(e){r(null,e)},r)},r),a=s.push,o=s.unshift;return s.push=function(e){var t=new Promise(function(t,r){a(e,function(e,i){e?r(e):t(i)})});return t.catch(n),t},s.unshift=function(e){var t=new Promise(function(t,r){o(e,function(e,i){e?r(e):t(i)})});return t.catch(n),t},s.drained=function(){return new Promise(function(e){process.nextTick(function(){if(s.idle())e();else{var t=s.drain;s.drain=function(){"function"==typeof t&&t(),e(),s.drain=t}}})})},s}}),f=u((e,t)=>{var{format:r}=c("node:util");function i(){return`${this.name} [${this.code}]: ${this.message}`}function n(e,t,n=500,s=Error){if(!e)throw new Error("Fastify error code must not be empty");if(!t)throw new Error("Fastify error message must not be empty");function a(...i){if(!new.target)return new a(...i);this.code=e,this.name="FastifyError",this.statusCode=n;let s=i.length-1;-1!==s&&i[s]&&"object"==typeof i[s]&&"cause"in i[s]&&(this.cause=i.pop().cause),this.message=r(t,...i),0!==Error.stackTraceLimit&&Error.captureStackTrace(this,a)}return e=e.toUpperCase(),!n&&(n=void 0),(a.prototype=Object.create(s.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}))[Symbol.toStringTag]="Error",a.prototype.toString=i,a}t.exports=n,t.exports.default=n,t.exports.createError=n}),m=u((e,t)=>{var{createError:r}=f();t.exports={AVV_ERR_EXPOSE_ALREADY_DEFINED:r("AVV_ERR_EXPOSE_ALREADY_DEFINED","'%s' is already defined, specify an expose option for '%s'"),AVV_ERR_ATTRIBUTE_ALREADY_DEFINED:r("AVV_ERR_ATTRIBUTE_ALREADY_DEFINED","'%s' is already defined"),AVV_ERR_CALLBACK_NOT_FN:r("AVV_ERR_CALLBACK_NOT_FN","Callback for '%s' hook is not a function. Received: '%s'"),AVV_ERR_PLUGIN_NOT_VALID:r("AVV_ERR_PLUGIN_NOT_VALID","Plugin must be a function or a promise. Received: '%s'"),AVV_ERR_ROOT_PLG_BOOTED:r("AVV_ERR_ROOT_PLG_BOOTED","Root plugin has already booted"),AVV_ERR_PARENT_PLG_LOADED:r("AVV_ERR_PARENT_PLG_LOADED","Impossible to load '%s' plugin because the parent '%s' was already loaded"),AVV_ERR_READY_TIMEOUT:r("AVV_ERR_READY_TIMEOUT","Plugin did not start in time: '%s'. You may have forgotten to call 'done' function or to resolve a Promise"),AVV_ERR_PLUGIN_EXEC_TIMEOUT:r("AVV_ERR_PLUGIN_EXEC_TIMEOUT","Plugin did not start in time: '%s'. You may have forgotten to call 'done' function or to resolve a Promise")}}),g=u((e,t)=>{var r=Symbol("avvio.Boot"),i=Symbol("isOnCloseHandler"),n=Symbol("avvio.ThenifyDoNotWrap"),s=Symbol("avvio.TimeTree.untrackNode"),a=Symbol("avvio.TimeTree.trackNode"),o=Symbol("avvio.TimeTree.getParent"),l=Symbol("avvio.TimeTree.getNode"),c=Symbol("avvio.TimeTree.addNode"),u=Symbol.for("plugin-meta");t.exports={kAvvio:r,kIsOnCloseHandler:i,kThenifyDoNotWrap:n,kUntrackNode:s,kTrackNode:a,kGetParent:o,kGetNode:l,kAddNode:c,kPluginMeta:u}}),y=u((e,t)=>{var{kUntrackNode:r,kTrackNode:i,kGetParent:n,kGetNode:s,kAddNode:a}=g();function o(e,t=""){let r=t,i=e.nodes.length,n=i-1;r+=`${e.label} ${e.diff} ms\n`;for(let s=0;s<i;++s){let i=e.nodes[s];r+=t,r+=s===n?"└─":"├─",r+=0===i.nodes.length?"─ ":"┬ ",r+=o(i,t+(s===n?"  ":"│ ")).slice(t.length+2)}return r}t.exports={TimeTree:class{constructor(){this.root=null,this.tableId=new Map,this.tableLabel=new Map}[i](e){this.tableId.set(e.id,e),this.tableLabel.has(e.label)?this.tableLabel.get(e.label).push(e):this.tableLabel.set(e.label,[e])}[r](e){this.tableId.delete(e.id);let t=this.tableLabel.get(e.label);t.pop(),0===t.length&&this.tableLabel.delete(e.label)}[n](e){if(null===e)return null;if(this.tableLabel.has(e)){let t=this.tableLabel.get(e);return t[t.length-1]}return null}[s](e){return this.tableId.get(e)}[a](e,t,r){let s=this[n](e);if(null===s)return this.root={parent:null,id:"root",label:t,nodes:[],start:r,stop:null,diff:-1},this[i](this.root),this.root.id;let a=`${t}-${Math.random()}`,o={parent:e,id:a,label:t,nodes:[],start:r,stop:null,diff:-1};return s.nodes.push(o),this[i](o),a}start(e,t,r=Date.now()){return this[a](e,t,r)}stop(e,t=Date.now()){let i=this[s](e);i&&(i.stop=t,i.diff=i.stop-i.start||0,this[r](i))}toJSON(){return Object.assign({},this.root)}prettyPrint(){return o(this.toJSON())}}}}),v=u((e,t)=>{var{debuglog:r}=c("node:util"),i=r("avvio");t.exports={debug:i}}),b=u((e,t)=>{t.exports={createPromise:function(){let e={resolve:null,reject:null,promise:null};return e.promise=new Promise((t,r)=>{e.resolve=t,e.reject=r}),e}}}),w=u((e,t)=>{var{kPluginMeta:r}=g();t.exports={getPluginName:function(e,t){return e[r]&&e[r].name?e[r].name:t&&t.name?t.name:e.name?e.name:e.toString().split("\n").slice(0,2).map(e=>e.trim()).join(" -- ")}}}),_=u((e,t)=>{t.exports={isPromiseLike:function(e){return null!==e&&"object"==typeof e&&"function"==typeof e.then}}}),S=u((e,t)=>{var{EventEmitter:r}=c("node:events"),{inherits:i}=c("node:util"),{debug:n}=v(),{createPromise:s}=b(),{AVV_ERR_PLUGIN_EXEC_TIMEOUT:a}=m(),{getPluginName:o}=w(),{isPromiseLike:l}=_();function u(e,t,r,i,n){this.queue=e,this.func=t,this.options=r,this.isAfter=i,this.timeout=n,this.started=!1,this.name=o(t,r),this.queue.pause(),this._error=null,this.loaded=!1,this._promise=null,this.startTime=null}function d(){}i(u,r),u.prototype.exec=function(e,t){n("exec",this.name),this.server=e;let r=this.func,i=this.name,s=!1;this.options="function"==typeof this.options?this.options(this.server):this.options;let o=null,c=e=>{s?n("loading complete",i):(this._error=e,n(e?"exec errored":"exec completed",i),s=!0,o&&clearTimeout(o),t(e))};this.timeout>0&&(n("setting up timeout",i,this.timeout),o=setTimeout(function(){n("timed out",i),o=null;let e=new a(i);e.fn=r,c(e)},this.timeout)),this.started=!0,this.startTime=Date.now(),this.emit("start",this.server?this.server.name:null,this.name,Date.now());let u=r(this.server,this.options,c);l(u)&&(n("exec: resolving promise",i),u.then(()=>process.nextTick(c),e=>process.nextTick(c,e)))},u.prototype.loadedSoFar=function(){if(n("loadedSoFar",this.name),this.loaded)return Promise.resolve();let e,t=()=>{this.server.after((e,t)=>{this._error=e,this.queue.pause(),this._promise&&(e?(n("rejecting promise",this.name,e),this._promise.reject(e)):(n("resolving promise",this.name),this._promise.resolve()),this._promise=null),process.nextTick(t,e)}),this.queue.resume()};return this._promise?e=Promise.resolve():(this._promise=s(),e=this._promise.promise,this.server?t():this.on("start",t)),e},u.prototype.enqueue=function(e,t){n("enqueue",this.name,e.name),this.emit("enqueue",this.server?this.server.name:null,this.name,Date.now()),this.queue.push(e,t)},u.prototype.finish=function(e,t){n("finish",this.name,e);let r=()=>{this.loaded||(n("loaded",this.name),this.emit("loaded",this.server?this.server.name:null,this.name,Date.now()),this.loaded=!0,t(e))};if(e)return this._promise&&(this._promise.reject(e),this._promise=null),void r();let i=()=>{if(n("check",this.name,this.queue.length(),this.queue.running(),this._promise),0===this.queue.length()&&0===this.queue.running())if(this._promise){let e=()=>{n("wrap"),queueMicrotask(i)};this._promise.resolve(),this._promise.promise.then(e,e),this._promise=null}else r();else n("delayed",this.name),this.queue.drain=()=>{n("drain",this.name),this.queue.drain=d,queueMicrotask(i)}};queueMicrotask(i),this.queue.resume()},t.exports={Plugin:u}}),E=u((e,t)=>{var{AVV_ERR_PLUGIN_NOT_VALID:r}=m();t.exports={validatePlugin:function(e){if(!e||"function"!=typeof e&&"function"!=typeof e.then)throw Array.isArray(e)?new r("array"):new r(null===e?"null":typeof e)}}}),k=u((e,t)=>{t.exports={isBundledOrTypescriptPlugin:function(e){return null!==e&&"object"==typeof e&&"function"==typeof e.default}}}),x=u((e,t)=>{var{debug:r}=v(),{kThenifyDoNotWrap:i}=g();t.exports={thenify:function(){if(this.booted)r("thenify returning undefined because we are already booted");else{if(!this[i])return r("thenify"),(e,t)=>this._loadRegistered().then(()=>(this[i]=!0,e(this._server)),t);this[i]=!1}}}}),T=u((e,t)=>{var{isPromiseLike:r}=_(),{kAvvio:i}=g();t.exports={executeWithThenable:function(e,t,n){let s=e.apply(e,t);r(s)&&!s[i]?s.then(()=>process.nextTick(n),e=>process.nextTick(n,e)):n&&process.nextTick(n)}}}),P=u((e,t)=>{var r=h(),i=c("node:events").EventEmitter,n=c("node:util").inherits,{AVV_ERR_EXPOSE_ALREADY_DEFINED:s,AVV_ERR_CALLBACK_NOT_FN:a,AVV_ERR_ROOT_PLG_BOOTED:o,AVV_ERR_READY_TIMEOUT:l,AVV_ERR_ATTRIBUTE_ALREADY_DEFINED:u}=m(),{kAvvio:d,kIsOnCloseHandler:p}=g(),{TimeTree:f}=y(),{Plugin:b}=S(),{debug:w}=v(),{validatePlugin:P}=E(),{isBundledOrTypescriptPlugin:R}=k(),{isPromiseLike:O}=_(),{thenify:$}=x(),{executeWithThenable:C}=T();function A(e,t,i){if("function"==typeof e&&1===arguments.length&&(i=e,t={},e=null),"function"==typeof t&&(i=t,t={}),(t=t||{}).autostart=!1!==t.autostart,t.timeout=Number(t.timeout)||0,t.expose=t.expose||{},!new.target)return new A(e,t,i);this._server=e||this,this._opts=t,e&&this._expose(),this._current=[],this._error=null,this._lastUsed=null,this.setMaxListeners(0),i&&this.once("start",i),this.started=!1,this.booted=!1,this.pluginTree=new f,this._readyQ=r(this,I,1),this._readyQ.pause(),this._readyQ.drain=()=>{this.emit("start"),this._readyQ.drain=N},this._closeQ=r(this,L,1),this._closeQ.pause(),this._closeQ.drain=()=>{this.emit("close"),this._closeQ.drain=N},this._doStart=null;let n=this;this._root=new b(r(this,this._loadPluginNextTick,1),function(e,t,r){n._doStart=r,t.autostart&&n.start()},t,!1,0),this._trackPluginLoading(this._root),this._loadPlugin(this._root,e=>{w("root plugin ready");try{this.emit("preReady"),this._root=null}catch(t){e=e||this._error||t}if(e){if(this._error=e,0===this._readyQ.length())throw e}else this.booted=!0;this._readyQ.resume()})}function N(){}function I(e,t){let r=this._server,i=this._error;if(this._error=null,0===e.length)this._error=i,C(e,[],t);else if(1===e.length)C(e,[i],t);else if(0===this._opts.timeout){let n=e=>{this._error=e,t(this._error)};2===e.length?e(i,n):e(i,r,n)}else j.call(this,e,i,r,t)}function j(e,t,r,i){let n=e.unwrappedName??e.name;w("setting up ready timeout",n,this._opts.timeout);let s=setTimeout(()=>{w("timed out",n),s=null;let t=new l(n);t.fn=e,this._error=t,i(t)},this._opts.timeout);function a(e){s&&(clearTimeout(s),this._error=e,i(this._error))}2===e.length?e(t,a.bind(this)):e(t,r,a.bind(this))}function L(e,t){let r=this._server,i=e[p];if(0===e.length||1===e.length){let n;n=e(i?r:this._error),n&&"function"==typeof n.then?(w("resolving close/onClose promise"),n.then(()=>process.nextTick(t),e=>process.nextTick(t,e))):process.nextTick(t)}else 2===e.length?e(i?r:this._error,t):i?e(r,t):e(this._error,r,t)}function D(e,t){let r=function(t,r){let i;e?0===e.length?(i=e(),i&&i.then?i.then(function(){process.nextTick(r,t)},r):process.nextTick(r,t)):1===e.length?(i=e(t),i&&i.then?i.then(function(){process.nextTick(r)},r):process.nextTick(r)):2===e.length?e(t,r):e(t,this,r):process.nextTick(r)}.bind(t);return r.unwrappedName=e.name,r}n(A,i),A.prototype.start=function(){return this.started=!0,process.nextTick(this._doStart),this},A.prototype.override=function(e,t,r){return e},A.prototype[d]=!0,A.prototype.use=function(e,t){return this._lastUsed=this._addPlugin(e,t,!1),this},A.prototype._loadRegistered=function(){let e=this._current[0];return!this.started&&!this.booted&&process.nextTick(()=>this._root.queue.resume()),e?e.loadedSoFar():Promise.resolve()},Object.defineProperty(A.prototype,"then",{get:$}),A.prototype._addPlugin=function(e,t,i){if(R(e)&&(e=e.default),P(e),t=t||{},this.booted)throw new o;let n=this._current[0],s=this._opts.timeout;if(!n.loaded&&n.timeout>0){let e=Date.now()-n.startTime;s=n.timeout-(e+3)}let a=new b(r(this,this._loadPluginNextTick,1),e,t,i,s);if(this._trackPluginLoading(a),n.loaded)throw new Error(a.name,n.name);return n.enqueue(a,e=>{e&&(this._error=e)}),a},A.prototype._expose=function(){let e=this,t=e._server,{use:r="use",after:i="after",ready:n="ready",onClose:o="onClose",close:l="close"}=this._opts.expose;if(t[r])throw new s(r,"use");if(t[r]=function(t,r){return e.use(t,r),this},t[i])throw new s(i,"after");if(t[i]=function(t){return"function"!=typeof t?e._loadRegistered():(e.after(D(t,this)),this)},t[n])throw new s(n,"ready");if(t[n]=function(t){if(t&&"function"!=typeof t)throw new a(n,typeof t);return e.ready(t?D(t,this):void 0)},t[o])throw new s(o,"onClose");if(t[o]=function(t){if("function"!=typeof t)throw new a(o,typeof t);return e.onClose(function(e,t){return function(t,r){let i;0===e.length?(i=e(),i&&i.then?i.then(function(){process.nextTick(r)},r):process.nextTick(r)):1===e.length?(i=e(this),i&&i.then?i.then(function(){process.nextTick(r)},r):process.nextTick(r)):e(this,r)}.bind(t)}(t,this)),this},t[l])throw new s(l,"close");if(t[l]=function(t){if(t&&"function"!=typeof t)throw new a(l,typeof t);return t?(e.close(D(t,this)),this):e.close()},t.then)throw new u("then");Object.defineProperty(t,"then",{get:$.bind(e)}),t[d]=!0},A.prototype.after=function(e){return e?(this._addPlugin(function(t,r,i){I.call(this,e,i)}.bind(this),{},!0),this):this._loadRegistered()},A.prototype.onClose=function(e){if("function"!=typeof e)throw new a("onClose",typeof e);return e[p]=!0,this._closeQ.unshift(e,e=>{e&&(this._error=e)}),this},A.prototype.close=function(e){let t;if(e){if("function"!=typeof e)throw new a("close",typeof e)}else t=new Promise(function(t,r){e=function(e){if(e)return r(e);t()}});return this.ready(()=>{this._error=null,this._closeQ.push(e),process.nextTick(this._closeQ.resume.bind(this._closeQ))}),t},A.prototype.ready=function(e){if(e){if("function"!=typeof e)throw new a("ready",typeof e);return this._readyQ.push(e),void queueMicrotask(this.start.bind(this))}return new Promise((e,t)=>{this._readyQ.push(function(i,n,s){i?t(i):e(r),process.nextTick(s)}),this.start();let r=this._current[0].server})},A.prototype._trackPluginLoading=function(e){let t=this._current[0]?.name||null;e.once("start",(r,i,n)=>{let s=this.pluginTree.start(t||null,i,n);e.once("loaded",(e,t,r)=>{this.pluginTree.stop(s,r)})})},A.prototype.prettyPrint=function(){return this.pluginTree.prettyPrint()},A.prototype.toJSON=function(){return this.pluginTree.toJSON()},A.prototype._loadPlugin=function(e,t){let r=this;if(O(e.func))return void e.func.then(r=>{"function"==typeof r.default&&(r=r.default),e.func=r,this._loadPlugin(e,t)},t);let i=r._current[0];if(r._current.unshift(e),r._error&&!e.isAfter)return w("skipping loading of plugin as instance errored and it is not an after",e.name),void process.nextTick(s);let n=i&&i.server||r._server;if(!e.isAfter)try{n=r.override(n,e.func,e.options)}catch(t){return w("override errored",e.name),s(t)}function s(i){e.finish(i,e=>{r._current.shift(),t(e)})}e.exec(n,s)},A.prototype._loadPluginNextTick=function(e,t){process.nextTick(this._loadPlugin.bind(this),e,t)},t.exports=A,t.exports.express=function(e){return A(e,{expose:{use:"load"}})}}),R=u((e,t)=>{var r={kAvvioBoot:Symbol("fastify.avvioBoot"),kChildren:Symbol("fastify.children"),kServerBindings:Symbol("fastify.serverBindings"),kBodyLimit:Symbol("fastify.bodyLimit"),kRoutePrefix:Symbol("fastify.routePrefix"),kLogLevel:Symbol("fastify.logLevel"),kLogSerializers:Symbol("fastify.logSerializers"),kHooks:Symbol("fastify.hooks"),kContentTypeParser:Symbol("fastify.contentTypeParser"),kState:Symbol("fastify.state"),kOptions:Symbol("fastify.options"),kDisableRequestLogging:Symbol("fastify.disableRequestLogging"),kPluginNameChain:Symbol("fastify.pluginNameChain"),kRouteContext:Symbol("fastify.context"),kPublicRouteContext:Symbol("fastify.routeOptions"),kGenReqId:Symbol("fastify.genReqId"),kSchemaController:Symbol("fastify.schemaController"),kSchemaHeaders:Symbol("headers-schema"),kSchemaParams:Symbol("params-schema"),kSchemaQuerystring:Symbol("querystring-schema"),kSchemaBody:Symbol("body-schema"),kSchemaResponse:Symbol("response-schema"),kSchemaErrorFormatter:Symbol("fastify.schemaErrorFormatter"),kSchemaVisited:Symbol("fastify.schemas.visited"),kRequest:Symbol("fastify.Request"),kRequestPayloadStream:Symbol("fastify.RequestPayloadStream"),kRequestAcceptVersion:Symbol("fastify.RequestAcceptVersion"),kRequestCacheValidateFns:Symbol("fastify.request.cache.validateFns"),kRequestOriginalUrl:Symbol("fastify.request.originalUrl"),kFourOhFour:Symbol("fastify.404"),kCanSetNotFoundHandler:Symbol("fastify.canSetNotFoundHandler"),kFourOhFourLevelInstance:Symbol("fastify.404LogLevelInstance"),kFourOhFourContext:Symbol("fastify.404ContextKey"),kDefaultJsonParse:Symbol("fastify.defaultJSONParse"),kReply:Symbol("fastify.Reply"),kReplySerializer:Symbol("fastify.reply.serializer"),kReplyIsError:Symbol("fastify.reply.isError"),kReplyHeaders:Symbol("fastify.reply.headers"),kReplyTrailers:Symbol("fastify.reply.trailers"),kReplyHasStatusCode:Symbol("fastify.reply.hasStatusCode"),kReplyHijacked:Symbol("fastify.reply.hijacked"),kReplyStartTime:Symbol("fastify.reply.startTime"),kReplyNextErrorHandler:Symbol("fastify.reply.nextErrorHandler"),kReplyEndTime:Symbol("fastify.reply.endTime"),kReplyErrorHandlerCalled:Symbol("fastify.reply.errorHandlerCalled"),kReplyIsRunningOnErrorHook:Symbol("fastify.reply.isRunningOnErrorHook"),kReplySerializerDefault:Symbol("fastify.replySerializerDefault"),kReplyCacheSerializeFns:Symbol("fastify.reply.cache.serializeFns"),kTestInternals:Symbol("fastify.testInternals"),kErrorHandler:Symbol("fastify.errorHandler"),kChildLoggerFactory:Symbol("fastify.childLoggerFactory"),kHasBeenDecorated:Symbol("fastify.hasBeenDecorated"),kKeepAliveConnections:Symbol("fastify.keepAliveConnections"),kRouteByFastify:Symbol("fastify.routeByFastify")};t.exports=r}),O=u((e,t)=>{var{format:r}=c("node:util");function i({name:e,code:t,message:i,unlimited:n=!1}={}){if(!e)throw new Error("Warning name must not be empty");if(!t)throw new Error("Warning code must not be empty");if(!i)throw new Error("Warning message must not be empty");if("boolean"!=typeof n)throw new Error("Warning opts.unlimited must be a boolean");t=t.toUpperCase();let s={[e]:function(e,t,r){!0===a.emitted&&!0!==a.unlimited||(a.emitted=!0,process.emitWarning(a.format(e,t,r),a.name,a.code))}};n&&(s={[e]:function(e,t,r){a.emitted=!0,process.emitWarning(a.format(e,t,r),a.name,a.code)}});let a=s[e];return a.emitted=!1,a.message=i,a.unlimited=n,a.code=t,a.format=function(e,t,n){let s;return s=e&&t&&n?r(i,e,t,n):e&&t?r(i,e,t):e?r(i,e):i,s},a}var n={createWarning:i,createDeprecation:function(e){return i({...e,name:"DeprecationWarning"})}};t.exports=n,t.exports.default=n,t.exports.processWarning=n}),$=u((e,t)=>{var{createDeprecation:r,createWarning:i}=O(),n=r({code:"FSTDEP005",message:'You are accessing the deprecated "request.connection" property. Use "request.socket" instead.'}),s=r({code:"FSTDEP006",message:"You are decorating Request/Reply with a reference type. This reference is shared amongst all requests. Use onRequest hook instead. Property: %s"}),a=r({code:"FSTDEP007",message:'You are trying to set a HEAD route using "exposeHeadRoute" route flag when a sibling route is already set. See documentation for more info.'}),o=r({code:"FSTDEP008",message:'You are using route constraints via the route { version: "..." } option, use { constraints: { version: "..." } } option instead.'}),l=r({code:"FSTDEP009",message:'You are using a custom route versioning strategy via the server { versioning: "..." } option, use { constraints: { version: "..." } } option instead.'}),c=r({code:"FSTDEP010",message:'Modifying the "reply.sent" property is deprecated. Use the "reply.hijack()" method instead.'}),u=r({code:"FSTDEP011",message:'Variadic listen method is deprecated. Please use ".listen(optionsObject)" instead. The variadic signature will be removed in `fastify@5`.'}),d=r({code:"FSTDEP012",message:'request.context property access is deprecated. Please use "request.routeOptions.config" or "request.routeOptions.schema" instead for accessing Route settings. The "request.context" will be removed in `fastify@5`.'}),p=r({code:"FSTDEP013",message:'Direct return of "trailers" function is deprecated. Please use "callback" or "async-await" for return value. The support of direct return will removed in `fastify@5`.'}),h=r({code:"FSTDEP014",message:"You are trying to set/access the default route. This property is deprecated. Please, use setNotFoundHandler if you want to custom a 404 handler or the wildcard (*) to match all routes."}),f=r({code:"FSTDEP015",message:'You are accessing the deprecated "request.routeSchema" property. Use "request.routeOptions.schema" instead. Property "req.routeSchema" will be removed in `fastify@5`.'}),m=r({code:"FSTDEP016",message:'You are accessing the deprecated "request.routeConfig" property. Use "request.routeOptions.config" instead. Property "req.routeConfig" will be removed in `fastify@5`.'}),g=r({code:"FSTDEP017",message:'You are accessing the deprecated "request.routerPath" property. Use "request.routeOptions.url" instead. Property "req.routerPath" will be removed in `fastify@5`.'}),y=r({code:"FSTDEP018",message:'You are accessing the deprecated "request.routerMethod" property. Use "request.routeOptions.method" instead. Property "req.routerMethod" will be removed in `fastify@5`.'}),v=r({code:"FSTDEP019",message:'reply.context property access is deprecated. Please use "request.routeOptions.config" or "request.routeOptions.schema" instead for accessing Route settings. The "reply.context" will be removed in `fastify@5`.'}),b=r({code:"FSTDEP020",message:'You are using the deprecated "reply.getResponseTime()" method. Use the "reply.elapsedTime" property instead. Method "reply.getResponseTime()" will be removed in `fastify@5`.'}),w=r({code:"FSTDEP021",message:"The `reply.redirect()` method has a new signature: `reply.redirect(url: string, code?: number)`. It will be enforced in `fastify@v5`"}),_=r({code:"FSTDEP021",message:"You are using the deprecated json shorthand schema on route %s. Specify full object schema instead. It will be removed in `fastify@v5`"}),S=i({name:"FastifyWarning",code:"FSTWRN001",message:"The %s schema for %s: %s is missing. This may indicate the schema is not well specified.",unlimited:!0}),E=i({name:"FastifyWarning",code:"FSTWRN002",message:"The %s plugin being registered mixes async and callback styles, which will result in an error in `fastify@5`",unlimited:!0});t.exports={FSTDEP005:n,FSTDEP006:s,FSTDEP007:a,FSTDEP008:o,FSTDEP009:l,FSTDEP010:c,FSTDEP011:u,FSTDEP012:d,FSTDEP013:p,FSTDEP014:h,FSTDEP015:f,FSTDEP016:m,FSTDEP017:g,FSTDEP018:y,FSTDEP019:v,FSTDEP020:b,FSTDEP021:w,FSTDEP022:_,FSTWRN001:S,FSTWRN002:E}}),C=u((e,t)=>{var r=f(),i={FST_ERR_NOT_FOUND:r("FST_ERR_NOT_FOUND","Not Found",404),FST_ERR_OPTIONS_NOT_OBJ:r("FST_ERR_OPTIONS_NOT_OBJ","Options must be an object",500,TypeError),FST_ERR_QSP_NOT_FN:r("FST_ERR_QSP_NOT_FN","querystringParser option should be a function, instead got '%s'",500,TypeError),FST_ERR_SCHEMA_CONTROLLER_BUCKET_OPT_NOT_FN:r("FST_ERR_SCHEMA_CONTROLLER_BUCKET_OPT_NOT_FN","schemaController.bucket option should be a function, instead got '%s'",500,TypeError),FST_ERR_SCHEMA_ERROR_FORMATTER_NOT_FN:r("FST_ERR_SCHEMA_ERROR_FORMATTER_NOT_FN","schemaErrorFormatter option should be a non async function. Instead got '%s'.",500,TypeError),FST_ERR_AJV_CUSTOM_OPTIONS_OPT_NOT_OBJ:r("FST_ERR_AJV_CUSTOM_OPTIONS_OPT_NOT_OBJ","ajv.customOptions option should be an object, instead got '%s'",500,TypeError),FST_ERR_AJV_CUSTOM_OPTIONS_OPT_NOT_ARR:r("FST_ERR_AJV_CUSTOM_OPTIONS_OPT_NOT_ARR","ajv.plugins option should be an array, instead got '%s'",500,TypeError),FST_ERR_VERSION_CONSTRAINT_NOT_STR:r("FST_ERR_VERSION_CONSTRAINT_NOT_STR","Version constraint should be a string.",500,TypeError),FST_ERR_VALIDATION:r("FST_ERR_VALIDATION","%s",400),FST_ERR_LISTEN_OPTIONS_INVALID:r("FST_ERR_LISTEN_OPTIONS_INVALID","Invalid listen options: '%s'",500,TypeError),FST_ERR_ERROR_HANDLER_NOT_FN:r("FST_ERR_ERROR_HANDLER_NOT_FN","Error Handler must be a function",500,TypeError),FST_ERR_CTP_ALREADY_PRESENT:r("FST_ERR_CTP_ALREADY_PRESENT","Content type parser '%s' already present."),FST_ERR_CTP_INVALID_TYPE:r("FST_ERR_CTP_INVALID_TYPE","The content type should be a string or a RegExp",500,TypeError),FST_ERR_CTP_EMPTY_TYPE:r("FST_ERR_CTP_EMPTY_TYPE","The content type cannot be an empty string",500,TypeError),FST_ERR_CTP_INVALID_HANDLER:r("FST_ERR_CTP_INVALID_HANDLER","The content type handler should be a function",500,TypeError),FST_ERR_CTP_INVALID_PARSE_TYPE:r("FST_ERR_CTP_INVALID_PARSE_TYPE","The body parser can only parse your data as 'string' or 'buffer', you asked '%s' which is not supported.",500,TypeError),FST_ERR_CTP_BODY_TOO_LARGE:r("FST_ERR_CTP_BODY_TOO_LARGE","Request body is too large",413,RangeError),FST_ERR_CTP_INVALID_MEDIA_TYPE:r("FST_ERR_CTP_INVALID_MEDIA_TYPE","Unsupported Media Type: %s",415),FST_ERR_CTP_INVALID_CONTENT_LENGTH:r("FST_ERR_CTP_INVALID_CONTENT_LENGTH","Request body size did not match Content-Length",400,RangeError),FST_ERR_CTP_EMPTY_JSON_BODY:r("FST_ERR_CTP_EMPTY_JSON_BODY","Body cannot be empty when content-type is set to 'application/json'",400),FST_ERR_CTP_INSTANCE_ALREADY_STARTED:r("FST_ERR_CTP_INSTANCE_ALREADY_STARTED",'Cannot call "%s" when fastify instance is already started!',400),FST_ERR_DEC_ALREADY_PRESENT:r("FST_ERR_DEC_ALREADY_PRESENT","The decorator '%s' has already been added!"),FST_ERR_DEC_DEPENDENCY_INVALID_TYPE:r("FST_ERR_DEC_DEPENDENCY_INVALID_TYPE","The dependencies of decorator '%s' must be of type Array.",500,TypeError),FST_ERR_DEC_MISSING_DEPENDENCY:r("FST_ERR_DEC_MISSING_DEPENDENCY","The decorator is missing dependency '%s'."),FST_ERR_DEC_AFTER_START:r("FST_ERR_DEC_AFTER_START","The decorator '%s' has been added after start!"),FST_ERR_HOOK_INVALID_TYPE:r("FST_ERR_HOOK_INVALID_TYPE","The hook name must be a string",500,TypeError),FST_ERR_HOOK_INVALID_HANDLER:r("FST_ERR_HOOK_INVALID_HANDLER","%s hook should be a function, instead got %s",500,TypeError),FST_ERR_HOOK_INVALID_ASYNC_HANDLER:r("FST_ERR_HOOK_INVALID_ASYNC_HANDLER","Async function has too many arguments. Async hooks should not use the 'done' argument.",500,TypeError),FST_ERR_HOOK_NOT_SUPPORTED:r("FST_ERR_HOOK_NOT_SUPPORTED","%s hook not supported!",500,TypeError),FST_ERR_MISSING_MIDDLEWARE:r("FST_ERR_MISSING_MIDDLEWARE","You must register a plugin for handling middlewares, visit fastify.dev/docs/latest/Reference/Middleware/ for more info.",500),FST_ERR_HOOK_TIMEOUT:r("FST_ERR_HOOK_TIMEOUT","A callback for '%s' hook timed out. You may have forgotten to call 'done' function or to resolve a Promise"),FST_ERR_LOG_INVALID_DESTINATION:r("FST_ERR_LOG_INVALID_DESTINATION","Cannot specify both logger.stream and logger.file options"),FST_ERR_LOG_INVALID_LOGGER:r("FST_ERR_LOG_INVALID_LOGGER","Invalid logger object provided. The logger instance should have these functions(s): '%s'.",500,TypeError),FST_ERR_REP_INVALID_PAYLOAD_TYPE:r("FST_ERR_REP_INVALID_PAYLOAD_TYPE","Attempted to send payload of invalid type '%s'. Expected a string or Buffer.",500,TypeError),FST_ERR_REP_RESPONSE_BODY_CONSUMED:r("FST_ERR_REP_RESPONSE_BODY_CONSUMED","Response.body is already consumed."),FST_ERR_REP_ALREADY_SENT:r("FST_ERR_REP_ALREADY_SENT",'Reply was already sent, did you forget to "return reply" in "%s" (%s)?'),FST_ERR_REP_SENT_VALUE:r("FST_ERR_REP_SENT_VALUE","The only possible value for reply.sent is true.",500,TypeError),FST_ERR_SEND_INSIDE_ONERR:r("FST_ERR_SEND_INSIDE_ONERR","You cannot use `send` inside the `onError` hook"),FST_ERR_SEND_UNDEFINED_ERR:r("FST_ERR_SEND_UNDEFINED_ERR","Undefined error has occurred"),FST_ERR_BAD_STATUS_CODE:r("FST_ERR_BAD_STATUS_CODE","Called reply with an invalid status code: %s"),FST_ERR_BAD_TRAILER_NAME:r("FST_ERR_BAD_TRAILER_NAME","Called reply.trailer with an invalid header name: %s"),FST_ERR_BAD_TRAILER_VALUE:r("FST_ERR_BAD_TRAILER_VALUE","Called reply.trailer('%s', fn) with an invalid type: %s. Expected a function."),FST_ERR_FAILED_ERROR_SERIALIZATION:r("FST_ERR_FAILED_ERROR_SERIALIZATION","Failed to serialize an error. Error: %s. Original error: %s"),FST_ERR_MISSING_SERIALIZATION_FN:r("FST_ERR_MISSING_SERIALIZATION_FN",'Missing serialization function. Key "%s"'),FST_ERR_MISSING_CONTENTTYPE_SERIALIZATION_FN:r("FST_ERR_MISSING_CONTENTTYPE_SERIALIZATION_FN",'Missing serialization function. Key "%s:%s"'),FST_ERR_REQ_INVALID_VALIDATION_INVOCATION:r("FST_ERR_REQ_INVALID_VALIDATION_INVOCATION",'Invalid validation invocation. Missing validation function for HTTP part "%s" nor schema provided.'),FST_ERR_SCH_MISSING_ID:r("FST_ERR_SCH_MISSING_ID","Missing schema $id property"),FST_ERR_SCH_ALREADY_PRESENT:r("FST_ERR_SCH_ALREADY_PRESENT","Schema with id '%s' already declared!"),FST_ERR_SCH_CONTENT_MISSING_SCHEMA:r("FST_ERR_SCH_CONTENT_MISSING_SCHEMA","Schema is missing for the content type '%s'"),FST_ERR_SCH_DUPLICATE:r("FST_ERR_SCH_DUPLICATE","Schema with '%s' already present!"),FST_ERR_SCH_VALIDATION_BUILD:r("FST_ERR_SCH_VALIDATION_BUILD","Failed building the validation schema for %s: %s, due to error %s"),FST_ERR_SCH_SERIALIZATION_BUILD:r("FST_ERR_SCH_SERIALIZATION_BUILD","Failed building the serialization schema for %s: %s, due to error %s"),FST_ERR_SCH_RESPONSE_SCHEMA_NOT_NESTED_2XX:r("FST_ERR_SCH_RESPONSE_SCHEMA_NOT_NESTED_2XX",'response schemas should be nested under a valid status code, e.g { 2xx: { type: "object" } }'),FST_ERR_HTTP2_INVALID_VERSION:r("FST_ERR_HTTP2_INVALID_VERSION","HTTP2 is available only from node >= 8.8.1"),FST_ERR_INIT_OPTS_INVALID:r("FST_ERR_INIT_OPTS_INVALID","Invalid initialization options: '%s'"),FST_ERR_FORCE_CLOSE_CONNECTIONS_IDLE_NOT_AVAILABLE:r("FST_ERR_FORCE_CLOSE_CONNECTIONS_IDLE_NOT_AVAILABLE","Cannot set forceCloseConnections to 'idle' as your HTTP server does not support closeIdleConnections method"),FST_ERR_DUPLICATED_ROUTE:r("FST_ERR_DUPLICATED_ROUTE","Method '%s' already declared for route '%s'"),FST_ERR_BAD_URL:r("FST_ERR_BAD_URL","'%s' is not a valid url component",400,URIError),FST_ERR_ASYNC_CONSTRAINT:r("FST_ERR_ASYNC_CONSTRAINT","Unexpected error from async constraint",500),FST_ERR_DEFAULT_ROUTE_INVALID_TYPE:r("FST_ERR_DEFAULT_ROUTE_INVALID_TYPE","The defaultRoute type should be a function",500,TypeError),FST_ERR_INVALID_URL:r("FST_ERR_INVALID_URL","URL must be a string. Received '%s'",400,TypeError),FST_ERR_ROUTE_OPTIONS_NOT_OBJ:r("FST_ERR_ROUTE_OPTIONS_NOT_OBJ",'Options for "%s:%s" route must be an object',500,TypeError),FST_ERR_ROUTE_DUPLICATED_HANDLER:r("FST_ERR_ROUTE_DUPLICATED_HANDLER",'Duplicate handler for "%s:%s" route is not allowed!',500),FST_ERR_ROUTE_HANDLER_NOT_FN:r("FST_ERR_ROUTE_HANDLER_NOT_FN","Error Handler for %s:%s route, if defined, must be a function",500,TypeError),FST_ERR_ROUTE_MISSING_HANDLER:r("FST_ERR_ROUTE_MISSING_HANDLER",'Missing handler function for "%s:%s" route.',500),FST_ERR_ROUTE_METHOD_INVALID:r("FST_ERR_ROUTE_METHOD_INVALID","Provided method is invalid!",500,TypeError),FST_ERR_ROUTE_METHOD_NOT_SUPPORTED:r("FST_ERR_ROUTE_METHOD_NOT_SUPPORTED","%s method is not supported.",500),FST_ERR_ROUTE_BODY_VALIDATION_SCHEMA_NOT_SUPPORTED:r("FST_ERR_ROUTE_BODY_VALIDATION_SCHEMA_NOT_SUPPORTED","Body validation schema for %s:%s route is not supported!",500),FST_ERR_ROUTE_BODY_LIMIT_OPTION_NOT_INT:r("FST_ERR_ROUTE_BODY_LIMIT_OPTION_NOT_INT","'bodyLimit' option must be an integer > 0. Got '%s'",500,TypeError),FST_ERR_ROUTE_REWRITE_NOT_STR:r("FST_ERR_ROUTE_REWRITE_NOT_STR",'Rewrite url for "%s" needs to be of type "string" but received "%s"',500,TypeError),FST_ERR_REOPENED_CLOSE_SERVER:r("FST_ERR_REOPENED_CLOSE_SERVER","Fastify has already been closed and cannot be reopened"),FST_ERR_REOPENED_SERVER:r("FST_ERR_REOPENED_SERVER","Fastify is already listening"),FST_ERR_INSTANCE_ALREADY_LISTENING:r("FST_ERR_INSTANCE_ALREADY_LISTENING","Fastify instance is already listening. %s"),FST_ERR_PLUGIN_VERSION_MISMATCH:r("FST_ERR_PLUGIN_VERSION_MISMATCH","fastify-plugin: %s - expected '%s' fastify version, '%s' is installed"),FST_ERR_PLUGIN_NOT_PRESENT_IN_INSTANCE:r("FST_ERR_PLUGIN_NOT_PRESENT_IN_INSTANCE","The decorator '%s'%s is not present in %s"),FST_ERR_PLUGIN_CALLBACK_NOT_FN:r("FST_ERR_PLUGIN_CALLBACK_NOT_FN","fastify-plugin: %s",500,TypeError),FST_ERR_PLUGIN_NOT_VALID:r("FST_ERR_PLUGIN_NOT_VALID","fastify-plugin: %s"),FST_ERR_ROOT_PLG_BOOTED:r("FST_ERR_ROOT_PLG_BOOTED","fastify-plugin: %s"),FST_ERR_PARENT_PLUGIN_BOOTED:r("FST_ERR_PARENT_PLUGIN_BOOTED","fastify-plugin: %s"),FST_ERR_PLUGIN_TIMEOUT:r("FST_ERR_PLUGIN_TIMEOUT","fastify-plugin: %s")};t.exports=i,t.exports.appendStackTrace=function(e,t){return t.cause=e,t},t.exports.AVVIO_ERRORS_MAP={AVV_ERR_CALLBACK_NOT_FN:i.FST_ERR_PLUGIN_CALLBACK_NOT_FN,AVV_ERR_PLUGIN_NOT_VALID:i.FST_ERR_PLUGIN_NOT_VALID,AVV_ERR_ROOT_PLG_BOOTED:i.FST_ERR_ROOT_PLG_BOOTED,AVV_ERR_PARENT_PLG_LOADED:i.FST_ERR_PARENT_PLUGIN_BOOTED,AVV_ERR_READY_TIMEOUT:i.FST_ERR_PLUGIN_TIMEOUT,AVV_ERR_PLUGIN_EXEC_TIMEOUT:i.FST_ERR_PLUGIN_TIMEOUT}}),A=u((e,t)=>{var r=["onTimeout","onRequest","preParsing","preValidation","preSerialization","preHandler","onSend","onResponse","onError","onRequestAbort"],i=r.concat(["onRoute","onRegister","onReady","onListen","preClose","onClose"]),{FST_ERR_HOOK_INVALID_TYPE:n,FST_ERR_HOOK_INVALID_HANDLER:s,FST_ERR_SEND_UNDEFINED_ERR:a,FST_ERR_HOOK_TIMEOUT:o,FST_ERR_HOOK_NOT_SUPPORTED:l,AVVIO_ERRORS_MAP:c,appendStackTrace:u}=C(),{kChildren:d,kHooks:p,kRequestPayloadStream:h}=R();function f(){this.onRequest=[],this.preParsing=[],this.preValidation=[],this.preSerialization=[],this.preHandler=[],this.onResponse=[],this.onSend=[],this.onError=[],this.onRoute=[],this.onRegister=[],this.onReady=[],this.onListen=[],this.onTimeout=[],this.onRequestAbort=[],this.preClose=[]}function m(e){return function(t,r,i,n){let s=0;function o(a){if(a||s===t.length)return void n(a,r,i);let u;try{u=e(t[s++],r,i,o)}catch(e){return void n(e,r,i)}u&&"function"==typeof u.then&&u.then(l,c)}function l(){o()}function c(e){e||(e=new a),n(e,r,i)}o()}}(f.prototype=Object.create(null)).validate=function(e,t){if("string"!=typeof e)throw new n;if(!1===Array.isArray(this[e]))throw new l(e);if("function"!=typeof t)throw new s(e,Object.prototype.toString.call(t))},f.prototype.add=function(e,t){this.validate(e,t),this[e].push(t)};var g=m(function(e,t,r,i){return e(t,r,i)}),y=m(S),v=m(S),b=m(S),w=m(S);function _(e,t,r,i,n){let s=0;function o(a,u){if(a)return void n(a,t,r,i);if(void 0!==u&&(i=u),s===e.length)return void n(null,t,r,i);let d;try{d=e[s++](t,r,i,o)}catch(e){return void n(e,t,r)}d&&"function"==typeof d.then&&d.then(l,c)}function l(e){o(null,e)}function c(e){e||(e=new a),n(e,t,r,i)}o()}function S(e,t,r,i){if(!0!==r.sent)return e(t,r,i)}t.exports={Hooks:f,buildHooks:function(e){let t=new f;return t.onRequest=e.onRequest.slice(),t.preParsing=e.preParsing.slice(),t.preValidation=e.preValidation.slice(),t.preSerialization=e.preSerialization.slice(),t.preHandler=e.preHandler.slice(),t.onSend=e.onSend.slice(),t.onResponse=e.onResponse.slice(),t.onError=e.onError.slice(),t.onRoute=e.onRoute.slice(),t.onRegister=e.onRegister.slice(),t.onTimeout=e.onTimeout.slice(),t.onRequestAbort=e.onRequestAbort.slice(),t.onReady=[],t.onListen=[],t.preClose=[],t},hookRunnerGenerator:m,preParsingHookRunner:function(e,t,r,i){let n=0;function s(a,c){if(r.sent)return;if(void 0!==c&&(t[h]=c),a||n===e.length)return void i(a,t,r);let u;try{u=e[n++](t,r,t[h],s)}catch(e){return void i(e,t,r)}u&&"function"==typeof u.then&&u.then(o,l)}function o(e){s(null,e)}function l(e){e||(e=new a),i(e,t,r)}s()},onResponseHookRunner:g,onSendHookRunner:_,preSerializationHookRunner:_,onRequestAbortHookRunner:function(e,t,r){let i=0;function n(a){if(a||i===e.length)return void r(a,t);let l;try{l=e[i++](t,n)}catch(e){return void r(e,t)}l&&"function"==typeof l.then&&l.then(s,o)}function s(){n()}function o(e){e||(e=new a),r(e,t)}n()},hookIterator:S,hookRunnerApplication:function e(t,r,i,n){let s=i[p][t],a=0,l=0;function h(e){if(e)return e="AVV_ERR_READY_TIMEOUT"===e.code?u(e,new o(t)):null!=c[e.code]?u(e,new c[e.code](e.message)):e,void n(e);n()}!function n(o){if(o)h(o);else if(a!==s.length||l!==i[d].length){if(a===s.length&&l<i[d].length){let s=i[d][l++];return void e(t,r,s,n)}r(function(e,t){return function(r,i){if(r)i(r);else if(1!==e.length){try{let r=e.call(t);if(r&&"function"==typeof r.then)return void r.then(i,i)}catch(e){r=e}i(r)}else try{e.call(t,i)}catch(e){i(e)}}}(s[a++],i)),n()}else 0===a&&0===l?h():r(function(e,t){h(e),t(e)})}()},onListenHookRunner:function e(t){let r=t[p].onListen,i=r.length,n=0,s=0;!function a(o){if(o&&t.log.error(o),n!==i)!async function(e,t,r){if(1!==e.length)try{let i=e.call(t);if(i&&"function"==typeof i.then)return void i.then(r,r);r()}catch(e){r(e)}else try{e.call(t,r)}catch(e){r(e)}}(r[n++],t,a);else for(;s<t[d].length;)e(t[d][s++])}()},preHandlerHookRunner:v,preValidationHookRunner:y,onRequestHookRunner:w,onTimeoutHookRunner:b,lifecycleHooks:r,supportedHooks:i}}),N=u((e,t)=>{var r=c("node:http"),i=c("node:https"),n=c("node:dns"),{FSTDEP011:s}=$(),{kState:a,kOptions:o,kServerBindings:l}=R(),{onListenHookRunner:u}=A(),{FST_ERR_HTTP2_INVALID_VERSION:d,FST_ERR_REOPENED_CLOSE_SERVER:p,FST_ERR_REOPENED_SERVER:h,FST_ERR_LISTEN_OPTIONS_INVALID:f}=C();function m(e){return`Server listening at ${e}`}function g(e,t,r,i,s){this[a].listening=!1,n.lookup(i.host,{all:!0},(n,o)=>{if(n)return void s();let c=0,u=0;if(!e.listening||!r.serverFactory){let n=e.address();for(let d of o)if(d.address!==n.address){c++;let o=Object.assign({},i,{host:d.address,port:n.port,cb:e=>{u++,e||this[l].push(p),u===c&&s()}}),p=b(r,t),h=()=>{p.close(()=>{}),"idle"===r.forceCloseConnections?p.closeIdleConnections():"function"==typeof p.closeAllConnections&&r.forceCloseConnections&&p.closeAllConnections()};p.on("upgrade",e.emit.bind(e,"upgrade")),e.on("unref",h),e.on("close",h),e.on("error",h),this[a].listening=!1,y.call(this,p,o)()}}if(0===c)return void s();let d=e.unref;e.unref=function(){d.call(e),e.emit("unref")}})}function y(e,t){let r=i=>{if(e.removeListener("error",r),e.removeListener("listening",r),i)this[a].listening=!1,t.cb(i,null);else{let r=_.call(this,e,t.listenTextResolver||m);t.cb(null,r)}};return i=>null!=i?t.cb(i):this[a].listening&&this[a].closing?t.cb(new p,null):this[a].listening?t.cb(new h,null):(e.once("error",r),void(this[a].closing||(e.once("listening",r),e.listen(t),this[a].listening=!0)))}function v(e,t){return this[a].listening&&this[a].closing?Promise.reject(new p):this[a].listening?Promise.reject(new h):this.ready().then(()=>{let r,i;function n(){e.removeListener("error",r),e.removeListener("listening",i)}let s=new Promise((t,i)=>{r=e=>{n(),this[a].listening=!1,i(e)},e.once("error",r)}),o=new Promise((r,s)=>{i=()=>{n(),this[a].listening=!0,r(_.call(this,e,t.listenTextResolver||m))},e.once("listening",i)});return e.listen(t),Promise.race([s,o])})}function b(e,t){let n=null,s=!0===e.https?{}:e.https;return e.serverFactory?n=e.serverFactory(t,e):e.http2?(n="object"==typeof s?S().createSecureServer(s,t):S().createServer(t),n.on("session",function(e){return function(t){t.setTimeout(e,E)}}(e.http2SessionTimeout))):(n=s?i.createServer(s,t):r.createServer(e.http,t),n.keepAliveTimeout=e.keepAliveTimeout,n.requestTimeout=e.requestTimeout,e.maxRequestsPerSocket>0&&(n.maxRequestsPerSocket=e.maxRequestsPerSocket)),e.serverFactory||n.setTimeout(e.connectionTimeout),n}function w(e){if(0===e.length)return{port:0,host:"localhost"};let t={cb:"function"==typeof e[e.length-1]?e.pop():void 0},r=e[0],i=e.length,n=e[i-1];return"string"==typeof r&&isNaN(r)?(t.path=r,t.backlog=i>1?n:void 0):(t.port=i>=1&&Number.isInteger(r)?r:function(e){let t=Number(e);return t>=0&&!Number.isNaN(t)&&Number.isInteger(t)?t:0}(r),t.host=i>=2&&e[1]?e[1]:"localhost",t.backlog=i>=3?e[2]:void 0),t}function _(e,t){let r=e.address(),i="string"==typeof r;i||(r=-1===r.address.indexOf(":")?r.address+":"+r.port:"["+r.address+"]:"+r.port),r=(i?"":"http"+(this[o].https?"s":"")+"://")+r;let n=t(r);return this.log.info(n),r}function S(){try{return c("node:http2")}catch{throw new d}}function E(){this.close()}t.exports.createServer=function(e,t){let r=b(e,t);return{server:r,listen:function(i,...n){let o,l=n.slice(-1).pop(),c=Object.prototype.toString.call(arguments[0]);if(0===arguments.length?i=w([]):arguments.length>0&&"[object Object]"!==c&&"[object Function]"!==c?(s(),i=w(Array.from(arguments)),l=i.cb):n.length>1?(s(),Object.assign(i,w([...i.path?[i.path]:[i.port??0,i.host??"localhost"],...n]))):i.cb=l,i.signal){if("function"!=typeof i.signal.on&&"function"!=typeof i.signal.addEventListener)throw new f("Invalid options.signal");i.signal.aborted?this.close():i.signal.addEventListener("abort",()=>{this.close()},{once:!0})}if(o=null==i.path?i.host??"localhost":i.host,(!1===Object.prototype.hasOwnProperty.call(i,"host")||null==i.host)&&(i.host=o),i.cb="localhost"===o?(n,s)=>{n?l(n,s):g.call(this,r,t,e,i,()=>{this[a].listening=!0,l(null,s),u(this)})}:(e,t)=>{e?l(e,t):(this[a].listening=!0,l(null,t),u(this))},void 0===l)return v.call(this,r,i).then(n=>new Promise((s,l)=>{"localhost"===o?g.call(this,r,t,e,i,()=>{this[a].listening=!0,s(n),u(this)}):(s(n),u(this))}));this.ready(y.call(this,r,i))}}},t.exports.compileValidateHTTPVersion=function(e){let t=!1,r=new Map;return e.serverFactory&&(t=!0),e.http2?(r.set("2.0",!0),e.https&&!0===e.https.allowHTTP1&&(r.set("1.1",!0),r.set("1.0",!0))):(r.set("1.1",!0),r.set("1.0",!0)),function(e){return t||r.has(e)}}}),I=u((e,t)=>{var{kSchemaHeaders:r,kSchemaParams:i,kSchemaQuerystring:n,kSchemaBody:s,kSchemaResponse:a}=R(),o=/^[1-5]{1}[0-9]{2}$|^[1-5]xx$|^default$/,{FST_ERR_SCH_RESPONSE_SCHEMA_NOT_NESTED_2XX:l}=C(),{FSTWRN001:c}=$();function u(e,t,r){let i=e&&e(void 0===t[r]?null:t[r]);return i?.then?i.then(e=>n(e)).catch(e=>e):n(i);function n(i){return!1===i?e.errors:i&&i.error?i.error:(i&&i.value&&(t[r]=i.value),!1)}}function d(e,t,r){if(e instanceof Error)return e.statusCode=e.statusCode||400,e.code=e.code||"FST_ERR_VALIDATION",e.validationContext=e.validationContext||t,e;let i=r(e,t);return i.statusCode=i.statusCode||400,i.code=i.code||"FST_ERR_VALIDATION",i.validation=e,i.validationContext=t,i}t.exports={symbols:{bodySchema:s,querystringSchema:n,responseSchema:a,paramsSchema:i,headersSchema:r},compileSchemasForValidation:function(e,t,a){let{schema:o}=e;if(!o)return;let{method:l,url:u}=e.config||{},d=o.headers;if(d&&(a||Object.getPrototypeOf(d)!==Object.prototype))e[r]=t({schema:d,method:l,url:u,httpPart:"headers"});else if(d){let i={};Object.keys(d).forEach(e=>{i[e]=d[e]}),i.required instanceof Array&&(i.required=i.required.map(e=>e.toLowerCase())),d.properties&&(i.properties={},Object.keys(d.properties).forEach(e=>{i.properties[e.toLowerCase()]=d.properties[e]})),e[r]=t({schema:i,method:l,url:u,httpPart:"headers"})}else Object.prototype.hasOwnProperty.call(o,"headers")&&c("headers",l,u);if(o.body){let r=o.body.content;if(r){let i={};for(let e of Object.keys(r))i[e]=t({schema:r[e].schema,method:l,url:u,httpPart:"body",contentType:e});e[s]=i}else e[s]=t({schema:o.body,method:l,url:u,httpPart:"body"})}else Object.prototype.hasOwnProperty.call(o,"body")&&c("body",l,u);o.querystring?e[n]=t({schema:o.querystring,method:l,url:u,httpPart:"querystring"}):Object.prototype.hasOwnProperty.call(o,"querystring")&&c("querystring",l,u),o.params?e[i]=t({schema:o.params,method:l,url:u,httpPart:"params"}):Object.prototype.hasOwnProperty.call(o,"params")&&c("params",l,u)},compileSchemasForSerialization:function(e,t){if(!e.schema||!e.schema.response)return;let{method:r,url:i}=e.config||{};e[a]=Object.keys(e.schema.response).reduce(function(n,s){let a=e.schema.response[s];if(s=s.toLowerCase(),!o.exec(s))throw new l;if(a.content){let e={};for(let n of Object.keys(a.content))e[n]=t({schema:a.content[n].schema,url:i,method:r,httpStatus:s,contentType:n});n[s]=e}else n[s]=t({schema:a,url:i,method:r,httpStatus:s});return n},{})},validate:function e(t,a,o){let l=void 0===o;if(l||!o.skipParams){let r=u(t[i],a,"params");if(r)return"function"!=typeof r.then?d(r,"params",t.schemaErrorFormatter):function(t,r,i){return t.then(t=>t?d(t,"params",r.schemaErrorFormatter):e(r,i,{skipParams:!0}))}(r,t,a)}if(l||!o.skipBody){let r=null;if("function"==typeof t[s])r=t[s];else if(t[s]){let e=function(e){return e?e.split(/[ ;]/,1)[0].trim().toLowerCase():""}(a.headers["content-type"]),i=t[s][e];i&&(r=i)}let i=u(r,a,"body");if(i)return"function"!=typeof i.then?d(i,"body",t.schemaErrorFormatter):function(t,r,i){return t.then(t=>t?d(t,"body",r.schemaErrorFormatter):e(r,i,{skipParams:!0,skipBody:!0}))}(i,t,a)}if(l||!o.skipQuery){let r=u(t[n],a,"query");if(r)return"function"!=typeof r.then?d(r,"querystring",t.schemaErrorFormatter):function(t,r,i){return t.then(t=>t?d(t,"querystring",r.schemaErrorFormatter):e(r,i,{skipParams:!0,skipBody:!0,skipQuery:!0}))}(r,t,a)}let c=u(t[r],a,"headers");return!!c&&("function"!=typeof c.then?d(c,"headers",t.schemaErrorFormatter):function(e,t){return e.then(e=>!!e&&d(e,"headers",t.schemaErrorFormatter))}(c,t))}}}),j=u((e,t)=>{var{kReplyIsError:r,kReplyHijacked:i}=R();t.exports=function(e,t){e.then(function(e){if(!0!==t[i]&&(void 0!==e||!1===t.sent&&!1===t.raw.headersSent&&!1===t.request.raw.aborted))try{t.send(e)}catch(e){t[r]=!0,t.send(e)}},function(e){if(!0!==t.sent){t[r]=!0;try{t.send(e)}catch(e){t.send(e)}}else t.log.error({err:e},"Promise errored, but reply.sent = true was set")})}}),L=u((e,t)=>{var{validate:r}=I(),{preValidationHookRunner:i,preHandlerHookRunner:n}=A(),s=j(),{kReplyIsError:a,kRouteContext:o}=R();function l(e,t){try{null!==e[o].preValidation?i(e[o].preValidation,e,t,c):c(null,e,t)}catch(r){c(r,e,t)}}function c(e,t,i){if(!0===i.sent)return;if(null!=e)return i[a]=!0,void i.send(e);let n=r(i[o],t);if(n&&"function"==typeof n.then){let e=u.bind(null,t,i);n.then(e,e)}else u(t,i,n)}function u(e,t,r){if(r){if(!1===t[o].attachValidation)return void t.send(r);t.request.validationError=r}null!==e[o].preHandler?n(e[o].preHandler,e,t,d):d(null,e,t)}function d(e,t,r){if(r.sent)return;if(null!=e)return r[a]=!0,void r.send(e);let i;try{i=t[o].handler(t,r)}catch(e){return r[a]=!0,void r.send(e)}void 0!==i&&(null!==i&&"function"==typeof i.then?s(i,r):r.send(i))}t.exports=function(e,t,r){if(!0===r.sent)return;if(null!=e)return r[a]=!0,void r.send(e);let i=t.raw.method,n=t.headers,s=t[o];if("GET"===i||"HEAD"===i)return void l(t,r);let c=n["content-type"];"POST"!==i&&"PUT"!==i&&"PATCH"!==i&&"TRACE"!==i&&"SEARCH"!==i&&"PROPFIND"!==i&&"PROPPATCH"!==i&&"LOCK"!==i&&"COPY"!==i&&"MOVE"!==i&&"MKCOL"!==i&&"REPORT"!==i&&"MKCALENDAR"!==i?"OPTIONS"!==i&&"DELETE"!==i||void 0===c||void 0===n["transfer-encoding"]&&void 0===n["content-length"]?l(t,r):s.contentTypeParser.run(c,l,t,r):void 0===c?void 0!==n["transfer-encoding"]||"0"!==n["content-length"]&&void 0!==n["content-length"]?s.contentTypeParser.run("",l,t,r):l(t,r):s.contentTypeParser.run(c,l,t,r)},t.exports[Symbol.for("internals")]={handler:l,preHandlerCallback:d}}),D=u((e,t)=>{function r(){}var i={fatal:r,error:r,warn:r,info:r,debug:r,trace:r};Object.defineProperty(t,"exports",{get:()=>Object.create(i)})}),F=u((e,t)=>{var r=e=>e&&"string"==typeof e.message,i=e=>{if(!e)return;let t=e.cause;if("function"==typeof t){let t=e.cause();return r(t)?t:void 0}return r(t)?t:void 0},n=(e,t)=>{if(!r(e))return"";let s=e.stack||"";if(t.has(e))return s+"\ncauses have become circular...";let a=i(e);return a?(t.add(e),s+"\ncaused by: "+n(a,t)):s},s=(e,t,n)=>{if(!r(e))return"";let a=n?"":e.message||"";if(t.has(e))return a+": ...";let o=i(e);if(o){t.add(e);let r="function"==typeof e.cause;return a+(r?"":": ")+s(o,t,r)}return a};t.exports={isErrorLike:r,getErrorCause:i,stackWithCauses:e=>n(e,new Set),messageWithCauses:e=>s(e,new Set)}}),M=u((e,t)=>{var r=Symbol("circular-ref-tag"),i=Symbol("pino-raw-err-ref"),n=Object.create({},{type:{enumerable:!0,writable:!0,value:void 0},message:{enumerable:!0,writable:!0,value:void 0},stack:{enumerable:!0,writable:!0,value:void 0},aggregateErrors:{enumerable:!0,writable:!0,value:void 0},raw:{enumerable:!1,get:function(){return this[i]},set:function(e){this[i]=e}}});Object.defineProperty(n,i,{writable:!0,value:{}}),t.exports={pinoErrProto:n,pinoErrorSymbols:{seen:r,rawSymbol:i}}}),z=u((e,t)=>{t.exports=function e(t){if(!n(t))return t;t[o]=void 0;let a=Object.create(s);a.type="[object Function]"===l.call(t.constructor)?t.constructor.name:t.name,a.message=r(t),a.stack=i(t),Array.isArray(t.errors)&&(a.aggregateErrors=t.errors.map(t=>e(t)));for(let r in t)if(void 0===a[r]){let i=t[r];n(i)?"cause"!==r&&!Object.prototype.hasOwnProperty.call(i,o)&&(a[r]=e(i)):a[r]=i}return delete t[o],a.raw=t,a};var{messageWithCauses:r,stackWithCauses:i,isErrorLike:n}=F(),{pinoErrProto:s,pinoErrorSymbols:a}=M(),{seen:o}=a,{toString:l}=Object.prototype}),q=u((e,t)=>{t.exports=function e(t){if(!r(t))return t;t[s]=void 0;let n=Object.create(i);n.type="[object Function]"===a.call(t.constructor)?t.constructor.name:t.name,n.message=t.message,n.stack=t.stack,Array.isArray(t.errors)&&(n.aggregateErrors=t.errors.map(t=>e(t))),r(t.cause)&&!Object.prototype.hasOwnProperty.call(t.cause,s)&&(n.cause=e(t.cause));for(let i in t)if(void 0===n[i]){let a=t[i];r(a)?Object.prototype.hasOwnProperty.call(a,s)||(n[i]=e(a)):n[i]=a}return delete t[s],n.raw=t,n};var{isErrorLike:r}=F(),{pinoErrProto:i,pinoErrorSymbols:n}=M(),{seen:s}=n,{toString:a}=Object.prototype}),U=u((e,t)=>{t.exports={mapHttpRequest:function(e){return{req:n(e)}},reqSerializer:n};var r=Symbol("pino-raw-req-ref"),i=Object.create({},{id:{enumerable:!0,writable:!0,value:""},method:{enumerable:!0,writable:!0,value:""},url:{enumerable:!0,writable:!0,value:""},query:{enumerable:!0,writable:!0,value:""},params:{enumerable:!0,writable:!0,value:""},headers:{enumerable:!0,writable:!0,value:{}},remoteAddress:{enumerable:!0,writable:!0,value:""},remotePort:{enumerable:!0,writable:!0,value:""},raw:{enumerable:!1,get:function(){return this[r]},set:function(e){this[r]=e}}});function n(e){let t=e.info||e.socket,r=Object.create(i);if(r.id="function"==typeof e.id?e.id():e.id||(e.info?e.info.id:void 0),r.method=e.method,e.originalUrl)r.url=e.originalUrl;else{let t=e.path;r.url="string"==typeof t?t:e.url?e.url.path||e.url:void 0}return e.query&&(r.query=e.query),e.params&&(r.params=e.params),r.headers=e.headers,r.remoteAddress=t&&t.remoteAddress,r.remotePort=t&&t.remotePort,r.raw=e.raw||e,r}Object.defineProperty(i,r,{writable:!0,value:{}})}),B=u((e,t)=>{t.exports={mapHttpResponse:function(e){return{res:n(e)}},resSerializer:n};var r=Symbol("pino-raw-res-ref"),i=Object.create({},{statusCode:{enumerable:!0,writable:!0,value:0},headers:{enumerable:!0,writable:!0,value:""},raw:{enumerable:!1,get:function(){return this[r]},set:function(e){this[r]=e}}});function n(e){let t=Object.create(i);return t.statusCode=e.headersSent?e.statusCode:null,t.headers=e.getHeaders?e.getHeaders():e._headers,t.raw=e,t}Object.defineProperty(i,r,{writable:!0,value:{}})}),H=u((e,t)=>{var r=z(),i=q(),n=U(),s=B();t.exports={err:r,errWithCause:i,mapHttpRequest:n.mapHttpRequest,mapHttpResponse:s.mapHttpResponse,req:n.reqSerializer,res:s.resSerializer,wrapErrorSerializer:function(e){return e===r?e:function(t){return e(r(t))}},wrapRequestSerializer:function(e){return e===n.reqSerializer?e:function(t){return e(n.reqSerializer(t))}},wrapResponseSerializer:function(e){return e===s.resSerializer?e:function(t){return e(s.resSerializer(t))}}}}),V=u((e,t)=>{function r(e,t){return t}t.exports=function(){let e=Error.prepareStackTrace;Error.prepareStackTrace=r;let t=(new Error).stack;if(Error.prepareStackTrace=e,!Array.isArray(t))return;let i=t.slice(2),n=[];for(let e of i)e&&n.push(e.getFileName());return n}}),G=u((e,t)=>{function r(e){if(null===e||"object"!=typeof e)return e;if(e instanceof Date)return new Date(e.getTime());if(e instanceof Array){let t=[];for(let i=0;i<e.length;i++)t[i]=r(e[i]);return t}if("object"==typeof e){let t=Object.create(Object.getPrototypeOf(e));for(let i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=r(e[i]));return t}return e}function i(e){let t=[],r="",i=!1,n=!1,s="";for(let a=0;a<e.length;a++){let o=e[a];i||"."!==o?"["===o?(r&&(t.push(r),r=""),i=!0):"]"===o&&i?(t.push(r),r="",i=!1,n=!1):'"'!==o&&"'"!==o||!i?r+=o:n?o===s?(n=!1,s=""):r+=o:(n=!0,s=o):r&&(t.push(r),r="")}return r&&t.push(r),t}function n(e,t,r){let i=e;for(let e=0;e<t.length-1;e++){let r=t[e];if("object"!=typeof i||null===i||!(r in i)||"object"!=typeof i[r]||null===i[r])return!1;i=i[r]}let n=t[t.length-1];if("*"===n){if(Array.isArray(i))for(let e=0;e<i.length;e++)i[e]=r;else if("object"==typeof i&&null!==i)for(let e in i)Object.prototype.hasOwnProperty.call(i,e)&&(i[e]=r)}else"object"==typeof i&&null!==i&&n in i&&Object.prototype.hasOwnProperty.call(i,n)&&(i[n]=r);return!0}function s(e,t){let r=e;for(let e=0;e<t.length-1;e++){let i=t[e];if("object"!=typeof r||null===r||!(i in r)||"object"!=typeof r[i]||null===r[i])return!1;r=r[i]}let i=t[t.length-1];if("*"===i){if(Array.isArray(r))for(let e=0;e<r.length;e++)r[e]=void 0;else if("object"==typeof r&&null!==r)for(let e in r)Object.prototype.hasOwnProperty.call(r,e)&&delete r[e]}else"object"==typeof r&&null!==r&&i in r&&Object.prototype.hasOwnProperty.call(r,i)&&delete r[i];return!0}var a=Symbol("PATH_NOT_FOUND");function o(e,t){let r=e;for(let e of t){if(null==r||"object"!=typeof r||null===r||!(e in r))return a;r=r[e]}return r}function l(e,t,r,i,a=!1){let o=t.indexOf("*");if(o===t.length-1){let i=t.slice(0,-1),n=e;for(let e of i){if(null==n||"object"!=typeof n||null===n)return;n=n[e]}if(Array.isArray(n))if(a)for(let e=0;e<n.length;e++)n[e]=void 0;else for(let e=0;e<n.length;e++){let t=[...i,e.toString()],s="function"==typeof r?r(n[e],t):r;n[e]=s}else if("object"==typeof n&&null!==n)if(a){let e=[];for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e.push(t);for(let t of e)delete n[t]}else for(let e in n){let t=[...i,e],s="function"==typeof r?r(n[e],t):r;n[e]=s}}else!function(e,t,r,i,a,o=!1){let c=t.slice(0,i),u=t.slice(i+1),d=[];function p(e,t){if(t===c.length){if(Array.isArray(e))for(let r=0;r<e.length;r++)d[t]=r.toString(),p(e[r],t+1);else if("object"==typeof e&&null!==e)for(let r in e)d[t]=r,p(e[r],t+1)}else if(t<c.length){let r=c[t];e&&"object"==typeof e&&null!==e&&r in e&&(d[t]=r,p(e[r],t+1))}else if(u.includes("*"))l(e,u,"function"==typeof r?(e,i)=>{let n=[...d.slice(0,t),...i];return r(e,n)}:r,a,o);else if(o)s(e,u);else{let i="function"==typeof r?r(function(e,t){let r=e;for(let e of t){if(null==r||"object"!=typeof r||null===r)return;r=r[e]}return r}(e,u),[...d.slice(0,t),...u]):r;n(e,u,i)}}if(0===c.length)p(e,0);else{let t=e;for(let e=0;e<c.length;e++){let r=c[e];if(null==t||"object"!=typeof t||null===t)return;t=t[r],d[e]=r}null!=t&&p(t,c.length)}}(e,t,r,o,i,a)}function c(e){if("string"!=typeof e)throw new Error("Paths must be (non-empty) strings");if(""===e)throw new Error("Invalid redaction path ()");if(e.includes(".."))throw new Error(`Invalid redaction path (${e})`);if(e.includes(","))throw new Error(`Invalid redaction path (${e})`);let t=0,r=!1,i="";for(let n=0;n<e.length;n++){let s=e[n];if(('"'===s||"'"===s)&&t>0)r?s===i&&(r=!1,i=""):(r=!0,i=s);else if("["!==s||r){if("]"===s&&!r&&(t--,t<0))throw new Error(`Invalid redaction path (${e})`)}else t++}if(0!==t)throw new Error(`Invalid redaction path (${e})`)}t.exports=function(e={}){let{paths:t=[],censor:u="[REDACTED]",serialize:d=JSON.stringify,strict:p=!0,remove:h=!1}=e;!function(e){if(!Array.isArray(e))throw new TypeError("paths must be an array");for(let t of e)c(t)}(t);let f=function(e){if(0===e.length)return null;let t=new Map;for(let r of e){let e=i(r),n=t;for(let t=0;t<e.length;t++){let r=e[t];n.has(r)||n.set(r,new Map),n=n.get(r)}}return t}(t);return function(e){if(p&&(null===e||"object"!=typeof e)&&(null==e||"object"!=typeof e))return d?d(e):e;let c=function(e,t){return t?function e(t,r,i=0){if(!r||0===r.size||null===t||"object"!=typeof t)return t;if(t instanceof Date)return new Date(t.getTime());if(Array.isArray(t)){let i=[];for(let n=0;n<t.length;n++){let s=n.toString();i[n]=r.has(s)||r.has("*")?e(t[n],r.get(s)||r.get("*")):t[n]}return i}let n=Object.create(Object.getPrototypeOf(t));for(let i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=r.has(i)||r.has("*")?e(t[i],r.get(i)||r.get("*")):t[i]);return n}(e,t):e}(e,f),m=e,g=u;return"function"==typeof u&&(g=u),function(e,t,r,c=!1){for(let u of t){let t=i(u);if(t.includes("*"))l(e,t,r,u,c);else if(c)s(e,t);else{let i=o(e,t);if(i===a)continue;n(e,t,"function"==typeof r?r(i,t):r)}}}(c,t,g,h),!1===d?(c.restore=function(){return r(m)},c):"function"==typeof d?d(c):JSON.stringify(c)}}}),W=u((e,t)=>{var r=Symbol("pino.setLevel"),i=Symbol("pino.getLevel"),n=Symbol("pino.levelVal"),s=Symbol("pino.levelComp"),a=Symbol("pino.useLevelLabels"),o=Symbol("pino.useOnlyCustomLevels"),l=Symbol("pino.mixin"),c=Symbol("pino.lsCache"),u=Symbol("pino.chindings"),d=Symbol("pino.asJson"),p=Symbol("pino.write"),h=Symbol("pino.redactFmt"),f=Symbol("pino.time"),m=Symbol("pino.timeSliceIndex"),g=Symbol("pino.stream"),y=Symbol("pino.stringify"),v=Symbol("pino.stringifySafe"),b=Symbol("pino.stringifiers"),w=Symbol("pino.end"),_=Symbol("pino.formatOpts"),S=Symbol("pino.messageKey"),E=Symbol("pino.errorKey"),k=Symbol("pino.nestedKey"),x=Symbol("pino.nestedKeyStr"),T=Symbol("pino.mixinMergeStrategy"),P=Symbol("pino.msgPrefix"),R=Symbol("pino.wildcardFirst"),O=Symbol.for("pino.serializers"),$=Symbol.for("pino.formatters"),C=Symbol.for("pino.hooks"),A=Symbol.for("pino.metadata");t.exports={setLevelSym:r,getLevelSym:i,levelValSym:n,levelCompSym:s,useLevelLabelsSym:a,mixinSym:l,lsCacheSym:c,chindingsSym:u,asJsonSym:d,writeSym:p,serializersSym:O,redactFmtSym:h,timeSym:f,timeSliceIndexSym:m,streamSym:g,stringifySym:y,stringifySafeSym:v,stringifiersSym:b,endSym:w,formatOptsSym:_,messageKeySym:S,errorKeySym:E,nestedKeySym:k,wildcardFirstSym:R,needsMetadataGsym:A,useOnlyCustomLevelsSym:o,formattersSym:$,hooksSym:C,nestedKeyStrSym:x,mixinMergeStrategySym:T,msgPrefixSym:P}}),K=u((e,t)=>{var r=G(),{redactFmtSym:i,wildcardFirstSym:n}=W(),s=/[^.[\]]+|\[([^[\]]*?)\]/g,a="[Redacted]",o=!1;t.exports=function(e,t){let{paths:l,censor:c,remove:u}=function(e){if(Array.isArray(e))return e={paths:e,censor:a};let{paths:t,censor:r=a,remove:i}=e;if(!1===Array.isArray(t))throw Error("pino – redact must contain an array of strings");return!0===i&&(r=void 0),{paths:t,censor:r,remove:i}}(e),d=l.reduce((e,t)=>{s.lastIndex=0;let r=s.exec(t),i=s.exec(t),a=void 0!==r[1]?r[1].replace(/^(?:"|'|`)(.*)(?:"|'|`)$/,"$1"):r[0];if("*"===a&&(a=n),null===i)return e[a]=null,e;if(null===e[a])return e;let{index:o}=i,l=`${t.substr(o,t.length-1)}`;return e[a]=e[a]||[],a!==n&&0===e[a].length&&e[a].push(...e[n]||[]),a===n&&Object.keys(e).forEach(function(t){e[t]&&e[t].push(l)}),e[a].push(l),e},{}),p={[i]:r({paths:l,censor:c,serialize:t,strict:o,remove:u})};return[...Object.keys(d),...Object.getOwnPropertySymbols(d)].reduce((e,i)=>(e[i]=null===d[i]?e=>((...e)=>t("function"==typeof c?c(...e):c))(e,[i]):r({paths:d[i],censor:"function"==typeof c?(e,t)=>c(e,[i,...t]):c,serialize:t,strict:o,remove:u}),e),p)}}),J=u((e,t)=>{var r=1000000000n,i=1000000n*BigInt(Date.now()),n=process.hrtime.bigint();t.exports={nullTime:()=>"",epochTime:()=>`,"time":${Date.now()}`,unixTime:()=>`,"time":${Math.round(Date.now()/1e3)}`,isoTime:()=>`,"time":"${new Date(Date.now()).toISOString()}"`,isoTimeNano:()=>{let e=process.hrtime.bigint()-n,t=i+e,s=t%r,a=Number(t/r*1000n+s/1000000n),o=new Date(a);return`,"time":"${o.getUTCFullYear()}-${(o.getUTCMonth()+1).toString().padStart(2,"0")}-${o.getUTCDate().toString().padStart(2,"0")}T${o.getUTCHours().toString().padStart(2,"0")}:${o.getUTCMinutes().toString().padStart(2,"0")}:${o.getUTCSeconds().toString().padStart(2,"0")}.${s.toString().padStart(9,"0")}Z"`}}}),Z=u((e,t)=>{function r(e){try{return JSON.stringify(e)}catch{return'"[Circular]"'}}t.exports=function(e,t,i){var n=i&&i.stringify||r;if("object"==typeof e&&null!==e){var s=t.length+1;if(1===s)return e;var a=new Array(s);a[0]=n(e);for(var o=1;o<s;o++)a[o]=n(t[o]);return a.join(" ")}if("string"!=typeof e)return e;var l=t.length;if(0===l)return e;for(var c="",u=0,d=-1,p=e&&e.length||0,h=0;h<p;){if(37===e.charCodeAt(h)&&h+1<p){switch(d=d>-1?d:0,e.charCodeAt(h+1)){case 100:case 102:if(u>=l||null==t[u])break;d<h&&(c+=e.slice(d,h)),c+=Number(t[u]),d=h+2,h++;break;case 105:if(u>=l||null==t[u])break;d<h&&(c+=e.slice(d,h)),c+=Math.floor(Number(t[u])),d=h+2,h++;break;case 79:case 111:case 106:if(u>=l||void 0===t[u])break;d<h&&(c+=e.slice(d,h));var f=typeof t[u];if("string"===f){c+="'"+t[u]+"'",d=h+2,h++;break}if("function"===f){c+=t[u].name||"<anonymous>",d=h+2,h++;break}c+=n(t[u]),d=h+2,h++;break;case 115:if(u>=l)break;d<h&&(c+=e.slice(d,h)),c+=String(t[u]),d=h+2,h++;break;case 37:d<h&&(c+=e.slice(d,h)),c+="%",d=h+2,h++,u--}++u}++h}return-1===d?e:(d<p&&(c+=e.slice(d)),c)}}),Y=u((e,t)=>{if(typeof SharedArrayBuffer<"u"&&typeof Atomics<"u"){let e=function(e){if(0==(e>0&&e<1/0))throw"number"!=typeof e&&"bigint"!=typeof e?TypeError("sleep: ms must be a number"):RangeError("sleep: ms must be a number that is greater than 0 but less than Infinity");Atomics.wait(r,0,0,Number(e))},r=new Int32Array(new SharedArrayBuffer(4));t.exports=e}else t.exports=function(e){if(0==(e>0&&e<1/0))throw"number"!=typeof e&&"bigint"!=typeof e?TypeError("sleep: ms must be a number"):RangeError("sleep: ms must be a number that is greater than 0 but less than Infinity");let t=Date.now()+Number(e);for(;t>Date.now(););}}),X=u((e,t)=>{var r=c("fs"),i=c("events"),n=c("util").inherits,s=c("path"),a=Y(),o=c("assert"),l=100,u=Buffer.allocUnsafe(0),d="buffer",p="utf8",[h,f]=(process.versions.node||"0.0").split(".").map(Number),m=h>=22&&f>=7;function g(e,t){function i(r,i){if(r)return t._reopening=!1,t._writing=!1,t._opening=!1,void(t.sync?process.nextTick(()=>{t.listenerCount("error")>0&&t.emit("error",r)}):t.emit("error",r));let n=t._reopening;t.fd=i,t.file=e,t._reopening=!1,t._opening=!1,t._writing=!1,t.sync?process.nextTick(()=>t.emit("ready")):t.emit("ready"),!t.destroyed&&(!t._writing&&t._len>t.minLength||t._flushPending?t._actualWrite():n&&process.nextTick(()=>t.emit("drain")))}t._opening=!0,t._writing=!0,t._asyncDrainScheduled=!1;let n=t.append?"a":"w",a=t.mode;if(t.sync)try{t.mkdir&&r.mkdirSync(s.dirname(e),{recursive:!0}),i(null,r.openSync(e,n,a))}catch(e){throw i(e),e}else t.mkdir?r.mkdir(s.dirname(e),{recursive:!0},t=>{if(t)return i(t);r.open(e,n,a,i)}):r.open(e,n,a,i)}function y(e){if(!(this instanceof y))return new y(e);let t,i,{fd:n,dest:s,minLength:o,maxLength:c,maxWrite:h,periodicFlush:f,sync:m,append:w=!0,mkdir:E,retryEAGAIN:C,fsync:A,contentMode:N,mode:I}=e||{};if(n=n||s,this._len=0,this.fd=-1,this._bufs=[],this._lens=[],this._writing=!1,this._ending=!1,this._reopening=!1,this._asyncDrainScheduled=!1,this._flushPending=!1,this._hwm=Math.max(o||0,16387),this.file=null,this.destroyed=!1,this.minLength=o||0,this.maxLength=c||0,this.maxWrite=h||16384,this._periodicFlush=f||0,this._periodicFlushTimer=void 0,this.sync=m||!1,this.writable=!0,this._fsync=A||!1,this.append=w||!1,this.mode=I,this.retryEAGAIN=C||(()=>!0),this.mkdir=E||!1,N===d)this._writingBuf=u,this.write=S,this.flush=x,this.flushSync=P,this._actualWrite=O,t=()=>r.writeSync(this.fd,this._writingBuf),i=()=>r.write(this.fd,this._writingBuf,this.release);else{if(void 0!==N&&N!==p)throw new Error(`SonicBoom supports "${p}" and "${d}", but passed ${N}`);this._writingBuf="",this.write=_,this.flush=k,this.flushSync=T,this._actualWrite=R,t=()=>Buffer.isBuffer(this._writingBuf)?r.writeSync(this.fd,this._writingBuf):r.writeSync(this.fd,this._writingBuf,"utf8"),i=()=>Buffer.isBuffer(this._writingBuf)?r.write(this.fd,this._writingBuf,this.release):r.write(this.fd,this._writingBuf,"utf8",this.release)}if("number"==typeof n)this.fd=n,process.nextTick(()=>this.emit("ready"));else{if("string"!=typeof n)throw new Error("SonicBoom supports only file descriptors and files");g(n,this)}if(this.minLength>=this.maxWrite)throw new Error(`minLength should be smaller than maxWrite (${this.maxWrite})`);this.release=(e,n)=>{if(e){if("EAGAIN"!==e.code&&"EBUSY"!==e.code||!this.retryEAGAIN(e,this._writingBuf.length,this._len-this._writingBuf.length))this._writing=!1,this.emit("error",e);else if(this.sync)try{a(l),this.release(void 0,0)}catch(e){this.release(e)}else setTimeout(i,l);return}this.emit("write",n);let s=v(this._writingBuf,this._len,n);if(this._len=s.len,this._writingBuf=s.writingBuf,this._writingBuf.length){if(!this.sync)return void i();try{do{let e=t(),r=v(this._writingBuf,this._len,e);this._len=r.len,this._writingBuf=r.writingBuf}while(this._writingBuf.length)}catch(e){return void this.release(e)}}this._fsync&&r.fsyncSync(this.fd);let o=this._len;this._reopening?(this._writing=!1,this._reopening=!1,this.reopen()):o>this.minLength?this._actualWrite():this._ending?o>0?this._actualWrite():(this._writing=!1,$(this)):(this._writing=!1,this.sync?this._asyncDrainScheduled||(this._asyncDrainScheduled=!0,process.nextTick(b,this)):this.emit("drain"))},this.on("newListener",function(e){"drain"===e&&(this._asyncDrainScheduled=!1)}),0!==this._periodicFlush&&(this._periodicFlushTimer=setInterval(()=>this.flush(null),this._periodicFlush),this._periodicFlushTimer.unref())}function v(e,t,r){return"string"==typeof e&&(e=Buffer.from(e)),t=Math.max(t-r,0),{writingBuf:e=e.subarray(r),len:t}}function b(e){e.listenerCount("drain")>0&&(e._asyncDrainScheduled=!1,e.emit("drain"))}function w(e,t){return 0===e.length?u:1===e.length?e[0]:Buffer.concat(e,t)}function _(e){if(this.destroyed)throw new Error("SonicBoom destroyed");e=""+e;let t=Buffer.byteLength(e),r=this._len+t,i=this._bufs;return this.maxLength&&r>this.maxLength?(this.emit("drop",e),this._len<this._hwm):(0===i.length||Buffer.byteLength(i[i.length-1])+t>this.maxWrite?i.push(e):i[i.length-1]+=e,this._len=r,!this._writing&&this._len>=this.minLength&&this._actualWrite(),this._len<this._hwm)}function S(e){if(this.destroyed)throw new Error("SonicBoom destroyed");let t=this._len+e.length,r=this._bufs,i=this._lens;return this.maxLength&&t>this.maxLength?(this.emit("drop",e),this._len<this._hwm):(0===r.length||i[i.length-1]+e.length>this.maxWrite?(r.push([e]),i.push(e.length)):(r[r.length-1].push(e),i[i.length-1]+=e.length),this._len=t,!this._writing&&this._len>=this.minLength&&this._actualWrite(),this._len<this._hwm)}function E(e){this._flushPending=!0;let t=()=>{if(this._fsync)this._flushPending=!1,e();else try{r.fsync(this.fd,t=>{this._flushPending=!1,e(t)})}catch(t){e(t)}this.off("error",i)},i=r=>{this._flushPending=!1,e(r),this.off("drain",t)};this.once("drain",t),this.once("error",i)}function k(e){if(null!=e&&"function"!=typeof e)throw new Error("flush cb must be a function");if(this.destroyed){let t=new Error("SonicBoom destroyed");if(e)return void e(t);throw t}this.minLength<=0?e?.():(e&&E.call(this,e),!this._writing&&(0===this._bufs.length&&this._bufs.push(""),this._actualWrite()))}function x(e){if(null!=e&&"function"!=typeof e)throw new Error("flush cb must be a function");if(this.destroyed){let t=new Error("SonicBoom destroyed");if(e)return void e(t);throw t}this.minLength<=0?e?.():(e&&E.call(this,e),!this._writing&&(0===this._bufs.length&&(this._bufs.push([]),this._lens.push(0)),this._actualWrite()))}function T(){if(this.destroyed)throw new Error("SonicBoom destroyed");if(this.fd<0)throw new Error("sonic boom is not ready yet");!this._writing&&this._writingBuf.length>0&&(this._bufs.unshift(this._writingBuf),this._writingBuf="");let e="";for(;this._bufs.length||e.length;){e.length<=0&&(e=this._bufs[0]);try{let t=Buffer.isBuffer(e)?r.writeSync(this.fd,e):r.writeSync(this.fd,e,"utf8"),i=v(e,this._len,t);e=i.writingBuf,this._len=i.len,e.length<=0&&this._bufs.shift()}catch(t){if(("EAGAIN"===t.code||"EBUSY"===t.code)&&!this.retryEAGAIN(t,e.length,this._len-e.length))throw t;a(l)}}try{r.fsyncSync(this.fd)}catch{}}function P(){if(this.destroyed)throw new Error("SonicBoom destroyed");if(this.fd<0)throw new Error("sonic boom is not ready yet");!this._writing&&this._writingBuf.length>0&&(this._bufs.unshift([this._writingBuf]),this._writingBuf=u);let e=u;for(;this._bufs.length||e.length;){e.length<=0&&(e=w(this._bufs[0],this._lens[0]));try{let t=r.writeSync(this.fd,e);e=e.subarray(t),this._len=Math.max(this._len-t,0),e.length<=0&&(this._bufs.shift(),this._lens.shift())}catch(t){if(("EAGAIN"===t.code||"EBUSY"===t.code)&&!this.retryEAGAIN(t,e.length,this._len-e.length))throw t;a(l)}}}function R(){let e=this.release;if(this._writing=!0,this._writingBuf=this._writingBuf.length?this._writingBuf:this._bufs.shift()||"",this.sync)try{e(null,Buffer.isBuffer(this._writingBuf)?r.writeSync(this.fd,this._writingBuf):r.writeSync(this.fd,this._writingBuf,"utf8"))}catch(t){e(t)}else r.write(this.fd,this._writingBuf,e)}function O(){let e=this.release;if(this._writing=!0,this._writingBuf=this._writingBuf.length?this._writingBuf:w(this._bufs.shift(),this._lens.shift()),this.sync)try{e(null,r.writeSync(this.fd,this._writingBuf))}catch(t){e(t)}else m&&(this._writingBuf=Buffer.from(this._writingBuf)),r.write(this.fd,this._writingBuf,e)}function $(e){if(-1!==e.fd){void 0!==e._periodicFlushTimer&&clearInterval(e._periodicFlushTimer),e.destroyed=!0,e._bufs=[],e._lens=[],o("number"==typeof e.fd,"sonic.fd must be a number, got "+typeof e.fd);try{r.fsync(e.fd,function(){1!==e.fd&&2!==e.fd?r.close(e.fd,t):t()})}catch{}}else e.once("ready",$.bind(null,e));function t(t){t?e.emit("error",t):(e._ending&&!e._writing&&e.emit("finish"),e.emit("close"))}}n(y,i),y.prototype.reopen=function(e){if(this.destroyed)throw new Error("SonicBoom destroyed");if(this._opening)return void this.once("ready",()=>{this.reopen(e)});if(this._ending)return;if(!this.file)throw new Error("Unable to reopen a file descriptor, you must pass a file to SonicBoom");if(e&&(this.file=e),this._reopening=!0,this._writing)return;let t=this.fd;this.once("ready",()=>{t!==this.fd&&r.close(t,e=>{if(e)return this.emit("error",e)})}),g(this.file,this)},y.prototype.end=function(){if(this.destroyed)throw new Error("SonicBoom destroyed");this._opening?this.once("ready",()=>{this.end()}):this._ending||(this._ending=!0,!this._writing&&(this._len>0&&this.fd>=0?this._actualWrite():$(this)))},y.prototype.destroy=function(){this.destroyed||$(this)},y.SonicBoom=y,y.default=y,t.exports=y}),Q=u((e,t)=>{var r,i={exit:[],beforeExit:[]},n={exit:function(){a("exit")},beforeExit:function(){a("beforeExit")}};function s(e){i[e].length>0||(process.removeListener(e,n[e]),0===i.exit.length&&0===i.beforeExit.length&&(r=void 0))}function a(e){for(let t of i[e]){let r=t.deref();void 0!==r&&(0,t.fn)(r,e)}i[e]=[]}function o(e){for(let t of["exit","beforeExit"]){let r=i[t].indexOf(e);i[t].splice(r,r+1),s(t)}}function l(e,t,s){if(void 0===t)throw new Error("the object can't be undefined");!function(e){i[e].length>0||process.on(e,n[e])}(e);let a=new WeakRef(t);a.fn=s,void 0===r&&(r=new FinalizationRegistry(o)),r.register(t,a),i[e].push(a)}t.exports={register:function(e,t){l("exit",e,t)},registerBeforeExit:function(e,t){l("beforeExit",e,t)},unregister:function(e){if(void 0!==r){r.unregister(e);for(let t of["exit","beforeExit"])i[t]=i[t].filter(t=>{let r=t.deref();return r&&r!==e}),s(t)}}}}),ee=u((e,t)=>{t.exports={name:"thread-stream",version:"3.1.0",description:"A streaming way to send data to a Node.js Worker Thread",main:"index.js",types:"index.d.ts",dependencies:{"real-require":"^0.2.0"},devDependencies:{"@types/node":"^20.1.0","@types/tap":"^15.0.0","@yao-pkg/pkg":"^5.11.5",desm:"^1.3.0",fastbench:"^1.0.1",husky:"^9.0.6","pino-elasticsearch":"^8.0.0","sonic-boom":"^4.0.1",standard:"^17.0.0",tap:"^16.2.0","ts-node":"^10.8.0",typescript:"^5.3.2","why-is-node-running":"^2.2.2"},scripts:{build:"tsc --noEmit",test:'standard && npm run build && npm run transpile && tap "test/**/*.test.*js" && tap --ts test/*.test.*ts',"test:ci":"standard && npm run transpile && npm run test:ci:js && npm run test:ci:ts","test:ci:js":'tap --no-check-coverage --timeout=120 --coverage-report=lcovonly "test/**/*.test.*js"',"test:ci:ts":'tap --ts --no-check-coverage --coverage-report=lcovonly "test/**/*.test.*ts"',"test:yarn":'npm run transpile && tap "test/**/*.test.js" --no-check-coverage',transpile:"sh ./test/ts/transpile.sh",prepare:"husky install"},standard:{ignore:["test/ts/**/*","test/syntax-error.mjs"]},repository:{type:"git",url:"git+https://github.com/mcollina/thread-stream.git"},keywords:["worker","thread","threads","stream"],author:"Matteo Collina <hello@matteocollina.com>",license:"MIT",bugs:{url:"https://github.com/mcollina/thread-stream/issues"},homepage:"https://github.com/mcollina/thread-stream#readme"}}),te=u((e,t)=>{t.exports={wait:function(e,t,r,i,n){let s=Date.now()+i,a=Atomics.load(e,t);if(a===r)return void n(null,"ok");let o=a,l=i=>{Date.now()>s?n(null,"timed-out"):setTimeout(()=>{o=a,a=Atomics.load(e,t),a===o?l(i>=1e3?1e3:2*i):n(null,a===r?"ok":"not-equal")},i)};l(1)},waitDiff:function(e,t,r,i,n){let s=Date.now()+i,a=Atomics.load(e,t);if(a!==r)return void n(null,"ok");let o=i=>{Date.now()>s?n(null,"timed-out"):setTimeout(()=>{a=Atomics.load(e,t),a!==r?n(null,"ok"):o(i>=1e3?1e3:2*i)},i)};o(1)}}}),re=u((e,t)=>{t.exports={WRITE_INDEX:4,READ_INDEX:8}}),ie=u((e,t)=>{var{version:r}=ee(),{EventEmitter:i}=c("events"),{Worker:n}=c("worker_threads"),{join:s}=c("path"),{pathToFileURL:a}=c("url"),{wait:o}=te(),{WRITE_INDEX:l,READ_INDEX:u}=re(),d=c("buffer"),p=c("assert"),h=Symbol("kImpl"),f=d.constants.MAX_STRING_LENGTH,m=class{constructor(e){this._value=e}deref(){return this._value}},g=class{register(){}unregister(){}},y=process.env.NODE_V8_COVERAGE?g:global.FinalizationRegistry||g,v=process.env.NODE_V8_COVERAGE?m:global.WeakRef||m,b=new y(e=>{e.exited||e.terminate()});function w(e){p(!e[h].sync),e[h].needDrain&&(e[h].needDrain=!1,e.emit("drain"))}function _(e){let t=Atomics.load(e[h].state,l),r=e[h].data.length-t;if(r>0){if(0===e[h].buf.length)return e[h].flushing=!1,void(e[h].ending?P(e):e[h].needDrain&&process.nextTick(w,e));let t=e[h].buf.slice(0,r),i=Buffer.byteLength(t);i<=r?(e[h].buf=e[h].buf.slice(r),T(e,t,_.bind(null,e))):e.flush(()=>{if(!e.destroyed){for(Atomics.store(e[h].state,u,0),Atomics.store(e[h].state,l,0);i>e[h].data.length;)r/=2,t=e[h].buf.slice(0,r),i=Buffer.byteLength(t);e[h].buf=e[h].buf.slice(r),T(e,t,_.bind(null,e))}})}else if(0===r){if(0===t&&0===e[h].buf.length)return;e.flush(()=>{Atomics.store(e[h].state,u,0),Atomics.store(e[h].state,l,0),_(e)})}else x(e,new Error("overwritten"))}function S(e){let t=this.stream.deref();if(void 0===t)return this.exited=!0,void this.terminate();switch(e.code){case"READY":this.stream=new v(t),t.flush(()=>{t[h].ready=!0,t.emit("ready")});break;case"ERROR":x(t,e.err);break;case"EVENT":Array.isArray(e.args)?t.emit(e.name,...e.args):t.emit(e.name,e.args);break;case"WARNING":process.emitWarning(e.err);break;default:x(t,new Error("this should not happen: "+e.code))}}function E(e){let t=this.stream.deref();void 0!==t&&(b.unregister(t),t.worker.exited=!0,t.worker.off("exit",E),x(t,0!==e?new Error("the worker thread exited"):null))}function k(e,t){setImmediate(()=>{e.emit("error",t)})}function x(e,t){e[h].destroyed||(e[h].destroyed=!0,t&&(e[h].errored=t,k(e,t)),e.worker.exited?setImmediate(()=>{e[h].closed=!0,e.emit("close")}):e.worker.terminate().catch(()=>{}).then(()=>{e[h].closed=!0,e.emit("close")}))}function T(e,t,r){let i=Atomics.load(e[h].state,l),n=Buffer.byteLength(t);return e[h].data.write(t,i),Atomics.store(e[h].state,l,i+n),Atomics.notify(e[h].state,l),r(),!0}function P(e){if(!e[h].ended&&e[h].ending&&!e[h].flushing){e[h].ended=!0;try{e.flushSync();let t=Atomics.load(e[h].state,u);Atomics.store(e[h].state,l,-1),Atomics.notify(e[h].state,l);let r=0;for(;-1!==t;){if(Atomics.wait(e[h].state,u,t,1e3),t=Atomics.load(e[h].state,u),-2===t)return void x(e,new Error("end() failed"));if(10===++r)return void x(e,new Error("end() took too long (10s)"))}process.nextTick(()=>{e[h].finished=!0,e.emit("finish")})}catch(t){x(e,t)}}}function R(e){let t=()=>{e[h].ending?P(e):e[h].needDrain&&process.nextTick(w,e)};for(e[h].flushing=!1;0!==e[h].buf.length;){let r=Atomics.load(e[h].state,l),i=e[h].data.length-r;if(0===i){O(e),Atomics.store(e[h].state,u,0),Atomics.store(e[h].state,l,0);continue}if(i<0)throw new Error("overwritten");let n=e[h].buf.slice(0,i),s=Buffer.byteLength(n);if(s<=i)e[h].buf=e[h].buf.slice(i),T(e,n,t);else{for(O(e),Atomics.store(e[h].state,u,0),Atomics.store(e[h].state,l,0);s>e[h].buf.length;)i/=2,n=e[h].buf.slice(0,i),s=Buffer.byteLength(n);e[h].buf=e[h].buf.slice(i),T(e,n,t)}}}function O(e){if(e[h].flushing)throw new Error("unable to flush while flushing");let t=Atomics.load(e[h].state,l),r=0;for(;;){let i=Atomics.load(e[h].state,u);if(-2===i)throw Error("_flushSync failed");if(i===t)break;if(Atomics.wait(e[h].state,u,i,1e3),10===++r)throw new Error("_flushSync took too long (10s)")}}t.exports=class extends i{constructor(e={}){if(super(),e.bufferSize<4)throw new Error("bufferSize must at least fit a 4-byte utf-8 char");this[h]={},this[h].stateBuf=new SharedArrayBuffer(128),this[h].state=new Int32Array(this[h].stateBuf),this[h].dataBuf=new SharedArrayBuffer(e.bufferSize||4194304),this[h].data=Buffer.from(this[h].dataBuf),this[h].sync=e.sync||!1,this[h].ending=!1,this[h].ended=!1,this[h].needDrain=!1,this[h].destroyed=!1,this[h].flushing=!1,this[h].ready=!1,this[h].finished=!1,this[h].errored=null,this[h].closed=!1,this[h].buf="",this.worker=function(e,t){let{filename:i,workerData:o}=t,l=("__bundlerPathsOverrides"in globalThis?globalThis.__bundlerPathsOverrides:{})["thread-stream-worker"]||s(__dirname,"lib","worker.js"),c=new n(l,{...t.workerOpts,trackUnmanagedFds:!1,workerData:{filename:0===i.indexOf("file://")?i:a(i).href,dataBuf:e[h].dataBuf,stateBuf:e[h].stateBuf,workerData:{$context:{threadStreamVersion:r},...o}}});return c.stream=new m(e),c.on("message",S),c.on("exit",E),b.register(e,c),c}(this,e),this.on("message",(e,t)=>{this.worker.postMessage(e,t)})}write(e){if(this[h].destroyed)return k(this,new Error("the worker has exited")),!1;if(this[h].ending)return k(this,new Error("the worker is ending")),!1;if(this[h].flushing&&this[h].buf.length+e.length>=f)try{R(this),this[h].flushing=!0}catch(e){return x(this,e),!1}if(this[h].buf+=e,this[h].sync)try{return R(this),!0}catch(e){return x(this,e),!1}return this[h].flushing||(this[h].flushing=!0,setImmediate(_,this)),this[h].needDrain=this[h].data.length-this[h].buf.length-Atomics.load(this[h].state,l)<=0,!this[h].needDrain}end(){this[h].destroyed||(this[h].ending=!0,P(this))}flush(e){if(this[h].destroyed)return void("function"==typeof e&&process.nextTick(e,new Error("the worker has exited")));let t=Atomics.load(this[h].state,l);o(this[h].state,u,t,1/0,(t,r)=>{if(t)return x(this,t),void process.nextTick(e,t);"not-equal"!==r?process.nextTick(e):this.flush(e)})}flushSync(){this[h].destroyed||(R(this),O(this))}unref(){this.worker.unref()}ref(){this.worker.ref()}get ready(){return this[h].ready}get destroyed(){return this[h].destroyed}get closed(){return this[h].closed}get writable(){return!this[h].destroyed&&!this[h].ending}get writableEnded(){return this[h].ending}get writableFinished(){return this[h].finished}get writableNeedDrain(){return this[h].needDrain}get writableObjectMode(){return!1}get writableErrored(){return this[h].errored}}}),ne=u((e,t)=>{var{createRequire:r}=c("module"),i=V(),{join:n,isAbsolute:s,sep:a}=c("node:path"),o=Y(),l=Q(),u=ie();function d(e){e.ref(),e.flushSync(),e.end(),e.once("close",function(){e.unref()})}function p(e){e.flushSync()}t.exports=function(e){let{pipeline:t,targets:c,levels:h,dedupe:f,worker:m={},caller:g=i(),sync:y=!1}=e,v={...e.options},b="string"==typeof g?[g]:g,w="__bundlerPathsOverrides"in globalThis?globalThis.__bundlerPathsOverrides:{},_=e.target;if(_&&c)throw new Error("only one of target or targets can be specified");return c?(_=w["pino-worker"]||n(__dirname,"worker.js"),v.targets=c.filter(e=>e.target).map(e=>({...e,target:S(e.target)})),v.pipelines=c.filter(e=>e.pipeline).map(e=>e.pipeline.map(t=>({...t,level:e.level,target:S(t.target)})))):t&&(_=w["pino-worker"]||n(__dirname,"worker.js"),v.pipelines=[t.map(e=>({...e,target:S(e.target)}))]),h&&(v.levels=h),f&&(v.dedupe=f),v.pinoWillSendConfig=!0,function(e,t,r,i){let n=new u({filename:e,workerData:t,workerOpts:r,sync:i});function s(){n.closed||(n.flushSync(),o(100),n.end())}return n.on("ready",function(){process.removeListener("exit",s),n.unref(),!1!==r.autoEnd&&function(e){l.register(e,d),l.registerBeforeExit(e,p),e.on("close",function(){l.unregister(e)})}(n)}),n.on("close",function(){process.removeListener("exit",s)}),process.on("exit",s),n}(S(_),v,m,y);function S(e){if(s(e=w[e]||e)||0===e.indexOf("file://"))return e;if("pino/file"===e)return n(__dirname,"..","file.js");let t;for(let i of b)try{let n="node:repl"===i?process.cwd()+a:i;t=r(n).resolve(e);break}catch{continue}if(!t)throw new Error(`unable to determine transport target for "${e}"`);return t}}}),se=u((e,t)=>{var r,i=c("node:diagnostics_channel"),n=Z(),{mapHttpRequest:s,mapHttpResponse:a}=H(),o=X(),l=Q(),{lsCacheSym:u,chindingsSym:d,writeSym:p,serializersSym:h,formatOptsSym:f,endSym:m,stringifiersSym:g,stringifySym:y,stringifySafeSym:v,wildcardFirstSym:b,nestedKeySym:w,formattersSym:_,messageKeySym:S,errorKeySym:E,nestedKeyStrSym:k,msgPrefixSym:x}=W(),{isMainThread:T}=c("worker_threads"),P=ne();function R(){}function O(e){let t="",r=0,i=!1,n=255,s=e.length;if(s>100)return JSON.stringify(e);for(var a=0;a<s&&n>=32;a++)n=e.charCodeAt(a),(34===n||92===n)&&(t+=e.slice(r,a)+"\\",r=a,i=!0);return i?t+=e.slice(r):t=e,n<32?JSON.stringify(e):'"'+t+'"'}function $(e,t,r,i){let n,s=this[y],a=this[v],o=this[g],l=this[m],c=this[h],p=this[_],f=this[S],x=this[E],T=this[u][r]+i;T+=this[d],p.log&&(e=p.log(e));let P=o[b],R="";for(let t in e)if(n=e[t],Object.prototype.hasOwnProperty.call(e,t)&&void 0!==n){c[t]?n=c[t](n):t===x&&c.err&&(n=c.err(n));let e=o[t]||P;switch(typeof n){case"undefined":case"function":continue;case"number":!1===Number.isFinite(n)&&(n=null);case"boolean":e&&(n=e(n));break;case"string":n=(e||O)(n);break;default:n=(e||s)(n,a)}if(void 0===n)continue;R+=","+O(t)+":"+n}let $="";if(void 0!==t){n=c[f]?c[f](t):t;let e=o[f]||P;switch(typeof n){case"function":break;case"number":!1===Number.isFinite(n)&&(n=null);case"boolean":e&&(n=e(n)),$=',"'+f+'":'+n;break;case"string":n=(e||O)(n),$=',"'+f+'":'+n;break;default:n=(e||s)(n,a),$=',"'+f+'":'+n}}return this[w]&&R?T+this[k]+R.slice(1)+"}"+$+l:T+R+$+l}function C(e){let t=new o(e);return t.on("error",function e(r){if("EPIPE"===r.code)return t.write=R,t.end=R,t.flushSync=R,void(t.destroy=R);t.removeListener("error",e),t.emit("error",r)}),!e.sync&&T&&(l.register(t,A),t.on("close",function(){l.unregister(t)})),t}function A(e,t){e.destroyed||("beforeExit"===t?(e.flush(),e.on("drain",function(){e.end()})):e.flushSync())}r="function"==typeof i.tracingChannel?i.tracingChannel("pino_asJson"):{hasSubscribers:!1,traceSync:(e,t,r,...i)=>e.call(r,...i)},t.exports={noop:R,buildSafeSonicBoom:C,asChindings:function(e,t){let r,i=e[d],n=e[y],s=e[v],a=e[g],o=a[b],l=e[h];t=(0,e[_].bindings)(t);for(let e in t)if(r=t[e],!0===((e.length<5||"level"!==e&&"serializers"!==e&&"formatters"!==e&&"customLevels"!==e)&&t.hasOwnProperty(e)&&void 0!==r)){if(r=l[e]?l[e](r):r,r=(a[e]||o||n)(r,s),void 0===r)continue;i+=',"'+e+'":'+r}return i},asJson:function(e,t,i,n){return!1===r.hasSubscribers?$.call(this,e,t,i,n):r.traceSync($,{instance:this,arguments},this,e,t,i,n)},genLog:function(e,t){return t?function(...i){t.call(this,i,r,e)}:r;function r(t,...r){if("object"==typeof t){let i,o=t;null!==t&&(t.method&&t.headers&&t.socket?t=s(t):"function"==typeof t.setHeader&&(t=a(t))),null===o&&0===r.length?i=[null]:(o=r.shift(),i=r),"string"==typeof this[x]&&null!=o&&(o=this[x]+o),this[p](t,n(o,i,this[f]),e)}else{let i=void 0===t?r.shift():t;"string"==typeof this[x]&&null!=i&&(i=this[x]+i),this[p](null,n(i,r,this[f]),e)}}},createArgsNormalizer:function(e){return function(t,r,i={},n){if("string"==typeof i)n=C({dest:i}),i={};else if("string"==typeof n){if(i&&i.transport)throw Error("only one of option.transport or stream can be specified");n=C({dest:n})}else if(i instanceof o||i.writable||i._writableState)n=i,i={};else if(i.transport){if(i.transport instanceof o||i.transport.writable||i.transport._writableState)throw Error("option.transport do not allow stream, please pass to option directly. e.g. pino(transport)");if(i.transport.targets&&i.transport.targets.length&&i.formatters&&"function"==typeof i.formatters.level)throw Error("option.transport.targets do not allow custom level formatters");let e;i.customLevels&&(e=i.useOnlyCustomLevels?i.customLevels:Object.assign({},i.levels,i.customLevels)),n=P({caller:r,...i.transport,levels:e})}if((i=Object.assign({},e,i)).serializers=Object.assign({},e.serializers,i.serializers),i.formatters=Object.assign({},e.formatters,i.formatters),i.prettyPrint)throw new Error("prettyPrint option is no longer supported, see the pino-pretty package (https://github.com/pinojs/pino-pretty)");let{enabled:s,onChild:a}=i;return!1===s&&(i.level="silent"),a||(i.onChild=R),n||(n=function(e){return e.write!==e.constructor.prototype.write}(process.stdout)?process.stdout:C({fd:process.stdout.fd||1})),{opts:i,stream:n}}},stringify:function(e,t){try{return JSON.stringify(e)}catch{try{return(t||this[v])(e)}catch{return'"[unable to serialize, circular reference is too complex to analyze]"'}}},buildFormatters:function(e,t,r){return{level:e,bindings:t,log:r}},normalizeDestFileDescriptor:function(e){let t=Number(e);return"string"==typeof e&&Number.isFinite(t)?t:void 0===e?1:e}}}),ae=u((e,t)=>{t.exports={DEFAULT_LEVELS:{trace:10,debug:20,info:30,warn:40,error:50,fatal:60},SORTING_ORDER:{ASC:"ASC",DESC:"DESC"}}}),oe=u((e,t)=>{var{lsCacheSym:r,levelValSym:i,useOnlyCustomLevelsSym:n,streamSym:s,formattersSym:a,hooksSym:o,levelCompSym:l}=W(),{noop:c,genLog:u}=se(),{DEFAULT_LEVELS:d,SORTING_ORDER:p}=ae(),h={fatal:e=>{let t=u(d.fatal,e);return function(...e){let r=this[s];if(t.call(this,...e),"function"==typeof r.flushSync)try{r.flushSync()}catch{}}},error:e=>u(d.error,e),warn:e=>u(d.warn,e),info:e=>u(d.info,e),debug:e=>u(d.debug,e),trace:e=>u(d.trace,e)},f=Object.keys(d).reduce((e,t)=>(e[d[t]]=t,e),{}),m=Object.keys(f).reduce((e,t)=>(e[t]='{"level":'+Number(t),e),{});function g(e,t){if(t)return!1;switch(e){case"fatal":case"error":case"warn":case"info":case"debug":case"trace":return!0;default:return!1}}function y(e,t,r){return e===p.DESC?t<=r:t>=r}t.exports={initialLsCache:m,genLsCache:function(e){let t=e[a].level,{labels:i}=e.levels,n={};for(let e in i){let r=t(i[e],Number(e));n[e]=JSON.stringify(r).slice(0,-1)}return e[r]=n,e},levelMethods:h,getLevel:function(e){let{levels:t,levelVal:r}=this;return t&&t.labels?t.labels[r]:""},setLevel:function(e){let{labels:t,values:r}=this.levels;if("number"==typeof e){if(void 0===t[e])throw Error("unknown level value"+e);e=t[e]}if(void 0===r[e])throw Error("unknown level "+e);let s=this[i],a=this[i]=r[e],d=this[n],p=this[l],f=this[o].logMethod;for(let e in r)this[e]=!1!==p(r[e],a)?g(e,d)?h[e](f):u(r[e],f):c;this.emit("level-change",e,a,t[s],s,this)},isLevelEnabled:function(e){let{values:t}=this.levels,r=t[e];return void 0!==r&&this[l](r,this[i])},mappings:function(e=null,t=!1){let r=e?Object.keys(e).reduce((t,r)=>(t[e[r]]=r,t),{}):null;return{labels:Object.assign(Object.create(Object.prototype,{Infinity:{value:"silent"}}),t?null:f,r),values:Object.assign(Object.create(Object.prototype,{silent:{value:1/0}}),t?null:d,e)}},assertNoLevelCollisions:function(e,t){let{labels:r,values:i}=e;for(let e in t){if(e in i)throw Error("levels cannot be overridden");if(t[e]in r)throw Error("pre-existing level values cannot be used for new levels")}},assertDefaultLevelFound:function(e,t,r){if("number"!=typeof e){if(!(e in Object.assign(Object.create(Object.prototype,{silent:{value:1/0}}),r?null:d,t)))throw Error(`default level:${e} must be included in custom levels`)}else if(![].concat(Object.keys(t||{}).map(e=>t[e]),r?[]:Object.keys(f).map(e=>+e),1/0).includes(e))throw Error(`default level:${e} must be included in custom levels`)},genLevelComparison:function(e){return"string"==typeof e?y.bind(null,e):e},assertLevelComparison:function(e){if("function"!=typeof e&&("string"!=typeof e||!Object.values(p).includes(e)))throw new Error('Levels comparison should be one of "ASC", "DESC" or "function" type')}}}),le=u((e,t)=>{t.exports={version:"9.14.0"}}),ce=u((e,t)=>{var{EventEmitter:r}=c("node:events"),{lsCacheSym:i,levelValSym:n,setLevelSym:s,getLevelSym:a,chindingsSym:o,parsedChindingsSym:l,mixinSym:u,asJsonSym:d,writeSym:p,mixinMergeStrategySym:h,timeSym:f,timeSliceIndexSym:m,streamSym:g,serializersSym:y,formattersSym:v,errorKeySym:b,messageKeySym:w,useOnlyCustomLevelsSym:_,needsMetadataGsym:S,redactFmtSym:E,stringifySym:k,formatOptsSym:x,stringifiersSym:T,msgPrefixSym:P,hooksSym:R}=W(),{getLevel:O,setLevel:$,isLevelEnabled:C,mappings:A,initialLsCache:N,genLsCache:I,assertNoLevelCollisions:j}=oe(),{asChindings:L,asJson:D,buildFormatters:F,stringify:M,noop:z}=se(),{version:q}=le(),U=K(),B={constructor:class{},child:function(e,t){if(!e)throw Error("missing bindings for child Pino");let r=this[y],i=this[v],n=Object.create(this);if(null==t)return n[v].bindings!==H&&(n[v]=F(i.level,H,i.log)),n[o]=L(n,e),n[s](this.level),this.onChild!==z&&this.onChild(n),n;if(!0===t.hasOwnProperty("serializers")){n[y]=Object.create(null);for(let e in r)n[y][e]=r[e];let e=Object.getOwnPropertySymbols(r);for(var a=0;a<e.length;a++){let t=e[a];n[y][t]=r[t]}for(let e in t.serializers)n[y][e]=t.serializers[e];let i=Object.getOwnPropertySymbols(t.serializers);for(var l=0;l<i.length;l++){let e=i[l];n[y][e]=t.serializers[e]}}else n[y]=r;if(t.hasOwnProperty("formatters")){let{level:e,bindings:r,log:s}=t.formatters;n[v]=F(e||i.level,r||H,s||i.log)}else n[v]=F(i.level,H,i.log);if(!0===t.hasOwnProperty("customLevels")&&(j(this.levels,t.customLevels),n.levels=A(t.customLevels,n[_]),I(n)),"object"==typeof t.redact&&null!==t.redact||Array.isArray(t.redact)){n.redact=t.redact;let e=U(n.redact,M),r={stringify:e[E]};n[k]=M,n[T]=e,n[x]=r}return"string"==typeof t.msgPrefix&&(n[P]=(this[P]||"")+t.msgPrefix),n[o]=L(n,e),n[s](t.level||this.level),this.onChild(n),n},bindings:function(){let e=`{${this[o].substr(1)}}`,t=JSON.parse(e);return delete t.pid,delete t.hostname,t},setBindings:function(e){let t=L(this,e);this[o]=t,delete this[l]},flush:function(e){if(null!=e&&"function"!=typeof e)throw Error("callback must be a function");let t=this[g];"function"==typeof t.flush?t.flush(e||z):e&&e()},isLevelEnabled:C,version:q,get level(){return this[a]()},set level(e){this[s](e)},get levelVal(){return this[n]},set levelVal(e){throw Error("levelVal is read-only")},get msgPrefix(){return this[P]},get[Symbol.toStringTag](){return"Pino"},[i]:N,[p]:function(e,t,r){let i,n=this[f](),s=this[u],a=this[b],o=this[w],l=this[h]||V,c=this[R].streamWrite;null==e?i={}:e instanceof Error?(i={[a]:e},void 0===t&&(t=e.message)):(i=e,void 0===t&&void 0===e[o]&&e[a]&&(t=e[a].message)),s&&(i=l(i,s(i,r,this)));let p=this[d](i,t,r,n),y=this[g];!0===y[S]&&(y.lastLevel=r,y.lastObj=i,y.lastMsg=t,y.lastTime=n.slice(this[m]),y.lastLogger=this),y.write(c?c(p):p)},[d]:D,[a]:O,[s]:$};Object.setPrototypeOf(B,r.prototype),t.exports=function(){return Object.create(B)};var H=e=>e;function V(e,t){return Object.assign(t,e)}}),ue=u((e,t)=>{var{hasOwnProperty:r}=Object.prototype,i=p();i.configure=p,i.stringify=i,i.default=i,e.stringify=i,e.configure=p,t.exports=i;var n=/[\u0000-\u001f\u0022\u005c\ud800-\udfff]/;function s(e){return e.length<5e3&&!n.test(e)?`"${e}"`:JSON.stringify(e)}function a(e,t){if(e.length>200||t)return e.sort(t);for(let t=1;t<e.length;t++){let r=e[t],i=t;for(;0!==i&&e[i-1]>r;)e[i]=e[i-1],i--;e[i]=r}return e}var o=Object.getOwnPropertyDescriptor(Object.getPrototypeOf(Object.getPrototypeOf(new Int8Array)),Symbol.toStringTag).get;function l(e){return void 0!==o.call(e)&&0!==e.length}function c(e,t,r){e.length<r&&(r=e.length);let i=","===t?"":" ",n=`"0":${i}${e[0]}`;for(let s=1;s<r;s++)n+=`${t}"${s}":${i}${e[s]}`;return n}function u(e,t){let i;if(r.call(e,t)){if(i=e[t],"number"!=typeof i)throw new TypeError(`The "${t}" argument must be of type number`);if(!Number.isInteger(i))throw new TypeError(`The "${t}" argument must be an integer`);if(i<1)throw new RangeError(`The "${t}" argument must be >= 1`)}return void 0===i?1/0:i}function d(e){return 1===e?"1 item":`${e} items`}function p(e){let t=function(e){if(r.call(e,"strict")){let t=e.strict;if("boolean"!=typeof t)throw new TypeError('The "strict" argument must be of type boolean');if(t)return e=>{let t="Object can not safely be stringified. Received type "+typeof e;throw"function"!=typeof e&&(t+=` (${e.toString()})`),new Error(t)}}}(e={...e});t&&(void 0===e.bigint&&(e.bigint=!1),"circularValue"in e||(e.circularValue=Error));let i=function(e){if(r.call(e,"circularValue")){let t=e.circularValue;if("string"==typeof t)return`"${t}"`;if(null==t)return t;if(t===Error||t===TypeError)return{toString(){throw new TypeError("Converting circular structure to JSON")}};throw new TypeError('The "circularValue" argument must be of type string or the value null or undefined')}return'"[Circular]"'}(e),n=function(e,t){let i;if(r.call(e,t)&&(i=e[t],"boolean"!=typeof i))throw new TypeError(`The "${t}" argument must be of type boolean`);return void 0===i||i}(e,"bigint"),o=function(e){let t;if(r.call(e,"deterministic")&&(t=e.deterministic,"boolean"!=typeof t&&"function"!=typeof t))throw new TypeError('The "deterministic" argument must be of type boolean or comparator function');return void 0===t||t}(e),p="function"==typeof o?o:void 0,h=u(e,"maximumDepth"),f=u(e,"maximumBreadth");function m(e,r,c,u,g,y){let v=r[e];switch("object"==typeof v&&null!==v&&"function"==typeof v.toJSON&&(v=v.toJSON(e)),v=u.call(r,e,v),typeof v){case"string":return s(v);case"object":{if(null===v)return"null";if(-1!==c.indexOf(v))return i;let e="",t=",",r=y;if(Array.isArray(v)){if(0===v.length)return"[]";if(h<c.length+1)return'"[Array]"';c.push(v),""!==g&&(e+=`\n${y+=g}`,t=`,\n${y}`);let i=Math.min(v.length,f),n=0;for(;n<i-1;n++){let r=m(String(n),v,c,u,g,y);e+=void 0!==r?r:"null",e+=t}let s=m(String(n),v,c,u,g,y);return e+=void 0!==s?s:"null",v.length-1>f&&(e+=`${t}"... ${d(v.length-f-1)} not stringified"`),""!==g&&(e+=`\n${r}`),c.pop(),`[${e}]`}let n=Object.keys(v),b=n.length;if(0===b)return"{}";if(h<c.length+1)return'"[Object]"';let w="",_="";""!==g&&(t=`,\n${y+=g}`,w=" ");let S=Math.min(b,f);o&&!l(v)&&(n=a(n,p)),c.push(v);for(let r=0;r<S;r++){let i=n[r],a=m(i,v,c,u,g,y);void 0!==a&&(e+=`${_}${s(i)}:${w}${a}`,_=t)}return b>f&&(e+=`${_}"...":${w}"${d(b-f)} not stringified"`,_=t),""!==g&&_.length>1&&(e=`\n${y}${e}\n${r}`),c.pop(),`{${e}}`}case"number":return isFinite(v)?String(v):t?t(v):"null";case"boolean":return!0===v?"true":"false";case"undefined":return;case"bigint":if(n)return String(v);default:return t?t(v):void 0}}function g(e,r,a,o,l,c){switch("object"==typeof r&&null!==r&&"function"==typeof r.toJSON&&(r=r.toJSON(e)),typeof r){case"string":return s(r);case"object":{if(null===r)return"null";if(-1!==a.indexOf(r))return i;let e=c,t="",n=",";if(Array.isArray(r)){if(0===r.length)return"[]";if(h<a.length+1)return'"[Array]"';a.push(r),""!==l&&(t+=`\n${c+=l}`,n=`,\n${c}`);let i=Math.min(r.length,f),s=0;for(;s<i-1;s++){let e=g(String(s),r[s],a,o,l,c);t+=void 0!==e?e:"null",t+=n}let u=g(String(s),r[s],a,o,l,c);return t+=void 0!==u?u:"null",r.length-1>f&&(t+=`${n}"... ${d(r.length-f-1)} not stringified"`),""!==l&&(t+=`\n${e}`),a.pop(),`[${t}]`}a.push(r);let u="";""!==l&&(n=`,\n${c+=l}`,u=" ");let p="";for(let e of o){let i=g(e,r[e],a,o,l,c);void 0!==i&&(t+=`${p}${s(e)}:${u}${i}`,p=n)}return""!==l&&p.length>1&&(t=`\n${c}${t}\n${e}`),a.pop(),`{${t}}`}case"number":return isFinite(r)?String(r):t?t(r):"null";case"boolean":return!0===r?"true":"false";case"undefined":return;case"bigint":if(n)return String(r);default:return t?t(r):void 0}}function y(e,r,u,m,g){switch(typeof r){case"string":return s(r);case"object":{if(null===r)return"null";if("function"==typeof r.toJSON){if("object"!=typeof(r=r.toJSON(e)))return y(e,r,u,m,g);if(null===r)return"null"}if(-1!==u.indexOf(r))return i;let t=g;if(Array.isArray(r)){if(0===r.length)return"[]";if(h<u.length+1)return'"[Array]"';u.push(r);let e=`\n${g+=m}`,i=`,\n${g}`,n=Math.min(r.length,f),s=0;for(;s<n-1;s++){let t=y(String(s),r[s],u,m,g);e+=void 0!==t?t:"null",e+=i}let a=y(String(s),r[s],u,m,g);return e+=void 0!==a?a:"null",r.length-1>f&&(e+=`${i}"... ${d(r.length-f-1)} not stringified"`),e+=`\n${t}`,u.pop(),`[${e}]`}let n=Object.keys(r),v=n.length;if(0===v)return"{}";if(h<u.length+1)return'"[Object]"';let b=`,\n${g+=m}`,w="",_="",S=Math.min(v,f);l(r)&&(w+=c(r,b,f),n=n.slice(r.length),S-=r.length,_=b),o&&(n=a(n,p)),u.push(r);for(let e=0;e<S;e++){let t=n[e],i=y(t,r[t],u,m,g);void 0!==i&&(w+=`${_}${s(t)}: ${i}`,_=b)}return v>f&&(w+=`${_}"...": "${d(v-f)} not stringified"`,_=b),""!==_&&(w=`\n${g}${w}\n${t}`),u.pop(),`{${w}}`}case"number":return isFinite(r)?String(r):t?t(r):"null";case"boolean":return!0===r?"true":"false";case"undefined":return;case"bigint":if(n)return String(r);default:return t?t(r):void 0}}function v(e,r,u){switch(typeof r){case"string":return s(r);case"object":{if(null===r)return"null";if("function"==typeof r.toJSON){if("object"!=typeof(r=r.toJSON(e)))return v(e,r,u);if(null===r)return"null"}if(-1!==u.indexOf(r))return i;let t="",n=void 0!==r.length;if(n&&Array.isArray(r)){if(0===r.length)return"[]";if(h<u.length+1)return'"[Array]"';u.push(r);let e=Math.min(r.length,f),i=0;for(;i<e-1;i++){let e=v(String(i),r[i],u);t+=void 0!==e?e:"null",t+=","}let n=v(String(i),r[i],u);return t+=void 0!==n?n:"null",r.length-1>f&&(t+=`,"... ${d(r.length-f-1)} not stringified"`),u.pop(),`[${t}]`}let m=Object.keys(r),g=m.length;if(0===g)return"{}";if(h<u.length+1)return'"[Object]"';let y="",b=Math.min(g,f);n&&l(r)&&(t+=c(r,",",f),m=m.slice(r.length),b-=r.length,y=","),o&&(m=a(m,p)),u.push(r);for(let e=0;e<b;e++){let i=m[e],n=v(i,r[i],u);void 0!==n&&(t+=`${y}${s(i)}:${n}`,y=",")}return g>f&&(t+=`${y}"...":"${d(g-f)} not stringified"`),u.pop(),`{${t}}`}case"number":return isFinite(r)?String(r):t?t(r):"null";case"boolean":return!0===r?"true":"false";case"undefined":return;case"bigint":if(n)return String(r);default:return t?t(r):void 0}}return function(e,t,r){if(arguments.length>1){let i="";if("number"==typeof r?i=" ".repeat(Math.min(r,10)):"string"==typeof r&&(i=r.slice(0,10)),null!=t){if("function"==typeof t)return m("",{"":e},[],t,i,"");if(Array.isArray(t))return g("",e,[],function(e){let t=new Set;for(let r of e)("string"==typeof r||"number"==typeof r)&&t.add(String(r));return t}(t),i,"")}if(0!==i.length)return y("",e,[],i,"")}return v("",e,[])}}}),de=u((e,t)=>{var r=Symbol.for("pino.metadata"),{DEFAULT_LEVELS:i}=ae(),n=i.info;function s(e,t){return e.level-t.level}function a(e,t){return t?e-1:e+1}function o(e,t,r){return r?e>=0:e<t}t.exports=function(e,t){e=e||[],t=t||{dedupe:!1};let l=Object.create(i);l.silent=1/0,t.levels&&"object"==typeof t.levels&&Object.keys(t.levels).forEach(e=>{l[e]=t.levels[e]});let c={write:u,add:h,remove:f,emit:d,flushSync:p,end:function(){for(let{stream:e}of this.streams)"function"==typeof e.flushSync&&e.flushSync(),e.end()},minLevel:0,lastId:0,streams:[],clone:function e(t){let i=new Array(this.streams.length);for(let e=0;e<i.length;e++)i[e]={level:t,stream:this.streams[e].stream};return{write:u,add:h,remove:f,minLevel:t,streams:i,clone:e,emit:d,flushSync:p,[r]:!0}},[r]:!0,streamLevels:l};return Array.isArray(e)?e.forEach(h,c):h.call(c,e),e=null,c;function u(e){let i,n,s=this.lastLevel,{streams:l}=this,c=0;for(let u=function(e,t){return t?e-1:0}(l.length,t.dedupe);o(u,l.length,t.dedupe);u=a(u,t.dedupe))if(i=l[u],i.level<=s){if(0!==c&&c!==i.level)break;if(n=i.stream,n[r]){let{lastTime:e,lastMsg:t,lastObj:r,lastLogger:i}=this;n.lastLevel=s,n.lastTime=e,n.lastMsg=t,n.lastObj=r,n.lastLogger=i}n.write(e),t.dedupe&&(c=i.level)}else if(!t.dedupe)break}function d(...e){for(let{stream:t}of this.streams)"function"==typeof t.emit&&t.emit(...e)}function p(){for(let{stream:e}of this.streams)"function"==typeof e.flushSync&&e.flushSync()}function h(e){if(!e)return c;let t=e.write?e:e.stream;if("function"!=typeof e.write&&!e.stream)throw Error("stream object needs to implement either StreamEntry or DestinationStream interface");let r,{streams:i,streamLevels:a}=this;r="number"==typeof e.levelVal?e.levelVal:"string"==typeof e.level?a[e.level]:"number"==typeof e.level?e.level:n;let o={stream:t,level:r,levelVal:void 0,id:++c.lastId};return i.unshift(o),i.sort(s),this.minLevel=i[0].level,c}function f(e){let{streams:t}=this,r=t.findIndex(t=>t.id===e);return r>=0&&(t.splice(r,1),t.sort(s),this.minLevel=t.length>0?t[0].level:-1),c}}}),pe=u((e,t)=>{var r=c("node:os"),i=H(),n=V(),s=K(),a=J(),o=ce(),l=W(),{configure:u}=ue(),{assertDefaultLevelFound:d,mappings:p,genLsCache:h,genLevelComparison:f,assertLevelComparison:m}=oe(),{DEFAULT_LEVELS:g,SORTING_ORDER:y}=ae(),{createArgsNormalizer:v,asChindings:b,buildSafeSonicBoom:w,buildFormatters:_,stringify:S,normalizeDestFileDescriptor:E,noop:k}=se(),{version:x}=le(),{chindingsSym:T,redactFmtSym:P,serializersSym:R,timeSym:O,timeSliceIndexSym:$,streamSym:C,stringifySym:A,stringifySafeSym:N,stringifiersSym:I,setLevelSym:j,endSym:L,formatOptsSym:D,messageKeySym:F,errorKeySym:M,nestedKeySym:z,mixinSym:q,levelCompSym:U,useOnlyCustomLevelsSym:B,formattersSym:G,hooksSym:Z,nestedKeyStrSym:Y,mixinMergeStrategySym:X,msgPrefixSym:Q}=l,{epochTime:ee,nullTime:te}=a,{pid:re}=process,ie=r.hostname(),pe=i.err,he={level:"info",levelComparison:y.ASC,levels:g,messageKey:"msg",errorKey:"err",nestedKey:null,enabled:!0,base:{pid:re,hostname:ie},serializers:Object.assign(Object.create(null),{err:pe}),formatters:Object.assign(Object.create(null),{bindings:e=>e,level:(e,t)=>({level:t})}),hooks:{logMethod:void 0,streamWrite:void 0},timestamp:ee,name:void 0,redact:null,customLevels:null,useOnlyCustomLevels:!1,depthLimit:5,edgeLimit:100},fe=v(he),me=Object.assign(Object.create(null),i);function ge(...e){let t={},{opts:r,stream:i}=fe(t,n(),...e);r.level&&"string"==typeof r.level&&void 0!==g[r.level.toLowerCase()]&&(r.level=r.level.toLowerCase());let{redact:a,crlf:l,serializers:c,timestamp:y,messageKey:v,errorKey:w,nestedKey:E,base:x,name:H,level:V,customLevels:W,levelComparison:K,mixin:J,mixinMergeStrategy:re,useOnlyCustomLevels:ie,formatters:ne,hooks:se,depthLimit:ae,edgeLimit:oe,onChild:le,msgPrefix:ce}=r,ue=u({maximumDepth:ae,maximumBreadth:oe}),de=_(ne.level,ne.bindings,ne.log),pe=S.bind({[N]:ue}),he=a?s(a,pe):{},me=a?{stringify:he[P]}:{stringify:pe},ge="}"+(l?"\r\n":"\n"),ye=b.bind(null,{[T]:"",[R]:c,[I]:he,[A]:S,[N]:ue,[G]:de}),ve="";null!==x&&(ve=ye(void 0===H?x:Object.assign({},x,{name:H})));let be=y instanceof Function?y:y?ee:te,we=be().indexOf(":")+1;if(ie&&!W)throw Error("customLevels is required if useOnlyCustomLevels is set true");if(J&&"function"!=typeof J)throw Error(`Unknown mixin type "${typeof J}" - expected "function"`);if(ce&&"string"!=typeof ce)throw Error(`Unknown msgPrefix type "${typeof ce}" - expected "string"`);d(V,W,ie);let _e=p(W,ie);"function"==typeof i.emit&&i.emit("message",{code:"PINO_CONFIG",config:{levels:_e,messageKey:v,errorKey:w}}),m(K);let Se=f(K);return Object.assign(t,{levels:_e,[U]:Se,[B]:ie,[C]:i,[O]:be,[$]:we,[A]:S,[N]:ue,[I]:he,[L]:ge,[D]:me,[F]:v,[M]:w,[z]:E,[Y]:E?`,${JSON.stringify(E)}:{`:"",[R]:c,[q]:J,[X]:re,[T]:ve,[G]:de,[Z]:se,silent:k,onChild:le,[Q]:ce}),Object.setPrototypeOf(t,o()),h(t),t[j](V),t}t.exports=ge,t.exports.destination=(e=process.stdout.fd)=>"object"==typeof e?(e.dest=E(e.dest||process.stdout.fd),w(e)):w({dest:E(e),minLength:0}),t.exports.transport=ne(),t.exports.multistream=de(),t.exports.levels=p(),t.exports.stdSerializers=me,t.exports.stdTimeFunctions=Object.assign({},a),t.exports.symbols=l,t.exports.version=x,t.exports.default=ge,t.exports.pino=ge}),he=u((e,t)=>{var r=D(),i=pe(),{serializersSym:n}=i.symbols,{FST_ERR_LOG_INVALID_DESTINATION:s,FST_ERR_LOG_INVALID_LOGGER:a}=C();function o(e){if(e.stream&&e.file)throw new s;e.file&&(e.stream=i.destination(e.file),delete e.file);let t=e.logger,r=e.genReqId,a=null;return t?(e.logger=void 0,e.genReqId=void 0,t[n]&&(e.serializers=Object.assign({},e.serializers,t[n])),a=t.child({},e),e.logger=t,e.genReqId=r):a=i(e,e.stream),a}var l={req:function(e){return{method:e.method,url:e.url,version:e.headers&&e.headers["accept-version"],hostname:e.hostname,remoteAddress:e.ip,remotePort:e.socket?e.socket.remotePort:void 0}},err:i.stdSerializers.err,res:function(e){return{statusCode:e.statusCode}}};function c(e,t){let r=["info","error","debug","fatal","warn","trace","child"],i=e?r.filter(t=>!e[t]||"function"!=typeof e[t]):r;if(i.length){if(i.length===r.length&&!t)return!1;throw a(i.join(","))}return!0}function u(e,t,r){return e.child(t,r)}t.exports={createLogger:function(e){if(!e.logger){let e=r;return e.child=()=>e,{logger:e,hasLogger:!1}}if(c(e.logger))return{logger:o({logger:e.logger,serializers:Object.assign({},l,e.logger.serializers)}),hasLogger:!0};let t={};return"[object Object]"===Object.prototype.toString.call(e.logger)&&Reflect.ownKeys(e.logger).forEach(r=>{Object.defineProperty(t,r,{value:e.logger[r],writable:!0,enumerable:!0,configurable:!0})}),t.level=t.level||"info",t.serializers=Object.assign({},l,t.serializers),e.logger=t,{logger:o(e.logger),hasLogger:!0}},createChildLogger:function(e,t,r,i,n){let s=e.childLoggerFactory.call(e.server,t,{[e.requestIdLogLabel]:i},n||{},r);return e.childLoggerFactory!==u&&c(s,!0),s},defaultChildLoggerFactory:u,serializers:l,now:function(){let e=process.hrtime();return 1e3*e[0]+e[1]/1e6}}}),fe=u((e,t)=>{function r(e){return e instanceof Buffer?Buffer.from(e):new e.constructor(e.buffer.slice(),e.byteOffset,e.length)}t.exports=function(e){if((e=e||{}).circles)return function(e){let t=[],i=[],n=new Map;if(n.set(Date,e=>new Date(e)),n.set(Map,(e,t)=>new Map(a(Array.from(e),t))),n.set(Set,(e,t)=>new Set(a(Array.from(e),t))),e.constructorHandlers)for(let t of e.constructorHandlers)n.set(t[0],t[1]);let s=null;return e.proto?function e(o){if("object"!=typeof o||null===o)return o;if(Array.isArray(o))return a(o,e);if(o.constructor!==Object&&(s=n.get(o.constructor)))return s(o,e);let l={};t.push(o),i.push(l);for(let a in o){let c=o[a];if("object"!=typeof c||null===c)l[a]=c;else if(c.constructor!==Object&&(s=n.get(c.constructor)))l[a]=s(c,e);else if(ArrayBuffer.isView(c))l[a]=r(c);else{let r=t.indexOf(c);l[a]=-1!==r?i[r]:e(c)}}return t.pop(),i.pop(),l}:function e(o){if("object"!=typeof o||null===o)return o;if(Array.isArray(o))return a(o,e);if(o.constructor!==Object&&(s=n.get(o.constructor)))return s(o,e);let l={};t.push(o),i.push(l);for(let a in o){if(!1===Object.hasOwnProperty.call(o,a))continue;let c=o[a];if("object"!=typeof c||null===c)l[a]=c;else if(c.constructor!==Object&&(s=n.get(c.constructor)))l[a]=s(c,e);else if(ArrayBuffer.isView(c))l[a]=r(c);else{let r=t.indexOf(c);l[a]=-1!==r?i[r]:e(c)}}return t.pop(),i.pop(),l};function a(e,a){let o=Object.keys(e),l=new Array(o.length);for(let c=0;c<o.length;c++){let u=o[c],d=e[u];if("object"!=typeof d||null===d)l[u]=d;else if(d.constructor!==Object&&(s=n.get(d.constructor)))l[u]=s(d,a);else if(ArrayBuffer.isView(d))l[u]=r(d);else{let e=t.indexOf(d);l[u]=-1!==e?i[e]:a(d)}}return l}}(e);let t=new Map;if(t.set(Date,e=>new Date(e)),t.set(Map,(e,t)=>new Map(n(Array.from(e),t))),t.set(Set,(e,t)=>new Set(n(Array.from(e),t))),e.constructorHandlers)for(let r of e.constructorHandlers)t.set(r[0],r[1]);let i=null;return e.proto?function e(s){if("object"!=typeof s||null===s)return s;if(Array.isArray(s))return n(s,e);if(s.constructor!==Object&&(i=t.get(s.constructor)))return i(s,e);let a={};for(let n in s){let o=s[n];a[n]="object"!=typeof o||null===o?o:o.constructor!==Object&&(i=t.get(o.constructor))?i(o,e):ArrayBuffer.isView(o)?r(o):e(o)}return a}:function e(s){if("object"!=typeof s||null===s)return s;if(Array.isArray(s))return n(s,e);if(s.constructor!==Object&&(i=t.get(s.constructor)))return i(s,e);let a={};for(let n in s){if(!1===Object.hasOwnProperty.call(s,n))continue;let o=s[n];a[n]="object"!=typeof o||null===o?o:o.constructor!==Object&&(i=t.get(o.constructor))?i(o,e):ArrayBuffer.isView(o)?r(o):e(o)}return a};function n(e,n){let s=Object.keys(e),a=new Array(s.length);for(let o=0;o<s.length;o++){let l=s[o],c=e[l];a[l]="object"!=typeof c||null===c?c:c.constructor!==Object&&(i=t.get(c.constructor))?i(c,n):ArrayBuffer.isView(c)?r(c):n(c)}return a}}}),me=u((e,t)=>{var r=fe()({circles:!1,proto:!0}),{kSchemaVisited:i,kSchemaResponse:n}=R(),s=Symbol.for("fluent-schema-object"),{FSTDEP022:a}=$(),{FST_ERR_SCH_MISSING_ID:o,FST_ERR_SCH_ALREADY_PRESENT:l,FST_ERR_SCH_DUPLICATE:c,FST_ERR_SCH_CONTENT_MISSING_SCHEMA:u}=C(),d=["params","body","querystring","query","headers"];function p(e){this.store=e||{}}function h(e){return"object"==typeof e&&Object.getPrototypeOf(e)!==Object.prototype}function f(e,t,r){return!r||t.$ref||t.oneOf||t.allOf||t.anyOf||t.$merge||t.$patch||t.type||t.properties?t:(a(e),{type:"object",properties:t})}p.prototype.add=function(e){let t=r(e.isFluentSchema||e.isFluentJSONSchema||e[s]?e.valueOf():e),i=t.$id;if(!i)throw new o;if(this.store[i])throw new l(i);this.store[i]=t},p.prototype.getSchemas=function(){return Object.assign({},this.store)},p.prototype.getSchema=function(e){return this.store[e]},t.exports={buildSchemas:e=>new p(e),getSchemaSerializer:function(e,t,r){let i=e[n];if(!i)return!1;if(i[t]){if(i[t].constructor===Object&&r){let e=r.split(";",1)[0];return!!i[t][e]&&i[t][e]}return i[t]}let s=(t+"")[0]+"xx";if(i[s]){if(i[s].constructor===Object&&r){let e=r.split(";",1)[0];return!!i[s][e]&&i[s][e]}return i[s]}if(i.default){if(i.default.constructor===Object&&r){let e=r.split(";",1)[0];return!!i.default[e]&&i.default[e]}return i.default}return!1},normalizeSchema:function(e,t,r){if(t[i])return t;if(t.query){if(t.querystring)throw new c("querystring");t.querystring=t.query}!function(e){for(let t of d)e[t]&&(e[t].isFluentSchema||e[t][s])&&(e[t]=e[t].valueOf());if(e.response){let t=Object.keys(e.response);for(let r of t)(e.response[r].isFluentSchema||e.response[r][s])&&(e.response[r]=e.response[r].valueOf())}}(t);for(let i of d){let n=t[i];if(n&&!h(n)){if("body"===i&&n.content){let i=n.content,s=Object.keys(i);for(let n=0;n<s.length;n++){let a=s[n],o=i[a].schema;if(!o)throw new u(a);t.body.content[a].schema=f(e.url,o,r.jsonShorthand)}continue}t[i]=f(e.url,n,r.jsonShorthand)}}if(t.response){let i=Object.keys(t.response);for(let n of i){if(h(t.response[n]))continue;let i=t.response[n].content,s=!1;if(i){let a=Object.keys(i);for(let o=0;o<a.length;o++){let l=a[o];if(!i[l].schema){if(1===a.length)break;throw new u(l)}t.response[n].content[l].schema=f(e.url,i[l].schema,r.jsonShorthand),o===a.length-1&&(s=!0)}}s||(t.response[n]=f(e.url,t.response[n],r.jsonShorthand))}}return t[i]=!0,t}}}),ge=u((e,t)=>{var r=/[\u0000-\u001f\u0022\u005c\ud800-\udfff]/;t.exports=class e{constructor(e){switch(e&&e.rounding){case"floor":this.parseInteger=Math.floor;break;case"ceil":this.parseInteger=Math.ceil;break;case"round":this.parseInteger=Math.round;break;default:this.parseInteger=Math.trunc}this._options=e}asInteger(e){if(Number.isInteger(e))return""+e;if("bigint"==typeof e)return e.toString();let t=this.parseInteger(e);if(t===1/0||t===-1/0||t!=t)throw new Error(`The value "${e}" cannot be converted to an integer.`);return""+t}asNumber(e){let t=Number(e);if(t!=t)throw new Error(`The value "${e}" cannot be converted to a number.`);return t===1/0||t===-1/0?"null":""+t}asBoolean(e){return e?"true":"false"}asDateTime(e){if(null===e)return'""';if(e instanceof Date)return'"'+e.toISOString()+'"';if("string"==typeof e)return'"'+e+'"';throw new Error(`The value "${e}" cannot be converted to a date-time.`)}asDate(e){if(null===e)return'""';if(e instanceof Date)return'"'+new Date(e.getTime()-6e4*e.getTimezoneOffset()).toISOString().slice(0,10)+'"';if("string"==typeof e)return'"'+e+'"';throw new Error(`The value "${e}" cannot be converted to a date.`)}asTime(e){if(null===e)return'""';if(e instanceof Date)return'"'+new Date(e.getTime()-6e4*e.getTimezoneOffset()).toISOString().slice(11,19)+'"';if("string"==typeof e)return'"'+e+'"';throw new Error(`The value "${e}" cannot be converted to a time.`)}asString(e){let t=e.length;if(t<42){let r="",n=-1,s=255;for(var i=0;i<t;i++)if(s=e.charCodeAt(i),34===s||92===s)-1===n&&(n=0),r+=e.slice(n,i)+"\\",n=i;else if(s<32||s>=55296&&s<=57343)return JSON.stringify(e);return-1===n&&'"'+e+'"'||'"'+r+e.slice(n)+'"'}return t<5e3&&!1===r.test(e)?'"'+e+'"':JSON.stringify(e)}asUnsafeString(e){return'"'+e+'"'}getState(){return this._options}static restoreFromState(t){return new e(t)}}}),ye=u((e,t)=>{var r,i=ge().restoreFromState({mode:"standalone"});t.exports=(r=i,function(e){let t=e&&"function"==typeof e.toJSON?e.toJSON():e;if(null===t)return"{}";let i,n="{",s=!1;return i=t.statusCode,void 0!==i&&(!s&&(s=!0)||(n+=","),n+='"statusCode":',n+=r.asNumber(i)),i=t.code,void 0!==i&&(!s&&(s=!0)||(n+=","),n+='"code":',"string"!=typeof i?null===i?n+='""':i instanceof Date?n+='"'+i.toISOString()+'"':i instanceof RegExp?n+=r.asString(i.source):n+=r.asString(i.toString()):n+=r.asString(i)),i=t.error,void 0!==i&&(!s&&(s=!0)||(n+=","),n+='"error":',"string"!=typeof i?null===i?n+='""':i instanceof Date?n+='"'+i.toISOString()+'"':i instanceof RegExp?n+=r.asString(i.source):n+=r.asString(i.toString()):n+=r.asString(i)),i=t.message,void 0!==i&&(!s&&(s=!0)||(n+=","),n+='"message":',"string"!=typeof i?null===i?n+='""':i instanceof Date?n+='"'+i.toISOString()+'"':i instanceof RegExp?n+=r.asString(i.source):n+=r.asString(i.toString()):n+=r.asString(i)),n+"}"})}),ve=u((e,t)=>{var r=c("node:http").STATUS_CODES,i=j(),{kReplyHeaders:n,kReplyNextErrorHandler:s,kReplyIsRunningOnErrorHook:a,kReplyHasStatusCode:o,kRouteContext:l,kDisableRequestLogging:u}=R(),{FST_ERR_REP_INVALID_PAYLOAD_TYPE:d,FST_ERR_FAILED_ERROR_SERIALIZATION:p}=C(),{getSchemaSerializer:h}=me(),f=ye(),m={func:function(e,t,r){if(function(e,t){let r=t.raw,i=r.statusCode;i=i>=400?i:500,null!=e&&(void 0!==e.headers&&t.headers(e.headers),e.status>=400?i=e.status:e.statusCode>=400&&(i=e.statusCode)),r.statusCode=i}(e,r),!r[o]||200===r.statusCode){let t=e.statusCode||e.status;r.code(t>=400?t:500)}r.statusCode<500?r.log[u]||r.log.info({res:r,err:e},e&&e.message):r.log[u]||r.log.error({req:t,res:r,err:e},e&&e.message),r.send(e)},toJSON(){return this.func.name.toString()+"()"}};function g(e,t,i){let s,a=t.raw,o=t.statusCode;t[n]["content-type"]=t[n]["content-type"]??"application/json; charset=utf-8";try{let i=h(t[l],o,t[n]["content-type"]);s=!1===i?f({error:r[o+""],code:e.code,message:e.message,statusCode:o}):i(Object.create(e,{error:{value:r[o+""]},message:{value:e.message},statusCode:{value:o}}))}catch(r){t.log[u]||t.log.error({err:r,statusCode:a.statusCode},"The serializer for the given status code failed"),t.code(500),s=f(new p(r.message,e.message))}"string"!=typeof s&&!Buffer.isBuffer(s)&&(s=f(new d(typeof s))),t[n]["content-length"]=""+Buffer.byteLength(s),i(t,s)}t.exports={buildErrorHandler:function(e=m,t){if(!t)return e;let r=Object.create(e);return r.func=t,r},handleError:function(e,t,r){e[a]=!1;let o=e[l];if(!1===e[s])return void g(t,e,function(e,t){try{e.raw.writeHead(e.raw.statusCode,e[n])}catch(t){e.log[u]||e.log.warn({req:e.request,res:e,err:t},t&&t.message),e.raw.writeHead(e.raw.statusCode)}e.raw.end(t)});let c=e[s]||o.errorHandler;e[s]=Object.getPrototypeOf(c),delete e[n]["content-type"],delete e[n]["content-length"];let d=c.func;if(!d)return e[s]=!1,void g(t,e,r);try{let r=d(t,e.request,e);void 0!==r&&(null!==r&&"function"==typeof r.then?i(r,e):e.send(r))}catch(t){e.send(t)}}}}),be=u((e,t)=>{var r=c("node:stream").finished,i=c("node:stream").Readable,{kFourOhFourContext:n,kPublicRouteContext:s,kReplyErrorHandlerCalled:a,kReplyHijacked:o,kReplyStartTime:l,kReplyEndTime:u,kReplySerializer:d,kReplySerializerDefault:p,kReplyIsError:h,kReplyHeaders:f,kReplyTrailers:m,kReplyHasStatusCode:g,kReplyIsRunningOnErrorHook:y,kReplyNextErrorHandler:v,kDisableRequestLogging:b,kSchemaResponse:w,kReplyCacheSerializeFns:_,kSchemaController:S,kOptions:E,kRouteContext:k}=R(),{onSendHookRunner:x,onResponseHookRunner:T,preHandlerHookRunner:P,preSerializationHookRunner:O}=A(),N=L()[Symbol.for("internals")],I=he().now,{handleError:j}=ve(),{getSchemaSerializer:D}=me(),{FST_ERR_REP_INVALID_PAYLOAD_TYPE:F,FST_ERR_REP_RESPONSE_BODY_CONSUMED:M,FST_ERR_REP_ALREADY_SENT:z,FST_ERR_REP_SENT_VALUE:q,FST_ERR_SEND_INSIDE_ONERR:U,FST_ERR_BAD_STATUS_CODE:B,FST_ERR_BAD_TRAILER_NAME:H,FST_ERR_BAD_TRAILER_VALUE:V,FST_ERR_MISSING_SERIALIZATION_FN:G,FST_ERR_MISSING_CONTENTTYPE_SERIALIZATION_FN:W}=C(),{FSTDEP010:K,FSTDEP013:J,FSTDEP019:Z,FSTDEP020:Y,FSTDEP021:X}=$(),Q=Object.prototype.toString;function ee(e,t,r){this.raw=e,this[d]=null,this[a]=!1,this[h]=!1,this[y]=!1,this.request=t,this[f]={},this[m]=null,this[g]=!1,this[l]=void 0,this.log=r}ee.props=[],Object.defineProperties(ee.prototype,{[k]:{get(){return this.request[k]}},context:{get(){return Z(),this.request[k]}},elapsedTime:{get(){return void 0===this[l]?0:(this[u]||I())-this[l]}},server:{get(){return this.request[k].server}},sent:{enumerable:!0,get(){return!0===(this[o]||this.raw.writableEnded)},set(e){if(K(),!0!==e)throw new q;if(this.sent&&this[o])throw new z(this.request.url,this.request.method);this[o]=!0}},statusCode:{get(){return this.raw.statusCode},set(e){this.code(e)}},[s]:{get(){return this.request[s]}}}),ee.prototype.hijack=function(){return this[o]=!0,this},ee.prototype.send=function(e){if(!0===this[y])throw new U;if(this.sent)return this.log.warn({err:new z(this.request.url,this.request.method)}),this;if(e instanceof Error||!0===this[h])return this[h]=!1,de(this,e,ne),this;if(void 0===e)return ne(this,e),this;let t=this.getHeader("content-type"),r=void 0!==t;if(null!==e){if("function"==typeof e.pipe||"function"==typeof e.getReader||"[object Response]"===Q.call(e))return ne(this,e),this;if(e?.buffer instanceof ArrayBuffer)return!1===r&&(this[f]["content-type"]="application/octet-stream"),ne(this,Buffer.isBuffer(e)?e:Buffer.from(e.buffer,e.byteOffset,e.byteLength)),this;if(!1===r&&"string"==typeof e)return this[f]["content-type"]="text/plain; charset=utf-8",ne(this,e),this}if(null!==this[d]){if("string"!=typeof e)return re(this,e),this;e=this[d](e)}else if(!1===r||t.indexOf("json")>-1){if(!1===r)this[f]["content-type"]="application/json; charset=utf-8";else if(-1===t.indexOf("charset")){let e=t.trim();this[f]["content-type"]=e.endsWith(";")?`${e} charset=utf-8`:`${e}; charset=utf-8`}if("string"!=typeof e)return re(this,e),this}return ne(this,e),this},ee.prototype.getHeader=function(e){e=e.toLowerCase();let t=this.raw,r=this[f][e];return void 0===r&&t.hasHeader(e)&&(r=t.getHeader(e)),r},ee.prototype.getHeaders=function(){return{...this.raw.getHeaders(),...this[f]}},ee.prototype.hasHeader=function(e){return e=e.toLowerCase(),void 0!==this[f][e]||this.raw.hasHeader(e)},ee.prototype.removeHeader=function(e){return delete this[f][e.toLowerCase()],this},ee.prototype.header=function(e,t=""){return e=e.toLowerCase(),this[f][e]&&"set-cookie"===e?("string"==typeof this[f][e]&&(this[f][e]=[this[f][e]]),Array.isArray(t)?Array.prototype.push.apply(this[f][e],t):this[f][e].push(t)):this[f][e]=t,this},ee.prototype.headers=function(e){let t=Object.keys(e);for(var r=0;r!==t.length;++r){let i=t[r];this.header(i,e[i])}return this};var te=new Set(["transfer-encoding","content-length","host","cache-control","max-forwards","te","authorization","set-cookie","content-encoding","content-type","content-range","trailer"]);function re(e,t){null!==e[k].preSerialization?O(e[k].preSerialization,e.request,e,t,ie):ie(null,0,e,t)}function ie(e,t,r,i){if(null==e){try{i=null!==r[d]?r[d](i):r[k]&&r[k][p]?r[k][p](i,r.raw.statusCode):fe(r[k],i,r.raw.statusCode,r[f]["content-type"])}catch(e){return function(e,t){e.serialization=t[k].config}(e,r),void de(r,e)}ne(r,i)}else de(r,e)}function ne(e,t){null!==e[k].onSend?x(e[k].onSend,e.request,e,t,se):oe(e,t)}function se(e,t,r,i){null!=e?de(r,e):oe(r,i)}function ae(e,t){let r=e.raw;try{r.writeHead(t,e[f])}catch(t){throw"ERR_HTTP_HEADERS_SENT"===t.code&&e.log.warn(`Reply was already sent, did you forget to "return reply" in the "${e.request.raw.url}" (${e.request.raw.method}) route?`),t}}function oe(e,t){let r=e.raw,n=e.request;if(null!==e[m]){let t=Object.keys(e[m]),r="";for(let i of t)"function"==typeof e[m][i]&&(r+=" ",r+=i);e.header("Transfer-Encoding","chunked"),e.header("Trailer",r.trim())}if("[object Response]"===Q.call(t)){if("number"==typeof t.status&&e.code(t.status),"object"==typeof t.headers&&"function"==typeof t.headers.forEach)for(let[r,i]of t.headers)e.header(r,i);if(null!==t.body&&t.bodyUsed)throw new M;t=t.body}let s=r.statusCode;if(null==t)return s>=200&&204!==s&&304!==s&&"HEAD"!==n.method&&null===e[m]&&(e[f]["content-length"]="0"),ae(e,s),void ue(t,r,e);if(s>=100&&s<200||204===s)return e.removeHeader("content-type"),e.removeHeader("content-length"),ae(e,s),ue(void 0,r,e),void("function"==typeof t.resume&&(t.on("error",ge),t.resume()));if("function"!=typeof t.pipe)if("function"!=typeof t.getReader){if("string"!=typeof t&&!Buffer.isBuffer(t))throw new F(typeof t);if(null===e[m]){let r=e[f]["content-length"];(!r||"HEAD"!==n.raw.method&&Number(r)!==Buffer.byteLength(t))&&(e[f]["content-length"]=""+Buffer.byteLength(t))}ae(e,s),r.write(t),ue(t,r,e)}else!function(e,t,r){ce(i.fromWeb(e),t,r)}(t,r,e);else ce(t,r,e)}function le(e,t,r){"ERR_STREAM_PREMATURE_CLOSE"===t.code?e[b]||e.info({res:r},"stream closed prematurely"):e.warn({err:t},"response terminated with an error with headers already sent")}function ce(e,t,i){let n=!0,s=!1;if(function(e,t,r){null!==r[m]&&e.on("end",()=>ue(null,t,r))}(e,t,i),r(e,{readable:!0,writable:!1},function(e){n=!1,null!=e&&(t.headersSent||!0===i.request.raw.aborted?(s||(s=!0,le(i.log,e,i)),t.destroy()):de(i,e))}),r(t,function(r){n&&(null!=r&&t.headersSent&&!s&&(s=!0,le(i.log,r,t)),"function"==typeof e.destroy?e.destroy():"function"==typeof e.close?e.close(ge):"function"==typeof e.abort?e.abort():i.log.warn("stream payload does not end properly"))}),t.headersSent)i.log.warn("response will send, but you shouldn't use res.writeHead in stream mode");else for(let e in i[f])t.setHeader(e,i[f][e]);e.pipe(t)}function ue(e,t,r){if(null===r[m])return void t.end(null,null,null);let i=Object.keys(r[m]),n={},s=0,a=!0;function o(){0===s&&(t.addTrailers(n),t.end(null,null,null))}for(let t of i){let i=function(e,i){s++,e?r.log.debug(e):n[t]=i,process.nextTick(o)};if("function"!=typeof r[m][t])continue;a=!1,s--;let l=r[m][t](r,e,i);"object"==typeof l&&"function"==typeof l.then?l.then(e=>i(null,e),i):null!=l&&(J(),i(null,l))}a&&t.end(null,null,null)}function de(e,t,r){null===e[k].onError||e[v]?j(e,t,r):(e[y]=!0,x(e[k].onError,e.request,e,t,()=>j(e,t,r)))}function pe(e,t,r){if(r.log[b])return;let i=r.elapsedTime;null==e?r.log.info({res:r,responseTime:i},"request completed"):r.log.error({res:r,err:e,responseTime:i},"request errored")}function fe(e,t,r,i){let n=D(e,r,i);return n?n(t):JSON.stringify(t)}function ge(){}ee.prototype.trailer=function(e,t){if(e=e.toLowerCase(),te.has(e))throw new H(e);if("function"!=typeof t)throw new V(e,typeof t);return null===this[m]&&(this[m]={}),this[m][e]=t,this},ee.prototype.hasTrailer=function(e){return void 0!==this[m]?.[e.toLowerCase()]},ee.prototype.removeTrailer=function(e){return null===this[m]||(this[m][e.toLowerCase()]=void 0),this},ee.prototype.code=function(e){let t=Number(e);if(isNaN(t)||t<100||t>599)throw new B(e||String(e));return this.raw.statusCode=t,this[g]=!0,this},ee.prototype.status=ee.prototype.code,ee.prototype.getSerializationFunction=function(e,t){let r;return"string"==typeof e||"number"==typeof e?r="string"==typeof t?this[k][w]?.[e]?.[t]:this[k][w]?.[e]:"object"==typeof e&&(r=this[k][_]?.get(e)),r},ee.prototype.compileSerializationSchema=function(e,t=null,r=null){let{request:i}=this,{method:n,url:s}=i;if(this[k][_]?.has(e))return this[k][_].get(e);let a=(this[k].serializerCompiler||this.server[S].serializerCompiler||this.server[S].setupSerializer(this.server[E])||this.server[S].serializerCompiler)({schema:e,method:n,url:s,httpStatus:t,contentType:r});return null==this[k][_]&&(this[k][_]=new WeakMap),this[k][_].set(e,a),a},ee.prototype.serializeInput=function(e,t,r,i){let n,s=r;if(i=(r="string"==typeof t||"number"==typeof t?t:r)&&s!==r?s:i,null!=r){if(n=null!=i?this[k][w]?.[r]?.[i]:this[k][w]?.[r],null==n)throw i?new W(r,i):new G(r)}else n=this[k][_]?.has(t)?this[k][_].get(t):this.compileSerializationSchema(t,r,i);return n(e)},ee.prototype.serialize=function(e){return null!==this[d]?this[d](e):this[k]&&this[k][p]?this[k][p](e,this.raw.statusCode):fe(this[k],e,this.raw.statusCode)},ee.prototype.serializer=function(e){return this[d]=e,this},ee.prototype.type=function(e){return this[f]["content-type"]=e,this},ee.prototype.redirect=function(e,t){if("number"==typeof e){X();let r=t;t=e,e=r}return t||(t=this[g]?this.raw.statusCode:302),this.header("location",e).code(t).send()},ee.prototype.callNotFound=function(){return function(e){if(null===e[k][n])return e.log.warn("Trying to send a NotFound error inside a 404 handler. Sending basic 404 response."),void e.code(404).send("404 Not Found");e.request[k]=e[k][n],null!==e[k].preHandler?P(e[k].preHandler,e.request,e,N.preHandlerCallback):N.preHandlerCallback(null,e.request,e)}(this),this},ee.prototype.getResponseTime=function(){return Y(),this.elapsedTime},ee.prototype.then=function(e,t){this.sent?e():r(this.raw,r=>{r&&"ERR_STREAM_PREMATURE_CLOSE"!==r.code?t?t(r):this.log&&this.log.warn("unhandled rejection on reply.then"):e()})},t.exports=ee,t.exports.buildReply=function(e){let t=e.props.slice();function r(e,r,i){this.raw=e,this[h]=!1,this[a]=!1,this[o]=!1,this[d]=null,this.request=r,this[f]={},this[m]=null,this[l]=void 0,this[u]=void 0,this.log=i;for(var n,s=0;s<t.length;s++)this[(n=t[s]).key]=n.value}return Object.setPrototypeOf(r.prototype,e.prototype),Object.setPrototypeOf(r,e),r.parent=e,r.props=t,r},t.exports.setupResponseListeners=function(e){e[l]=I();let t=r=>{e[u]=I(),e.raw.removeListener("finish",t),e.raw.removeListener("error",t);let i=e[k];i&&null!==i.onResponse?T(i.onResponse,e.request,e,pe):pe(r,0,e)};e.raw.on("finish",t),e.raw.on("error",t)}}),we=u((e,t)=>{t.exports=function(e){if(!e)throw new TypeError("argument req is required");var t=function(e){for(var t=e.length,r=[],i=e.length,n=e.length-1;n>=0;n--)switch(e.charCodeAt(n)){case 32:i===t&&(i=t=n);break;case 44:i!==t&&r.push(e.substring(i,t)),i=t=n;break;default:i=n}return i!==t&&r.push(e.substring(i,t)),r}(e.headers["x-forwarded-for"]||""),r=function(e){return e.socket?e.socket.remoteAddress:e.connection.remoteAddress}(e);return[r].concat(t)}}),_e=u((e,t)=>{(function(){var e,r,i,n,s,a,o,l;r={},typeof t<"u"&&null!==t&&t.exports?t.exports=r:this.ipaddr=r,o=function(e,t,r,i){var n,s;if(e.length!==t.length)throw new Error("ipaddr: cannot match CIDR for objects with different lengths");for(n=0;i>0;){if((s=r-i)<0&&(s=0),e[n]>>s!==t[n]>>s)return!1;i-=r,n+=1}return!0},r.subnetMatch=function(e,t,r){var i,n,s,a,o;for(s in null==r&&(r="unicast"),t)for((a=t[s])[0]&&!(a[0]instanceof Array)&&(a=[a]),i=0,n=a.length;i<n;i++)if(o=a[i],e.kind()===o[0].kind()&&e.match.apply(e,o))return s;return r},r.IPv4=function(){function e(e){var t,r,i;if(4!==e.length)throw new Error("ipaddr: ipv4 octet count should be 4");for(t=0,r=e.length;t<r;t++)if(!(0<=(i=e[t])&&i<=255))throw new Error("ipaddr: ipv4 octet should fit in 8 bits");this.octets=e}return e.prototype.kind=function(){return"ipv4"},e.prototype.toString=function(){return this.octets.join(".")},e.prototype.toNormalizedString=function(){return this.toString()},e.prototype.toByteArray=function(){return this.octets.slice(0)},e.prototype.match=function(e,t){var r;if(void 0===t&&(e=(r=e)[0],t=r[1]),"ipv4"!==e.kind())throw new Error("ipaddr: cannot match ipv4 address with non-ipv4 one");return o(this.octets,e.octets,8,t)},e.prototype.SpecialRanges={unspecified:[[new e([0,0,0,0]),8]],broadcast:[[new e([255,255,255,255]),32]],multicast:[[new e([224,0,0,0]),4]],linkLocal:[[new e([169,254,0,0]),16]],loopback:[[new e([127,0,0,0]),8]],carrierGradeNat:[[new e([100,64,0,0]),10]],private:[[new e([10,0,0,0]),8],[new e([172,16,0,0]),12],[new e([192,168,0,0]),16]],reserved:[[new e([192,0,0,0]),24],[new e([192,0,2,0]),24],[new e([192,88,99,0]),24],[new e([198,51,100,0]),24],[new e([203,0,113,0]),24],[new e([240,0,0,0]),4]]},e.prototype.range=function(){return r.subnetMatch(this,this.SpecialRanges)},e.prototype.toIPv4MappedAddress=function(){return r.IPv6.parse("::ffff:"+this.toString())},e.prototype.prefixLengthFromSubnetMask=function(){var e,t,r,i,n,s,a;for(a={0:8,128:7,192:6,224:5,240:4,248:3,252:2,254:1,255:0},e=0,n=!1,t=r=3;r>=0;t=r+=-1){if(!((i=this.octets[t])in a))return null;if(s=a[i],n&&0!==s)return null;8!==s&&(n=!0),e+=s}return 32-e},e}(),i="(0?\\d+|0x[a-f0-9]+)",n={fourOctet:new RegExp("^"+i+"\\."+i+"\\."+i+"\\."+i+"$","i"),longValue:new RegExp("^"+i+"$","i")},r.IPv4.parser=function(e){var t,r,i,s;if(r=function(e){return"0"===e[0]&&"x"!==e[1]?parseInt(e,8):parseInt(e)},t=e.match(n.fourOctet))return function(){var e,i,n,s;for(s=[],e=0,i=(n=t.slice(1,6)).length;e<i;e++)s.push(r(n[e]));return s}();if(t=e.match(n.longValue)){if((s=r(t[1]))>4294967295||s<0)throw new Error("ipaddr: address outside defined range");return function(){var e,t;for(t=[],i=e=0;e<=24;i=e+=8)t.push(s>>i&255);return t}().reverse()}return null},r.IPv6=function(){function e(e,t){var r,i,n,s,a,o;if(16===e.length)for(this.parts=[],r=i=0;i<=14;r=i+=2)this.parts.push(e[r]<<8|e[r+1]);else{if(8!==e.length)throw new Error("ipaddr: ipv6 part count should be 8 or 16");this.parts=e}for(n=0,s=(o=this.parts).length;n<s;n++)if(!(0<=(a=o[n])&&a<=65535))throw new Error("ipaddr: ipv6 part should fit in 16 bits");t&&(this.zoneId=t)}return e.prototype.kind=function(){return"ipv6"},e.prototype.toString=function(){return this.toNormalizedString().replace(/((^|:)(0(:|$))+)/,"::")},e.prototype.toRFC5952String=function(){var e,t,r,i,n;for(i=/((^|:)(0(:|$)){2,})/g,n=this.toNormalizedString(),e=0,t=-1;r=i.exec(n);)r[0].length>t&&(e=r.index,t=r[0].length);return t<0?n:n.substring(0,e)+"::"+n.substring(e+t)},e.prototype.toByteArray=function(){var e,t,r,i,n;for(e=[],t=0,r=(n=this.parts).length;t<r;t++)e.push((i=n[t])>>8),e.push(255&i);return e},e.prototype.toNormalizedString=function(){var e,t;return e=function(){var e,t,r,i;for(i=[],e=0,t=(r=this.parts).length;e<t;e++)i.push(r[e].toString(16));return i}.call(this).join(":"),t="",this.zoneId&&(t="%"+this.zoneId),e+t},e.prototype.toFixedLengthString=function(){var e,t;return e=function(){var e,t,r,i;for(i=[],e=0,t=(r=this.parts).length;e<t;e++)i.push(r[e].toString(16).padStart(4,"0"));return i}.call(this).join(":"),t="",this.zoneId&&(t="%"+this.zoneId),e+t},e.prototype.match=function(e,t){var r;if(void 0===t&&(e=(r=e)[0],t=r[1]),"ipv6"!==e.kind())throw new Error("ipaddr: cannot match ipv6 address with non-ipv6 one");return o(this.parts,e.parts,16,t)},e.prototype.SpecialRanges={unspecified:[new e([0,0,0,0,0,0,0,0]),128],linkLocal:[new e([65152,0,0,0,0,0,0,0]),10],multicast:[new e([65280,0,0,0,0,0,0,0]),8],loopback:[new e([0,0,0,0,0,0,0,1]),128],uniqueLocal:[new e([64512,0,0,0,0,0,0,0]),7],ipv4Mapped:[new e([0,0,0,0,0,65535,0,0]),96],rfc6145:[new e([0,0,0,0,65535,0,0,0]),96],rfc6052:[new e([100,65435,0,0,0,0,0,0]),96],"6to4":[new e([8194,0,0,0,0,0,0,0]),16],teredo:[new e([8193,0,0,0,0,0,0,0]),32],reserved:[[new e([8193,3512,0,0,0,0,0,0]),32]]},e.prototype.range=function(){return r.subnetMatch(this,this.SpecialRanges)},e.prototype.isIPv4MappedAddress=function(){return"ipv4Mapped"===this.range()},e.prototype.toIPv4Address=function(){var e,t,i;if(!this.isIPv4MappedAddress())throw new Error("ipaddr: trying to convert a generic ipv6 address to ipv4");return i=this.parts.slice(-2),new r.IPv4([(e=i[0])>>8,255&e,(t=i[1])>>8,255&t])},e.prototype.prefixLengthFromSubnetMask=function(){var e,t,r,i,n,s,a;for(a={0:16,32768:15,49152:14,57344:13,61440:12,63488:11,64512:10,65024:9,65280:8,65408:7,65472:6,65504:5,65520:4,65528:3,65532:2,65534:1,65535:0},e=0,n=!1,t=r=7;r>=0;t=r+=-1){if(!((i=this.parts[t])in a))return null;if(s=a[i],n&&0!==s)return null;16!==s&&(n=!0),e+=s}return 128-e},e}(),s="(?:[0-9a-f]+::?)+",l="%[0-9a-z]{1,}",a={zoneIndex:new RegExp(l,"i"),native:new RegExp("^(::)?("+s+")?([0-9a-f]+)?(::)?("+l+")?$","i"),transitional:new RegExp("^((?:"+s+")|(?:::)(?:"+s+")?)"+i+"\\."+i+"\\."+i+"\\."+i+"("+l+")?$","i")},e=function(e,t){var r,i,n,s,o;if(e.indexOf("::")!==e.lastIndexOf("::"))return null;for((o=(e.match(a.zoneIndex)||[])[0])&&(o=o.substring(1),e=e.replace(/%.+$/,"")),r=0,i=-1;(i=e.indexOf(":",i+1))>=0;)r++;if("::"===e.substr(0,2)&&r--,"::"===e.substr(-2,2)&&r--,r>t)return null;for(s=t-r,n=":";s--;)n+="0:";return":"===(e=e.replace("::",n))[0]&&(e=e.slice(1)),":"===e[e.length-1]&&(e=e.slice(0,-1)),{parts:t=function(){var t,r,i,n;for(n=[],t=0,r=(i=e.split(":")).length;t<r;t++)n.push(parseInt(i[t],16));return n}(),zoneId:o}},r.IPv6.parser=function(t){var r,i,n,s,o,l,c;if(a.native.test(t))return e(t,8);if((s=t.match(a.transitional))&&(c=s[6]||"",(r=e(s[1].slice(0,-1)+c,6)).parts)){for(i=0,n=(l=[parseInt(s[2]),parseInt(s[3]),parseInt(s[4]),parseInt(s[5])]).length;i<n;i++)if(!(0<=(o=l[i])&&o<=255))return null;return r.parts.push(l[0]<<8|l[1]),r.parts.push(l[2]<<8|l[3]),{parts:r.parts,zoneId:r.zoneId}}return null},r.IPv4.isIPv4=r.IPv6.isIPv6=function(e){return null!==this.parser(e)},r.IPv4.isValid=function(e){try{return new this(this.parser(e)),!0}catch(e){return!1}},r.IPv4.isValidFourPartDecimal=function(e){return!(!r.IPv4.isValid(e)||!e.match(/^(0|[1-9]\d*)(\.(0|[1-9]\d*)){3}$/))},r.IPv6.isValid=function(e){var t;if("string"==typeof e&&-1===e.indexOf(":"))return!1;try{return new this((t=this.parser(e)).parts,t.zoneId),!0}catch(e){return!1}},r.IPv4.parse=function(e){var t;if(null===(t=this.parser(e)))throw new Error("ipaddr: string is not formatted like ip address");return new this(t)},r.IPv6.parse=function(e){var t;if(null===(t=this.parser(e)).parts)throw new Error("ipaddr: string is not formatted like ip address");return new this(t.parts,t.zoneId)},r.IPv4.parseCIDR=function(e){var t,r,i;if((r=e.match(/^(.+)\/(\d+)$/))&&(t=parseInt(r[2]))>=0&&t<=32)return i=[this.parse(r[1]),t],Object.defineProperty(i,"toString",{value:function(){return this.join("/")}}),i;throw new Error("ipaddr: string is not formatted like an IPv4 CIDR range")},r.IPv4.subnetMaskFromPrefixLength=function(e){var t,r,i;if((e=parseInt(e))<0||e>32)throw new Error("ipaddr: invalid IPv4 prefix length");for(i=[0,0,0,0],r=0,t=Math.floor(e/8);r<t;)i[r]=255,r++;return t<4&&(i[t]=Math.pow(2,e%8)-1<<8-e%8),new this(i)},r.IPv4.broadcastAddressFromCIDR=function(e){var t,r,i,n,s;try{for(i=(t=this.parseCIDR(e))[0].toByteArray(),s=this.subnetMaskFromPrefixLength(t[1]).toByteArray(),n=[],r=0;r<4;)n.push(parseInt(i[r],10)|255^parseInt(s[r],10)),r++;return new this(n)}catch(e){throw new Error("ipaddr: the address does not have IPv4 CIDR format")}},r.IPv4.networkAddressFromCIDR=function(e){var t,r,i,n,s;try{for(i=(t=this.parseCIDR(e))[0].toByteArray(),s=this.subnetMaskFromPrefixLength(t[1]).toByteArray(),n=[],r=0;r<4;)n.push(parseInt(i[r],10)&parseInt(s[r],10)),r++;return new this(n)}catch(e){throw new Error("ipaddr: the address does not have IPv4 CIDR format")}},r.IPv6.parseCIDR=function(e){var t,r,i;if((r=e.match(/^(.+)\/(\d+)$/))&&(t=parseInt(r[2]))>=0&&t<=128)return i=[this.parse(r[1]),t],Object.defineProperty(i,"toString",{value:function(){return this.join("/")}}),i;throw new Error("ipaddr: string is not formatted like an IPv6 CIDR range")},r.isValid=function(e){return r.IPv6.isValid(e)||r.IPv4.isValid(e)},r.parse=function(e){if(r.IPv6.isValid(e))return r.IPv6.parse(e);if(r.IPv4.isValid(e))return r.IPv4.parse(e);throw new Error("ipaddr: the address has neither IPv6 nor IPv4 format")},r.parseCIDR=function(e){try{return r.IPv6.parseCIDR(e)}catch(t){try{return r.IPv4.parseCIDR(e)}catch(e){throw new Error("ipaddr: the address has neither IPv6 nor IPv4 CIDR format")}}},r.fromByteArray=function(e){var t;if(4===(t=e.length))return new r.IPv4(e);if(16===t)return new r.IPv6(e);throw new Error("ipaddr: the binary input is neither an IPv6 nor IPv4 address")},r.process=function(e){var t;return"ipv6"===(t=this.parse(e)).kind()&&t.isIPv4MappedAddress()?t.toIPv4Address():t}}).call(e)}),Se=u((e,t)=>{t.exports=function(e,t){if(!e)throw new TypeError("req argument is required");if(!t)throw new TypeError("trust argument is required");var r=l(e,t);return r[r.length-1]},t.exports.all=l,t.exports.compile=c;var r=we(),i=_e(),n=/^[0-9]+$/,s=i.isValid,a=i.parse,o={linklocal:["169.254.0.0/16","fe80::/10"],loopback:["127.0.0.1/8","::1/128"],uniquelocal:["10.0.0.0/8","172.16.0.0/12","192.168.0.0/16","fc00::/7"]};function l(e,t){var i=r(e);if(!t)return i;"function"!=typeof t&&(t=c(t));for(var n=0;n<i.length-1;n++)t(i[n],n)||(i.length=n+1);return i}function c(e){if(!e)throw new TypeError("argument is required");var t;if("string"==typeof e)t=[e];else{if(!Array.isArray(e))throw new TypeError("unsupported trust argument");t=e.slice()}for(var r=0;r<t.length;r++)e=t[r],Object.prototype.hasOwnProperty.call(o,e)&&(t.splice.apply(t,[r,1].concat(e=o[e])),r+=e.length-1);return function(e){var t=e.length;return 0===t?d:1===t?function(e){var t=e[0],r=t.kind(),i="ipv4"===r,n=e[1];return function(e){if(!s(e))return!1;var o=a(e);if(o.kind()!==r){if(i&&!o.isIPv4MappedAddress())return!1;o=i?o.toIPv4Address():o.toIPv4MappedAddress()}return o.match(t,n)}}(e[0]):function(e){return function(t){if(!s(t))return!1;for(var r,i=a(t),n=i.kind(),o=0;o<e.length;o++){var l=e[o],c=l[0],u=c.kind(),d=l[1],p=i;if(n!==u){if("ipv4"===u&&!i.isIPv4MappedAddress())continue;r||(r="ipv4"===u?i.toIPv4Address():i.toIPv4MappedAddress()),p=r}if(p.match(c,d))return!0}return!1}}(e)}(function(e){for(var t=new Array(e.length),r=0;r<e.length;r++)t[r]=u(e[r]);return t}(t))}function u(e){var t=e.lastIndexOf("/"),r=-1!==t?e.substring(0,t):e;if(!s(r))throw new TypeError("invalid IP address: "+r);var i=a(r);-1===t&&"ipv6"===i.kind()&&i.isIPv4MappedAddress()&&(i=i.toIPv4Address());var o="ipv6"===i.kind()?128:32,l=-1!==t?e.substring(t+1,e.length):null;if(l=null===l?o:n.test(l)?parseInt(l,10):"ipv4"===i.kind()&&s(l)?function(e){var t=a(e);return"ipv4"===t.kind()?t.prefixLengthFromSubnetMask():null}(l):null,l<=0||l>o)throw new TypeError("invalid range on address: "+e);return[i,l]}function d(){return!1}}),Ee=u((e,t)=>{t.exports={MAX_LENGTH:256,MAX_SAFE_COMPONENT_LENGTH:16,MAX_SAFE_BUILD_LENGTH:250,MAX_SAFE_INTEGER:Number.MAX_SAFE_INTEGER||9007199254740991,RELEASE_TYPES:["major","premajor","minor","preminor","patch","prepatch","prerelease"],SEMVER_SPEC_VERSION:"2.0.0",FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2}}),ke=u((e,t)=>{var r="object"==typeof process&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...e)=>console.error("SEMVER",...e):()=>{};t.exports=r}),xe=u((e,t)=>{var{MAX_SAFE_COMPONENT_LENGTH:r,MAX_SAFE_BUILD_LENGTH:i,MAX_LENGTH:n}=Ee(),s=ke(),a=(e=t.exports={}).re=[],o=e.safeRe=[],l=e.src=[],c=e.safeSrc=[],u=e.t={},d=0,p="[a-zA-Z0-9-]",h=[["\\s",1],["\\d",n],[p,i]],f=(e,t,r)=>{let i=(e=>{for(let[t,r]of h)e=e.split(`${t}*`).join(`${t}{0,${r}}`).split(`${t}+`).join(`${t}{1,${r}}`);return e})(t),n=d++;s(e,n,t),u[e]=n,l[n]=t,c[n]=i,a[n]=new RegExp(t,r?"g":void 0),o[n]=new RegExp(i,r?"g":void 0)};f("NUMERICIDENTIFIER","0|[1-9]\\d*"),f("NUMERICIDENTIFIERLOOSE","\\d+"),f("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${p}*`),f("MAINVERSION",`(${l[u.NUMERICIDENTIFIER]})\\.(${l[u.NUMERICIDENTIFIER]})\\.(${l[u.NUMERICIDENTIFIER]})`),f("MAINVERSIONLOOSE",`(${l[u.NUMERICIDENTIFIERLOOSE]})\\.(${l[u.NUMERICIDENTIFIERLOOSE]})\\.(${l[u.NUMERICIDENTIFIERLOOSE]})`),f("PRERELEASEIDENTIFIER",`(?:${l[u.NONNUMERICIDENTIFIER]}|${l[u.NUMERICIDENTIFIER]})`),f("PRERELEASEIDENTIFIERLOOSE",`(?:${l[u.NONNUMERICIDENTIFIER]}|${l[u.NUMERICIDENTIFIERLOOSE]})`),f("PRERELEASE",`(?:-(${l[u.PRERELEASEIDENTIFIER]}(?:\\.${l[u.PRERELEASEIDENTIFIER]})*))`),f("PRERELEASELOOSE",`(?:-?(${l[u.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${l[u.PRERELEASEIDENTIFIERLOOSE]})*))`),f("BUILDIDENTIFIER",`${p}+`),f("BUILD",`(?:\\+(${l[u.BUILDIDENTIFIER]}(?:\\.${l[u.BUILDIDENTIFIER]})*))`),f("FULLPLAIN",`v?${l[u.MAINVERSION]}${l[u.PRERELEASE]}?${l[u.BUILD]}?`),f("FULL",`^${l[u.FULLPLAIN]}$`),f("LOOSEPLAIN",`[v=\\s]*${l[u.MAINVERSIONLOOSE]}${l[u.PRERELEASELOOSE]}?${l[u.BUILD]}?`),f("LOOSE",`^${l[u.LOOSEPLAIN]}$`),f("GTLT","((?:<|>)?=?)"),f("XRANGEIDENTIFIERLOOSE",`${l[u.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),f("XRANGEIDENTIFIER",`${l[u.NUMERICIDENTIFIER]}|x|X|\\*`),f("XRANGEPLAIN",`[v=\\s]*(${l[u.XRANGEIDENTIFIER]})(?:\\.(${l[u.XRANGEIDENTIFIER]})(?:\\.(${l[u.XRANGEIDENTIFIER]})(?:${l[u.PRERELEASE]})?${l[u.BUILD]}?)?)?`),f("XRANGEPLAINLOOSE",`[v=\\s]*(${l[u.XRANGEIDENTIFIERLOOSE]})(?:\\.(${l[u.XRANGEIDENTIFIERLOOSE]})(?:\\.(${l[u.XRANGEIDENTIFIERLOOSE]})(?:${l[u.PRERELEASELOOSE]})?${l[u.BUILD]}?)?)?`),f("XRANGE",`^${l[u.GTLT]}\\s*${l[u.XRANGEPLAIN]}$`),f("XRANGELOOSE",`^${l[u.GTLT]}\\s*${l[u.XRANGEPLAINLOOSE]}$`),f("COERCEPLAIN",`(^|[^\\d])(\\d{1,${r}})(?:\\.(\\d{1,${r}}))?(?:\\.(\\d{1,${r}}))?`),f("COERCE",`${l[u.COERCEPLAIN]}(?:$|[^\\d])`),f("COERCEFULL",l[u.COERCEPLAIN]+`(?:${l[u.PRERELEASE]})?(?:${l[u.BUILD]})?(?:$|[^\\d])`),f("COERCERTL",l[u.COERCE],!0),f("COERCERTLFULL",l[u.COERCEFULL],!0),f("LONETILDE","(?:~>?)"),f("TILDETRIM",`(\\s*)${l[u.LONETILDE]}\\s+`,!0),e.tildeTrimReplace="$1~",f("TILDE",`^${l[u.LONETILDE]}${l[u.XRANGEPLAIN]}$`),f("TILDELOOSE",`^${l[u.LONETILDE]}${l[u.XRANGEPLAINLOOSE]}$`),f("LONECARET","(?:\\^)"),f("CARETTRIM",`(\\s*)${l[u.LONECARET]}\\s+`,!0),e.caretTrimReplace="$1^",f("CARET",`^${l[u.LONECARET]}${l[u.XRANGEPLAIN]}$`),f("CARETLOOSE",`^${l[u.LONECARET]}${l[u.XRANGEPLAINLOOSE]}$`),f("COMPARATORLOOSE",`^${l[u.GTLT]}\\s*(${l[u.LOOSEPLAIN]})$|^$`),f("COMPARATOR",`^${l[u.GTLT]}\\s*(${l[u.FULLPLAIN]})$|^$`),f("COMPARATORTRIM",`(\\s*)${l[u.GTLT]}\\s*(${l[u.LOOSEPLAIN]}|${l[u.XRANGEPLAIN]})`,!0),e.comparatorTrimReplace="$1$2$3",f("HYPHENRANGE",`^\\s*(${l[u.XRANGEPLAIN]})\\s+-\\s+(${l[u.XRANGEPLAIN]})\\s*$`),f("HYPHENRANGELOOSE",`^\\s*(${l[u.XRANGEPLAINLOOSE]})\\s+-\\s+(${l[u.XRANGEPLAINLOOSE]})\\s*$`),f("STAR","(<|>)?=?\\s*\\*"),f("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),f("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")}),Te=u((e,t)=>{var r=Object.freeze({loose:!0}),i=Object.freeze({});t.exports=e=>e?"object"!=typeof e?r:e:i}),Pe=u((e,t)=>{var r=/^[0-9]+$/,i=(e,t)=>{if("number"==typeof e&&"number"==typeof t)return e===t?0:e<t?-1:1;let i=r.test(e),n=r.test(t);return i&&n&&(e=+e,t=+t),e===t?0:i&&!n?-1:n&&!i?1:e<t?-1:1};t.exports={compareIdentifiers:i,rcompareIdentifiers:(e,t)=>i(t,e)}}),Re=u((e,t)=>{var r=ke(),{MAX_LENGTH:i,MAX_SAFE_INTEGER:n}=Ee(),{safeRe:s,t:a}=xe(),o=Te(),{compareIdentifiers:l}=Pe();t.exports=class e{constructor(t,l){if(l=o(l),t instanceof e){if(t.loose===!!l.loose&&t.includePrerelease===!!l.includePrerelease)return t;t=t.version}else if("string"!=typeof t)throw new TypeError(`Invalid version. Must be a string. Got type "${typeof t}".`);if(t.length>i)throw new TypeError(`version is longer than ${i} characters`);r("SemVer",t,l),this.options=l,this.loose=!!l.loose,this.includePrerelease=!!l.includePrerelease;let c=t.trim().match(l.loose?s[a.LOOSE]:s[a.FULL]);if(!c)throw new TypeError(`Invalid Version: ${t}`);if(this.raw=t,this.major=+c[1],this.minor=+c[2],this.patch=+c[3],this.major>n||this.major<0)throw new TypeError("Invalid major version");if(this.minor>n||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>n||this.patch<0)throw new TypeError("Invalid patch version");this.prerelease=c[4]?c[4].split(".").map(e=>{if(/^[0-9]+$/.test(e)){let t=+e;if(t>=0&&t<n)return t}return e}):[],this.build=c[5]?c[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(t){if(r("SemVer.compare",this.version,this.options,t),!(t instanceof e)){if("string"==typeof t&&t===this.version)return 0;t=new e(t,this.options)}return t.version===this.version?0:this.compareMain(t)||this.comparePre(t)}compareMain(t){return t instanceof e||(t=new e(t,this.options)),this.major<t.major?-1:this.major>t.major?1:this.minor<t.minor?-1:this.minor>t.minor?1:this.patch<t.patch?-1:this.patch>t.patch?1:0}comparePre(t){if(t instanceof e||(t=new e(t,this.options)),this.prerelease.length&&!t.prerelease.length)return-1;if(!this.prerelease.length&&t.prerelease.length)return 1;if(!this.prerelease.length&&!t.prerelease.length)return 0;let i=0;do{let e=this.prerelease[i],n=t.prerelease[i];if(r("prerelease compare",i,e,n),void 0===e&&void 0===n)return 0;if(void 0===n)return 1;if(void 0===e)return-1;if(e!==n)return l(e,n)}while(++i)}compareBuild(t){t instanceof e||(t=new e(t,this.options));let i=0;do{let e=this.build[i],n=t.build[i];if(r("build compare",i,e,n),void 0===e&&void 0===n)return 0;if(void 0===n)return 1;if(void 0===e)return-1;if(e!==n)return l(e,n)}while(++i)}inc(e,t,r){if(e.startsWith("pre")){if(!t&&!1===r)throw new Error("invalid increment argument: identifier is empty");if(t){let e=`-${t}`.match(this.options.loose?s[a.PRERELEASELOOSE]:s[a.PRERELEASE]);if(!e||e[1]!==t)throw new Error(`invalid identifier: ${t}`)}}switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t,r);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t,r);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t,r),this.inc("pre",t,r);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",t,r),this.inc("pre",t,r);break;case"release":if(0===this.prerelease.length)throw new Error(`version ${this.raw} is not a prerelease`);this.prerelease.length=0;break;case"major":(0!==this.minor||0!==this.patch||0===this.prerelease.length)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(0!==this.patch||0===this.prerelease.length)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":{let e=Number(r)?1:0;if(0===this.prerelease.length)this.prerelease=[e];else{let i=this.prerelease.length;for(;--i>=0;)"number"==typeof this.prerelease[i]&&(this.prerelease[i]++,i=-2);if(-1===i){if(t===this.prerelease.join(".")&&!1===r)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(e)}}if(t){let i=[t,e];!1===r&&(i=[t]),0===l(this.prerelease[0],t)?isNaN(this.prerelease[1])&&(this.prerelease=i):this.prerelease=i}break}default:throw new Error(`invalid increment argument: ${e}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}}}),Oe=u((e,t)=>{var r=Re();t.exports=(e,t,i=!1)=>{if(e instanceof r)return e;try{return new r(e,t)}catch(e){if(!i)return null;throw e}}}),$e=u((e,t)=>{var r=Oe();t.exports=(e,t)=>{let i=r(e,t);return i?i.version:null}}),Ce=u((e,t)=>{var r=Oe();t.exports=(e,t)=>{let i=r(e.trim().replace(/^[=v]+/,""),t);return i?i.version:null}}),Ae=u((e,t)=>{var r=Re();t.exports=(e,t,i,n,s)=>{"string"==typeof i&&(s=n,n=i,i=void 0);try{return new r(e instanceof r?e.version:e,i).inc(t,n,s).version}catch{return null}}}),Ne=u((e,t)=>{var r=Oe();t.exports=(e,t)=>{let i=r(e,null,!0),n=r(t,null,!0),s=i.compare(n);if(0===s)return null;let a=s>0,o=a?i:n,l=a?n:i,c=!!o.prerelease.length;if(l.prerelease.length&&!c){if(!l.patch&&!l.minor)return"major";if(0===l.compareMain(o))return l.minor&&!l.patch?"minor":"patch"}let u=c?"pre":"";return i.major!==n.major?u+"major":i.minor!==n.minor?u+"minor":i.patch!==n.patch?u+"patch":"prerelease"}}),Ie=u((e,t)=>{var r=Re();t.exports=(e,t)=>new r(e,t).major}),je=u((e,t)=>{var r=Re();t.exports=(e,t)=>new r(e,t).minor}),Le=u((e,t)=>{var r=Re();t.exports=(e,t)=>new r(e,t).patch}),De=u((e,t)=>{var r=Oe();t.exports=(e,t)=>{let i=r(e,t);return i&&i.prerelease.length?i.prerelease:null}}),Fe=u((e,t)=>{var r=Re();t.exports=(e,t,i)=>new r(e,i).compare(new r(t,i))}),Me=u((e,t)=>{var r=Fe();t.exports=(e,t,i)=>r(t,e,i)}),ze=u((e,t)=>{var r=Fe();t.exports=(e,t)=>r(e,t,!0)}),qe=u((e,t)=>{var r=Re();t.exports=(e,t,i)=>{let n=new r(e,i),s=new r(t,i);return n.compare(s)||n.compareBuild(s)}}),Ue=u((e,t)=>{var r=qe();t.exports=(e,t)=>e.sort((e,i)=>r(e,i,t))}),Be=u((e,t)=>{var r=qe();t.exports=(e,t)=>e.sort((e,i)=>r(i,e,t))}),He=u((e,t)=>{var r=Fe();t.exports=(e,t,i)=>r(e,t,i)>0}),Ve=u((e,t)=>{var r=Fe();t.exports=(e,t,i)=>r(e,t,i)<0}),Ge=u((e,t)=>{var r=Fe();t.exports=(e,t,i)=>0===r(e,t,i)}),We=u((e,t)=>{var r=Fe();t.exports=(e,t,i)=>0!==r(e,t,i)}),Ke=u((e,t)=>{var r=Fe();t.exports=(e,t,i)=>r(e,t,i)>=0}),Je=u((e,t)=>{var r=Fe();t.exports=(e,t,i)=>r(e,t,i)<=0}),Ze=u((e,t)=>{var r=Ge(),i=We(),n=He(),s=Ke(),a=Ve(),o=Je();t.exports=(e,t,l,c)=>{switch(t){case"===":return"object"==typeof e&&(e=e.version),"object"==typeof l&&(l=l.version),e===l;case"!==":return"object"==typeof e&&(e=e.version),"object"==typeof l&&(l=l.version),e!==l;case"":case"=":case"==":return r(e,l,c);case"!=":return i(e,l,c);case">":return n(e,l,c);case">=":return s(e,l,c);case"<":return a(e,l,c);case"<=":return o(e,l,c);default:throw new TypeError(`Invalid operator: ${t}`)}}}),Ye=u((e,t)=>{var r=Re(),i=Oe(),{safeRe:n,t:s}=xe();t.exports=(e,t)=>{if(e instanceof r)return e;if("number"==typeof e&&(e=String(e)),"string"!=typeof e)return null;let a=null;if((t=t||{}).rtl){let r,i=t.includePrerelease?n[s.COERCERTLFULL]:n[s.COERCERTL];for(;(r=i.exec(e))&&(!a||a.index+a[0].length!==e.length);)(!a||r.index+r[0].length!==a.index+a[0].length)&&(a=r),i.lastIndex=r.index+r[1].length+r[2].length;i.lastIndex=-1}else a=e.match(t.includePrerelease?n[s.COERCEFULL]:n[s.COERCE]);return null===a?null:i(`${a[2]}.${a[3]||"0"}.${a[4]||"0"}${t.includePrerelease&&a[5]?`-${a[5]}`:""}${t.includePrerelease&&a[6]?`+${a[6]}`:""}`,t)}}),Xe=u((e,t)=>{t.exports=class{constructor(){this.max=1e3,this.map=new Map}get(e){let t=this.map.get(e);if(void 0!==t)return this.map.delete(e),this.map.set(e,t),t}delete(e){return this.map.delete(e)}set(e,t){if(!this.delete(e)&&void 0!==t){if(this.map.size>=this.max){let e=this.map.keys().next().value;this.delete(e)}this.map.set(e,t)}return this}}}),Qe=u((e,t)=>{var r=/\s+/g;t.exports=class e{constructor(t,i){if(i=n(i),t instanceof e)return t.loose===!!i.loose&&t.includePrerelease===!!i.includePrerelease?t:new e(t.raw,i);if(t instanceof s)return this.raw=t.value,this.set=[[t]],this.formatted=void 0,this;if(this.options=i,this.loose=!!i.loose,this.includePrerelease=!!i.includePrerelease,this.raw=t.trim().replace(r," "),this.set=this.raw.split("||").map(e=>this.parseRange(e.trim())).filter(e=>e.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){let e=this.set[0];if(this.set=this.set.filter(e=>!m(e[0])),0===this.set.length)this.set=[e];else if(this.set.length>1)for(let e of this.set)if(1===e.length&&g(e[0])){this.set=[e];break}}this.formatted=void 0}get range(){if(void 0===this.formatted){this.formatted="";for(let e=0;e<this.set.length;e++){e>0&&(this.formatted+="||");let t=this.set[e];for(let e=0;e<t.length;e++)e>0&&(this.formatted+=" "),this.formatted+=t[e].toString().trim()}}return this.formatted}format(){return this.range}toString(){return this.range}parseRange(e){let t=((this.options.includePrerelease&&h)|(this.options.loose&&f))+":"+e,r=i.get(t);if(r)return r;let n=this.options.loose;e=e.replace(n?l[c.HYPHENRANGELOOSE]:l[c.HYPHENRANGE],R(this.options.includePrerelease)),a("hyphen replace",e),e=e.replace(l[c.COMPARATORTRIM],u),a("comparator trim",e),e=e.replace(l[c.TILDETRIM],d),a("tilde trim",e),e=e.replace(l[c.CARETTRIM],p),a("caret trim",e);let o=e.split(" ").map(e=>v(e,this.options)).join(" ").split(/\s+/).map(e=>P(e,this.options));n&&(o=o.filter(e=>(a("loose invalid filter",e,this.options),!!e.match(l[c.COMPARATORLOOSE])))),a("range list",o);let g=new Map,y=o.map(e=>new s(e,this.options));for(let e of y){if(m(e))return[e];g.set(e.value,e)}g.size>1&&g.has("")&&g.delete("");let b=[...g.values()];return i.set(t,b),b}intersects(t,r){if(!(t instanceof e))throw new TypeError("a Range is required");return this.set.some(e=>y(e,r)&&t.set.some(t=>y(t,r)&&e.every(e=>t.every(t=>e.intersects(t,r)))))}test(e){if(!e)return!1;if("string"==typeof e)try{e=new o(e,this.options)}catch{return!1}for(let t=0;t<this.set.length;t++)if(O(this.set[t],e,this.options))return!0;return!1}};var i=new(Xe()),n=Te(),s=et(),a=ke(),o=Re(),{safeRe:l,t:c,comparatorTrimReplace:u,tildeTrimReplace:d,caretTrimReplace:p}=xe(),{FLAG_INCLUDE_PRERELEASE:h,FLAG_LOOSE:f}=Ee(),m=e=>"<0.0.0-0"===e.value,g=e=>""===e.value,y=(e,t)=>{let r=!0,i=e.slice(),n=i.pop();for(;r&&i.length;)r=i.every(e=>n.intersects(e,t)),n=i.pop();return r},v=(e,t)=>(e=e.replace(l[c.BUILD],""),a("comp",e,t),e=S(e,t),a("caret",e),e=w(e,t),a("tildes",e),e=k(e,t),a("xrange",e),e=T(e,t),a("stars",e),e),b=e=>!e||"x"===e.toLowerCase()||"*"===e,w=(e,t)=>e.trim().split(/\s+/).map(e=>_(e,t)).join(" "),_=(e,t)=>e.replace(t.loose?l[c.TILDELOOSE]:l[c.TILDE],(t,r,i,n,s)=>{let o;return a("tilde",e,t,r,i,n,s),b(r)?o="":b(i)?o=`>=${r}.0.0 <${+r+1}.0.0-0`:b(n)?o=`>=${r}.${i}.0 <${r}.${+i+1}.0-0`:s?(a("replaceTilde pr",s),o=`>=${r}.${i}.${n}-${s} <${r}.${+i+1}.0-0`):o=`>=${r}.${i}.${n} <${r}.${+i+1}.0-0`,a("tilde return",o),o}),S=(e,t)=>e.trim().split(/\s+/).map(e=>E(e,t)).join(" "),E=(e,t)=>{a("caret",e,t);let r=t.includePrerelease?"-0":"";return e.replace(t.loose?l[c.CARETLOOSE]:l[c.CARET],(t,i,n,s,o)=>{let l;return a("caret",e,t,i,n,s,o),b(i)?l="":b(n)?l=`>=${i}.0.0${r} <${+i+1}.0.0-0`:b(s)?l="0"===i?`>=${i}.${n}.0${r} <${i}.${+n+1}.0-0`:`>=${i}.${n}.0${r} <${+i+1}.0.0-0`:o?(a("replaceCaret pr",o),l="0"===i?"0"===n?`>=${i}.${n}.${s}-${o} <${i}.${n}.${+s+1}-0`:`>=${i}.${n}.${s}-${o} <${i}.${+n+1}.0-0`:`>=${i}.${n}.${s}-${o} <${+i+1}.0.0-0`):(a("no pr"),l="0"===i?"0"===n?`>=${i}.${n}.${s}${r} <${i}.${n}.${+s+1}-0`:`>=${i}.${n}.${s}${r} <${i}.${+n+1}.0-0`:`>=${i}.${n}.${s} <${+i+1}.0.0-0`),a("caret return",l),l})},k=(e,t)=>(a("replaceXRanges",e,t),e.split(/\s+/).map(e=>x(e,t)).join(" ")),x=(e,t)=>(e=e.trim()).replace(t.loose?l[c.XRANGELOOSE]:l[c.XRANGE],(r,i,n,s,o,l)=>{a("xRange",e,r,i,n,s,o,l);let c=b(n),u=c||b(s),d=u||b(o);return"="===i&&d&&(i=""),l=t.includePrerelease?"-0":"",c?r=">"===i||"<"===i?"<0.0.0-0":"*":i&&d?(u&&(s=0),o=0,">"===i?(i=">=",u?(n=+n+1,s=0,o=0):(s=+s+1,o=0)):"<="===i&&(i="<",u?n=+n+1:s=+s+1),"<"===i&&(l="-0"),r=`${i+n}.${s}.${o}${l}`):u?r=`>=${n}.0.0${l} <${+n+1}.0.0-0`:d&&(r=`>=${n}.${s}.0${l} <${n}.${+s+1}.0-0`),a("xRange return",r),r}),T=(e,t)=>(a("replaceStars",e,t),e.trim().replace(l[c.STAR],"")),P=(e,t)=>(a("replaceGTE0",e,t),e.trim().replace(l[t.includePrerelease?c.GTE0PRE:c.GTE0],"")),R=e=>(t,r,i,n,s,a,o,l,c,u,d,p)=>`${r=b(i)?"":b(n)?`>=${i}.0.0${e?"-0":""}`:b(s)?`>=${i}.${n}.0${e?"-0":""}`:a?`>=${r}`:`>=${r}${e?"-0":""}`} ${l=b(c)?"":b(u)?`<${+c+1}.0.0-0`:b(d)?`<${c}.${+u+1}.0-0`:p?`<=${c}.${u}.${d}-${p}`:e?`<${c}.${u}.${+d+1}-0`:`<=${l}`}`.trim(),O=(e,t,r)=>{for(let r=0;r<e.length;r++)if(!e[r].test(t))return!1;if(t.prerelease.length&&!r.includePrerelease){for(let r=0;r<e.length;r++)if(a(e[r].semver),e[r].semver!==s.ANY&&e[r].semver.prerelease.length>0){let i=e[r].semver;if(i.major===t.major&&i.minor===t.minor&&i.patch===t.patch)return!0}return!1}return!0}}),et=u((e,t)=>{var r=Symbol("SemVer ANY");t.exports=class e{static get ANY(){return r}constructor(t,n){if(n=i(n),t instanceof e){if(t.loose===!!n.loose)return t;t=t.value}t=t.trim().split(/\s+/).join(" "),o("comparator",t,n),this.options=n,this.loose=!!n.loose,this.parse(t),this.value=this.semver===r?"":this.operator+this.semver.version,o("comp",this)}parse(e){let t=e.match(this.options.loose?n[s.COMPARATORLOOSE]:n[s.COMPARATOR]);if(!t)throw new TypeError(`Invalid comparator: ${e}`);this.operator=void 0!==t[1]?t[1]:"","="===this.operator&&(this.operator=""),this.semver=t[2]?new l(t[2],this.options.loose):r}toString(){return this.value}test(e){if(o("Comparator.test",e,this.options.loose),this.semver===r||e===r)return!0;if("string"==typeof e)try{e=new l(e,this.options)}catch{return!1}return a(e,this.operator,this.semver,this.options)}intersects(t,r){if(!(t instanceof e))throw new TypeError("a Comparator is required");return""===this.operator?""===this.value||new c(t.value,r).test(this.value):""===t.operator?""===t.value||new c(this.value,r).test(t.semver):!((r=i(r)).includePrerelease&&("<0.0.0-0"===this.value||"<0.0.0-0"===t.value)||!r.includePrerelease&&(this.value.startsWith("<0.0.0")||t.value.startsWith("<0.0.0"))||!(this.operator.startsWith(">")&&t.operator.startsWith(">")||this.operator.startsWith("<")&&t.operator.startsWith("<")||this.semver.version===t.semver.version&&this.operator.includes("=")&&t.operator.includes("=")||a(this.semver,"<",t.semver,r)&&this.operator.startsWith(">")&&t.operator.startsWith("<")||a(this.semver,">",t.semver,r)&&this.operator.startsWith("<")&&t.operator.startsWith(">")))}};var i=Te(),{safeRe:n,t:s}=xe(),a=Ze(),o=ke(),l=Re(),c=Qe()}),tt=u((e,t)=>{var r=Qe();t.exports=(e,t,i)=>{try{t=new r(t,i)}catch{return!1}return t.test(e)}}),rt=u((e,t)=>{var r=Qe();t.exports=(e,t)=>new r(e,t).set.map(e=>e.map(e=>e.value).join(" ").trim().split(" "))}),it=u((e,t)=>{var r=Re(),i=Qe();t.exports=(e,t,n)=>{let s=null,a=null,o=null;try{o=new i(t,n)}catch{return null}return e.forEach(e=>{o.test(e)&&(!s||-1===a.compare(e))&&(s=e,a=new r(s,n))}),s}}),nt=u((e,t)=>{var r=Re(),i=Qe();t.exports=(e,t,n)=>{let s=null,a=null,o=null;try{o=new i(t,n)}catch{return null}return e.forEach(e=>{o.test(e)&&(!s||1===a.compare(e))&&(s=e,a=new r(s,n))}),s}}),st=u((e,t)=>{var r=Re(),i=Qe(),n=He();t.exports=(e,t)=>{e=new i(e,t);let s=new r("0.0.0");if(e.test(s)||(s=new r("0.0.0-0"),e.test(s)))return s;s=null;for(let t=0;t<e.set.length;++t){let i=null;e.set[t].forEach(e=>{let t=new r(e.semver.version);switch(e.operator){case">":0===t.prerelease.length?t.patch++:t.prerelease.push(0),t.raw=t.format();case"":case">=":(!i||n(t,i))&&(i=t);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${e.operator}`)}}),i&&(!s||n(s,i))&&(s=i)}return s&&e.test(s)?s:null}}),at=u((e,t)=>{var r=Qe();t.exports=(e,t)=>{try{return new r(e,t).range||"*"}catch{return null}}}),ot=u((e,t)=>{var r=Re(),i=et(),{ANY:n}=i,s=Qe(),a=tt(),o=He(),l=Ve(),c=Je(),u=Ke();t.exports=(e,t,d,p)=>{let h,f,m,g,y;switch(e=new r(e,p),t=new s(t,p),d){case">":h=o,f=c,m=l,g=">",y=">=";break;case"<":h=l,f=u,m=o,g="<",y="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(a(e,t,p))return!1;for(let r=0;r<t.set.length;++r){let s=null,a=null;if(t.set[r].forEach(e=>{e.semver===n&&(e=new i(">=0.0.0")),s=s||e,a=a||e,h(e.semver,s.semver,p)?s=e:m(e.semver,a.semver,p)&&(a=e)}),s.operator===g||s.operator===y||(!a.operator||a.operator===g)&&f(e,a.semver))return!1;if(a.operator===y&&m(e,a.semver))return!1}return!0}}),lt=u((e,t)=>{var r=ot();t.exports=(e,t,i)=>r(e,t,">",i)}),ct=u((e,t)=>{var r=ot();t.exports=(e,t,i)=>r(e,t,"<",i)}),ut=u((e,t)=>{var r=Qe();t.exports=(e,t,i)=>(e=new r(e,i),t=new r(t,i),e.intersects(t,i))}),dt=u((e,t)=>{var r=tt(),i=Fe();t.exports=(e,t,n)=>{let s=[],a=null,o=null,l=e.sort((e,t)=>i(e,t,n));for(let e of l)r(e,t,n)?(o=e,a||(a=e)):(o&&s.push([a,o]),o=null,a=null);a&&s.push([a,null]);let c=[];for(let[e,t]of s)c.push(e===t?e:t||e!==l[0]?t?e===l[0]?`<=${t}`:`${e} - ${t}`:`>=${e}`:"*");let u=c.join(" || "),d="string"==typeof t.raw?t.raw:String(t);return u.length<d.length?u:t}}),pt=u((e,t)=>{var r=Qe(),i=et(),{ANY:n}=i,s=tt(),a=Fe(),o=[new i(">=0.0.0-0")],l=[new i(">=0.0.0")],c=(e,t,r)=>{if(e===t)return!0;if(1===e.length&&e[0].semver===n){if(1===t.length&&t[0].semver===n)return!0;e=r.includePrerelease?o:l}if(1===t.length&&t[0].semver===n){if(r.includePrerelease)return!0;t=l}let i,c,p,h=new Set;for(let t of e)">"===t.operator||">="===t.operator?i=u(i,t,r):"<"===t.operator||"<="===t.operator?c=d(c,t,r):h.add(t.semver);if(h.size>1)return null;if(i&&c){if(p=a(i.semver,c.semver,r),p>0)return null;if(0===p&&(">="!==i.operator||"<="!==c.operator))return null}for(let e of h){if(i&&!s(e,String(i),r)||c&&!s(e,String(c),r))return null;for(let i of t)if(!s(e,String(i),r))return!1;return!0}let f,m,g,y,v=!(!c||r.includePrerelease||!c.semver.prerelease.length)&&c.semver,b=!(!i||r.includePrerelease||!i.semver.prerelease.length)&&i.semver;v&&1===v.prerelease.length&&"<"===c.operator&&0===v.prerelease[0]&&(v=!1);for(let e of t){if(y=y||">"===e.operator||">="===e.operator,g=g||"<"===e.operator||"<="===e.operator,i)if(b&&e.semver.prerelease&&e.semver.prerelease.length&&e.semver.major===b.major&&e.semver.minor===b.minor&&e.semver.patch===b.patch&&(b=!1),">"===e.operator||">="===e.operator){if(f=u(i,e,r),f===e&&f!==i)return!1}else if(">="===i.operator&&!s(i.semver,String(e),r))return!1;if(c)if(v&&e.semver.prerelease&&e.semver.prerelease.length&&e.semver.major===v.major&&e.semver.minor===v.minor&&e.semver.patch===v.patch&&(v=!1),"<"===e.operator||"<="===e.operator){if(m=d(c,e,r),m===e&&m!==c)return!1}else if("<="===c.operator&&!s(c.semver,String(e),r))return!1;if(!e.operator&&(c||i)&&0!==p)return!1}return!(i&&g&&!c&&0!==p||c&&y&&!i&&0!==p||b||v)},u=(e,t,r)=>{if(!e)return t;let i=a(e.semver,t.semver,r);return i>0?e:i<0||">"===t.operator&&">="===e.operator?t:e},d=(e,t,r)=>{if(!e)return t;let i=a(e.semver,t.semver,r);return i<0?e:i>0||"<"===t.operator&&"<="===e.operator?t:e};t.exports=(e,t,i={})=>{if(e===t)return!0;e=new r(e,i),t=new r(t,i);let n=!1;e:for(let r of e.set){for(let e of t.set){let t=c(r,e,i);if(n=n||null!==t,t)continue e}if(n)return!1}return!0}}),ht=u((e,t)=>{var r=xe(),i=Ee(),n=Re(),s=Pe(),a=Oe(),o=$e(),l=Ce(),c=Ae(),u=Ne(),d=Ie(),p=je(),h=Le(),f=De(),m=Fe(),g=Me(),y=ze(),v=qe(),b=Ue(),w=Be(),_=He(),S=Ve(),E=Ge(),k=We(),x=Ke(),T=Je(),P=Ze(),R=Ye(),O=et(),$=Qe(),C=tt(),A=rt(),N=it(),I=nt(),j=st(),L=at(),D=ot(),F=lt(),M=ct(),z=ut(),q=dt(),U=pt();t.exports={parse:a,valid:o,clean:l,inc:c,diff:u,major:d,minor:p,patch:h,prerelease:f,compare:m,rcompare:g,compareLoose:y,compareBuild:v,sort:b,rsort:w,gt:_,lt:S,eq:E,neq:k,gte:x,lte:T,cmp:P,coerce:R,Comparator:O,Range:$,satisfies:C,toComparators:A,maxSatisfying:N,minSatisfying:I,minVersion:j,validRange:L,outside:D,gtr:F,ltr:M,intersects:z,simplifyRange:q,subset:U,SemVer:n,re:r.re,src:r.src,tokens:r.t,SEMVER_SPEC_VERSION:i.SEMVER_SPEC_VERSION,RELEASE_TYPES:i.RELEASE_TYPES,compareIdentifiers:s.compareIdentifiers,rcompareIdentifiers:s.rcompareIdentifiers}}),ft=u((e,t)=>{var r=Se(),i=ht(),{FSTDEP005:n,FSTDEP012:s,FSTDEP015:a,FSTDEP016:o,FSTDEP017:l,FSTDEP018:c}=$(),{kHasBeenDecorated:u,kSchemaBody:d,kSchemaHeaders:p,kSchemaParams:h,kSchemaQuerystring:f,kSchemaController:m,kOptions:g,kRequestCacheValidateFns:y,kRouteContext:v,kPublicRouteContext:b,kRequestOriginalUrl:w}=R(),{FST_ERR_REQ_INVALID_VALIDATION_INVOCATION:_}=C(),S={body:d,headers:p,params:h,querystring:f,query:f};function E(e,t,r,i,n,s){this.id=e,this[v]=s,this.params=t,this.raw=r,this.query=i,this.log=n,this.body=void 0}function k(e){let t=e.props.slice();function r(e,r,i,n,s,a){this.id=e,this[v]=a,this.params=r,this.raw=i,this.query=n,this.log=s,this.body=void 0;for(var o,l=0;l<t.length;l++)this[(o=t[l]).key]=o.value}return Object.setPrototypeOf(r.prototype,e.prototype),Object.setPrototypeOf(r,e),r.props=t,r.parent=e,r}function x(e){let t=e.lastIndexOf(",");return-1===t?e.trim():e.slice(t+1).trim()}E.props=[],Object.defineProperties(E.prototype,{server:{get(){return this[v].server}},url:{get(){return this.raw.url}},originalUrl:{get(){return this[w]||(this[w]=this.raw.originalUrl||this.raw.url),this[w]}},method:{get(){return this.raw.method}},context:{get(){return s(),this[v]}},routerPath:{get(){return l(),this[v].config?.url}},routeOptions:{get(){let e=this[v],t=e._parserOptions.limit,r=e.server.initialConfig.bodyLimit,i=e.server.hasConstraintStrategy("version")?this.raw.headers["accept-version"]:void 0,n={method:e.config?.method,url:e.config?.url,bodyLimit:t||r,attachValidation:e.attachValidation,logLevel:e.logLevel,exposeHeadRoute:e.exposeHeadRoute,prefixTrailingSlash:e.prefixTrailingSlash,handler:e.handler,version:i};return Object.defineProperties(n,{config:{get:()=>e.config},schema:{get:()=>e.schema}}),Object.freeze(n)}},routerMethod:{get(){return c(),this[v].config?.method}},routeConfig:{get(){return o(),this[v][b]?.config}},routeSchema:{get(){return a(),this[v][b].schema}},is404:{get(){return void 0===this[v].config?.url}},connection:{get(){return i.gte(process.versions.node,"13.0.0")&&n(),this.raw.connection}},socket:{get(){return this.raw.socket}},ip:{get(){if(this.socket)return this.socket.remoteAddress}},hostname:{get(){return this.raw.headers.host||this.raw.headers[":authority"]}},protocol:{get(){if(this.socket)return this.socket.encrypted?"https":"http"}},headers:{get(){return this.additionalHeaders?Object.assign({},this.raw.headers,this.additionalHeaders):this.raw.headers},set(e){this.additionalHeaders=e}},getValidationFunction:{value:function(e){return"string"==typeof e?this[v][S[e]]:"object"==typeof e?this[v][y]?.get(e):void 0}},compileValidationSchema:{value:function(e,t=null){let{method:r,url:i}=this;if(this[v][y]?.has(e))return this[v][y].get(e);let n=(this[v].validatorCompiler||this.server[m].validatorCompiler||this.server[m].setupValidator(this.server[g])||this.server[m].validatorCompiler)({schema:e,method:r,url:i,httpPart:t});return null==this[v][y]&&(this[v][y]=new WeakMap),this[v][y].set(e,n),n}},validateInput:{value:function(e,t,r){let i,n=null!=(r="string"==typeof t?t:r)&&"string"==typeof r&&S[r];if(n&&(i=this[v][n]),null==i&&(null==t||"object"!=typeof t||Array.isArray(t)))throw new _(r);return null==i&&(i=this[v][y]?.has(t)?this[v][y].get(t):this.compileValidationSchema(t,r)),i(e)}}}),t.exports=E,t.exports.buildRequest=function(e,t){return t?function(e,t){let i=k(e),n=function(e){if("function"==typeof e)return e;if(!0===e)return function(){return!0};if("number"==typeof e)return function(t,r){return r<e};if("string"==typeof e){let t=e.split(",").map(e=>e.trim());return r.compile(t)}return r.compile(e)}(t);return i[u]=!0,Object.defineProperties(i.prototype,{ip:{get(){return r(this.raw,n)}},ips:{get(){return r.all(this.raw,n)}},hostname:{get(){return void 0!==this.ip&&this.headers["x-forwarded-host"]?x(this.headers["x-forwarded-host"]):this.headers.host||this.headers[":authority"]}},protocol:{get(){return this.headers["x-forwarded-proto"]?x(this.headers["x-forwarded-proto"]):this.socket?this.socket.encrypted?"https":"http":void 0}}}),i}(e,t):k(e)}}),mt=u((e,t)=>{var{kFourOhFourContext:r,kReplySerializerDefault:i,kSchemaErrorFormatter:n,kErrorHandler:s,kChildLoggerFactory:a,kOptions:o,kReply:l,kRequest:c,kBodyLimit:u,kLogLevel:d,kContentTypeParser:p,kRouteByFastify:h,kRequestCacheValidateFns:f,kReplyCacheSerializeFns:m,kPublicRouteContext:g}=R();function y(e,t){let r="";for(var i=0;i!==e.length;++i){let n=e[i];r+=t+(n.instancePath||"")+" "+n.message+", "}return new Error(r.slice(0,-2))}t.exports=function({schema:e,handler:t,config:v,requestIdLogLabel:b,childLoggerFactory:w,errorHandler:_,bodyLimit:S,logLevel:E,logSerializers:k,attachValidation:x,validatorCompiler:T,serializerCompiler:P,replySerializer:R,schemaErrorFormatter:O,exposeHeadRoute:$,prefixTrailingSlash:C,server:A,isFastify:N}){this.schema=e,this.handler=t,this.Reply=A[l],this.Request=A[c],this.contentTypeParser=A[p],this.onRequest=null,this.onSend=null,this.onError=null,this.onTimeout=null,this.preHandler=null,this.onResponse=null,this.preSerialization=null,this.onRequestAbort=null,this.config=v,this.errorHandler=_||A[s],this.requestIdLogLabel=b||A[o].requestIdLogLabel,this.childLoggerFactory=w||A[a],this._middie=null,this._parserOptions={limit:S||A[u]},this.exposeHeadRoute=$,this.prefixTrailingSlash=C,this.logLevel=E||A[d],this.logSerializers=k,this[r]=null,this.attachValidation=x,this[i]=R,this.schemaErrorFormatter=O||A[n]||y,this[h]=N,this[f]=null,this[m]=null,this.validatorCompiler=T||null,this.serializerCompiler=P||null,this[g]=function(e){return Object.create(null,{schema:{enumerable:!0,get:()=>e.schema},config:{enumerable:!0,get:()=>e.config}})}(this),this.server=A}}),gt=u((e,t)=>{t.exports={supportedMethods:["DELETE","GET","HEAD","PATCH","POST","PUT","OPTIONS","PROPFIND","PROPPATCH","MKCOL","COPY","MOVE","LOCK","UNLOCK","TRACE","SEARCH","REPORT","MKCALENDAR"]}}),yt=u((e,t)=>{var{kReply:r,kRequest:i,kState:n,kHasBeenDecorated:s}=R(),{FST_ERR_DEC_ALREADY_PRESENT:a,FST_ERR_DEC_MISSING_DEPENDENCY:o,FST_ERR_DEC_AFTER_START:l,FST_ERR_DEC_DEPENDENCY_INVALID_TYPE:c}=C(),{FSTDEP006:u}=$();function d(e,t,r,i){let n=e.prototype;if(Object.prototype.hasOwnProperty.call(n,t)||f(e,t))throw new a(t);e[s]=!0,m(e,t,i),!r||"function"!=typeof r.getter&&"function"!=typeof r.setter?"function"==typeof r?n[t]=r:e.props.push({key:t,value:r}):Object.defineProperty(n,t,{get:r.getter,set:r.setter})}function p(e,t){"object"==typeof t&&t&&"function"!=typeof t.getter&&"function"!=typeof t.setter&&u(e)}function h(e,t){return t?t in e||e.prototype&&t in e.prototype||f(e,t):e in this}function f(e,t){return!!e.props&&e.props.find(({key:e})=>e===t)}function m(e,t,r){if(null!=r){if(!Array.isArray(r))throw new c(t);for(var i=0;i!==r.length;++i)if(!h(e,r[i]))throw new o(r[i])}}function g(e,t){if(e[n].started)throw new l(t)}t.exports={add:function(e,t,r){return g(this,e),function(e,t,r,i){if(Object.prototype.hasOwnProperty.call(e,t))throw new a(t);m(e,t,i),!r||"function"!=typeof r.getter&&"function"!=typeof r.setter?e[t]=r:Object.defineProperty(e,t,{get:r.getter,set:r.setter})}(this,e,t,r),this},exist:h,existRequest:function(e){return!(!e||!f(this[i],e))||h(this[i].prototype,e)},existReply:function(e){return!(!e||!f(this[r],e))||h(this[r].prototype,e)},dependencies:m,decorateReply:function(e,t,i){return g(this,e),p(e,t),d(this[r],e,t,i),this},decorateRequest:function(e,t,r){return g(this,e),p(e,t),d(this[i],e,t,r),this}}}),vt=u(e=>{var t=class{constructor(e=1e3,t=0){if(isNaN(e)||e<0)throw new Error("Invalid max value");if(isNaN(t)||t<0)throw new Error("Invalid ttl value");this.first=null,this.items=Object.create(null),this.last=null,this.size=0,this.max=e,this.ttl=t}bumpLru(e){if(this.last===e)return;let t=this.last,r=e.next,i=e.prev;this.first===e&&(this.first=r),e.next=null,e.prev=t,t.next=e,null!==i&&(i.next=r),null!==r&&(r.prev=i),this.last=e}clear(){this.items=Object.create(null),this.first=null,this.last=null,this.size=0}delete(e){if(Object.prototype.hasOwnProperty.call(this.items,e)){let t=this.items[e];delete this.items[e],this.size--,null!==t.prev&&(t.prev.next=t.next),null!==t.next&&(t.next.prev=t.prev),this.first===t&&(this.first=t.next),this.last===t&&(this.last=t.prev)}}deleteMany(e){for(var t=0;t<e.length;t++)this.delete(e[t])}evict(){if(this.size>0){let e=this.first;delete this.items[e.key],0===--this.size?(this.first=null,this.last=null):(this.first=e.next,this.first.prev=null)}}expiresAt(e){if(Object.prototype.hasOwnProperty.call(this.items,e))return this.items[e].expiry}get(e){if(Object.prototype.hasOwnProperty.call(this.items,e)){let t=this.items[e];return this.ttl>0&&t.expiry<=Date.now()?void this.delete(e):(this.bumpLru(t),t.value)}}getMany(e){let t=[];for(var r=0;r<e.length;r++)t.push(this.get(e[r]));return t}keys(){return Object.keys(this.items)}set(e,t){if(Object.prototype.hasOwnProperty.call(this.items,e)){let r=this.items[e];return r.value=t,r.expiry=this.ttl>0?Date.now()+this.ttl:this.ttl,void(this.last!==r&&this.bumpLru(r))}this.max>0&&this.size===this.max&&this.evict();let r={expiry:this.ttl>0?Date.now()+this.ttl:this.ttl,key:e,prev:this.last,next:null,value:t};this.items[e]=r,1===++this.size?this.first=r:this.last.next=r,this.last=r}},r=class{constructor(){this.records={}}initForCache(e,t){this.records[e]={[t]:{cacheSize:0,hits:0,falsyHits:0,emptyHits:0,misses:0,expirations:0,evictions:0,invalidateOne:0,invalidateAll:0,sets:0}}}resetForCache(e){for(let t of Object.keys(this.records[e]))this.records[e][t]={cacheSize:0,hits:0,falsyHits:0,emptyHits:0,misses:0,expirations:0,evictions:0,invalidateOne:0,invalidateAll:0,sets:0}}getStatistics(){return this.records}};function i(e){return`${e.getFullYear()}-${(e.getMonth()+1).toString().padStart(2,"0")}-${e.getDate().toString().padStart(2,"0")}`}var n=class{constructor(e,t,n){this.cacheId=e,this.statisticTtlInHours=t,this.collectionStart=new Date,this.currentTimeStamp=i(this.collectionStart),this.records=n||new r,this.records.initForCache(this.cacheId,this.currentTimeStamp)}get currentRecord(){return this.records.records[this.cacheId][this.currentTimeStamp]||(this.records.records[this.cacheId][this.currentTimeStamp]={cacheSize:0,hits:0,falsyHits:0,emptyHits:0,misses:0,expirations:0,evictions:0,sets:0,invalidateOne:0,invalidateAll:0}),this.records.records[this.cacheId][this.currentTimeStamp]}hoursPassed(){return(Date.now()-this.collectionStart)/1e3/60/60}addHit(){this.archiveIfNeeded(),this.currentRecord.hits++}addFalsyHit(){this.archiveIfNeeded(),this.currentRecord.falsyHits++}addEmptyHit(){this.archiveIfNeeded(),this.currentRecord.emptyHits++}addMiss(){this.archiveIfNeeded(),this.currentRecord.misses++}addEviction(){this.archiveIfNeeded(),this.currentRecord.evictions++}setCacheSize(e){this.archiveIfNeeded(),this.currentRecord.cacheSize=e}addExpiration(){this.archiveIfNeeded(),this.currentRecord.expirations++}addSet(){this.archiveIfNeeded(),this.currentRecord.sets++}addInvalidateOne(){this.archiveIfNeeded(),this.currentRecord.invalidateOne++}addInvalidateAll(){this.archiveIfNeeded(),this.currentRecord.invalidateAll++}getStatistics(){return this.records.getStatistics()}archiveIfNeeded(){this.hoursPassed()>=this.statisticTtlInHours&&(this.collectionStart=new Date,this.currentTimeStamp=i(this.collectionStart),this.records.initForCache(this.cacheId,this.currentTimeStamp))}},s=class extends t{constructor(e,t,r,i,s){if(super(e||1e3,t||0),!r)throw new Error("Cache id is mandatory");this.hitStatistics=new n(r,void 0!==s?s:24,i)}getStatistics(){return this.hitStatistics.getStatistics()}set(e,t){super.set(e,t),this.hitStatistics.addSet(),this.hitStatistics.setCacheSize(this.size)}evict(){super.evict(),this.hitStatistics.addEviction(),this.hitStatistics.setCacheSize(this.size)}delete(e,t=!1){super.delete(e),t||this.hitStatistics.addInvalidateOne(),this.hitStatistics.setCacheSize(this.size)}clear(){super.clear(),this.hitStatistics.addInvalidateAll(),this.hitStatistics.setCacheSize(this.size)}get(e){if(Object.prototype.hasOwnProperty.call(this.items,e)){let t=this.items[e];return this.ttl>0&&t.expiry<=Date.now()?(this.delete(e,!0),void this.hitStatistics.addExpiration()):(this.bumpLru(t),t.value||this.hitStatistics.addFalsyHit(),(null==t.value||""===t.value)&&this.hitStatistics.addEmptyHit(),this.hitStatistics.addHit(),t.value)}this.hitStatistics.addMiss()}},a=class{constructor(e=1e3,t=0){if(isNaN(e)||e<0)throw new Error("Invalid max value");if(isNaN(t)||t<0)throw new Error("Invalid ttl value");this.first=null,this.items=Object.create(null),this.last=null,this.size=0,this.max=e,this.ttl=t}clear(){this.items=Object.create(null),this.first=null,this.last=null,this.size=0}delete(e){if(Object.prototype.hasOwnProperty.call(this.items,e)){let t=this.items[e];delete this.items[e],this.size--,null!==t.prev&&(t.prev.next=t.next),null!==t.next&&(t.next.prev=t.prev),this.first===t&&(this.first=t.next),this.last===t&&(this.last=t.prev)}}deleteMany(e){for(var t=0;t<e.length;t++)this.delete(e[t])}evict(){if(this.size>0){let e=this.first;delete this.items[e.key],0===--this.size?(this.first=null,this.last=null):(this.first=e.next,this.first.prev=null)}}expiresAt(e){if(Object.prototype.hasOwnProperty.call(this.items,e))return this.items[e].expiry}get(e){if(Object.prototype.hasOwnProperty.call(this.items,e)){let t=this.items[e];return this.ttl>0&&t.expiry<=Date.now()?void this.delete(e):t.value}}getMany(e){let t=[];for(var r=0;r<e.length;r++)t.push(this.get(e[r]));return t}keys(){return Object.keys(this.items)}set(e,t){if(Object.prototype.hasOwnProperty.call(this.items,e)){let r=this.items[e];return r.value=t,void(r.expiry=this.ttl>0?Date.now()+this.ttl:this.ttl)}this.max>0&&this.size===this.max&&this.evict();let r={expiry:this.ttl>0?Date.now()+this.ttl:this.ttl,key:e,prev:this.last,next:null,value:t};this.items[e]=r,1===++this.size?this.first=r:this.last.next=r,this.last=r}};e.Fifo=a,e.FifoMap=class{constructor(e=1e3,t=0){if(isNaN(e)||e<0)throw new Error("Invalid max value");if(isNaN(t)||t<0)throw new Error("Invalid ttl value");this.first=null,this.items=new Map,this.last=null,this.max=e,this.ttl=t}get size(){return this.items.size}clear(){this.items=new Map,this.first=null,this.last=null}delete(e){if(this.items.has(e)){let t=this.items.get(e);this.items.delete(e),null!==t.prev&&(t.prev.next=t.next),null!==t.next&&(t.next.prev=t.prev),this.first===t&&(this.first=t.next),this.last===t&&(this.last=t.prev)}}deleteMany(e){for(var t=0;t<e.length;t++)this.delete(e[t])}evict(){if(this.size>0){let e=this.first;this.items.delete(e.key),0===this.size?(this.first=null,this.last=null):(this.first=e.next,this.first.prev=null)}}expiresAt(e){if(this.items.has(e))return this.items.get(e).expiry}get(e){if(this.items.has(e)){let t=this.items.get(e);return this.ttl>0&&t.expiry<=Date.now()?void this.delete(e):t.value}}getMany(e){let t=[];for(var r=0;r<e.length;r++)t.push(this.get(e[r]));return t}keys(){return this.items.keys()}set(e,t){if(this.items.has(e)){let r=this.items.get(e);return r.value=t,void(r.expiry=this.ttl>0?Date.now()+this.ttl:this.ttl)}this.max>0&&this.size===this.max&&this.evict();let r={expiry:this.ttl>0?Date.now()+this.ttl:this.ttl,key:e,prev:this.last,next:null,value:t};this.items.set(e,r),1===this.size?this.first=r:this.last.next=r,this.last=r}},e.FifoObject=a,e.HitStatisticsRecord=r,e.Lru=t,e.LruHitStatistics=s,e.LruMap=class{constructor(e=1e3,t=0){if(isNaN(e)||e<0)throw new Error("Invalid max value");if(isNaN(t)||t<0)throw new Error("Invalid ttl value");this.first=null,this.items=new Map,this.last=null,this.max=e,this.ttl=t}get size(){return this.items.size}bumpLru(e){if(this.last===e)return;let t=this.last,r=e.next,i=e.prev;this.first===e&&(this.first=r),e.next=null,e.prev=t,t.next=e,null!==i&&(i.next=r),null!==r&&(r.prev=i),this.last=e}clear(){this.items=new Map,this.first=null,this.last=null}delete(e){if(this.items.has(e)){let t=this.items.get(e);this.items.delete(e),null!==t.prev&&(t.prev.next=t.next),null!==t.next&&(t.next.prev=t.prev),this.first===t&&(this.first=t.next),this.last===t&&(this.last=t.prev)}}deleteMany(e){for(var t=0;t<e.length;t++)this.delete(e[t])}evict(){if(this.size>0){let e=this.first;this.items.delete(e.key),0===this.size?(this.first=null,this.last=null):(this.first=e.next,this.first.prev=null)}}expiresAt(e){if(this.items.has(e))return this.items.get(e).expiry}get(e){if(this.items.has(e)){let t=this.items.get(e);return this.ttl>0&&t.expiry<=Date.now()?void this.delete(e):(this.bumpLru(t),t.value)}}getMany(e){let t=[];for(var r=0;r<e.length;r++)t.push(this.get(e[r]));return t}keys(){return this.items.keys()}set(e,t){if(this.items.has(e)){let r=this.items.get(e);return r.value=t,r.expiry=this.ttl>0?Date.now()+this.ttl:this.ttl,void(this.last!==r&&this.bumpLru(r))}this.max>0&&this.size===this.max&&this.evict();let r={expiry:this.ttl>0?Date.now()+this.ttl:this.ttl,key:e,prev:this.last,next:null,value:t};this.items.set(e,r),1===this.size?this.first=r:this.last.next=r,this.last=r}},e.LruObject=t,e.LruObjectHitStatistics=s}),bt=u((e,t)=>{var r=function(){};r.prototype=Object.create(null);var i=/; *([!#$%&'*+.^\w`|~-]+)=("(?:[\v\u0020\u0021\u0023-\u005b\u005d-\u007e\u0080-\u00ff]|\\[\v\u0020-\u00ff])*"|[!#$%&'*+.^\w`|~-]+) */gu,n=/\\([\v\u0020-\u00ff])/gu,s=/^[!#$%&'*+.^\w|~-]+\/[!#$%&'*+.^\w|~-]+$/u,a={type:"",parameters:new r};function o(e){if("string"!=typeof e)throw new TypeError("argument header is required and must be a string");let t=e.indexOf(";"),a=-1!==t?e.slice(0,t).trim():e.trim();if(!1===s.test(a))throw new TypeError("invalid media type");let o,l,c,u={type:a.toLowerCase(),parameters:new r};if(-1===t)return u;for(i.lastIndex=t;l=i.exec(e);){if(l.index!==t)throw new TypeError("invalid parameter format");t+=l[0].length,o=l[1].toLowerCase(),c=l[2],'"'===c[0]&&(c=c.slice(1,c.length-1),n.test(c)&&(c=c.replace(n,"$1"))),u.parameters[o]=c}if(t!==e.length)throw new TypeError("invalid parameter format");return u}function l(e){if("string"!=typeof e)return a;let t=e.indexOf(";"),o=-1!==t?e.slice(0,t).trim():e.trim();if(!1===s.test(o))return a;let l,c,u,d={type:o.toLowerCase(),parameters:new r};if(-1===t)return d;for(i.lastIndex=t;c=i.exec(e);){if(c.index!==t)return a;t+=c[0].length,l=c[1].toLowerCase(),u=c[2],'"'===u[0]&&(u=u.slice(1,u.length-1),n.test(u)&&(u=u.replace(n,"$1"))),d.parameters[l]=u}return t!==e.length?a:d}Object.freeze(a.parameters),Object.freeze(a),t.exports.default={parse:o,safeParse:l},t.exports.parse=o,t.exports.safeParse=l,t.exports.defaultContentType=a}),wt=u((e,t)=>{var r=typeof Buffer<"u",i=/"(?:_|\\u005[Ff])(?:_|\\u005[Ff])(?:p|\\u0070)(?:r|\\u0072)(?:o|\\u006[Ff])(?:t|\\u0074)(?:o|\\u006[Ff])(?:_|\\u005[Ff])(?:_|\\u005[Ff])"\s*:/,n=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/;function s(e,t,s){null==s&&null!==t&&"object"==typeof t&&(s=t,t=void 0),r&&Buffer.isBuffer(e)&&(e=e.toString()),e&&65279===e.charCodeAt(0)&&(e=e.slice(1));let o=JSON.parse(e,t);if(null===o||"object"!=typeof o)return o;let l=s&&s.protoAction||"error",c=s&&s.constructorAction||"error";if("ignore"===l&&"ignore"===c)return o;if("ignore"!==l&&"ignore"!==c){if(!1===i.test(e)&&!1===n.test(e))return o}else if("ignore"!==l&&"ignore"===c){if(!1===i.test(e))return o}else if(!1===n.test(e))return o;return a(o,{protoAction:l,constructorAction:c,safe:s&&s.safe})}function a(e,{protoAction:t="error",constructorAction:r="error",safe:i}={}){let n=[e];for(;n.length;){let e=n;n=[];for(let s of e){if("ignore"!==t&&Object.prototype.hasOwnProperty.call(s,"__proto__")){if(!0===i)return null;if("error"===t)throw new SyntaxError("Object contains forbidden prototype property");delete s.__proto__}if("ignore"!==r&&Object.prototype.hasOwnProperty.call(s,"constructor")&&Object.prototype.hasOwnProperty.call(s.constructor,"prototype")){if(!0===i)return null;if("error"===r)throw new SyntaxError("Object contains forbidden prototype property");delete s.constructor}for(let e in s){let t=s[e];t&&"object"==typeof t&&n.push(t)}}}return e}function o(e,t,r){let i=Error.stackTraceLimit;Error.stackTraceLimit=0;try{return s(e,t,r)}finally{Error.stackTraceLimit=i}}t.exports=o,t.exports.default=o,t.exports.parse=o,t.exports.safeParse=function(e,t){let r=Error.stackTraceLimit;Error.stackTraceLimit=0;try{return s(e,t,{safe:!0})}catch{return null}finally{Error.stackTraceLimit=r}},t.exports.scan=a}),_t=u((e,t)=>{var{AsyncResource:r}=c("node:async_hooks"),{FifoMap:i}=vt(),{safeParse:n,defaultContentType:s}=bt(),a=wt(),{kDefaultJsonParse:o,kContentTypeParser:l,kBodyLimit:u,kRequestPayloadStream:d,kState:p,kTestInternals:h,kReplyIsError:f,kRouteContext:m}=R(),{FST_ERR_CTP_INVALID_TYPE:g,FST_ERR_CTP_EMPTY_TYPE:y,FST_ERR_CTP_ALREADY_PRESENT:v,FST_ERR_CTP_INVALID_HANDLER:b,FST_ERR_CTP_INVALID_PARSE_TYPE:w,FST_ERR_CTP_BODY_TOO_LARGE:_,FST_ERR_CTP_INVALID_MEDIA_TYPE:S,FST_ERR_CTP_INVALID_CONTENT_LENGTH:E,FST_ERR_CTP_EMPTY_JSON_BODY:k,FST_ERR_CTP_INSTANCE_ALREADY_STARTED:x}=C();function T(e,t,r){this[o]=O(t,r),this.customParsers=new Map,this.customParsers.set("application/json",new A(!0,!1,e,this[o])),this.customParsers.set("text/plain",new A(!0,!1,e,$)),this.parserList=[new j("application/json"),new j("text/plain")],this.parserRegExpList=[],this.cache=new i(100)}function P(e,t,r,i,n){let s=i.asString,a=null===r.limit?i.bodyLimit:r.limit,o=void 0===e.headers["content-length"]?NaN:Number(e.headers["content-length"]);if(o>a)return t.header("connection","close"),void t.send(new _);let l=0,c=!0===s?"":[],u=e[d]||e.raw;function p(e){l+=e.length;let{receivedEncodedLength:r=0}=u;if(l>a||r>a)return u.removeListener("data",p),u.removeListener("end",h),u.removeListener("error",h),void t.send(new _);!0===s?c+=e:c.push(e)}function h(r){if(u.removeListener("data",p),u.removeListener("end",h),u.removeListener("error",h),void 0!==r)return"number"==typeof r.statusCode&&r.statusCode>=400||(r.statusCode=400),t[f]=!0,void t.code(r.statusCode).send(r);if(!0===s&&(l=Buffer.byteLength(c)),!Number.isNaN(o)&&(u.receivedEncodedLength||l)!==o)return t.header("connection","close"),void t.send(new E);!1===s&&(c=Buffer.concat(c));let a=i.fn(e,c,n);a&&"function"==typeof a.then&&a.then(e=>n(null,e),n)}!0===s&&u.setEncoding("utf8"),u.on("data",p),u.on("end",h),u.on("error",h),u.resume()}function O(e,t){return function(r,i,n){if(""===i||null==i||Buffer.isBuffer(i)&&0===i.length)return n(new k,void 0);let s;try{s=a.parse(i,{protoAction:e,constructorAction:t})}catch(e){return e.statusCode=400,n(e,void 0)}n(null,s)}}function $(e,t,r){r(null,t)}function A(e,t,r,i){this.asString=e,this.asBuffer=t,this.bodyLimit=r,this.fn=i}function N(e,t){if(t.isEssence)return-1!==e.type.indexOf(t);if(-1===e.type.indexOf(t.type))return!1;for(let r of t.parameterKeys)if(!(r in e.parameters)||e.parameters[r]!==t.parameters[r])return!1;return!0}function I(e,t,r){return r.test(r.isEssence?t:e)}function j(e){this.name=e;let t=n(e);if(this.isEssence=-1===e.indexOf(";"),!1===this.isEssence&&""===t.type){let t=e.split(";",1)[0];this.type=""===t?e:t}else this.type=t.type;this.parameters=t.parameters,this.parameterKeys=Object.keys(t.parameters)}T.prototype.add=function(e,t,r){let i="string"==typeof e;if(!(i||e instanceof RegExp))throw new g;if(i&&0===e.length)throw new y;if("function"!=typeof r)throw new b;if(this.existingParser(e))throw new v(e);if(void 0!==t.parseAs&&"string"!==t.parseAs&&"buffer"!==t.parseAs)throw new w(t.parseAs);let n=new A("string"===t.parseAs,"buffer"===t.parseAs,t.bodyLimit,r);i&&"*"===e?this.customParsers.set("",n):(i?this.parserList.unshift(new j(e)):(e.isEssence=-1===e.source.indexOf(";"),this.parserRegExpList.unshift(e)),this.customParsers.set(e.toString(),n))},T.prototype.hasParser=function(e){return this.customParsers.has("string"==typeof e?e:e.toString())},T.prototype.existingParser=function(e){return"application/json"===e&&this.customParsers.has(e)?this.customParsers.get(e).fn!==this[o]:"text/plain"===e&&this.customParsers.has(e)?this.customParsers.get(e).fn!==$:this.hasParser(e)},T.prototype.getParser=function(e){if(this.hasParser(e))return this.customParsers.get(e);let t=this.cache.get(e);if(void 0!==t)return t;let r=n(e);if(r===s)return this.customParsers.get("");for(var i=0;i!==this.parserList.length;++i){let t=this.parserList[i];if(N(r,t)){let r=this.customParsers.get(t.name);return this.cache.set(e,r),r}}for(var a=0;a!==this.parserRegExpList.length;++a){let t=this.parserRegExpList[a];if(I(e,r.type,t)){let r=this.customParsers.get(t.toString());return this.cache.set(e,r),r}}return this.customParsers.get("")},T.prototype.removeAll=function(){this.customParsers=new Map,this.parserRegExpList=[],this.parserList=[],this.cache=new i(100)},T.prototype.remove=function(e){if(!("string"==typeof e||e instanceof RegExp))throw new g;let t=this.customParsers.delete(e.toString()),r="string"==typeof e?this.parserList:this.parserRegExpList,i=r.findIndex(t=>t.toString()===e.toString());return i>-1&&r.splice(i,1),t||i>-1},T.prototype.run=function(e,t,i,n){let s=this.getParser(e);if(void 0===s)return void(i.is404?t(i,n):n.send(new S(e||void 0)));let a=new r("content-type-parser:run",i);if(!0===s.asString||!0===s.asBuffer)P(i,n,n[m]._parserOptions,s,o);else{let e=s.fn(i,i[d],o);e&&"function"==typeof e.then&&e.then(e=>o(null,e),o)}function o(e,r){a.runInAsyncScope(()=>{a.emitDestroy(),e?(n[f]=!0,n.send(e)):(i.body=r,t(i,n))})}},j.prototype.toString=function(){return this.name},t.exports=T,t.exports.helpers={buildContentTypeParser:function(e){let t=new T;return t[o]=e[o],t.customParsers=new Map(e.customParsers.entries()),t.parserList=e.parserList.slice(),t.parserRegExpList=e.parserRegExpList.slice(),t},addContentTypeParser:function(e,t,r){if(this[p].started)throw new x("addContentTypeParser");return"function"==typeof t&&(r=t,t={}),t||(t={}),t.bodyLimit||(t.bodyLimit=this[u]),Array.isArray(e)?e.forEach(e=>this[l].add(e,t,r)):this[l].add(e,t,r),this},hasContentTypeParser:function(e){return this[l].hasParser(e)},removeContentTypeParser:function(e){if(this[p].started)throw new x("removeContentTypeParser");if(Array.isArray(e))for(let t of e)this[l].remove(t);else this[l].remove(e)},removeAllContentTypeParsers:function(){if(this[p].started)throw new x("removeAllContentTypeParsers");this[l].removeAll()}},t.exports.defaultParsers={getDefaultJsonParser:O,defaultTextParser:$},t.exports[h]={rawBody:P}}),St=u((e,t)=>{t.exports=function e(t,r){if(t===r)return!0;if(t&&r&&"object"==typeof t&&"object"==typeof r){if(t.constructor!==r.constructor)return!1;var i,n,s;if(Array.isArray(t)){if((i=t.length)!=r.length)return!1;for(n=i;0!==n--;)if(!e(t[n],r[n]))return!1;return!0}if(t.constructor===RegExp)return t.source===r.source&&t.flags===r.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===r.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===r.toString();if((i=(s=Object.keys(t)).length)!==Object.keys(r).length)return!1;for(n=i;0!==n--;)if(!Object.prototype.hasOwnProperty.call(r,s[n]))return!1;for(n=i;0!==n--;){var a=s[n];if(!e(t[a],r[a]))return!1}return!0}return t!=t&&r!=r}}),Et=u((e,t)=>{var r=St(),i=Symbol.for("json-schema-ref");function n(e,t){let r=t.split("/"),i=e;for(let e of r)if(""!==e&&"#"!==e){if("object"!=typeof i||null===i)return null;i=i[e]}return i??null}t.exports={RefResolver:class{#e;#t;#r;#i;#n;constructor(e={}){this.#e={},this.#t={},this.#r=e.insertRefSymbol??!1,this.#i=e.allowEqualDuplicates??!0,this.#n=e.cloneSchemaWithoutRefs??!1}addSchema(e,t){void 0!==e.$id&&"#"!==e.$id.charAt(0)?t=e.$id:this.#s(e,t),this.#a(e,t)}getSchema(e,t="#"){let r=this.#e[e];if(void 0===r)throw new Error(`Cannot resolve ref "${e}${t}". Schema with id "${e}" is not found.`);return void 0!==r.anchors[t]?r.anchors[t]:n(r.schema,t)}hasSchema(e){return void 0!==this.#e[e]}getSchemaRefs(e){let t=this.#e[e];if(void 0===t)throw new Error(`Schema with id "${e}" is not found.`);return t.refs}getSchemaDependencies(e,t={}){let r=this.#e[e];for(let e of r.refs){let r=e.schemaId;void 0===t[r]&&(t[r]=this.getSchema(r),this.getSchemaDependencies(r,t))}return t}derefSchema(e){if(void 0!==this.#t[e])return;let t=this.#e[e];if(void 0===t)throw new Error(`Schema with id "${e}" is not found.`);!this.#n&&0===t.refs.length&&(this.#t[e]={schema:t.schema,anchors:t.anchors});let r=[];this.#o(t.schema,e,r);let i=this.getSchemaDependencies(e);for(let e in i)this.#o(i[e],e,r);for(let e of r){let{refSchemaId:t,refJsonPointer:r}=this.#l(e.ref,e.sourceSchemaId),i=this.getDerefSchema(t,r);if(null===i)throw new Error(`Cannot resolve ref "${e.ref}". Ref "${r}" is not found in schema "${t}".`);e.targetSchema=i,e.targetSchemaId=t}for(let e of r)this.#c(e,r)}getDerefSchema(e,t="#"){let r=this.#t[e];return void 0===r&&(this.derefSchema(e),r=this.#t[e]),void 0!==r.anchors[t]?r.anchors[t]:n(r.schema,t)}#l(e,t){let r=e.indexOf("#");return-1===r?{refSchemaId:e,refJsonPointer:"#"}:0===r?{refSchemaId:t,refJsonPointer:e}:{refSchemaId:e.slice(0,r),refJsonPointer:e.slice(r)}}#a(e,t){let r=e.$id;void 0!==r&&"string"==typeof r&&("#"===r.charAt(0)?this.#u(e,t,r):(this.#s(e,r),t=r));let i=e.$ref;if(void 0!==i&&"string"==typeof i){let{refSchemaId:e,refJsonPointer:r}=this.#l(i,t);this.#e[t].refs.push({schemaId:e,jsonPointer:r})}for(let r in e)"object"==typeof e[r]&&null!==e[r]&&this.#a(e[r],t)}#o(e,t,r=[]){let i=Array.isArray(e)?[...e]:{...e},n=i.$id;void 0!==n&&"string"==typeof n&&("#"===n.charAt(0)?this.#d(i,t,n):(this.#p(i,n),t=n)),void 0!==i.$ref&&r.push({ref:i.$ref,sourceSchemaId:t,sourceSchema:i});for(let e in i){let n=i[e];"object"==typeof n&&null!==n&&(i[e]=this.#o(n,t,r))}return i}#c(e,t){let{sourceSchema:n,targetSchema:s}=e;if(n.$ref){if(this.#r&&(n[i]=n.$ref),delete n.$ref,s.$ref){let e=t.find(e=>e.sourceSchema===s);this.#c(e,t)}for(let t in s)if("$id"!==t){if(void 0!==n[t]){if(r(n[t],s[t]))continue;throw new Error(`Cannot resolve ref "${e.ref}". Property "${t}" is already exist in schema "${e.sourceSchemaId}".`)}n[t]=s[t]}e.isResolved=!0}}#s(e,t){let i=this.#e[t];if(void 0!==i){if(this.#i&&r(e,i.schema))return;throw new Error(`There is already another schema with id "${t}".`)}this.#e[t]={schema:e,anchors:{},refs:[]}}#u(e,t,r){let{anchors:i}=this.#e[t];if(void 0!==i[r])throw new Error(`There is already another anchor "${r}" in a schema "${t}".`);i[r]=e}#p(e,t){void 0===this.#t[t]&&(this.#t[t]={schema:e,anchors:{}})}#d(e,t,r){let{anchors:i}=this.#t[t];i[r]=e}}}}),kt=u(e=>{Object.defineProperty(e,"__esModule",{value:!0}),e.regexpCode=e.getEsmExportName=e.getProperty=e.safeStringify=e.stringify=e.strConcat=e.addCodeArg=e.str=e._=e.nil=e._Code=e.Name=e.IDENTIFIER=e._CodeOrName=void 0;var t=class{};e._CodeOrName=t,e.IDENTIFIER=/^[a-z$_][a-z$_0-9]*$/i;var r=class extends t{constructor(t){if(super(),!e.IDENTIFIER.test(t))throw new Error("CodeGen: name must be a valid identifier");this.str=t}toString(){return this.str}emptyStr(){return!1}get names(){return{[this.str]:1}}};e.Name=r;var i=class extends t{constructor(e){super(),this._items="string"==typeof e?[e]:e}toString(){return this.str}emptyStr(){if(this._items.length>1)return!1;let e=this._items[0];return""===e||'""'===e}get str(){var e;return null!==(e=this._str)&&void 0!==e?e:this._str=this._items.reduce((e,t)=>`${e}${t}`,"")}get names(){var e;return null!==(e=this._names)&&void 0!==e?e:this._names=this._items.reduce((e,t)=>(t instanceof r&&(e[t.str]=(e[t.str]||0)+1),e),{})}};function n(e,...t){let r=[e[0]],n=0;for(;n<t.length;)o(r,t[n]),r.push(e[++n]);return new i(r)}e._Code=i,e.nil=new i(""),e._=n;var s=new i("+");function a(e,...t){let r=[c(e[0])],n=0;for(;n<t.length;)r.push(s),o(r,t[n]),r.push(s,c(e[++n]));return function(e){let t=1;for(;t<e.length-1;){if(e[t]===s){let r=l(e[t-1],e[t+1]);if(void 0!==r){e.splice(t-1,3,r);continue}e[t++]="+"}t++}}(r),new i(r)}function o(e,t){t instanceof i?e.push(...t._items):e.push(t instanceof r?t:function(e){return"number"==typeof e||"boolean"==typeof e||null===e?e:c(Array.isArray(e)?e.join(","):e)}(t))}function l(e,t){return'""'===t?e:'""'===e?t:"string"==typeof e?t instanceof r||'"'!==e[e.length-1]?void 0:"string"!=typeof t?`${e.slice(0,-1)}${t}"`:'"'===t[0]?e.slice(0,-1)+t.slice(1):void 0:"string"!=typeof t||'"'!==t[0]||e instanceof r?void 0:`"${e}${t.slice(1)}`}function c(e){return JSON.stringify(e).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")}e.str=a,e.addCodeArg=o,e.strConcat=function(e,t){return t.emptyStr()?e:e.emptyStr()?t:a`${e}${t}`},e.stringify=function(e){return new i(c(e))},e.safeStringify=c,e.getProperty=function(t){return"string"==typeof t&&e.IDENTIFIER.test(t)?new i(`.${t}`):n`[${t}]`},e.getEsmExportName=function(t){if("string"==typeof t&&e.IDENTIFIER.test(t))return new i(`${t}`);throw new Error(`CodeGen: invalid export name: ${t}, use explicit $id name mapping`)},e.regexpCode=function(e){return new i(e.toString())}}),xt=u(e=>{Object.defineProperty(e,"__esModule",{value:!0}),e.ValueScope=e.ValueScopeName=e.Scope=e.varKinds=e.UsedValueState=void 0;var t,r=kt(),i=class extends Error{constructor(e){super(`CodeGen: "code" for ${e} not defined`),this.value=e.value}};!function(e){e[e.Started=0]="Started",e[e.Completed=1]="Completed"}(t||(e.UsedValueState=t={})),e.varKinds={const:new r.Name("const"),let:new r.Name("let"),var:new r.Name("var")};var n=class{constructor({prefixes:e,parent:t}={}){this._names={},this._prefixes=e,this._parent=t}toName(e){return e instanceof r.Name?e:this.name(e)}name(e){return new r.Name(this._newName(e))}_newName(e){return`${e}${(this._names[e]||this._nameGroup(e)).index++}`}_nameGroup(e){var t,r;if(null!==(r=null===(t=this._parent)||void 0===t?void 0:t._prefixes)&&void 0!==r&&r.has(e)||this._prefixes&&!this._prefixes.has(e))throw new Error(`CodeGen: prefix "${e}" is not allowed in this scope`);return this._names[e]={prefix:e,index:0}}};e.Scope=n;var s=class extends r.Name{constructor(e,t){super(t),this.prefix=e}setValue(e,{property:t,itemIndex:i}){this.value=e,this.scopePath=r._`.${new r.Name(t)}[${i}]`}};e.ValueScopeName=s;var a=r._`\n`;e.ValueScope=class extends n{constructor(e){super(e),this._values={},this._scope=e.scope,this.opts={...e,_n:e.lines?a:r.nil}}get(){return this._scope}name(e){return new s(e,this._newName(e))}value(e,t){var r;if(void 0===t.ref)throw new Error("CodeGen: ref must be passed in value");let i=this.toName(e),{prefix:n}=i,s=null!==(r=t.key)&&void 0!==r?r:t.ref,a=this._values[n];if(a){let e=a.get(s);if(e)return e}else a=this._values[n]=new Map;a.set(s,i);let o=this._scope[n]||(this._scope[n]=[]),l=o.length;return o[l]=t.ref,i.setValue(t,{property:n,itemIndex:l}),i}getValue(e,t){let r=this._values[e];if(r)return r.get(t)}scopeRefs(e,t=this._values){return this._reduceValues(t,t=>{if(void 0===t.scopePath)throw new Error(`CodeGen: name "${t}" has no value`);return r._`${e}${t.scopePath}`})}scopeCode(e=this._values,t,r){return this._reduceValues(e,e=>{if(void 0===e.value)throw new Error(`CodeGen: name "${e}" has no value`);return e.value.code},t,r)}_reduceValues(n,s,a={},o){let l=r.nil;for(let c in n){let u=n[c];if(!u)continue;let d=a[c]=a[c]||new Map;u.forEach(n=>{if(d.has(n))return;d.set(n,t.Started);let a=s(n);if(a)l=r._`${l}${this.opts.es5?e.varKinds.var:e.varKinds.const} ${n} = ${a};${this.opts._n}`;else{if(!(a=o?.(n)))throw new i(n);l=r._`${l}${a}${this.opts._n}`}d.set(n,t.Completed)})}return l}}}),Tt=u(e=>{Object.defineProperty(e,"__esModule",{value:!0}),e.or=e.and=e.not=e.CodeGen=e.operators=e.varKinds=e.ValueScopeName=e.ValueScope=e.Scope=e.Name=e.regexpCode=e.stringify=e.getProperty=e.nil=e.strConcat=e.str=e._=void 0;var t=kt(),r=xt(),i=kt();Object.defineProperty(e,"_",{enumerable:!0,get:function(){return i._}}),Object.defineProperty(e,"str",{enumerable:!0,get:function(){return i.str}}),Object.defineProperty(e,"strConcat",{enumerable:!0,get:function(){return i.strConcat}}),Object.defineProperty(e,"nil",{enumerable:!0,get:function(){return i.nil}}),Object.defineProperty(e,"getProperty",{enumerable:!0,get:function(){return i.getProperty}}),Object.defineProperty(e,"stringify",{enumerable:!0,get:function(){return i.stringify}}),Object.defineProperty(e,"regexpCode",{enumerable:!0,get:function(){return i.regexpCode}}),Object.defineProperty(e,"Name",{enumerable:!0,get:function(){return i.Name}});var n=xt();Object.defineProperty(e,"Scope",{enumerable:!0,get:function(){return n.Scope}}),Object.defineProperty(e,"ValueScope",{enumerable:!0,get:function(){return n.ValueScope}}),Object.defineProperty(e,"ValueScopeName",{enumerable:!0,get:function(){return n.ValueScopeName}}),Object.defineProperty(e,"varKinds",{enumerable:!0,get:function(){return n.varKinds}}),e.operators={GT:new t._Code(">"),GTE:new t._Code(">="),LT:new t._Code("<"),LTE:new t._Code("<="),EQ:new t._Code("==="),NEQ:new t._Code("!=="),NOT:new t._Code("!"),OR:new t._Code("||"),AND:new t._Code("&&"),ADD:new t._Code("+")};var s=class{optimizeNodes(){return this}optimizeNames(e,t){return this}},a=class extends s{constructor(e,t,r){super(),this.varKind=e,this.name=t,this.rhs=r}render({es5:e,_n:t}){return`${e?r.varKinds.var:this.varKind} ${this.name}${void 0===this.rhs?"":` = ${this.rhs}`};`+t}optimizeNames(e,t){if(e[this.name.str])return this.rhs&&(this.rhs=O(this.rhs,e,t)),this}get names(){return this.rhs instanceof t._CodeOrName?this.rhs.names:{}}},o=class extends s{constructor(e,t,r){super(),this.lhs=e,this.rhs=t,this.sideEffects=r}render({_n:e}){return`${this.lhs} = ${this.rhs};`+e}optimizeNames(e,r){if(!(this.lhs instanceof t.Name)||e[this.lhs.str]||this.sideEffects)return this.rhs=O(this.rhs,e,r),this}get names(){return R(this.lhs instanceof t.Name?{}:{...this.lhs.names},this.rhs)}},l=class extends o{constructor(e,t,r,i){super(e,r,i),this.op=t}render({_n:e}){return`${this.lhs} ${this.op}= ${this.rhs};`+e}},c=class extends s{constructor(e){super(),this.label=e,this.names={}}render({_n:e}){return`${this.label}:`+e}},u=class extends s{constructor(e){super(),this.label=e,this.names={}}render({_n:e}){return`break${this.label?` ${this.label}`:""};`+e}},d=class extends s{constructor(e){super(),this.error=e}render({_n:e}){return`throw ${this.error};`+e}get names(){return this.error.names}},p=class extends s{constructor(e){super(),this.code=e}render({_n:e}){return`${this.code};`+e}optimizeNodes(){return`${this.code}`?this:void 0}optimizeNames(e,t){return this.code=O(this.code,e,t),this}get names(){return this.code instanceof t._CodeOrName?this.code.names:{}}},h=class extends s{constructor(e=[]){super(),this.nodes=e}render(e){return this.nodes.reduce((t,r)=>t+r.render(e),"")}optimizeNodes(){let{nodes:e}=this,t=e.length;for(;t--;){let r=e[t].optimizeNodes();Array.isArray(r)?e.splice(t,1,...r):r?e[t]=r:e.splice(t,1)}return e.length>0?this:void 0}optimizeNames(e,t){let{nodes:r}=this,i=r.length;for(;i--;){let n=r[i];n.optimizeNames(e,t)||($(e,n.names),r.splice(i,1))}return r.length>0?this:void 0}get names(){return this.nodes.reduce((e,t)=>P(e,t.names),{})}},f=class extends h{render(e){return"{"+e._n+super.render(e)+"}"+e._n}},m=class extends h{},g=class extends f{};g.kind="else";var y=class e extends f{constructor(e,t){super(t),this.condition=e}render(e){let t=`if(${this.condition})`+super.render(e);return this.else&&(t+="else "+this.else.render(e)),t}optimizeNodes(){super.optimizeNodes();let t=this.condition;if(!0===t)return this.nodes;let r=this.else;if(r){let e=r.optimizeNodes();r=this.else=Array.isArray(e)?new g(e):e}return r?!1===t?r instanceof e?r:r.nodes:this.nodes.length?this:new e(C(t),r instanceof e?[r]:r.nodes):!1!==t&&this.nodes.length?this:void 0}optimizeNames(e,t){var r;if(this.else=null===(r=this.else)||void 0===r?void 0:r.optimizeNames(e,t),super.optimizeNames(e,t)||this.else)return this.condition=O(this.condition,e,t),this}get names(){let e=super.names;return R(e,this.condition),this.else&&P(e,this.else.names),e}};y.kind="if";var v=class extends f{};v.kind="for";var b=class extends v{constructor(e){super(),this.iteration=e}render(e){return`for(${this.iteration})`+super.render(e)}optimizeNames(e,t){if(super.optimizeNames(e,t))return this.iteration=O(this.iteration,e,t),this}get names(){return P(super.names,this.iteration.names)}},w=class extends v{constructor(e,t,r,i){super(),this.varKind=e,this.name=t,this.from=r,this.to=i}render(e){let t=e.es5?r.varKinds.var:this.varKind,{name:i,from:n,to:s}=this;return`for(${t} ${i}=${n}; ${i}<${s}; ${i}++)`+super.render(e)}get names(){let e=R(super.names,this.from);return R(e,this.to)}},_=class extends v{constructor(e,t,r,i){super(),this.loop=e,this.varKind=t,this.name=r,this.iterable=i}render(e){return`for(${this.varKind} ${this.name} ${this.loop} ${this.iterable})`+super.render(e)}optimizeNames(e,t){if(super.optimizeNames(e,t))return this.iterable=O(this.iterable,e,t),this}get names(){return P(super.names,this.iterable.names)}},S=class extends f{constructor(e,t,r){super(),this.name=e,this.args=t,this.async=r}render(e){return`${this.async?"async ":""}function ${this.name}(${this.args})`+super.render(e)}};S.kind="func";var E=class extends h{render(e){return"return "+super.render(e)}};E.kind="return";var k=class extends f{render(e){let t="try"+super.render(e);return this.catch&&(t+=this.catch.render(e)),this.finally&&(t+=this.finally.render(e)),t}optimizeNodes(){var e,t;return super.optimizeNodes(),null===(e=this.catch)||void 0===e||e.optimizeNodes(),null===(t=this.finally)||void 0===t||t.optimizeNodes(),this}optimizeNames(e,t){var r,i;return super.optimizeNames(e,t),null===(r=this.catch)||void 0===r||r.optimizeNames(e,t),null===(i=this.finally)||void 0===i||i.optimizeNames(e,t),this}get names(){let e=super.names;return this.catch&&P(e,this.catch.names),this.finally&&P(e,this.finally.names),e}},x=class extends f{constructor(e){super(),this.error=e}render(e){return`catch(${this.error})`+super.render(e)}};x.kind="catch";var T=class extends f{render(e){return"finally"+super.render(e)}};function P(e,t){for(let r in t)e[r]=(e[r]||0)+(t[r]||0);return e}function R(e,r){return r instanceof t._CodeOrName?P(e,r.names):e}function O(e,r,i){return e instanceof t.Name?s(e):(n=e)instanceof t._Code&&n._items.some(e=>e instanceof t.Name&&1===r[e.str]&&void 0!==i[e.str])?new t._Code(e._items.reduce((e,r)=>(r instanceof t.Name&&(r=s(r)),r instanceof t._Code?e.push(...r._items):e.push(r),e),[])):e;var n;function s(e){let t=i[e.str];return void 0===t||1!==r[e.str]?e:(delete r[e.str],t)}}function $(e,t){for(let r in t)e[r]=(e[r]||0)-(t[r]||0)}function C(e){return"boolean"==typeof e||"number"==typeof e||null===e?!e:t._`!${j(e)}`}T.kind="finally",e.CodeGen=class{constructor(e,t={}){this._values={},this._blockStarts=[],this._constants={},this.opts={...t,_n:t.lines?"\n":""},this._extScope=e,this._scope=new r.Scope({parent:e}),this._nodes=[new m]}toString(){return this._root.render(this.opts)}name(e){return this._scope.name(e)}scopeName(e){return this._extScope.name(e)}scopeValue(e,t){let r=this._extScope.value(e,t);return(this._values[r.prefix]||(this._values[r.prefix]=new Set)).add(r),r}getScopeValue(e,t){return this._extScope.getValue(e,t)}scopeRefs(e){return this._extScope.scopeRefs(e,this._values)}scopeCode(){return this._extScope.scopeCode(this._values)}_def(e,t,r,i){let n=this._scope.toName(t);return void 0!==r&&i&&(this._constants[n.str]=r),this._leafNode(new a(e,n,r)),n}const(e,t,i){return this._def(r.varKinds.const,e,t,i)}let(e,t,i){return this._def(r.varKinds.let,e,t,i)}var(e,t,i){return this._def(r.varKinds.var,e,t,i)}assign(e,t,r){return this._leafNode(new o(e,t,r))}add(t,r){return this._leafNode(new l(t,e.operators.ADD,r))}code(e){return"function"==typeof e?e():e!==t.nil&&this._leafNode(new p(e)),this}object(...e){let r=["{"];for(let[i,n]of e)r.length>1&&r.push(","),r.push(i),(i!==n||this.opts.es5)&&(r.push(":"),(0,t.addCodeArg)(r,n));return r.push("}"),new t._Code(r)}if(e,t,r){if(this._blockNode(new y(e)),t&&r)this.code(t).else().code(r).endIf();else if(t)this.code(t).endIf();else if(r)throw new Error('CodeGen: "else" body without "then" body');return this}elseIf(e){return this._elseNode(new y(e))}else(){return this._elseNode(new g)}endIf(){return this._endBlockNode(y,g)}_for(e,t){return this._blockNode(e),t&&this.code(t).endFor(),this}for(e,t){return this._for(new b(e),t)}forRange(e,t,i,n,s=(this.opts.es5?r.varKinds.var:r.varKinds.let)){let a=this._scope.toName(e);return this._for(new w(s,a,t,i),()=>n(a))}forOf(e,i,n,s=r.varKinds.const){let a=this._scope.toName(e);if(this.opts.es5){let e=i instanceof t.Name?i:this.var("_arr",i);return this.forRange("_i",0,t._`${e}.length`,r=>{this.var(a,t._`${e}[${r}]`),n(a)})}return this._for(new _("of",s,a,i),()=>n(a))}forIn(e,i,n,s=(this.opts.es5?r.varKinds.var:r.varKinds.const)){if(this.opts.ownProperties)return this.forOf(e,t._`Object.keys(${i})`,n);let a=this._scope.toName(e);return this._for(new _("in",s,a,i),()=>n(a))}endFor(){return this._endBlockNode(v)}label(e){return this._leafNode(new c(e))}break(e){return this._leafNode(new u(e))}return(e){let t=new E;if(this._blockNode(t),this.code(e),1!==t.nodes.length)throw new Error('CodeGen: "return" should have one node');return this._endBlockNode(E)}try(e,t,r){if(!t&&!r)throw new Error('CodeGen: "try" without "catch" and "finally"');let i=new k;if(this._blockNode(i),this.code(e),t){let e=this.name("e");this._currNode=i.catch=new x(e),t(e)}return r&&(this._currNode=i.finally=new T,this.code(r)),this._endBlockNode(x,T)}throw(e){return this._leafNode(new d(e))}block(e,t){return this._blockStarts.push(this._nodes.length),e&&this.code(e).endBlock(t),this}endBlock(e){let t=this._blockStarts.pop();if(void 0===t)throw new Error("CodeGen: not in self-balancing block");let r=this._nodes.length-t;if(r<0||void 0!==e&&r!==e)throw new Error(`CodeGen: wrong number of nodes: ${r} vs ${e} expected`);return this._nodes.length=t,this}func(e,r=t.nil,i,n){return this._blockNode(new S(e,r,i)),n&&this.code(n).endFunc(),this}endFunc(){return this._endBlockNode(S)}optimize(e=1){for(;e-- >0;)this._root.optimizeNodes(),this._root.optimizeNames(this._root.names,this._constants)}_leafNode(e){return this._currNode.nodes.push(e),this}_blockNode(e){this._currNode.nodes.push(e),this._nodes.push(e)}_endBlockNode(e,t){let r=this._currNode;if(r instanceof e||t&&r instanceof t)return this._nodes.pop(),this;throw new Error(`CodeGen: not in block "${t?`${e.kind}/${t.kind}`:e.kind}"`)}_elseNode(e){let t=this._currNode;if(!(t instanceof y))throw new Error('CodeGen: "else" without "if"');return this._currNode=t.else=e,this}get _root(){return this._nodes[0]}get _currNode(){let e=this._nodes;return e[e.length-1]}set _currNode(e){let t=this._nodes;t[t.length-1]=e}},e.not=C;var A=I(e.operators.AND);e.and=function(...e){return e.reduce(A)};var N=I(e.operators.OR);function I(e){return(r,i)=>r===t.nil?i:i===t.nil?r:t._`${j(r)} ${e} ${j(i)}`}function j(e){return e instanceof t.Name?e:t._`(${e})`}e.or=function(...e){return e.reduce(N)}}),Pt=u(e=>{Object.defineProperty(e,"__esModule",{value:!0}),e.checkStrictMode=e.getErrorPath=e.Type=e.useFunc=e.setEvaluated=e.evaluatedPropsToName=e.mergeEvaluated=e.eachItem=e.unescapeJsonPointer=e.escapeJsonPointer=e.escapeFragment=e.unescapeFragment=e.schemaRefOrVal=e.schemaHasRulesButRef=e.schemaHasRules=e.checkUnknownRules=e.alwaysValidSchema=e.toHash=void 0;var t=Tt(),r=kt();function i(e,t=e.schema){let{opts:r,self:i}=e;if(!r.strictSchema||"boolean"==typeof t)return;let n=i.RULES.keywords;for(let r in t)n[r]||p(e,`unknown keyword: "${r}"`)}function n(e,t){if("boolean"==typeof e)return!e;for(let r in e)if(t[r])return!0;return!1}function s(e){return"number"==typeof e?`${e}`:e.replace(/~/g,"~0").replace(/\//g,"~1")}function a(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")}function o({mergeNames:e,mergeToName:r,mergeValues:i,resultToName:n}){return(s,a,o,l)=>{let c=void 0===o?a:o instanceof t.Name?(a instanceof t.Name?e(s,a,o):r(s,a,o),o):a instanceof t.Name?(r(s,o,a),a):i(a,o);return l!==t.Name||c instanceof t.Name?c:n(s,c)}}function l(e,r){if(!0===r)return e.var("props",!0);let i=e.var("props",t._`{}`);return void 0!==r&&c(e,i,r),i}function c(e,r,i){Object.keys(i).forEach(i=>e.assign(t._`${r}${(0,t.getProperty)(i)}`,!0))}e.toHash=function(e){let t={};for(let r of e)t[r]=!0;return t},e.alwaysValidSchema=function(e,t){return"boolean"==typeof t?t:0===Object.keys(t).length||(i(e,t),!n(t,e.self.RULES.all))},e.checkUnknownRules=i,e.schemaHasRules=n,e.schemaHasRulesButRef=function(e,t){if("boolean"==typeof e)return!e;for(let r in e)if("$ref"!==r&&t.all[r])return!0;return!1},e.schemaRefOrVal=function({topSchemaRef:e,schemaPath:r},i,n,s){if(!s){if("number"==typeof i||"boolean"==typeof i)return i;if("string"==typeof i)return t._`${i}`}return t._`${e}${r}${(0,t.getProperty)(n)}`},e.unescapeFragment=function(e){return a(decodeURIComponent(e))},e.escapeFragment=function(e){return encodeURIComponent(s(e))},e.escapeJsonPointer=s,e.unescapeJsonPointer=a,e.eachItem=function(e,t){if(Array.isArray(e))for(let r of e)t(r);else t(e)},e.mergeEvaluated={props:o({mergeNames:(e,r,i)=>e.if(t._`${i} !== true && ${r} !== undefined`,()=>{e.if(t._`${r} === true`,()=>e.assign(i,!0),()=>e.assign(i,t._`${i} || {}`).code(t._`Object.assign(${i}, ${r})`))}),mergeToName:(e,r,i)=>e.if(t._`${i} !== true`,()=>{!0===r?e.assign(i,!0):(e.assign(i,t._`${i} || {}`),c(e,i,r))}),mergeValues:(e,t)=>!0===e||{...e,...t},resultToName:l}),items:o({mergeNames:(e,r,i)=>e.if(t._`${i} !== true && ${r} !== undefined`,()=>e.assign(i,t._`${r} === true ? true : ${i} > ${r} ? ${i} : ${r}`)),mergeToName:(e,r,i)=>e.if(t._`${i} !== true`,()=>e.assign(i,!0===r||t._`${i} > ${r} ? ${i} : ${r}`)),mergeValues:(e,t)=>!0===e||Math.max(e,t),resultToName:(e,t)=>e.var("items",t)})},e.evaluatedPropsToName=l,e.setEvaluated=c;var u,d={};function p(e,t,r=e.opts.strictSchema){if(r){if(t=`strict mode: ${t}`,!0===r)throw new Error(t);e.self.logger.warn(t)}}e.useFunc=function(e,t){return e.scopeValue("func",{ref:t,code:d[t.code]||(d[t.code]=new r._Code(t.code))})},function(e){e[e.Num=0]="Num",e[e.Str=1]="Str"}(u||(e.Type=u={})),e.getErrorPath=function(e,r,i){if(e instanceof t.Name){let n=r===u.Num;return i?n?t._`"[" + ${e} + "]"`:t._`"['" + ${e} + "']"`:n?t._`"/" + ${e}`:t._`"/" + ${e}.replace(/~/g, "~0").replace(/\\//g, "~1")`}return i?(0,t.getProperty)(e).toString():"/"+s(e)},e.checkStrictMode=p}),Rt=u(e=>{Object.defineProperty(e,"__esModule",{value:!0});var t=Tt(),r={data:new t.Name("data"),valCxt:new t.Name("valCxt"),instancePath:new t.Name("instancePath"),parentData:new t.Name("parentData"),parentDataProperty:new t.Name("parentDataProperty"),rootData:new t.Name("rootData"),dynamicAnchors:new t.Name("dynamicAnchors"),vErrors:new t.Name("vErrors"),errors:new t.Name("errors"),this:new t.Name("this"),self:new t.Name("self"),scope:new t.Name("scope"),json:new t.Name("json"),jsonPos:new t.Name("jsonPos"),jsonLen:new t.Name("jsonLen"),jsonPart:new t.Name("jsonPart")};e.default=r}),Ot=u(e=>{Object.defineProperty(e,"__esModule",{value:!0}),e.extendErrors=e.resetErrorsCount=e.reportExtraError=e.reportError=e.keyword$DataError=e.keywordError=void 0;var t=Tt(),r=Pt(),i=Rt();function n(e,r){let n=e.const("err",r);e.if(t._`${i.default.vErrors} === null`,()=>e.assign(i.default.vErrors,t._`[${n}]`),t._`${i.default.vErrors}.push(${n})`),e.code(t._`${i.default.errors}++`)}function s(e,r){let{gen:i,validateName:n,schemaEnv:s}=e;s.$async?i.throw(t._`new ${e.ValidationError}(${r})`):(i.assign(t._`${n}.errors`,r),i.return(!1))}e.keywordError={message:({keyword:e})=>t.str`must pass "${e}" keyword validation`},e.keyword$DataError={message:({keyword:e,schemaType:r})=>r?t.str`"${e}" keyword must be ${r} ($data)`:t.str`"${e}" keyword is invalid ($data)`},e.reportError=function(r,i=e.keywordError,a,l){let{it:c}=r,{gen:u,compositeRule:d,allErrors:p}=c,h=o(r,i,a);l??(d||p)?n(u,h):s(c,t._`[${h}]`)},e.reportExtraError=function(t,r=e.keywordError,a){let{it:l}=t,{gen:c,compositeRule:u,allErrors:d}=l;n(c,o(t,r,a)),u||d||s(l,i.default.vErrors)},e.resetErrorsCount=function(e,r){e.assign(i.default.errors,r),e.if(t._`${i.default.vErrors} !== null`,()=>e.if(r,()=>e.assign(t._`${i.default.vErrors}.length`,r),()=>e.assign(i.default.vErrors,null)))},e.extendErrors=function({gen:e,keyword:r,schemaValue:n,data:s,errsCount:a,it:o}){if(void 0===a)throw new Error("ajv implementation error");let l=e.name("err");e.forRange("i",a,i.default.errors,a=>{e.const(l,t._`${i.default.vErrors}[${a}]`),e.if(t._`${l}.instancePath === undefined`,()=>e.assign(t._`${l}.instancePath`,(0,t.strConcat)(i.default.instancePath,o.errorPath))),e.assign(t._`${l}.schemaPath`,t.str`${o.errSchemaPath}/${r}`),o.opts.verbose&&(e.assign(t._`${l}.schema`,n),e.assign(t._`${l}.data`,s))})};var a={keyword:new t.Name("keyword"),schemaPath:new t.Name("schemaPath"),params:new t.Name("params"),propertyName:new t.Name("propertyName"),message:new t.Name("message"),schema:new t.Name("schema"),parentSchema:new t.Name("parentSchema")};function o(e,r,n){let{createErrors:s}=e.it;return!1===s?t._`{}`:function(e,r,n={}){let{gen:s,it:o}=e,u=[l(o,n),c(e,n)];return function(e,{params:r,message:n},s){let{keyword:o,data:l,schemaValue:c,it:u}=e,{opts:d,propertyName:p,topSchemaRef:h,schemaPath:f}=u;s.push([a.keyword,o],[a.params,"function"==typeof r?r(e):r||t._`{}`]),d.messages&&s.push([a.message,"function"==typeof n?n(e):n]),d.verbose&&s.push([a.schema,c],[a.parentSchema,t._`${h}${f}`],[i.default.data,l]),p&&s.push([a.propertyName,p])}(e,r,u),s.object(...u)}(e,r,n)}function l({errorPath:e},{instancePath:n}){let s=n?t.str`${e}${(0,r.getErrorPath)(n,r.Type.Str)}`:e;return[i.default.instancePath,(0,t.strConcat)(i.default.instancePath,s)]}function c({keyword:e,it:{errSchemaPath:i}},{schemaPath:n,parentSchema:s}){let o=s?i:t.str`${i}/${e}`;return n&&(o=t.str`${o}${(0,r.getErrorPath)(n,r.Type.Str)}`),[a.schemaPath,o]}}),$t=u(e=>{Object.defineProperty(e,"__esModule",{value:!0}),e.boolOrEmptySchema=e.topBoolOrEmptySchema=void 0;var t=Ot(),r=Tt(),i=Rt(),n={message:"boolean schema is false"};function s(e,r){let{gen:i,data:s}=e;(0,t.reportError)({gen:i,keyword:"false schema",data:s,schema:!1,schemaCode:!1,schemaValue:!1,params:{},it:e},n,void 0,r)}e.topBoolOrEmptySchema=function(e){let{gen:t,schema:n,validateName:a}=e;!1===n?s(e,!1):"object"==typeof n&&!0===n.$async?t.return(i.default.data):(t.assign(r._`${a}.errors`,null),t.return(!0))},e.boolOrEmptySchema=function(e,t){let{gen:r,schema:i}=e;!1===i?(r.var(t,!1),s(e)):r.var(t,!0)}}),Ct=u(e=>{Object.defineProperty(e,"__esModule",{value:!0}),e.getRules=e.isJSONType=void 0;var t=new Set(["string","number","integer","boolean","null","object","array"]);e.isJSONType=function(e){return"string"==typeof e&&t.has(e)},e.getRules=function(){let e={number:{type:"number",rules:[]},string:{type:"string",rules:[]},array:{type:"array",rules:[]},object:{type:"object",rules:[]}};return{types:{...e,integer:!0,boolean:!0,null:!0},rules:[{rules:[]},e.number,e.string,e.array,e.object],post:{rules:[]},all:{},keywords:{}}}}),At=u(e=>{function t(e,t){return t.rules.some(t=>r(e,t))}function r(e,t){var r;return void 0!==e[t.keyword]||(null===(r=t.definition.implements)||void 0===r?void 0:r.some(t=>void 0!==e[t]))}Object.defineProperty(e,"__esModule",{value:!0}),e.shouldUseRule=e.shouldUseGroup=e.schemaHasRulesForType=void 0,e.schemaHasRulesForType=function({schema:e,self:r},i){let n=r.RULES.types[i];return n&&!0!==n&&t(e,n)},e.shouldUseGroup=t,e.shouldUseRule=r}),Nt=u(e=>{Object.defineProperty(e,"__esModule",{value:!0}),e.reportTypeError=e.checkDataTypes=e.checkDataType=e.coerceAndCheckDataType=e.getJSONTypes=e.getSchemaTypes=e.DataType=void 0;var t,r=Ct(),i=At(),n=Ot(),s=Tt(),a=Pt();function o(e){let t=Array.isArray(e)?e:e?[e]:[];if(t.every(r.isJSONType))return t;throw new Error("type must be JSONType or JSONType[]: "+t.join(","))}!function(e){e[e.Correct=0]="Correct",e[e.Wrong=1]="Wrong"}(t||(e.DataType=t={})),e.getSchemaTypes=function(e){let t=o(e.type);if(t.includes("null")){if(!1===e.nullable)throw new Error("type: null contradicts nullable: false")}else{if(!t.length&&void 0!==e.nullable)throw new Error('"nullable" cannot be used without "type"');!0===e.nullable&&t.push("null")}return t},e.getJSONTypes=o,e.coerceAndCheckDataType=function(e,r){let{gen:n,data:a,opts:o}=e,c=function(e,t){return t?e.filter(e=>l.has(e)||"array"===t&&"array"===e):[]}(r,o.coerceTypes),d=r.length>0&&!(0===c.length&&1===r.length&&(0,i.schemaHasRulesForType)(e,r[0]));if(d){let i=u(r,a,o.strictNumbers,t.Wrong);n.if(i,()=>{c.length?function(e,t,r){let{gen:i,data:n,opts:a}=e,o=i.let("dataType",s._`typeof ${n}`),c=i.let("coerced",s._`undefined`);"array"===a.coerceTypes&&i.if(s._`${o} == 'object' && Array.isArray(${n}) && ${n}.length == 1`,()=>i.assign(n,s._`${n}[0]`).assign(o,s._`typeof ${n}`).if(u(t,n,a.strictNumbers),()=>i.assign(c,n))),i.if(s._`${c} !== undefined`);for(let e of r)(l.has(e)||"array"===e&&"array"===a.coerceTypes)&&d(e);function d(e){switch(e){case"string":return void i.elseIf(s._`${o} == "number" || ${o} == "boolean"`).assign(c,s._`"" + ${n}`).elseIf(s._`${n} === null`).assign(c,s._`""`);case"number":return void i.elseIf(s._`${o} == "boolean" || ${n} === null
              || (${o} == "string" && ${n} && ${n} == +${n})`).assign(c,s._`+${n}`);case"integer":return void i.elseIf(s._`${o} === "boolean" || ${n} === null
              || (${o} === "string" && ${n} && ${n} == +${n} && !(${n} % 1))`).assign(c,s._`+${n}`);case"boolean":return void i.elseIf(s._`${n} === "false" || ${n} === 0 || ${n} === null`).assign(c,!1).elseIf(s._`${n} === "true" || ${n} === 1`).assign(c,!0);case"null":return i.elseIf(s._`${n} === "" || ${n} === 0 || ${n} === false`),void i.assign(c,null);case"array":i.elseIf(s._`${o} === "string" || ${o} === "number"
              || ${o} === "boolean" || ${n} === null`).assign(c,s._`[${n}]`)}}i.else(),p(e),i.endIf(),i.if(s._`${c} !== undefined`,()=>{i.assign(n,c),function({gen:e,parentData:t,parentDataProperty:r},i){e.if(s._`${t} !== undefined`,()=>e.assign(s._`${t}[${r}]`,i))}(e,c)})}(e,r,c):p(e)})}return d};var l=new Set(["string","number","integer","boolean","null"]);function c(e,r,i,n=t.Correct){let a,o=n===t.Correct?s.operators.EQ:s.operators.NEQ;switch(e){case"null":return s._`${r} ${o} null`;case"array":a=s._`Array.isArray(${r})`;break;case"object":a=s._`${r} && typeof ${r} == "object" && !Array.isArray(${r})`;break;case"integer":a=l(s._`!(${r} % 1) && !isNaN(${r})`);break;case"number":a=l();break;default:return s._`typeof ${r} ${o} ${e}`}return n===t.Correct?a:(0,s.not)(a);function l(e=s.nil){return(0,s.and)(s._`typeof ${r} == "number"`,e,i?s._`isFinite(${r})`:s.nil)}}function u(e,t,r,i){if(1===e.length)return c(e[0],t,r,i);let n,o=(0,a.toHash)(e);if(o.array&&o.object){let e=s._`typeof ${t} != "object"`;n=o.null?e:s._`!${t} || ${e}`,delete o.null,delete o.array,delete o.object}else n=s.nil;o.number&&delete o.integer;for(let e in o)n=(0,s.and)(n,c(e,t,r,i));return n}e.checkDataType=c,e.checkDataTypes=u;var d={message:({schema:e})=>`must be ${e}`,params:({schema:e,schemaValue:t})=>"string"==typeof e?s._`{type: ${e}}`:s._`{type: ${t}}`};function p(e){let t=function(e){let{gen:t,data:r,schema:i}=e,n=(0,a.schemaRefOrVal)(e,i,"type");return{gen:t,keyword:"type",data:r,schema:i.type,schemaCode:n,schemaValue:n,parentSchema:i,params:{},it:e}}(e);(0,n.reportError)(t,d)}e.reportTypeError=p}),It=u(e=>{Object.defineProperty(e,"__esModule",{value:!0}),e.assignDefaults=void 0;var t=Tt(),r=Pt();function i(e,i,n){let{gen:s,compositeRule:a,data:o,opts:l}=e;if(void 0===n)return;let c=t._`${o}${(0,t.getProperty)(i)}`;if(a)return void(0,r.checkStrictMode)(e,`default is ignored for: ${c}`);let u=t._`${c} === undefined`;"empty"===l.useDefaults&&(u=t._`${u} || ${c} === null || ${c} === ""`),s.if(u,t._`${c} = ${(0,t.stringify)(n)}`)}e.assignDefaults=function(e,t){let{properties:r,items:n}=e.schema;if("object"===t&&r)for(let t in r)i(e,t,r[t].default);else"array"===t&&Array.isArray(n)&&n.forEach((t,r)=>i(e,r,t.default))}}),jt=u(e=>{Object.defineProperty(e,"__esModule",{value:!0}),e.validateUnion=e.validateArray=e.usePattern=e.callValidateCode=e.schemaProperties=e.allSchemaProperties=e.noPropertyInData=e.propertyInData=e.isOwnProperty=e.hasPropFunc=e.reportMissingProp=e.checkMissingProp=e.checkReportMissingProp=void 0;var t=Tt(),r=Pt(),i=Rt(),n=Pt();function s(e){return e.scopeValue("func",{ref:Object.prototype.hasOwnProperty,code:t._`Object.prototype.hasOwnProperty`})}function a(e,r,i){return t._`${s(e)}.call(${r}, ${i})`}function o(e,r,i,n){let s=t._`${r}${(0,t.getProperty)(i)} === undefined`;return n?(0,t.or)(s,(0,t.not)(a(e,r,i))):s}function l(e){return e?Object.keys(e).filter(e=>"__proto__"!==e):[]}e.checkReportMissingProp=function(e,r){let{gen:i,data:n,it:s}=e;i.if(o(i,n,r,s.opts.ownProperties),()=>{e.setParams({missingProperty:t._`${r}`},!0),e.error()})},e.checkMissingProp=function({gen:e,data:r,it:{opts:i}},n,s){return(0,t.or)(...n.map(n=>(0,t.and)(o(e,r,n,i.ownProperties),t._`${s} = ${n}`)))},e.reportMissingProp=function(e,t){e.setParams({missingProperty:t},!0),e.error()},e.hasPropFunc=s,e.isOwnProperty=a,e.propertyInData=function(e,r,i,n){let s=t._`${r}${(0,t.getProperty)(i)} !== undefined`;return n?t._`${s} && ${a(e,r,i)}`:s},e.noPropertyInData=o,e.allSchemaProperties=l,e.schemaProperties=function(e,t){return l(t).filter(i=>!(0,r.alwaysValidSchema)(e,t[i]))},e.callValidateCode=function({schemaCode:e,data:r,it:{gen:n,topSchemaRef:s,schemaPath:a,errorPath:o},it:l},c,u,d){let p=d?t._`${e}, ${r}, ${s}${a}`:r,h=[[i.default.instancePath,(0,t.strConcat)(i.default.instancePath,o)],[i.default.parentData,l.parentData],[i.default.parentDataProperty,l.parentDataProperty],[i.default.rootData,i.default.rootData]];l.opts.dynamicRef&&h.push([i.default.dynamicAnchors,i.default.dynamicAnchors]);let f=t._`${p}, ${n.object(...h)}`;return u!==t.nil?t._`${c}.call(${u}, ${f})`:t._`${c}(${f})`};var c=t._`new RegExp`;e.usePattern=function({gen:e,it:{opts:r}},i){let s=r.unicodeRegExp?"u":"",{regExp:a}=r.code,o=a(i,s);return e.scopeValue("pattern",{key:o.toString(),ref:o,code:t._`${"new RegExp"===a.code?c:(0,n.useFunc)(e,a)}(${i}, ${s})`})},e.validateArray=function(e){let{gen:i,data:n,keyword:s,it:a}=e,o=i.name("valid");if(a.allErrors){let e=i.let("valid",!0);return l(()=>i.assign(e,!1)),e}return i.var(o,!0),l(()=>i.break()),o;function l(a){let l=i.const("len",t._`${n}.length`);i.forRange("i",0,l,n=>{e.subschema({keyword:s,dataProp:n,dataPropType:r.Type.Num},o),i.if((0,t.not)(o),a)})}},e.validateUnion=function(e){let{gen:i,schema:n,keyword:s,it:a}=e;if(!Array.isArray(n))throw new Error("ajv implementation error");if(n.some(e=>(0,r.alwaysValidSchema)(a,e))&&!a.opts.unevaluated)return;let o=i.let("valid",!1),l=i.name("_valid");i.block(()=>n.forEach((r,n)=>{let a=e.subschema({keyword:s,schemaProp:n,compositeRule:!0},l);i.assign(o,t._`${o} || ${l}`),e.mergeValidEvaluated(a,l)||i.if((0,t.not)(o))})),e.result(o,()=>e.reset(),()=>e.error(!0))}}),Lt=u(e=>{Object.defineProperty(e,"__esModule",{value:!0}),e.validateKeywordUsage=e.validSchemaType=e.funcKeywordCode=e.macroKeywordCode=void 0;var t=Tt(),r=Rt(),i=jt(),n=Ot();function s(e){let{gen:r,data:i,it:n}=e;r.if(n.parentData,()=>r.assign(i,t._`${n.parentData}[${n.parentDataProperty}]`))}function a(e,r,i){if(void 0===i)throw new Error(`keyword "${r}" failed to compile`);return e.scopeValue("keyword","function"==typeof i?{ref:i}:{ref:i,code:(0,t.stringify)(i)})}e.macroKeywordCode=function(e,r){let{gen:i,keyword:n,schema:s,parentSchema:o,it:l}=e,c=r.macro.call(l.self,s,o,l),u=a(i,n,c);!1!==l.opts.validateSchema&&l.self.validateSchema(c,!0);let d=i.name("valid");e.subschema({schema:c,schemaPath:t.nil,errSchemaPath:`${l.errSchemaPath}/${n}`,topSchemaRef:u,compositeRule:!0},d),e.pass(d,()=>e.error(!0))},e.funcKeywordCode=function(e,o){var l;let{gen:c,keyword:u,schema:d,parentSchema:p,$data:h,it:f}=e;!function({schemaEnv:e},t){if(t.async&&!e.$async)throw new Error("async keyword in sync schema")}(f,o);let m=!h&&o.compile?o.compile.call(f.self,d,p,f):o.validate,g=a(c,u,m),y=c.let("valid");function v(n=(o.async?t._`await `:t.nil)){c.assign(y,t._`${n}${(0,i.callValidateCode)(e,g,f.opts.passContext?r.default.this:r.default.self,!("compile"in o&&!h||!1===o.schema))}`,o.modifying)}function b(e){var r;c.if((0,t.not)(null!==(r=o.valid)&&void 0!==r?r:y),e)}e.block$data(y,function(){if(!1===o.errors)v(),o.modifying&&s(e),b(()=>e.error());else{let i=o.async?function(){let e=c.let("ruleErrs",null);return c.try(()=>v(t._`await `),r=>c.assign(y,!1).if(t._`${r} instanceof ${f.ValidationError}`,()=>c.assign(e,t._`${r}.errors`),()=>c.throw(r))),e}():function(){let e=t._`${g}.errors`;return c.assign(e,null),v(t.nil),e}();o.modifying&&s(e),b(()=>function(e,i){let{gen:s}=e;s.if(t._`Array.isArray(${i})`,()=>{s.assign(r.default.vErrors,t._`${r.default.vErrors} === null ? ${i} : ${r.default.vErrors}.concat(${i})`).assign(r.default.errors,t._`${r.default.vErrors}.length`),(0,n.extendErrors)(e)},()=>e.error())}(e,i))}}),e.ok(null!==(l=o.valid)&&void 0!==l?l:y)},e.validSchemaType=function(e,t,r=!1){return!t.length||t.some(t=>"array"===t?Array.isArray(e):"object"===t?e&&"object"==typeof e&&!Array.isArray(e):typeof e==t||r&&typeof e>"u")},e.validateKeywordUsage=function({schema:e,opts:t,self:r,errSchemaPath:i},n,s){if(Array.isArray(n.keyword)?!n.keyword.includes(s):n.keyword!==s)throw new Error("ajv implementation error");let a=n.dependencies;if(a?.some(t=>!Object.prototype.hasOwnProperty.call(e,t)))throw new Error(`parent schema must have dependencies of ${s}: ${a.join(",")}`);if(n.validateSchema&&!n.validateSchema(e[s])){let e=`keyword "${s}" value is invalid at path "${i}": `+r.errorsText(n.validateSchema.errors);if("log"!==t.validateSchema)throw new Error(e);r.logger.error(e)}}}),Dt=u(e=>{Object.defineProperty(e,"__esModule",{value:!0}),e.extendSubschemaMode=e.extendSubschemaData=e.getSubschema=void 0;var t=Tt(),r=Pt();e.getSubschema=function(e,{keyword:i,schemaProp:n,schema:s,schemaPath:a,errSchemaPath:o,topSchemaRef:l}){if(void 0!==i&&void 0!==s)throw new Error('both "keyword" and "schema" passed, only one allowed');if(void 0!==i){let s=e.schema[i];return void 0===n?{schema:s,schemaPath:t._`${e.schemaPath}${(0,t.getProperty)(i)}`,errSchemaPath:`${e.errSchemaPath}/${i}`}:{schema:s[n],schemaPath:t._`${e.schemaPath}${(0,t.getProperty)(i)}${(0,t.getProperty)(n)}`,errSchemaPath:`${e.errSchemaPath}/${i}/${(0,r.escapeFragment)(n)}`}}if(void 0!==s){if(void 0===a||void 0===o||void 0===l)throw new Error('"schemaPath", "errSchemaPath" and "topSchemaRef" are required with "schema"');return{schema:s,schemaPath:a,topSchemaRef:l,errSchemaPath:o}}throw new Error('either "keyword" or "schema" must be passed')},e.extendSubschemaData=function(e,i,{dataProp:n,dataPropType:s,data:a,dataTypes:o,propertyName:l}){if(void 0!==a&&void 0!==n)throw new Error('both "data" and "dataProp" passed, only one allowed');let{gen:c}=i;if(void 0!==n){let{errorPath:a,dataPathArr:o,opts:l}=i;u(c.let("data",t._`${i.data}${(0,t.getProperty)(n)}`,!0)),e.errorPath=t.str`${a}${(0,r.getErrorPath)(n,s,l.jsPropertySyntax)}`,e.parentDataProperty=t._`${n}`,e.dataPathArr=[...o,e.parentDataProperty]}function u(t){e.data=t,e.dataLevel=i.dataLevel+1,e.dataTypes=[],i.definedProperties=new Set,e.parentData=i.data,e.dataNames=[...i.dataNames,t]}void 0!==a&&(u(a instanceof t.Name?a:c.let("data",a,!0)),void 0!==l&&(e.propertyName=l)),o&&(e.dataTypes=o)},e.extendSubschemaMode=function(e,{jtdDiscriminator:t,jtdMetadata:r,compositeRule:i,createErrors:n,allErrors:s}){void 0!==i&&(e.compositeRule=i),void 0!==n&&(e.createErrors=n),void 0!==s&&(e.allErrors=s),e.jtdDiscriminator=t,e.jtdMetadata=r}}),Ft=u((e,t)=>{var r=t.exports=function(e,t,r){"function"==typeof t&&(r=t,t={}),i(t,"function"==typeof(r=t.cb||r)?r:r.pre||function(){},r.post||function(){},e,"",e)};function i(e,t,s,a,o,l,c,u,d,p){if(a&&"object"==typeof a&&!Array.isArray(a)){for(var h in t(a,o,l,c,u,d,p),a){var f=a[h];if(Array.isArray(f)){if(h in r.arrayKeywords)for(var m=0;m<f.length;m++)i(e,t,s,f[m],o+"/"+h+"/"+m,l,o,h,a,m)}else if(h in r.propsKeywords){if(f&&"object"==typeof f)for(var g in f)i(e,t,s,f[g],o+"/"+h+"/"+n(g),l,o,h,a,g)}else(h in r.keywords||e.allKeys&&!(h in r.skipKeywords))&&i(e,t,s,f,o+"/"+h,l,o,h,a)}s(a,o,l,c,u,d,p)}}function n(e){return e.replace(/~/g,"~0").replace(/\//g,"~1")}r.keywords={additionalItems:!0,items:!0,contains:!0,additionalProperties:!0,propertyNames:!0,not:!0,if:!0,then:!0,else:!0},r.arrayKeywords={items:!0,allOf:!0,anyOf:!0,oneOf:!0},r.propsKeywords={$defs:!0,definitions:!0,properties:!0,patternProperties:!0,dependencies:!0},r.skipKeywords={default:!0,enum:!0,const:!0,required:!0,maximum:!0,minimum:!0,exclusiveMaximum:!0,exclusiveMinimum:!0,multipleOf:!0,maxLength:!0,minLength:!0,pattern:!0,format:!0,maxItems:!0,minItems:!0,uniqueItems:!0,maxProperties:!0,minProperties:!0}}),Mt=u(e=>{Object.defineProperty(e,"__esModule",{value:!0}),e.getSchemaRefs=e.resolveUrl=e.normalizeId=e._getFullPath=e.getFullPath=e.inlineRef=void 0;var t=Pt(),r=St(),i=Ft(),n=new Set(["type","format","pattern","maxLength","minLength","maxProperties","minProperties","maxItems","minItems","maximum","minimum","uniqueItems","multipleOf","required","enum","const"]);e.inlineRef=function(e,t=!0){return"boolean"==typeof e||(!0===t?!a(e):!!t&&o(e)<=t)};var s=new Set(["$ref","$recursiveRef","$recursiveAnchor","$dynamicRef","$dynamicAnchor"]);function a(e){for(let t in e){if(s.has(t))return!0;let r=e[t];if(Array.isArray(r)&&r.some(a)||"object"==typeof r&&a(r))return!0}return!1}function o(e){let r=0;for(let i in e){if("$ref"===i)return 1/0;if(r++,!n.has(i)&&("object"==typeof e[i]&&(0,t.eachItem)(e[i],e=>r+=o(e)),r===1/0))return 1/0}return r}function l(e,t="",r){!1!==r&&(t=d(t));let i=e.parse(t);return c(e,i)}function c(e,t){return e.serialize(t).split("#")[0]+"#"}e.getFullPath=l,e._getFullPath=c;var u=/#\/?$/;function d(e){return e?e.replace(u,""):""}e.normalizeId=d,e.resolveUrl=function(e,t,r){return r=d(r),e.resolve(t,r)};var p=/^[a-z_][-a-z0-9._]*$/i;e.getSchemaRefs=function(e,t){if("boolean"==typeof e)return{};let{schemaId:n,uriResolver:s}=this.opts,a=d(e[n]||t),o={"":a},c=l(s,a,!1),u={},h=new Set;return i(e,{allKeys:!0},(e,t,r,i)=>{if(void 0===i)return;let s=c+t,a=o[i];function l(t){if(t=d(a?(0,this.opts.uriResolver.resolve)(a,t):t),h.has(t))throw m(t);h.add(t);let r=this.refs[t];return"string"==typeof r&&(r=this.refs[r]),"object"==typeof r?f(e,r.schema,t):t!==d(s)&&("#"===t[0]?(f(e,u[t],t),u[t]=e):this.refs[t]=s),t}function g(e){if("string"==typeof e){if(!p.test(e))throw new Error(`invalid anchor "${e}"`);l.call(this,`#${e}`)}}"string"==typeof e[n]&&(a=l.call(this,e[n])),g.call(this,e.$anchor),g.call(this,e.$dynamicAnchor),o[t]=a}),u;function f(e,t,i){if(void 0!==t&&!r(e,t))throw m(i)}function m(e){return new Error(`reference "${e}" resolves to more than one schema`)}}}),zt=u(e=>{Object.defineProperty(e,"__esModule",{value:!0}),e.getData=e.KeywordCxt=e.validateFunctionCode=void 0;var t=$t(),r=Nt(),i=At(),n=Nt(),s=It(),a=Lt(),o=Dt(),l=Tt(),c=Rt(),u=Mt(),d=Pt(),p=Ot();function h({gen:e,validateName:t,schema:r,schemaEnv:i,opts:n},s){n.code.es5?e.func(t,l._`${c.default.data}, ${c.default.valCxt}`,i.$async,()=>{e.code(l._`"use strict"; ${f(r,n)}`),function(e,t){e.if(c.default.valCxt,()=>{e.var(c.default.instancePath,l._`${c.default.valCxt}.${c.default.instancePath}`),e.var(c.default.parentData,l._`${c.default.valCxt}.${c.default.parentData}`),e.var(c.default.parentDataProperty,l._`${c.default.valCxt}.${c.default.parentDataProperty}`),e.var(c.default.rootData,l._`${c.default.valCxt}.${c.default.rootData}`),t.dynamicRef&&e.var(c.default.dynamicAnchors,l._`${c.default.valCxt}.${c.default.dynamicAnchors}`)},()=>{e.var(c.default.instancePath,l._`""`),e.var(c.default.parentData,l._`undefined`),e.var(c.default.parentDataProperty,l._`undefined`),e.var(c.default.rootData,c.default.data),t.dynamicRef&&e.var(c.default.dynamicAnchors,l._`{}`)})}(e,n),e.code(s)}):e.func(t,l._`${c.default.data}, ${function(e){return l._`{${c.default.instancePath}="", ${c.default.parentData}, ${c.default.parentDataProperty}, ${c.default.rootData}=${c.default.data}${e.dynamicRef?l._`, ${c.default.dynamicAnchors}={}`:l.nil}}={}`}(n)}`,i.$async,()=>e.code(f(r,n)).code(s))}function f(e,t){let r="object"==typeof e&&e[t.schemaId];return r&&(t.code.source||t.code.process)?l._`/*# sourceURL=${r} */`:l.nil}function m({schema:e,self:t}){if("boolean"==typeof e)return!e;for(let r in e)if(t.RULES.all[r])return!0;return!1}function g(e){return"boolean"!=typeof e.schema}function y(e){(0,d.checkUnknownRules)(e),function(e){let{schema:t,errSchemaPath:r,opts:i,self:n}=e;t.$ref&&i.ignoreKeywordsWithRef&&(0,d.schemaHasRulesButRef)(t,n.RULES)&&n.logger.warn(`$ref: keywords ignored in schema at path "${r}"`)}(e)}function v(e,t){if(e.opts.jtd)return w(e,[],!1,t);let i=(0,r.getSchemaTypes)(e.schema);w(e,i,!(0,r.coerceAndCheckDataType)(e,i),t)}function b({gen:e,schemaEnv:t,schema:r,errSchemaPath:i,opts:n}){let s=r.$comment;if(!0===n.$comment)e.code(l._`${c.default.self}.logger.log(${s})`);else if("function"==typeof n.$comment){let r=l.str`${i}/$comment`,n=e.scopeValue("root",{ref:t.root});e.code(l._`${c.default.self}.opts.$comment(${s}, ${r}, ${n}.schema)`)}}function w(e,t,r,s){let{gen:a,schema:o,data:u,allErrors:p,opts:h,self:f}=e,{RULES:m}=f;function g(d){(0,i.shouldUseGroup)(o,d)&&(d.type?(a.if((0,n.checkDataType)(d.type,u,h.strictNumbers)),_(e,d),1===t.length&&t[0]===d.type&&r&&(a.else(),(0,n.reportTypeError)(e)),a.endIf()):_(e,d),p||a.if(l._`${c.default.errors} === ${s||0}`))}!o.$ref||!h.ignoreKeywordsWithRef&&(0,d.schemaHasRulesButRef)(o,m)?(h.jtd||function(e,t){e.schemaEnv.meta||!e.opts.strictTypes||(function(e,t){if(t.length){if(!e.dataTypes.length)return void(e.dataTypes=t);t.forEach(t=>{E(e.dataTypes,t)||k(e,`type "${t}" not allowed by context "${e.dataTypes.join(",")}"`)}),function(e,t){let r=[];for(let i of e.dataTypes)E(t,i)?r.push(i):t.includes("integer")&&"number"===i&&r.push("integer");e.dataTypes=r}(e,t)}}(e,t),e.opts.allowUnionTypes||function(e,t){t.length>1&&(2!==t.length||!t.includes("null"))&&k(e,"use allowUnionTypes to allow union type keyword")}(e,t),function(e,t){let r=e.self.RULES.all;for(let n in r){let s=r[n];if("object"==typeof s&&(0,i.shouldUseRule)(e.schema,s)){let{type:r}=s.definition;r.length&&!r.some(e=>S(t,e))&&k(e,`missing type "${r.join(",")}" for keyword "${n}"`)}}}(e,e.dataTypes))}(e,t),a.block(()=>{for(let e of m.rules)g(e);g(m.post)})):a.block(()=>T(e,"$ref",m.all.$ref.definition))}function _(e,t){let{gen:r,schema:n,opts:{useDefaults:a}}=e;a&&(0,s.assignDefaults)(e,t.type),r.block(()=>{for(let r of t.rules)(0,i.shouldUseRule)(n,r)&&T(e,r.keyword,r.definition,t.type)})}function S(e,t){return e.includes(t)||"number"===t&&e.includes("integer")}function E(e,t){return e.includes(t)||"integer"===t&&e.includes("number")}function k(e,t){(0,d.checkStrictMode)(e,t+=` at "${e.schemaEnv.baseId+e.errSchemaPath}" (strictTypes)`,e.opts.strictTypes)}e.validateFunctionCode=function(e){g(e)&&(y(e),m(e))?function(e){let{schema:t,opts:r,gen:i}=e;h(e,()=>{r.$comment&&t.$comment&&b(e),function(e){let{schema:t,opts:r}=e;void 0!==t.default&&r.useDefaults&&r.strictSchema&&(0,d.checkStrictMode)(e,"default is ignored in the schema root")}(e),i.let(c.default.vErrors,null),i.let(c.default.errors,0),r.unevaluated&&function(e){let{gen:t,validateName:r}=e;e.evaluated=t.const("evaluated",l._`${r}.evaluated`),t.if(l._`${e.evaluated}.dynamicProps`,()=>t.assign(l._`${e.evaluated}.props`,l._`undefined`)),t.if(l._`${e.evaluated}.dynamicItems`,()=>t.assign(l._`${e.evaluated}.items`,l._`undefined`))}(e),v(e),function(e){let{gen:t,schemaEnv:r,validateName:i,ValidationError:n,opts:s}=e;r.$async?t.if(l._`${c.default.errors} === 0`,()=>t.return(c.default.data),()=>t.throw(l._`new ${n}(${c.default.vErrors})`)):(t.assign(l._`${i}.errors`,c.default.vErrors),s.unevaluated&&function({gen:e,evaluated:t,props:r,items:i}){r instanceof l.Name&&e.assign(l._`${t}.props`,r),i instanceof l.Name&&e.assign(l._`${t}.items`,i)}(e),t.return(l._`${c.default.errors} === 0`))}(e)})}(e):h(e,()=>(0,t.topBoolOrEmptySchema)(e))};var x=class{constructor(e,t,r){if((0,a.validateKeywordUsage)(e,t,r),this.gen=e.gen,this.allErrors=e.allErrors,this.keyword=r,this.data=e.data,this.schema=e.schema[r],this.$data=t.$data&&e.opts.$data&&this.schema&&this.schema.$data,this.schemaValue=(0,d.schemaRefOrVal)(e,this.schema,r,this.$data),this.schemaType=t.schemaType,this.parentSchema=e.schema,this.params={},this.it=e,this.def=t,this.$data)this.schemaCode=e.gen.const("vSchema",O(this.$data,e));else if(this.schemaCode=this.schemaValue,!(0,a.validSchemaType)(this.schema,t.schemaType,t.allowUndefined))throw new Error(`${r} value must be ${JSON.stringify(t.schemaType)}`);("code"in t?t.trackErrors:!1!==t.errors)&&(this.errsCount=e.gen.const("_errs",c.default.errors))}result(e,t,r){this.failResult((0,l.not)(e),t,r)}failResult(e,t,r){this.gen.if(e),r?r():this.error(),t?(this.gen.else(),t(),this.allErrors&&this.gen.endIf()):this.allErrors?this.gen.endIf():this.gen.else()}pass(e,t){this.failResult((0,l.not)(e),void 0,t)}fail(e){if(void 0===e)return this.error(),void(this.allErrors||this.gen.if(!1));this.gen.if(e),this.error(),this.allErrors?this.gen.endIf():this.gen.else()}fail$data(e){if(!this.$data)return this.fail(e);let{schemaCode:t}=this;this.fail(l._`${t} !== undefined && (${(0,l.or)(this.invalid$data(),e)})`)}error(e,t,r){if(t)return this.setParams(t),this._error(e,r),void this.setParams({});this._error(e,r)}_error(e,t){(e?p.reportExtraError:p.reportError)(this,this.def.error,t)}$dataError(){(0,p.reportError)(this,this.def.$dataError||p.keyword$DataError)}reset(){if(void 0===this.errsCount)throw new Error('add "trackErrors" to keyword definition');(0,p.resetErrorsCount)(this.gen,this.errsCount)}ok(e){this.allErrors||this.gen.if(e)}setParams(e,t){t?Object.assign(this.params,e):this.params=e}block$data(e,t,r=l.nil){this.gen.block(()=>{this.check$data(e,r),t()})}check$data(e=l.nil,t=l.nil){if(!this.$data)return;let{gen:r,schemaCode:i,schemaType:n,def:s}=this;r.if((0,l.or)(l._`${i} === undefined`,t)),e!==l.nil&&r.assign(e,!0),(n.length||s.validateSchema)&&(r.elseIf(this.invalid$data()),this.$dataError(),e!==l.nil&&r.assign(e,!1)),r.else()}invalid$data(){let{gen:e,schemaCode:t,schemaType:r,def:i,it:s}=this;return(0,l.or)(function(){if(r.length){if(!(t instanceof l.Name))throw new Error("ajv implementation error");let e=Array.isArray(r)?r:[r];return l._`${(0,n.checkDataTypes)(e,t,s.opts.strictNumbers,n.DataType.Wrong)}`}return l.nil}(),function(){if(i.validateSchema){let r=e.scopeValue("validate$data",{ref:i.validateSchema});return l._`!${r}(${t})`}return l.nil}())}subschema(e,r){let i=(0,o.getSubschema)(this.it,e);(0,o.extendSubschemaData)(i,this.it,e),(0,o.extendSubschemaMode)(i,e);let n={...this.it,...i,items:void 0,props:void 0};return function(e,r){g(e)&&(y(e),m(e))?function(e,t){let{schema:r,gen:i,opts:n}=e;n.$comment&&r.$comment&&b(e),function(e){let t=e.schema[e.opts.schemaId];t&&(e.baseId=(0,u.resolveUrl)(e.opts.uriResolver,e.baseId,t))}(e),function(e){if(e.schema.$async&&!e.schemaEnv.$async)throw new Error("async schema in sync schema")}(e);let s=i.const("_errs",c.default.errors);v(e,s),i.var(t,l._`${s} === ${c.default.errors}`)}(e,r):(0,t.boolOrEmptySchema)(e,r)}(n,r),n}mergeEvaluated(e,t){let{it:r,gen:i}=this;r.opts.unevaluated&&(!0!==r.props&&void 0!==e.props&&(r.props=d.mergeEvaluated.props(i,e.props,r.props,t)),!0!==r.items&&void 0!==e.items&&(r.items=d.mergeEvaluated.items(i,e.items,r.items,t)))}mergeValidEvaluated(e,t){let{it:r,gen:i}=this;if(r.opts.unevaluated&&(!0!==r.props||!0!==r.items))return i.if(t,()=>this.mergeEvaluated(e,l.Name)),!0}};function T(e,t,r,i){let n=new x(e,r,t);"code"in r?r.code(n,i):n.$data&&r.validate?(0,a.funcKeywordCode)(n,r):"macro"in r?(0,a.macroKeywordCode)(n,r):(r.compile||r.validate)&&(0,a.funcKeywordCode)(n,r)}e.KeywordCxt=x;var P=/^\/(?:[^~]|~0|~1)*$/,R=/^([0-9]+)(#|\/(?:[^~]|~0|~1)*)?$/;function O(e,{dataLevel:t,dataNames:r,dataPathArr:i}){let n,s;if(""===e)return c.default.rootData;if("/"===e[0]){if(!P.test(e))throw new Error(`Invalid JSON-pointer: ${e}`);n=e,s=c.default.rootData}else{let a=R.exec(e);if(!a)throw new Error(`Invalid JSON-pointer: ${e}`);let o=+a[1];if(n=a[2],"#"===n){if(o>=t)throw new Error(u("property/index",o));return i[t-o]}if(o>t)throw new Error(u("data",o));if(s=r[t-o],!n)return s}let a=s,o=n.split("/");for(let e of o)e&&(s=l._`${s}${(0,l.getProperty)((0,d.unescapeJsonPointer)(e))}`,a=l._`${a} && ${s}`);return a;function u(e,r){return`Cannot access ${e} ${r} levels up, current level is ${t}`}}e.getData=O}),qt=u(e=>{Object.defineProperty(e,"__esModule",{value:!0});var t=class extends Error{constructor(e){super("validation failed"),this.errors=e,this.ajv=this.validation=!0}};e.default=t}),Ut=u(e=>{Object.defineProperty(e,"__esModule",{value:!0});var t=Mt(),r=class extends Error{constructor(e,r,i,n){super(n||`can't resolve reference ${i} from id ${r}`),this.missingRef=(0,t.resolveUrl)(e,r,i),this.missingSchema=(0,t.normalizeId)((0,t.getFullPath)(e,this.missingRef))}};e.default=r}),Bt=u(e=>{Object.defineProperty(e,"__esModule",{value:!0}),e.resolveSchema=e.getCompilingSchema=e.resolveRef=e.compileSchema=e.SchemaEnv=void 0;var t=Tt(),r=qt(),i=Rt(),n=Mt(),s=Pt(),a=zt(),o=class{constructor(e){var t;let r;this.refs={},this.dynamicAnchors={},"object"==typeof e.schema&&(r=e.schema),this.schema=e.schema,this.schemaId=e.schemaId,this.root=e.root||this,this.baseId=null!==(t=e.baseId)&&void 0!==t?t:(0,n.normalizeId)(r?.[e.schemaId||"$id"]),this.schemaPath=e.schemaPath,this.localRefs=e.localRefs,this.meta=e.meta,this.$async=r?.$async,this.refs={}}};function l(e){let s=u.call(this,e);if(s)return s;let o,l=(0,n.getFullPath)(this.opts.uriResolver,e.root.baseId),{es5:c,lines:d}=this.opts.code,{ownProperties:p}=this.opts,h=new t.CodeGen(this.scope,{es5:c,lines:d,ownProperties:p});e.$async&&(o=h.scopeValue("Error",{ref:r.default,code:t._`require("ajv/dist/runtime/validation_error").default`}));let f=h.scopeName("validate");e.validateName=f;let m,g={gen:h,allErrors:this.opts.allErrors,data:i.default.data,parentData:i.default.parentData,parentDataProperty:i.default.parentDataProperty,dataNames:[i.default.data],dataPathArr:[t.nil],dataLevel:0,dataTypes:[],definedProperties:new Set,topSchemaRef:h.scopeValue("schema",!0===this.opts.code.source?{ref:e.schema,code:(0,t.stringify)(e.schema)}:{ref:e.schema}),validateName:f,ValidationError:o,schema:e.schema,schemaEnv:e,rootId:l,baseId:e.baseId||l,schemaPath:t.nil,errSchemaPath:e.schemaPath||(this.opts.jtd?"":"#"),errorPath:t._`""`,opts:this.opts,self:this};try{this._compilations.add(e),(0,a.validateFunctionCode)(g),h.optimize(this.opts.code.optimize);let r=h.toString();m=`${h.scopeRefs(i.default.scope)}return ${r}`,this.opts.code.process&&(m=this.opts.code.process(m,e));let n=new Function(`${i.default.self}`,`${i.default.scope}`,m)(this,this.scope.get());if(this.scope.value(f,{ref:n}),n.errors=null,n.schema=e.schema,n.schemaEnv=e,e.$async&&(n.$async=!0),!0===this.opts.code.source&&(n.source={validateName:f,validateCode:r,scopeValues:h._values}),this.opts.unevaluated){let{props:e,items:r}=g;n.evaluated={props:e instanceof t.Name?void 0:e,items:r instanceof t.Name?void 0:r,dynamicProps:e instanceof t.Name,dynamicItems:r instanceof t.Name},n.source&&(n.source.evaluated=(0,t.stringify)(n.evaluated))}return e.validate=n,e}catch(t){throw delete e.validate,delete e.validateName,m&&this.logger.error("Error compiling schema, function code:",m),t}finally{this._compilations.delete(e)}}function c(e){return(0,n.inlineRef)(e.schema,this.opts.inlineRefs)?e.schema:e.validate?e:l.call(this,e)}function u(e){for(let t of this._compilations)if(d(t,e))return t}function d(e,t){return e.schema===t.schema&&e.root===t.root&&e.baseId===t.baseId}function p(e,t){let r;for(;"string"==typeof(r=this.refs[t]);)t=r;return r||this.schemas[t]||h.call(this,e,t)}function h(e,t){let r=this.opts.uriResolver.parse(t),i=(0,n._getFullPath)(this.opts.uriResolver,r),s=(0,n.getFullPath)(this.opts.uriResolver,e.baseId,void 0);if(Object.keys(e.schema).length>0&&i===s)return m.call(this,r,e);let a=(0,n.normalizeId)(i),c=this.refs[a]||this.schemas[a];if("string"==typeof c){let t=h.call(this,e,c);return"object"!=typeof t?.schema?void 0:m.call(this,r,t)}if("object"==typeof c?.schema){if(c.validate||l.call(this,c),a===(0,n.normalizeId)(t)){let{schema:t}=c,{schemaId:r}=this.opts,i=t[r];return i&&(s=(0,n.resolveUrl)(this.opts.uriResolver,s,i)),new o({schema:t,schemaId:r,root:e,baseId:s})}return m.call(this,r,c)}}e.SchemaEnv=o,e.compileSchema=l,e.resolveRef=function(e,t,r){var i;r=(0,n.resolveUrl)(this.opts.uriResolver,t,r);let s=e.refs[r];if(s)return s;let a=p.call(this,e,r);if(void 0===a){let n=null===(i=e.localRefs)||void 0===i?void 0:i[r],{schemaId:s}=this.opts;n&&(a=new o({schema:n,schemaId:s,root:e,baseId:t}))}return void 0!==a?e.refs[r]=c.call(this,a):void 0},e.getCompilingSchema=u,e.resolveSchema=h;var f=new Set(["properties","patternProperties","enum","dependencies","definitions"]);function m(e,{baseId:t,schema:r,root:i}){var a;if("/"!==(null===(a=e.fragment)||void 0===a?void 0:a[0]))return;for(let i of e.fragment.slice(1).split("/")){if("boolean"==typeof r)return;let e=r[(0,s.unescapeFragment)(i)];if(void 0===e)return;let a="object"==typeof(r=e)&&r[this.opts.schemaId];!f.has(i)&&a&&(t=(0,n.resolveUrl)(this.opts.uriResolver,t,a))}let l;if("boolean"!=typeof r&&r.$ref&&!(0,s.schemaHasRulesButRef)(r,this.RULES)){let e=(0,n.resolveUrl)(this.opts.uriResolver,t,r.$ref);l=h.call(this,i,e)}let{schemaId:c}=this.opts;return l=l||new o({schema:r,schemaId:c,root:i,baseId:t}),l.schema!==l.root.schema?l:void 0}}),Ht=u((e,t)=>{t.exports={$id:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#",description:"Meta-schema for $data reference (JSON AnySchema extension proposal)",type:"object",required:["$data"],properties:{$data:{type:"string",anyOf:[{format:"relative-json-pointer"},{format:"json-pointer"}]}},additionalProperties:!1}}),Vt=u((e,t)=>{var r=RegExp.prototype.test.bind(/^[\da-f]{8}-[\da-f]{4}-[\da-f]{4}-[\da-f]{4}-[\da-f]{12}$/iu),i=RegExp.prototype.test.bind(/^(?:(?:25[0-5]|2[0-4]\d|1\d{2}|[1-9]\d|\d)\.){3}(?:25[0-5]|2[0-4]\d|1\d{2}|[1-9]\d|\d)$/u);function n(e){let t="",r=0,i=0;for(i=0;i<e.length;i++)if(r=e[i].charCodeAt(0),48!==r){if(!(r>=48&&r<=57||r>=65&&r<=70||r>=97&&r<=102))return"";t+=e[i];break}for(i+=1;i<e.length;i++){if(r=e[i].charCodeAt(0),!(r>=48&&r<=57||r>=65&&r<=70||r>=97&&r<=102))return"";t+=e[i]}return t}var s=RegExp.prototype.test.bind(/[^!"$&'()*+,\-.;=_`a-z{}~]/u);function a(e){return e.length=0,!0}function o(e,t,r){if(e.length){let i=n(e);if(""===i)return r.error=!0,!1;t.push(i),e.length=0}return!0}function l(e){if(function(e){let t=0;for(let r=0;r<e.length;r++)":"===e[r]&&t++;return t}(e)<2)return{host:e,isIPV6:!1};let t=function(e){let t=0,r={error:!1,address:"",zone:""},i=[],s=[],l=!1,c=!1,u=o;for(let n=0;n<e.length;n++){let o=e[n];if("["!==o&&"]"!==o){if(":"===o){if(!0===l&&(c=!0),!u(s,i,r))break;if(++t>7){r.error=!0;break}n>0&&":"===e[n-1]&&(l=!0),i.push(":");continue}if("%"!==o){s.push(o);continue}if(!u(s,i,r))break;u=a}}return s.length&&(u===a?r.zone=s.join(""):i.push(c?s.join(""):n(s))),r.address=i.join(""),r}(e);if(t.error)return{host:e,isIPV6:!1};{let e=t.address,r=t.address;return t.zone&&(e+="%"+t.zone,r+="%25"+t.zone),{host:e,isIPV6:!0,escapedHost:r}}}t.exports={nonSimpleDomain:s,recomposeAuthority:function(e){let t=[];if(void 0!==e.userinfo&&(t.push(e.userinfo),t.push("@")),void 0!==e.host){let r=unescape(e.host);if(!i(r)){let t=l(r);r=!0===t.isIPV6?`[${t.escapedHost}]`:e.host}t.push(r)}return("number"==typeof e.port||"string"==typeof e.port)&&(t.push(":"),t.push(String(e.port))),t.length?t.join(""):void 0},normalizeComponentEncoding:function(e,t){let r=!0!==t?escape:unescape;return void 0!==e.scheme&&(e.scheme=r(e.scheme)),void 0!==e.userinfo&&(e.userinfo=r(e.userinfo)),void 0!==e.host&&(e.host=r(e.host)),void 0!==e.path&&(e.path=r(e.path)),void 0!==e.query&&(e.query=r(e.query)),void 0!==e.fragment&&(e.fragment=r(e.fragment)),e},removeDotSegments:function(e){let t=e,r=[],i=-1,n=0;for(;n=t.length;){if(1===n){if("."===t)break;if("/"===t){r.push("/");break}r.push(t);break}if(2===n){if("."===t[0]){if("."===t[1])break;if("/"===t[1]){t=t.slice(2);continue}}else if("/"===t[0]&&("."===t[1]||"/"===t[1])){r.push("/");break}}else if(3===n&&"/.."===t){0!==r.length&&r.pop(),r.push("/");break}if("."===t[0]){if("."===t[1]){if("/"===t[2]){t=t.slice(3);continue}}else if("/"===t[1]){t=t.slice(2);continue}}else if("/"===t[0]&&"."===t[1]){if("/"===t[2]){t=t.slice(2);continue}if("."===t[2]&&"/"===t[3]){t=t.slice(3),0!==r.length&&r.pop();continue}}if(-1===(i=t.indexOf("/",1))){r.push(t);break}r.push(t.slice(0,i)),t=t.slice(i)}return r.join("")},isIPv4:i,isUUID:r,normalizeIPv6:l,stringArrayToHexStripped:n}}),Gt=u((e,t)=>{var{isUUID:r}=Vt(),i=/([\da-z][\d\-a-z]{0,31}):((?:[\w!$'()*+,\-.:;=@]|%[\da-f]{2})+)/iu,n=["http","https","ws","wss","urn","urn:uuid"];function s(e){return!0===e.secure||!1!==e.secure&&!!e.scheme&&!(3!==e.scheme.length||"w"!==e.scheme[0]&&"W"!==e.scheme[0]||"s"!==e.scheme[1]&&"S"!==e.scheme[1]||"s"!==e.scheme[2]&&"S"!==e.scheme[2])}function a(e){return e.host||(e.error=e.error||"HTTP URIs must have a host."),e}function o(e){let t="https"===String(e.scheme).toLowerCase();return(e.port===(t?443:80)||""===e.port)&&(e.port=void 0),e.path||(e.path="/"),e}var l={scheme:"http",domainHost:!0,parse:a,serialize:o},c={scheme:"ws",domainHost:!0,parse:function(e){return e.secure=s(e),e.resourceName=(e.path||"/")+(e.query?"?"+e.query:""),e.path=void 0,e.query=void 0,e},serialize:function(e){if((e.port===(s(e)?443:80)||""===e.port)&&(e.port=void 0),"boolean"==typeof e.secure&&(e.scheme=e.secure?"wss":"ws",e.secure=void 0),e.resourceName){let[t,r]=e.resourceName.split("?");e.path=t&&"/"!==t?t:void 0,e.query=r,e.resourceName=void 0}return e.fragment=void 0,e}},u={scheme:"urn",parse:function(e,t){if(!e.path)return e.error="URN can not be parsed",e;let r=e.path.match(i);if(r){let i=t.scheme||e.scheme||"urn";e.nid=r[1].toLowerCase(),e.nss=r[2];let n=h(`${i}:${t.nid||e.nid}`);e.path=void 0,n&&(e=n.parse(e,t))}else e.error=e.error||"URN can not be parsed.";return e},serialize:function(e,t){if(void 0===e.nid)throw new Error("URN without nid cannot be serialized");let r=t.scheme||e.scheme||"urn",i=e.nid.toLowerCase(),n=h(`${r}:${t.nid||i}`);n&&(e=n.serialize(e,t));let s=e;return s.path=`${i||t.nid}:${e.nss}`,t.skipEscape=!0,s},skipNormalize:!0},d={scheme:"urn:uuid",parse:function(e,t){let i=e;return i.uuid=i.nss,i.nss=void 0,!t.tolerant&&(!i.uuid||!r(i.uuid))&&(i.error=i.error||"UUID is not valid."),i},serialize:function(e){let t=e;return t.nss=(e.uuid||"").toLowerCase(),t},skipNormalize:!0},p={http:l,https:{scheme:"https",domainHost:l.domainHost,parse:a,serialize:o},ws:c,wss:{scheme:"wss",domainHost:c.domainHost,parse:c.parse,serialize:c.serialize},urn:u,"urn:uuid":d};function h(e){return e&&(p[e]||p[e.toLowerCase()])||void 0}Object.setPrototypeOf(p,null),t.exports={wsIsSecure:s,SCHEMES:p,isValidSchemeName:function(e){return-1!==n.indexOf(e)},getSchemeHandler:h}}),Wt=u((e,t)=>{var{normalizeIPv6:r,removeDotSegments:i,recomposeAuthority:n,normalizeComponentEncoding:s,isIPv4:a,nonSimpleDomain:o}=Vt(),{SCHEMES:l,getSchemeHandler:c}=Gt();function u(e,t,r,n){let s={};return n||(e=h(d(e,r),r),t=h(d(t,r),r)),!(r=r||{}).tolerant&&t.scheme?(s.scheme=t.scheme,s.userinfo=t.userinfo,s.host=t.host,s.port=t.port,s.path=i(t.path||""),s.query=t.query):(void 0!==t.userinfo||void 0!==t.host||void 0!==t.port?(s.userinfo=t.userinfo,s.host=t.host,s.port=t.port,s.path=i(t.path||""),s.query=t.query):(t.path?("/"===t.path[0]?s.path=i(t.path):(s.path=void 0===e.userinfo&&void 0===e.host&&void 0===e.port||e.path?e.path?e.path.slice(0,e.path.lastIndexOf("/")+1)+t.path:t.path:"/"+t.path,s.path=i(s.path)),s.query=t.query):(s.path=e.path,s.query=void 0!==t.query?t.query:e.query),s.userinfo=e.userinfo,s.host=e.host,s.port=e.port),s.scheme=e.scheme),s.fragment=t.fragment,s}function d(e,t){let r={host:e.host,scheme:e.scheme,userinfo:e.userinfo,port:e.port,path:e.path,query:e.query,nid:e.nid,nss:e.nss,uuid:e.uuid,fragment:e.fragment,reference:e.reference,resourceName:e.resourceName,secure:e.secure,error:""},s=Object.assign({},t),a=[],o=c(s.scheme||r.scheme);o&&o.serialize&&o.serialize(r,s),void 0!==r.path&&(s.skipEscape?r.path=unescape(r.path):(r.path=escape(r.path),void 0!==r.scheme&&(r.path=r.path.split("%3A").join(":")))),"suffix"!==s.reference&&r.scheme&&a.push(r.scheme,":");let l=n(r);if(void 0!==l&&("suffix"!==s.reference&&a.push("//"),a.push(l),r.path&&"/"!==r.path[0]&&a.push("/")),void 0!==r.path){let e=r.path;!s.absolutePath&&(!o||!o.absolutePath)&&(e=i(e)),void 0===l&&"/"===e[0]&&"/"===e[1]&&(e="/%2F"+e.slice(2)),a.push(e)}return void 0!==r.query&&a.push("?",r.query),void 0!==r.fragment&&a.push("#",r.fragment),a.join("")}var p=/^(?:([^#/:?]+):)?(?:\/\/((?:([^#/?@]*)@)?(\[[^#/?\]]+\]|[^#/:?]*)(?::(\d*))?))?([^#?]*)(?:\?([^#]*))?(?:#((?:.|[\n\r])*))?/u;function h(e,t){let i=Object.assign({},t),n={scheme:void 0,userinfo:void 0,host:"",port:void 0,path:"",query:void 0,fragment:void 0},s=!1;"suffix"===i.reference&&(e=i.scheme?i.scheme+":"+e:"//"+e);let l=e.match(p);if(l){if(n.scheme=l[1],n.userinfo=l[3],n.host=l[4],n.port=parseInt(l[5],10),n.path=l[6]||"",n.query=l[7],n.fragment=l[8],isNaN(n.port)&&(n.port=l[5]),n.host)if(!1===a(n.host)){let e=r(n.host);n.host=e.host.toLowerCase(),s=e.isIPV6}else s=!0;n.reference=void 0!==n.scheme||void 0!==n.userinfo||void 0!==n.host||void 0!==n.port||void 0!==n.query||n.path?void 0===n.scheme?"relative":void 0===n.fragment?"absolute":"uri":"same-document",i.reference&&"suffix"!==i.reference&&i.reference!==n.reference&&(n.error=n.error||"URI is not a "+i.reference+" reference.");let t=c(i.scheme||n.scheme);if(!i.unicodeSupport&&(!t||!t.unicodeSupport)&&n.host&&(i.domainHost||t&&t.domainHost)&&!1===s&&o(n.host))try{n.host=URL.domainToASCII(n.host.toLowerCase())}catch(e){n.error=n.error||"Host's domain name can not be converted to ASCII: "+e}(!t||t&&!t.skipNormalize)&&(-1!==e.indexOf("%")&&(void 0!==n.scheme&&(n.scheme=unescape(n.scheme)),void 0!==n.host&&(n.host=unescape(n.host))),n.path&&(n.path=escape(unescape(n.path))),n.fragment&&(n.fragment=encodeURI(decodeURIComponent(n.fragment)))),t&&t.parse&&t.parse(n,i)}else n.error=n.error||"URI can not be parsed.";return n}var f={SCHEMES:l,normalize:function(e,t){return"string"==typeof e?e=d(h(e,t),t):"object"==typeof e&&(e=h(d(e,t),t)),e},resolve:function(e,t,r){let i=r?Object.assign({scheme:"null"},r):{scheme:"null"},n=u(h(e,i),h(t,i),i,!0);return i.skipEscape=!0,d(n,i)},resolveComponent:u,equal:function(e,t,r){return"string"==typeof e?(e=unescape(e),e=d(s(h(e,r),!0),{...r,skipEscape:!0})):"object"==typeof e&&(e=d(s(e,!0),{...r,skipEscape:!0})),"string"==typeof t?(t=unescape(t),t=d(s(h(t,r),!0),{...r,skipEscape:!0})):"object"==typeof t&&(t=d(s(t,!0),{...r,skipEscape:!0})),e.toLowerCase()===t.toLowerCase()},serialize:d,parse:h};t.exports=f,t.exports.default=f,t.exports.fastUri=f}),Kt=u(e=>{Object.defineProperty(e,"__esModule",{value:!0});var t=Wt();t.code='require("ajv/dist/runtime/uri").default',e.default=t}),Jt=u(e=>{Object.defineProperty(e,"__esModule",{value:!0}),e.CodeGen=e.Name=e.nil=e.stringify=e.str=e._=e.KeywordCxt=void 0;var t=zt();Object.defineProperty(e,"KeywordCxt",{enumerable:!0,get:function(){return t.KeywordCxt}});var r=Tt();Object.defineProperty(e,"_",{enumerable:!0,get:function(){return r._}}),Object.defineProperty(e,"str",{enumerable:!0,get:function(){return r.str}}),Object.defineProperty(e,"stringify",{enumerable:!0,get:function(){return r.stringify}}),Object.defineProperty(e,"nil",{enumerable:!0,get:function(){return r.nil}}),Object.defineProperty(e,"Name",{enumerable:!0,get:function(){return r.Name}}),Object.defineProperty(e,"CodeGen",{enumerable:!0,get:function(){return r.CodeGen}});var i=qt(),n=Ut(),s=Ct(),a=Bt(),o=Tt(),l=Mt(),c=Nt(),u=Pt(),d=Ht(),p=Kt(),h=(e,t)=>new RegExp(e,t);h.code="new RegExp";var f=["removeAdditional","useDefaults","coerceTypes"],m=new Set(["validate","serialize","parse","wrapper","root","schema","keyword","pattern","formats","validate$data","func","obj","Error"]),g={errorDataPath:"",format:"`validateFormats: false` can be used instead.",nullable:'"nullable" keyword is supported by default.',jsonPointers:"Deprecated jsPropertySyntax can be used instead.",extendRefs:"Deprecated ignoreKeywordsWithRef can be used instead.",missingRefs:"Pass empty schema with $id that should be ignored to ajv.addSchema.",processCode:"Use option `code: {process: (code, schemaEnv: object) => string}`",sourceCode:"Use option `code: {source: true}`",strictDefaults:"It is default now, see option `strict`.",strictKeywords:"It is default now, see option `strict`.",uniqueItems:'"uniqueItems" keyword is always validated.',unknownFormats:"Disable strict mode or pass `true` to `ajv.addFormat` (or `formats` option).",cache:"Map is used as cache, schema object as key.",serialize:"Map is used as cache, schema object as key.",ajvErrors:"It is default now."},y={ignoreKeywordsWithRef:"",jsPropertySyntax:"",unicode:'"minLength"/"maxLength" account for unicode characters by default.'};function v(e){var t,r,i,n,s,a,o,l,c,u,d,f,m,g,y,v,b,w,_,S,E,k,x,T,P;let R=e.strict,O=null===(t=e.code)||void 0===t?void 0:t.optimize,$=!0===O||void 0===O?1:O||0,C=null!==(i=null===(r=e.code)||void 0===r?void 0:r.regExp)&&void 0!==i?i:h,A=null!==(n=e.uriResolver)&&void 0!==n?n:p.default;return{strictSchema:null===(a=null!==(s=e.strictSchema)&&void 0!==s?s:R)||void 0===a||a,strictNumbers:null===(l=null!==(o=e.strictNumbers)&&void 0!==o?o:R)||void 0===l||l,strictTypes:null!==(u=null!==(c=e.strictTypes)&&void 0!==c?c:R)&&void 0!==u?u:"log",strictTuples:null!==(f=null!==(d=e.strictTuples)&&void 0!==d?d:R)&&void 0!==f?f:"log",strictRequired:null!==(g=null!==(m=e.strictRequired)&&void 0!==m?m:R)&&void 0!==g&&g,code:e.code?{...e.code,optimize:$,regExp:C}:{optimize:$,regExp:C},loopRequired:null!==(y=e.loopRequired)&&void 0!==y?y:200,loopEnum:null!==(v=e.loopEnum)&&void 0!==v?v:200,meta:null===(b=e.meta)||void 0===b||b,messages:null===(w=e.messages)||void 0===w||w,inlineRefs:null===(_=e.inlineRefs)||void 0===_||_,schemaId:null!==(S=e.schemaId)&&void 0!==S?S:"$id",addUsedSchema:null===(E=e.addUsedSchema)||void 0===E||E,validateSchema:null===(k=e.validateSchema)||void 0===k||k,validateFormats:null===(x=e.validateFormats)||void 0===x||x,unicodeRegExp:null===(T=e.unicodeRegExp)||void 0===T||T,int32range:null===(P=e.int32range)||void 0===P||P,uriResolver:A}}var b=class{constructor(e={}){this.schemas={},this.refs={},this.formats={},this._compilations=new Set,this._loading={},this._cache=new Map,e=this.opts={...e,...v(e)};let{es5:t,lines:r}=this.opts.code;this.scope=new o.ValueScope({scope:{},prefixes:m,es5:t,lines:r}),this.logger=function(e){if(!1===e)return T;if(void 0===e)return console;if(e.log&&e.warn&&e.error)return e;throw new Error("logger must implement log, warn and error methods")}(e.logger);let i=e.validateFormats;e.validateFormats=!1,this.RULES=(0,s.getRules)(),w.call(this,g,e,"NOT SUPPORTED"),w.call(this,y,e,"DEPRECATED","warn"),this._metaOpts=x.call(this),e.formats&&E.call(this),this._addVocabularies(),this._addDefaultMetaSchema(),e.keywords&&k.call(this,e.keywords),"object"==typeof e.meta&&this.addMetaSchema(e.meta),S.call(this),e.validateFormats=i}_addVocabularies(){this.addKeyword("$async")}_addDefaultMetaSchema(){let{$data:e,meta:t,schemaId:r}=this.opts,i=d;"id"===r&&(i={...d},i.id=i.$id,delete i.$id),t&&e&&this.addMetaSchema(i,i[r],!1)}defaultMeta(){let{meta:e,schemaId:t}=this.opts;return this.opts.defaultMeta="object"==typeof e?e[t]||e:void 0}validate(e,t){let r;if("string"==typeof e){if(r=this.getSchema(e),!r)throw new Error(`no schema with key or ref "${e}"`)}else r=this.compile(e);let i=r(t);return"$async"in r||(this.errors=r.errors),i}compile(e,t){let r=this._addSchema(e,t);return r.validate||this._compileSchemaEnv(r)}compileAsync(e,t){if("function"!=typeof this.opts.loadSchema)throw new Error("options.loadSchema should be a function");let{loadSchema:r}=this.opts;return i.call(this,e,t);async function i(e,t){await s.call(this,e.$schema);let r=this._addSchema(e,t);return r.validate||a.call(this,r)}async function s(e){e&&!this.getSchema(e)&&await i.call(this,{$ref:e},!0)}async function a(e){try{return this._compileSchemaEnv(e)}catch(t){if(!(t instanceof n.default))throw t;return o.call(this,t),await l.call(this,t.missingSchema),a.call(this,e)}}function o({missingSchema:e,missingRef:t}){if(this.refs[e])throw new Error(`AnySchema ${e} is loaded but ${t} cannot be resolved`)}async function l(e){let r=await c.call(this,e);this.refs[e]||await s.call(this,r.$schema),this.refs[e]||this.addSchema(r,e,t)}async function c(e){let t=this._loading[e];if(t)return t;try{return await(this._loading[e]=r(e))}finally{delete this._loading[e]}}}addSchema(e,t,r,i=this.opts.validateSchema){if(Array.isArray(e)){for(let t of e)this.addSchema(t,void 0,r,i);return this}let n;if("object"==typeof e){let{schemaId:t}=this.opts;if(n=e[t],void 0!==n&&"string"!=typeof n)throw new Error(`schema ${t} must be string`)}return t=(0,l.normalizeId)(t||n),this._checkUnique(t),this.schemas[t]=this._addSchema(e,r,t,i,!0),this}addMetaSchema(e,t,r=this.opts.validateSchema){return this.addSchema(e,t,!0,r),this}validateSchema(e,t){if("boolean"==typeof e)return!0;let r;if(r=e.$schema,void 0!==r&&"string"!=typeof r)throw new Error("$schema must be a string");if(r=r||this.opts.defaultMeta||this.defaultMeta(),!r)return this.logger.warn("meta-schema not available"),this.errors=null,!0;let i=this.validate(r,e);if(!i&&t){let e="schema is invalid: "+this.errorsText();if("log"!==this.opts.validateSchema)throw new Error(e);this.logger.error(e)}return i}getSchema(e){let t;for(;"string"==typeof(t=_.call(this,e));)e=t;if(void 0===t){let{schemaId:r}=this.opts,i=new a.SchemaEnv({schema:{},schemaId:r});if(t=a.resolveSchema.call(this,i,e),!t)return;this.refs[e]=t}return t.validate||this._compileSchemaEnv(t)}removeSchema(e){if(e instanceof RegExp)return this._removeAllSchemas(this.schemas,e),this._removeAllSchemas(this.refs,e),this;switch(typeof e){case"undefined":return this._removeAllSchemas(this.schemas),this._removeAllSchemas(this.refs),this._cache.clear(),this;case"string":{let t=_.call(this,e);return"object"==typeof t&&this._cache.delete(t.schema),delete this.schemas[e],delete this.refs[e],this}case"object":{this._cache.delete(e);let t=e[this.opts.schemaId];return t&&(t=(0,l.normalizeId)(t),delete this.schemas[t],delete this.refs[t]),this}default:throw new Error("ajv.removeSchema: invalid parameter")}}addVocabulary(e){for(let t of e)this.addKeyword(t);return this}addKeyword(e,t){let r;if("string"==typeof e)r=e,"object"==typeof t&&(this.logger.warn("these parameters are deprecated, see docs for addKeyword"),t.keyword=r);else{if("object"!=typeof e||void 0!==t)throw new Error("invalid addKeywords parameters");if(r=(t=e).keyword,Array.isArray(r)&&!r.length)throw new Error("addKeywords: keyword must be string or non-empty array")}if(R.call(this,r,t),!t)return(0,u.eachItem)(r,e=>O.call(this,e)),this;C.call(this,t);let i={...t,type:(0,c.getJSONTypes)(t.type),schemaType:(0,c.getJSONTypes)(t.schemaType)};return(0,u.eachItem)(r,0===i.type.length?e=>O.call(this,e,i):e=>i.type.forEach(t=>O.call(this,e,i,t))),this}getKeyword(e){let t=this.RULES.all[e];return"object"==typeof t?t.definition:!!t}removeKeyword(e){let{RULES:t}=this;delete t.keywords[e],delete t.all[e];for(let r of t.rules){let t=r.rules.findIndex(t=>t.keyword===e);t>=0&&r.rules.splice(t,1)}return this}addFormat(e,t){return"string"==typeof t&&(t=new RegExp(t)),this.formats[e]=t,this}errorsText(e=this.errors,{separator:t=", ",dataVar:r="data"}={}){return e&&0!==e.length?e.map(e=>`${r}${e.instancePath} ${e.message}`).reduce((e,r)=>e+t+r):"No errors"}$dataMetaSchema(e,t){let r=this.RULES.all;e=JSON.parse(JSON.stringify(e));for(let i of t){let t=i.split("/").slice(1),n=e;for(let e of t)n=n[e];for(let e in r){let t=r[e];if("object"!=typeof t)continue;let{$data:i}=t.definition,s=n[e];i&&s&&(n[e]=N(s))}}return e}_removeAllSchemas(e,t){for(let r in e){let i=e[r];(!t||t.test(r))&&("string"==typeof i?delete e[r]:i&&!i.meta&&(this._cache.delete(i.schema),delete e[r]))}}_addSchema(e,t,r,i=this.opts.validateSchema,n=this.opts.addUsedSchema){let s,{schemaId:o}=this.opts;if("object"==typeof e)s=e[o];else{if(this.opts.jtd)throw new Error("schema must be object");if("boolean"!=typeof e)throw new Error("schema must be object or boolean")}let c=this._cache.get(e);if(void 0!==c)return c;r=(0,l.normalizeId)(s||r);let u=l.getSchemaRefs.call(this,e,r);return c=new a.SchemaEnv({schema:e,schemaId:o,meta:t,baseId:r,localRefs:u}),this._cache.set(c.schema,c),n&&!r.startsWith("#")&&(r&&this._checkUnique(r),this.refs[r]=c),i&&this.validateSchema(e,!0),c}_checkUnique(e){if(this.schemas[e]||this.refs[e])throw new Error(`schema with key or id "${e}" already exists`)}_compileSchemaEnv(e){if(e.meta?this._compileMetaSchema(e):a.compileSchema.call(this,e),!e.validate)throw new Error("ajv implementation error");return e.validate}_compileMetaSchema(e){let t=this.opts;this.opts=this._metaOpts;try{a.compileSchema.call(this,e)}finally{this.opts=t}}};function w(e,t,r,i="error"){for(let n in e)n in t&&this.logger[i](`${r}: option ${n}. ${e[n]}`)}function _(e){return e=(0,l.normalizeId)(e),this.schemas[e]||this.refs[e]}function S(){let e=this.opts.schemas;if(e)if(Array.isArray(e))this.addSchema(e);else for(let t in e)this.addSchema(e[t],t)}function E(){for(let e in this.opts.formats){let t=this.opts.formats[e];t&&this.addFormat(e,t)}}function k(e){if(Array.isArray(e))this.addVocabulary(e);else{this.logger.warn("keywords option as map is deprecated, pass array");for(let t in e){let r=e[t];r.keyword||(r.keyword=t),this.addKeyword(r)}}}function x(){let e={...this.opts};for(let t of f)delete e[t];return e}b.ValidationError=i.default,b.MissingRefError=n.default,e.default=b;var T={log(){},warn(){},error(){}},P=/^[a-z_$][a-z0-9_$:-]*$/i;function R(e,t){let{RULES:r}=this;if((0,u.eachItem)(e,e=>{if(r.keywords[e])throw new Error(`Keyword ${e} is already defined`);if(!P.test(e))throw new Error(`Keyword ${e} has invalid name`)}),t&&t.$data&&!("code"in t)&&!("validate"in t))throw new Error('$data keyword must have "code" or "validate" function')}function O(e,t,r){var i;let n=t?.post;if(r&&n)throw new Error('keyword with "post" flag cannot have "type"');let{RULES:s}=this,a=n?s.post:s.rules.find(({type:e})=>e===r);if(a||(a={type:r,rules:[]},s.rules.push(a)),s.keywords[e]=!0,!t)return;let o={keyword:e,definition:{...t,type:(0,c.getJSONTypes)(t.type),schemaType:(0,c.getJSONTypes)(t.schemaType)}};t.before?$.call(this,a,o,t.before):a.rules.push(o),s.all[e]=o,null===(i=t.implements)||void 0===i||i.forEach(e=>this.addKeyword(e))}function $(e,t,r){let i=e.rules.findIndex(e=>e.keyword===r);i>=0?e.rules.splice(i,0,t):(e.rules.push(t),this.logger.warn(`rule ${r} is not defined`))}function C(e){let{metaSchema:t}=e;void 0!==t&&(e.$data&&this.opts.$data&&(t=N(t)),e.validateSchema=this.compile(t,!0))}var A={$ref:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#"};function N(e){return{anyOf:[e,A]}}}),Zt=u(e=>{Object.defineProperty(e,"__esModule",{value:!0}),e.default={keyword:"id",code(){throw new Error('NOT SUPPORTED: keyword "id", use "$id" for schema ID')}}}),Yt=u(e=>{Object.defineProperty(e,"__esModule",{value:!0}),e.callRef=e.getValidate=void 0;var t=Ut(),r=jt(),i=Tt(),n=Rt(),s=Bt(),a=Pt(),o={keyword:"$ref",schemaType:"string",code(e){let{gen:r,schema:n,it:a}=e,{baseId:o,schemaEnv:u,validateName:d,opts:p,self:h}=a,{root:f}=u;if(("#"===n||"#/"===n)&&o===f.baseId)return function(){if(u===f)return c(e,d,u,u.$async);let t=r.scopeValue("root",{ref:f});return c(e,i._`${t}.validate`,f,f.$async)}();let m=s.resolveRef.call(h,f,o,n);if(void 0===m)throw new t.default(a.opts.uriResolver,o,n);return m instanceof s.SchemaEnv?function(t){let r=l(e,t);c(e,r,t,t.$async)}(m):function(t){let s=r.scopeValue("schema",!0===p.code.source?{ref:t,code:(0,i.stringify)(t)}:{ref:t}),a=r.name("valid"),o=e.subschema({schema:t,dataTypes:[],schemaPath:i.nil,topSchemaRef:s,errSchemaPath:n},a);e.mergeEvaluated(o),e.ok(a)}(m)}};function l(e,t){let{gen:r}=e;return t.validate?r.scopeValue("validate",{ref:t.validate}):i._`${r.scopeValue("wrapper",{ref:t})}.validate`}function c(e,t,s,o){let{gen:l,it:c}=e,{allErrors:u,schemaEnv:d,opts:p}=c,h=p.passContext?n.default.this:i.nil;function f(e){let t=i._`${e}.errors`;l.assign(n.default.vErrors,i._`${n.default.vErrors} === null ? ${t} : ${n.default.vErrors}.concat(${t})`),l.assign(n.default.errors,i._`${n.default.vErrors}.length`)}function m(e){var t;if(!c.opts.unevaluated)return;let r=null===(t=s?.validate)||void 0===t?void 0:t.evaluated;if(!0!==c.props)if(r&&!r.dynamicProps)void 0!==r.props&&(c.props=a.mergeEvaluated.props(l,r.props,c.props));else{let t=l.var("props",i._`${e}.evaluated.props`);c.props=a.mergeEvaluated.props(l,t,c.props,i.Name)}if(!0!==c.items)if(r&&!r.dynamicItems)void 0!==r.items&&(c.items=a.mergeEvaluated.items(l,r.items,c.items));else{let t=l.var("items",i._`${e}.evaluated.items`);c.items=a.mergeEvaluated.items(l,t,c.items,i.Name)}}o?function(){if(!d.$async)throw new Error("async schema referenced by sync schema");let n=l.let("valid");l.try(()=>{l.code(i._`await ${(0,r.callValidateCode)(e,t,h)}`),m(t),u||l.assign(n,!0)},e=>{l.if(i._`!(${e} instanceof ${c.ValidationError})`,()=>l.throw(e)),f(e),u||l.assign(n,!1)}),e.ok(n)}():e.result((0,r.callValidateCode)(e,t,h),()=>m(t),()=>f(t))}e.getValidate=l,e.callRef=c,e.default=o}),Xt=u(e=>{Object.defineProperty(e,"__esModule",{value:!0});var t=Zt(),r=Yt();e.default=["$schema","$id","$defs","$vocabulary",{keyword:"$comment"},"definitions",t.default,r.default]}),Qt=u(e=>{Object.defineProperty(e,"__esModule",{value:!0});var t=Tt(),r=t.operators,i={maximum:{okStr:"<=",ok:r.LTE,fail:r.GT},minimum:{okStr:">=",ok:r.GTE,fail:r.LT},exclusiveMaximum:{okStr:"<",ok:r.LT,fail:r.GTE},exclusiveMinimum:{okStr:">",ok:r.GT,fail:r.LTE}},n={message:({keyword:e,schemaCode:r})=>t.str`must be ${i[e].okStr} ${r}`,params:({keyword:e,schemaCode:r})=>t._`{comparison: ${i[e].okStr}, limit: ${r}}`},s={keyword:Object.keys(i),type:"number",schemaType:"number",$data:!0,error:n,code(e){let{keyword:r,data:n,schemaCode:s}=e;e.fail$data(t._`${n} ${i[r].fail} ${s} || isNaN(${n})`)}};e.default=s}),er=u(e=>{Object.defineProperty(e,"__esModule",{value:!0});var t=Tt(),r={message:({schemaCode:e})=>t.str`must be multiple of ${e}`,params:({schemaCode:e})=>t._`{multipleOf: ${e}}`},i={keyword:"multipleOf",type:"number",schemaType:"number",$data:!0,error:r,code(e){let{gen:r,data:i,schemaCode:n,it:s}=e,a=s.opts.multipleOfPrecision,o=r.let("res"),l=a?t._`Math.abs(Math.round(${o}) - ${o}) > 1e-${a}`:t._`${o} !== parseInt(${o})`;e.fail$data(t._`(${n} === 0 || (${o} = ${i}/${n}, ${l}))`)}};e.default=i}),tr=u(e=>{function t(e){let t,r=e.length,i=0,n=0;for(;n<r;)i++,t=e.charCodeAt(n++),t>=55296&&t<=56319&&n<r&&(t=e.charCodeAt(n),56320==(64512&t)&&n++);return i}Object.defineProperty(e,"__esModule",{value:!0}),e.default=t,t.code='require("ajv/dist/runtime/ucs2length").default'}),rr=u(e=>{Object.defineProperty(e,"__esModule",{value:!0});var t=Tt(),r=Pt(),i=tr(),n={message:({keyword:e,schemaCode:r})=>t.str`must NOT have ${"maxLength"===e?"more":"fewer"} than ${r} characters`,params:({schemaCode:e})=>t._`{limit: ${e}}`},s={keyword:["maxLength","minLength"],type:"string",schemaType:"number",$data:!0,error:n,code(e){let{keyword:n,data:s,schemaCode:a,it:o}=e,l="maxLength"===n?t.operators.GT:t.operators.LT,c=!1===o.opts.unicode?t._`${s}.length`:t._`${(0,r.useFunc)(e.gen,i.default)}(${s})`;e.fail$data(t._`${c} ${l} ${a}`)}};e.default=s}),ir=u(e=>{Object.defineProperty(e,"__esModule",{value:!0});var t=jt(),r=Tt(),i={message:({schemaCode:e})=>r.str`must match pattern "${e}"`,params:({schemaCode:e})=>r._`{pattern: ${e}}`},n={keyword:"pattern",type:"string",schemaType:"string",$data:!0,error:i,code(e){let{data:i,$data:n,schema:s,schemaCode:a,it:o}=e,l=n?r._`(new RegExp(${a}, ${o.opts.unicodeRegExp?"u":""}))`:(0,t.usePattern)(e,s);e.fail$data(r._`!${l}.test(${i})`)}};e.default=n}),nr=u(e=>{Object.defineProperty(e,"__esModule",{value:!0});var t=Tt(),r={message:({keyword:e,schemaCode:r})=>t.str`must NOT have ${"maxProperties"===e?"more":"fewer"} than ${r} properties`,params:({schemaCode:e})=>t._`{limit: ${e}}`},i={keyword:["maxProperties","minProperties"],type:"object",schemaType:"number",$data:!0,error:r,code(e){let{keyword:r,data:i,schemaCode:n}=e;e.fail$data(t._`Object.keys(${i}).length ${"maxProperties"===r?t.operators.GT:t.operators.LT} ${n}`)}};e.default=i}),sr=u(e=>{Object.defineProperty(e,"__esModule",{value:!0});var t=jt(),r=Tt(),i=Pt(),n={message:({params:{missingProperty:e}})=>r.str`must have required property '${e}'`,params:({params:{missingProperty:e}})=>r._`{missingProperty: ${e}}`},s={keyword:"required",type:"object",schemaType:"array",$data:!0,error:n,code(e){let{gen:n,schema:s,schemaCode:a,data:o,$data:l,it:c}=e,{opts:u}=c;if(!l&&0===s.length)return;let d=s.length>=u.loopRequired;if(c.allErrors?function(){if(d||l)e.block$data(r.nil,p);else for(let r of s)(0,t.checkReportMissingProp)(e,r)}():function(){let i=n.let("missing");if(d||l){let s=n.let("valid",!0);e.block$data(s,()=>function(i,s){e.setParams({missingProperty:i}),n.forOf(i,a,()=>{n.assign(s,(0,t.propertyInData)(n,o,i,u.ownProperties)),n.if((0,r.not)(s),()=>{e.error(),n.break()})},r.nil)}(i,s)),e.ok(s)}else n.if((0,t.checkMissingProp)(e,s,i)),(0,t.reportMissingProp)(e,i),n.else()}(),u.strictRequired){let t=e.parentSchema.properties,{definedProperties:r}=e.it;for(let e of s)void 0!==t?.[e]||r.has(e)||(0,i.checkStrictMode)(c,`required property "${e}" is not defined at "${c.schemaEnv.baseId+c.errSchemaPath}" (strictRequired)`,c.opts.strictRequired)}function p(){n.forOf("prop",a,r=>{e.setParams({missingProperty:r}),n.if((0,t.noPropertyInData)(n,o,r,u.ownProperties),()=>e.error())})}}};e.default=s}),ar=u(e=>{Object.defineProperty(e,"__esModule",{value:!0});var t=Tt(),r={message:({keyword:e,schemaCode:r})=>t.str`must NOT have ${"maxItems"===e?"more":"fewer"} than ${r} items`,params:({schemaCode:e})=>t._`{limit: ${e}}`},i={keyword:["maxItems","minItems"],type:"array",schemaType:"number",$data:!0,error:r,code(e){let{keyword:r,data:i,schemaCode:n}=e;e.fail$data(t._`${i}.length ${"maxItems"===r?t.operators.GT:t.operators.LT} ${n}`)}};e.default=i}),or=u(e=>{Object.defineProperty(e,"__esModule",{value:!0});var t=St();t.code='require("ajv/dist/runtime/equal").default',e.default=t}),lr=u(e=>{Object.defineProperty(e,"__esModule",{value:!0});var t=Nt(),r=Tt(),i=Pt(),n=or(),s={message:({params:{i:e,j:t}})=>r.str`must NOT have duplicate items (items ## ${t} and ${e} are identical)`,params:({params:{i:e,j:t}})=>r._`{i: ${e}, j: ${t}}`},a={keyword:"uniqueItems",type:"array",schemaType:"boolean",$data:!0,error:s,code(e){let{gen:s,data:a,$data:o,schema:l,parentSchema:c,schemaCode:u,it:d}=e;if(!o&&!l)return;let p=s.let("valid"),h=c.items?(0,t.getSchemaTypes)(c.items):[];function f(i,n){let o=s.name("item"),l=(0,t.checkDataTypes)(h,o,d.opts.strictNumbers,t.DataType.Wrong),c=s.const("indices",r._`{}`);s.for(r._`;${i}--;`,()=>{s.let(o,r._`${a}[${i}]`),s.if(l,r._`continue`),h.length>1&&s.if(r._`typeof ${o} == "string"`,r._`${o} += "_"`),s.if(r._`typeof ${c}[${o}] == "number"`,()=>{s.assign(n,r._`${c}[${o}]`),e.error(),s.assign(p,!1).break()}).code(r._`${c}[${o}] = ${i}`)})}function m(t,o){let l=(0,i.useFunc)(s,n.default),c=s.name("outer");s.label(c).for(r._`;${t}--;`,()=>s.for(r._`${o} = ${t}; ${o}--;`,()=>s.if(r._`${l}(${a}[${t}], ${a}[${o}])`,()=>{e.error(),s.assign(p,!1).break(c)})))}e.block$data(p,function(){let t=s.let("i",r._`${a}.length`),i=s.let("j");e.setParams({i:t,j:i}),s.assign(p,!0),s.if(r._`${t} > 1`,()=>(h.length>0&&!h.some(e=>"object"===e||"array"===e)?f:m)(t,i))},r._`${u} === false`),e.ok(p)}};e.default=a}),cr=u(e=>{Object.defineProperty(e,"__esModule",{value:!0});var t=Tt(),r=Pt(),i=or(),n={message:"must be equal to constant",params:({schemaCode:e})=>t._`{allowedValue: ${e}}`},s={keyword:"const",$data:!0,error:n,code(e){let{gen:n,data:s,$data:a,schemaCode:o,schema:l}=e;a||l&&"object"==typeof l?e.fail$data(t._`!${(0,r.useFunc)(n,i.default)}(${s}, ${o})`):e.fail(t._`${l} !== ${s}`)}};e.default=s}),ur=u(e=>{Object.defineProperty(e,"__esModule",{value:!0});var t=Tt(),r=Pt(),i=or(),n={message:"must be equal to one of the allowed values",params:({schemaCode:e})=>t._`{allowedValues: ${e}}`},s={keyword:"enum",schemaType:"array",$data:!0,error:n,code(e){let{gen:n,data:s,$data:a,schema:o,schemaCode:l,it:c}=e;if(!a&&0===o.length)throw new Error("enum must have non-empty array");let u,d,p=()=>u??(u=(0,r.useFunc)(n,i.default));if(o.length>=c.opts.loopEnum||a)d=n.let("valid"),e.block$data(d,function(){n.assign(d,!1),n.forOf("v",l,e=>n.if(t._`${p()}(${s}, ${e})`,()=>n.assign(d,!0).break()))});else{if(!Array.isArray(o))throw new Error("ajv implementation error");let e=n.const("vSchema",l);d=(0,t.or)(...o.map((r,i)=>function(e,r){let i=o[r];return"object"==typeof i&&null!==i?t._`${p()}(${s}, ${e}[${r}])`:t._`${s} === ${i}`}(e,i)))}e.pass(d)}};e.default=s}),dr=u(e=>{Object.defineProperty(e,"__esModule",{value:!0});var t=Qt(),r=er(),i=rr(),n=ir(),s=nr(),a=sr(),o=ar(),l=lr(),c=cr(),u=ur();e.default=[t.default,r.default,i.default,n.default,s.default,a.default,o.default,l.default,{keyword:"type",schemaType:["string","array"]},{keyword:"nullable",schemaType:"boolean"},c.default,u.default]}),pr=u(e=>{Object.defineProperty(e,"__esModule",{value:!0}),e.validateAdditionalItems=void 0;var t=Tt(),r=Pt(),i={message:({params:{len:e}})=>t.str`must NOT have more than ${e} items`,params:({params:{len:e}})=>t._`{limit: ${e}}`},n={keyword:"additionalItems",type:"array",schemaType:["boolean","object"],before:"uniqueItems",error:i,code(e){let{parentSchema:t,it:i}=e,{items:n}=t;Array.isArray(n)?s(e,n):(0,r.checkStrictMode)(i,'"additionalItems" is ignored when "items" is not an array of schemas')}};function s(e,i){let{gen:n,schema:s,data:a,keyword:o,it:l}=e;l.items=!0;let c=n.const("len",t._`${a}.length`);if(!1===s)e.setParams({len:i.length}),e.pass(t._`${c} <= ${i.length}`);else if("object"==typeof s&&!(0,r.alwaysValidSchema)(l,s)){let s=n.var("valid",t._`${c} <= ${i.length}`);n.if((0,t.not)(s),()=>function(s){n.forRange("i",i.length,c,i=>{e.subschema({keyword:o,dataProp:i,dataPropType:r.Type.Num},s),l.allErrors||n.if((0,t.not)(s),()=>n.break())})}(s)),e.ok(s)}}e.validateAdditionalItems=s,e.default=n}),hr=u(e=>{Object.defineProperty(e,"__esModule",{value:!0}),e.validateTuple=void 0;var t=Tt(),r=Pt(),i=jt(),n={keyword:"items",type:"array",schemaType:["object","array","boolean"],before:"uniqueItems",code(e){let{schema:t,it:n}=e;if(Array.isArray(t))return s(e,"additionalItems",t);n.items=!0,!(0,r.alwaysValidSchema)(n,t)&&e.ok((0,i.validateArray)(e))}};function s(e,i,n=e.schema){let{gen:s,parentSchema:a,data:o,keyword:l,it:c}=e;(function(e){let{opts:t,errSchemaPath:s}=c,a=n.length;t.strictTuples&&!(a===e.minItems&&(a===e.maxItems||!1===e[i]))&&(0,r.checkStrictMode)(c,`"${l}" is ${a}-tuple, but minItems or maxItems/${i} are not specified or different at path "${s}"`,t.strictTuples)})(a),c.opts.unevaluated&&n.length&&!0!==c.items&&(c.items=r.mergeEvaluated.items(s,n.length,c.items));let u=s.name("valid"),d=s.const("len",t._`${o}.length`);n.forEach((i,n)=>{(0,r.alwaysValidSchema)(c,i)||(s.if(t._`${d} > ${n}`,()=>e.subschema({keyword:l,schemaProp:n,dataProp:n},u)),e.ok(u))})}e.validateTuple=s,e.default=n}),fr=u(e=>{Object.defineProperty(e,"__esModule",{value:!0});var t=hr(),r={keyword:"prefixItems",type:"array",schemaType:["array"],before:"uniqueItems",code:e=>(0,t.validateTuple)(e,"items")};e.default=r}),mr=u(e=>{Object.defineProperty(e,"__esModule",{value:!0});var t=Tt(),r=Pt(),i=jt(),n=pr(),s={message:({params:{len:e}})=>t.str`must NOT have more than ${e} items`,params:({params:{len:e}})=>t._`{limit: ${e}}`},a={keyword:"items",type:"array",schemaType:["object","boolean"],before:"uniqueItems",error:s,code(e){let{schema:t,parentSchema:s,it:a}=e,{prefixItems:o}=s;a.items=!0,!(0,r.alwaysValidSchema)(a,t)&&(o?(0,n.validateAdditionalItems)(e,o):e.ok((0,i.validateArray)(e)))}};e.default=a}),gr=u(e=>{Object.defineProperty(e,"__esModule",{value:!0});var t=Tt(),r=Pt(),i={message:({params:{min:e,max:r}})=>void 0===r?t.str`must contain at least ${e} valid item(s)`:t.str`must contain at least ${e} and no more than ${r} valid item(s)`,params:({params:{min:e,max:r}})=>void 0===r?t._`{minContains: ${e}}`:t._`{minContains: ${e}, maxContains: ${r}}`},n={keyword:"contains",type:"array",schemaType:["object","boolean"],before:"uniqueItems",trackErrors:!0,error:i,code(e){let i,n,{gen:s,schema:a,parentSchema:o,data:l,it:c}=e,{minContains:u,maxContains:d}=o;c.opts.next?(i=void 0===u?1:u,n=d):i=1;let p=s.const("len",t._`${l}.length`);if(e.setParams({min:i,max:n}),void 0===n&&0===i)return void(0,r.checkStrictMode)(c,'"minContains" == 0 without "maxContains": "contains" keyword ignored');if(void 0!==n&&i>n)return(0,r.checkStrictMode)(c,'"minContains" > "maxContains" is always invalid'),void e.fail();if((0,r.alwaysValidSchema)(c,a)){let r=t._`${p} >= ${i}`;return void 0!==n&&(r=t._`${r} && ${p} <= ${n}`),void e.pass(r)}c.items=!0;let h=s.name("valid");function f(){let e=s.name("_valid"),r=s.let("count",0);m(e,()=>s.if(e,()=>function(e){s.code(t._`${e}++`),void 0===n?s.if(t._`${e} >= ${i}`,()=>s.assign(h,!0).break()):(s.if(t._`${e} > ${n}`,()=>s.assign(h,!1).break()),1===i?s.assign(h,!0):s.if(t._`${e} >= ${i}`,()=>s.assign(h,!0)))}(r)))}function m(t,i){s.forRange("i",0,p,n=>{e.subschema({keyword:"contains",dataProp:n,dataPropType:r.Type.Num,compositeRule:!0},t),i()})}void 0===n&&1===i?m(h,()=>s.if(h,()=>s.break())):0===i?(s.let(h,!0),void 0!==n&&s.if(t._`${l}.length > 0`,f)):(s.let(h,!1),f()),e.result(h,()=>e.reset())}};e.default=n}),yr=u(e=>{Object.defineProperty(e,"__esModule",{value:!0}),e.validateSchemaDeps=e.validatePropertyDeps=e.error=void 0;var t=Tt(),r=Pt(),i=jt();e.error={message:({params:{property:e,depsCount:r,deps:i}})=>t.str`must have ${1===r?"property":"properties"} ${i} when property ${e} is present`,params:({params:{property:e,depsCount:r,deps:i,missingProperty:n}})=>t._`{property: ${e},
    missingProperty: ${n},
    depsCount: ${r},
    deps: ${i}}`};var n={keyword:"dependencies",type:"object",schemaType:"object",error:e.error,code(e){let[t,r]=function({schema:e}){let t={},r={};for(let i in e)"__proto__"!==i&&((Array.isArray(e[i])?t:r)[i]=e[i]);return[t,r]}(e);s(e,t),a(e,r)}};function s(e,r=e.schema){let{gen:n,data:s,it:a}=e;if(0===Object.keys(r).length)return;let o=n.let("missing");for(let l in r){let c=r[l];if(0===c.length)continue;let u=(0,i.propertyInData)(n,s,l,a.opts.ownProperties);e.setParams({property:l,depsCount:c.length,deps:c.join(", ")}),a.allErrors?n.if(u,()=>{for(let t of c)(0,i.checkReportMissingProp)(e,t)}):(n.if(t._`${u} && (${(0,i.checkMissingProp)(e,c,o)})`),(0,i.reportMissingProp)(e,o),n.else())}}function a(e,t=e.schema){let{gen:n,data:s,keyword:a,it:o}=e,l=n.name("valid");for(let c in t)(0,r.alwaysValidSchema)(o,t[c])||(n.if((0,i.propertyInData)(n,s,c,o.opts.ownProperties),()=>{let t=e.subschema({keyword:a,schemaProp:c},l);e.mergeValidEvaluated(t,l)},()=>n.var(l,!0)),e.ok(l))}e.validatePropertyDeps=s,e.validateSchemaDeps=a,e.default=n}),vr=u(e=>{Object.defineProperty(e,"__esModule",{value:!0});var t=Tt(),r=Pt(),i={message:"property name must be valid",params:({params:e})=>t._`{propertyName: ${e.propertyName}}`},n={keyword:"propertyNames",type:"object",schemaType:["object","boolean"],error:i,code(e){let{gen:i,schema:n,data:s,it:a}=e;if((0,r.alwaysValidSchema)(a,n))return;let o=i.name("valid");i.forIn("key",s,r=>{e.setParams({propertyName:r}),e.subschema({keyword:"propertyNames",data:r,dataTypes:["string"],propertyName:r,compositeRule:!0},o),i.if((0,t.not)(o),()=>{e.error(!0),a.allErrors||i.break()})}),e.ok(o)}};e.default=n}),br=u(e=>{Object.defineProperty(e,"__esModule",{value:!0});var t=jt(),r=Tt(),i=Rt(),n=Pt(),s={message:"must NOT have additional properties",params:({params:e})=>r._`{additionalProperty: ${e.additionalProperty}}`},a={keyword:"additionalProperties",type:["object"],schemaType:["boolean","object"],allowUndefined:!0,trackErrors:!0,error:s,code(e){let{gen:s,schema:a,parentSchema:o,data:l,errsCount:c,it:u}=e;if(!c)throw new Error("ajv implementation error");let{allErrors:d,opts:p}=u;if(u.props=!0,"all"!==p.removeAdditional&&(0,n.alwaysValidSchema)(u,a))return;let h=(0,t.allSchemaProperties)(o.properties),f=(0,t.allSchemaProperties)(o.patternProperties);function m(e){s.code(r._`delete ${l}[${e}]`)}function g(t){if("all"===p.removeAdditional||p.removeAdditional&&!1===a)m(t);else{if(!1===a)return e.setParams({additionalProperty:t}),e.error(),void(d||s.break());if("object"==typeof a&&!(0,n.alwaysValidSchema)(u,a)){let i=s.name("valid");"failing"===p.removeAdditional?(y(t,i,!1),s.if((0,r.not)(i),()=>{e.reset(),m(t)})):(y(t,i),d||s.if((0,r.not)(i),()=>s.break()))}}}function y(t,r,i){let s={keyword:"additionalProperties",dataProp:t,dataPropType:n.Type.Str};!1===i&&Object.assign(s,{compositeRule:!0,createErrors:!1,allErrors:!1}),e.subschema(s,r)}s.forIn("key",l,i=>{h.length||f.length?s.if(function(i){let a;if(h.length>8){let e=(0,n.schemaRefOrVal)(u,o.properties,"properties");a=(0,t.isOwnProperty)(s,e,i)}else a=h.length?(0,r.or)(...h.map(e=>r._`${i} === ${e}`)):r.nil;return f.length&&(a=(0,r.or)(a,...f.map(n=>r._`${(0,t.usePattern)(e,n)}.test(${i})`))),(0,r.not)(a)}(i),()=>g(i)):g(i)}),e.ok(r._`${c} === ${i.default.errors}`)}};e.default=a}),wr=u(e=>{Object.defineProperty(e,"__esModule",{value:!0});var t=zt(),r=jt(),i=Pt(),n=br(),s={keyword:"properties",type:"object",schemaType:"object",code(e){let{gen:s,schema:a,parentSchema:o,data:l,it:c}=e;"all"===c.opts.removeAdditional&&void 0===o.additionalProperties&&n.default.code(new t.KeywordCxt(c,n.default,"additionalProperties"));let u=(0,r.allSchemaProperties)(a);for(let e of u)c.definedProperties.add(e);c.opts.unevaluated&&u.length&&!0!==c.props&&(c.props=i.mergeEvaluated.props(s,(0,i.toHash)(u),c.props));let d=u.filter(e=>!(0,i.alwaysValidSchema)(c,a[e]));if(0===d.length)return;let p=s.name("valid");for(let t of d)h(t)?f(t):(s.if((0,r.propertyInData)(s,l,t,c.opts.ownProperties)),f(t),c.allErrors||s.else().var(p,!0),s.endIf()),e.it.definedProperties.add(t),e.ok(p);function h(e){return c.opts.useDefaults&&!c.compositeRule&&void 0!==a[e].default}function f(t){e.subschema({keyword:"properties",schemaProp:t,dataProp:t},p)}}};e.default=s}),_r=u(e=>{Object.defineProperty(e,"__esModule",{value:!0});var t=jt(),r=Tt(),i=Pt(),n=Pt(),s={keyword:"patternProperties",type:"object",schemaType:"object",code(e){let{gen:s,schema:a,data:o,parentSchema:l,it:c}=e,{opts:u}=c,d=(0,t.allSchemaProperties)(a),p=d.filter(e=>(0,i.alwaysValidSchema)(c,a[e]));if(0===d.length||p.length===d.length&&(!c.opts.unevaluated||!0===c.props))return;let h=u.strictSchema&&!u.allowMatchingProperties&&l.properties,f=s.name("valid");!0!==c.props&&!(c.props instanceof r.Name)&&(c.props=(0,n.evaluatedPropsToName)(s,c.props));let{props:m}=c;function g(e){for(let t in h)new RegExp(e).test(t)&&(0,i.checkStrictMode)(c,`property ${t} matches pattern ${e} (use allowMatchingProperties)`)}function y(i){s.forIn("key",o,a=>{s.if(r._`${(0,t.usePattern)(e,i)}.test(${a})`,()=>{let t=p.includes(i);t||e.subschema({keyword:"patternProperties",schemaProp:i,dataProp:a,dataPropType:n.Type.Str},f),c.opts.unevaluated&&!0!==m?s.assign(r._`${m}[${a}]`,!0):!t&&!c.allErrors&&s.if((0,r.not)(f),()=>s.break())})})}!function(){for(let e of d)h&&g(e),c.allErrors?y(e):(s.var(f,!0),y(e),s.if(f))}()}};e.default=s}),Sr=u(e=>{Object.defineProperty(e,"__esModule",{value:!0});var t=Pt(),r={keyword:"not",schemaType:["object","boolean"],trackErrors:!0,code(e){let{gen:r,schema:i,it:n}=e;if((0,t.alwaysValidSchema)(n,i))return void e.fail();let s=r.name("valid");e.subschema({keyword:"not",compositeRule:!0,createErrors:!1,allErrors:!1},s),e.failResult(s,()=>e.reset(),()=>e.error())},error:{message:"must NOT be valid"}};e.default=r}),Er=u(e=>{Object.defineProperty(e,"__esModule",{value:!0});var t=jt();e.default={keyword:"anyOf",schemaType:"array",trackErrors:!0,code:t.validateUnion,error:{message:"must match a schema in anyOf"}}}),kr=u(e=>{Object.defineProperty(e,"__esModule",{value:!0});var t=Tt(),r=Pt(),i={message:"must match exactly one schema in oneOf",params:({params:e})=>t._`{passingSchemas: ${e.passing}}`},n={keyword:"oneOf",schemaType:"array",trackErrors:!0,error:i,code(e){let{gen:i,schema:n,parentSchema:s,it:a}=e;if(!Array.isArray(n))throw new Error("ajv implementation error");if(a.opts.discriminator&&s.discriminator)return;let o=n,l=i.let("valid",!1),c=i.let("passing",null),u=i.name("_valid");e.setParams({passing:c}),i.block(function(){o.forEach((n,s)=>{let o;(0,r.alwaysValidSchema)(a,n)?i.var(u,!0):o=e.subschema({keyword:"oneOf",schemaProp:s,compositeRule:!0},u),s>0&&i.if(t._`${u} && ${l}`).assign(l,!1).assign(c,t._`[${c}, ${s}]`).else(),i.if(u,()=>{i.assign(l,!0),i.assign(c,s),o&&e.mergeEvaluated(o,t.Name)})})}),e.result(l,()=>e.reset(),()=>e.error(!0))}};e.default=n}),xr=u(e=>{Object.defineProperty(e,"__esModule",{value:!0});var t=Pt(),r={keyword:"allOf",schemaType:"array",code(e){let{gen:r,schema:i,it:n}=e;if(!Array.isArray(i))throw new Error("ajv implementation error");let s=r.name("valid");i.forEach((r,i)=>{if((0,t.alwaysValidSchema)(n,r))return;let a=e.subschema({keyword:"allOf",schemaProp:i},s);e.ok(s),e.mergeEvaluated(a)})}};e.default=r}),Tr=u(e=>{Object.defineProperty(e,"__esModule",{value:!0});var t=Tt(),r=Pt(),i={message:({params:e})=>t.str`must match "${e.ifClause}" schema`,params:({params:e})=>t._`{failingKeyword: ${e.ifClause}}`},n={keyword:"if",schemaType:["object","boolean"],trackErrors:!0,error:i,code(e){let{gen:i,parentSchema:n,it:a}=e;void 0===n.then&&void 0===n.else&&(0,r.checkStrictMode)(a,'"if" without "then" and "else" is ignored');let o=s(a,"then"),l=s(a,"else");if(!o&&!l)return;let c=i.let("valid",!0),u=i.name("_valid");if(function(){let t=e.subschema({keyword:"if",compositeRule:!0,createErrors:!1,allErrors:!1},u);e.mergeEvaluated(t)}(),e.reset(),o&&l){let t=i.let("ifClause");e.setParams({ifClause:t}),i.if(u,d("then",t),d("else",t))}else o?i.if(u,d("then")):i.if((0,t.not)(u),d("else"));function d(r,n){return()=>{let s=e.subschema({keyword:r},u);i.assign(c,u),e.mergeValidEvaluated(s,c),n?i.assign(n,t._`${r}`):e.setParams({ifClause:r})}}e.pass(c,()=>e.error(!0))}};function s(e,t){let i=e.schema[t];return void 0!==i&&!(0,r.alwaysValidSchema)(e,i)}e.default=n}),Pr=u(e=>{Object.defineProperty(e,"__esModule",{value:!0});var t=Pt(),r={keyword:["then","else"],schemaType:["object","boolean"],code({keyword:e,parentSchema:r,it:i}){void 0===r.if&&(0,t.checkStrictMode)(i,`"${e}" without "if" is ignored`)}};e.default=r}),Rr=u(e=>{Object.defineProperty(e,"__esModule",{value:!0});var t=pr(),r=fr(),i=hr(),n=mr(),s=gr(),a=yr(),o=vr(),l=br(),c=wr(),u=_r(),d=Sr(),p=Er(),h=kr(),f=xr(),m=Tr(),g=Pr();e.default=function(e=!1){let y=[d.default,p.default,h.default,f.default,m.default,g.default,o.default,l.default,a.default,c.default,u.default];return e?y.push(r.default,n.default):y.push(t.default,i.default),y.push(s.default),y}}),Or=u(e=>{Object.defineProperty(e,"__esModule",{value:!0});var t=Tt(),r={message:({schemaCode:e})=>t.str`must match format "${e}"`,params:({schemaCode:e})=>t._`{format: ${e}}`},i={keyword:"format",type:["number","string"],schemaType:"string",$data:!0,error:r,code(e,r){let{gen:i,data:n,$data:s,schema:a,schemaCode:o,it:l}=e,{opts:c,errSchemaPath:u,schemaEnv:d,self:p}=l;c.validateFormats&&(s?function(){let s=i.scopeValue("formats",{ref:p.formats,code:c.code.formats}),a=i.const("fDef",t._`${s}[${o}]`),l=i.let("fType"),u=i.let("format");i.if(t._`typeof ${a} == "object" && !(${a} instanceof RegExp)`,()=>i.assign(l,t._`${a}.type || "string"`).assign(u,t._`${a}.validate`),()=>i.assign(l,t._`"string"`).assign(u,a)),e.fail$data((0,t.or)(!1===c.strictSchema?t.nil:t._`${o} && !${u}`,function(){let e=d.$async?t._`(${a}.async ? await ${u}(${n}) : ${u}(${n}))`:t._`${u}(${n})`,i=t._`(typeof ${u} == "function" ? ${e} : ${u}.test(${n}))`;return t._`${u} && ${u} !== true && ${l} === ${r} && !${i}`}()))}():function(){let s=p.formats[a];if(!s)return void function(){if(!1!==c.strictSchema)throw new Error(e());function e(){return`unknown format "${a}" ignored in schema at path "${u}"`}p.logger.warn(e())}();if(!0===s)return;let[o,l,h]=function(e){let r=e instanceof RegExp?(0,t.regexpCode)(e):c.code.formats?t._`${c.code.formats}${(0,t.getProperty)(a)}`:void 0,n=i.scopeValue("formats",{key:a,ref:e,code:r});return"object"!=typeof e||e instanceof RegExp?["string",e,n]:[e.type||"string",e.validate,t._`${n}.validate`]}(s);o===r&&e.pass(function(){if("object"==typeof s&&!(s instanceof RegExp)&&s.async){if(!d.$async)throw new Error("async format in sync schema");return t._`await ${h}(${n})`}return"function"==typeof l?t._`${h}(${n})`:t._`${h}.test(${n})`}())}())}};e.default=i}),$r=u(e=>{Object.defineProperty(e,"__esModule",{value:!0});var t=Or();e.default=[t.default]}),Cr=u(e=>{Object.defineProperty(e,"__esModule",{value:!0}),e.contentVocabulary=e.metadataVocabulary=void 0,e.metadataVocabulary=["title","description","default","deprecated","readOnly","writeOnly","examples"],e.contentVocabulary=["contentMediaType","contentEncoding","contentSchema"]}),Ar=u(e=>{Object.defineProperty(e,"__esModule",{value:!0});var t=Xt(),r=dr(),i=Rr(),n=$r(),s=Cr(),a=[t.default,r.default,(0,i.default)(),n.default,s.metadataVocabulary,s.contentVocabulary];e.default=a}),Nr=u(e=>{var t;Object.defineProperty(e,"__esModule",{value:!0}),e.DiscrError=void 0,function(e){e.Tag="tag",e.Mapping="mapping"}(t||(e.DiscrError=t={}))}),Ir=u(e=>{Object.defineProperty(e,"__esModule",{value:!0});var t=Tt(),r=Nr(),i=Bt(),n=Ut(),s=Pt(),a={message:({params:{discrError:e,tagName:t}})=>e===r.DiscrError.Tag?`tag "${t}" must be string`:`value of tag "${t}" must be in oneOf`,params:({params:{discrError:e,tag:r,tagName:i}})=>t._`{error: ${e}, tag: ${i}, tagValue: ${r}}`},o={keyword:"discriminator",type:"object",schemaType:"object",error:a,code(e){let{gen:a,data:o,schema:l,parentSchema:c,it:u}=e,{oneOf:d}=c;if(!u.opts.discriminator)throw new Error("discriminator: requires discriminator option");let p=l.propertyName;if("string"!=typeof p)throw new Error("discriminator: requires propertyName");if(l.mapping)throw new Error("discriminator: mapping is not supported");if(!d)throw new Error("discriminator: requires oneOf keyword");let h=a.let("valid",!1),f=a.const("tag",t._`${o}${(0,t.getProperty)(p)}`);function m(r){let i=a.name("valid"),n=e.subschema({keyword:"oneOf",schemaProp:r},i);return e.mergeEvaluated(n,t.Name),i}a.if(t._`typeof ${f} == "string"`,()=>function(){let o=function(){var e;let t={},r=o(c),a=!0;for(let t=0;t<d.length;t++){let c=d[t];if(c?.$ref&&!(0,s.schemaHasRulesButRef)(c,u.self.RULES)){let e=c.$ref;if(c=i.resolveRef.call(u.self,u.schemaEnv.root,u.baseId,e),c instanceof i.SchemaEnv&&(c=c.schema),void 0===c)throw new n.default(u.opts.uriResolver,u.baseId,e)}let h=null===(e=c?.properties)||void 0===e?void 0:e[p];if("object"!=typeof h)throw new Error(`discriminator: oneOf subschemas (or referenced schemas) must have "properties/${p}"`);a=a&&(r||o(c)),l(h,t)}if(!a)throw new Error(`discriminator: "${p}" must be required`);return t;function o({required:e}){return Array.isArray(e)&&e.includes(p)}function l(e,t){if(e.const)h(e.const,t);else{if(!e.enum)throw new Error(`discriminator: "properties/${p}" must have "const" or "enum"`);for(let r of e.enum)h(r,t)}}function h(e,r){if("string"!=typeof e||e in t)throw new Error(`discriminator: "${p}" values must be unique strings`);t[e]=r}}();a.if(!1);for(let e in o)a.elseIf(t._`${f} === ${e}`),a.assign(h,m(o[e]));a.else(),e.error(!1,{discrError:r.DiscrError.Mapping,tag:f,tagName:p}),a.endIf()}(),()=>e.error(!1,{discrError:r.DiscrError.Tag,tag:f,tagName:p})),e.ok(h)}};e.default=o}),jr=u((e,t)=>{t.exports={$schema:"http://json-schema.org/draft-07/schema#",$id:"http://json-schema.org/draft-07/schema#",title:"Core schema meta-schema",definitions:{schemaArray:{type:"array",minItems:1,items:{$ref:"#"}},nonNegativeInteger:{type:"integer",minimum:0},nonNegativeIntegerDefault0:{allOf:[{$ref:"#/definitions/nonNegativeInteger"},{default:0}]},simpleTypes:{enum:["array","boolean","integer","null","number","object","string"]},stringArray:{type:"array",items:{type:"string"},uniqueItems:!0,default:[]}},type:["object","boolean"],properties:{$id:{type:"string",format:"uri-reference"},$schema:{type:"string",format:"uri"},$ref:{type:"string",format:"uri-reference"},$comment:{type:"string"},title:{type:"string"},description:{type:"string"},default:!0,readOnly:{type:"boolean",default:!1},examples:{type:"array",items:!0},multipleOf:{type:"number",exclusiveMinimum:0},maximum:{type:"number"},exclusiveMaximum:{type:"number"},minimum:{type:"number"},exclusiveMinimum:{type:"number"},maxLength:{$ref:"#/definitions/nonNegativeInteger"},minLength:{$ref:"#/definitions/nonNegativeIntegerDefault0"},pattern:{type:"string",format:"regex"},additionalItems:{$ref:"#"},items:{anyOf:[{$ref:"#"},{$ref:"#/definitions/schemaArray"}],default:!0},maxItems:{$ref:"#/definitions/nonNegativeInteger"},minItems:{$ref:"#/definitions/nonNegativeIntegerDefault0"},uniqueItems:{type:"boolean",default:!1},contains:{$ref:"#"},maxProperties:{$ref:"#/definitions/nonNegativeInteger"},minProperties:{$ref:"#/definitions/nonNegativeIntegerDefault0"},required:{$ref:"#/definitions/stringArray"},additionalProperties:{$ref:"#"},definitions:{type:"object",additionalProperties:{$ref:"#"},default:{}},properties:{type:"object",additionalProperties:{$ref:"#"},default:{}},patternProperties:{type:"object",additionalProperties:{$ref:"#"},propertyNames:{format:"regex"},default:{}},dependencies:{type:"object",additionalProperties:{anyOf:[{$ref:"#"},{$ref:"#/definitions/stringArray"}]}},propertyNames:{$ref:"#"},const:!0,enum:{type:"array",items:!0,minItems:1,uniqueItems:!0},type:{anyOf:[{$ref:"#/definitions/simpleTypes"},{type:"array",items:{$ref:"#/definitions/simpleTypes"},minItems:1,uniqueItems:!0}]},format:{type:"string"},contentMediaType:{type:"string"},contentEncoding:{type:"string"},if:{$ref:"#"},then:{$ref:"#"},else:{$ref:"#"},allOf:{$ref:"#/definitions/schemaArray"},anyOf:{$ref:"#/definitions/schemaArray"},oneOf:{$ref:"#/definitions/schemaArray"},not:{$ref:"#"}},default:!0}}),Lr=u((e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.MissingRefError=e.ValidationError=e.CodeGen=e.Name=e.nil=e.stringify=e.str=e._=e.KeywordCxt=e.Ajv=void 0;var r=Jt(),i=Ar(),n=Ir(),s=jr(),a=["/properties"],o="http://json-schema.org/draft-07/schema",l=class extends r.default{_addVocabularies(){super._addVocabularies(),i.default.forEach(e=>this.addVocabulary(e)),this.opts.discriminator&&this.addKeyword(n.default)}_addDefaultMetaSchema(){if(super._addDefaultMetaSchema(),!this.opts.meta)return;let e=this.opts.$data?this.$dataMetaSchema(s,a):s;this.addMetaSchema(e,o,!1),this.refs["http://json-schema.org/schema"]=o}defaultMeta(){return this.opts.defaultMeta=super.defaultMeta()||(this.getSchema(o)?o:void 0)}};e.Ajv=l,t.exports=e=l,t.exports.Ajv=l,Object.defineProperty(e,"__esModule",{value:!0}),e.default=l;var c=zt();Object.defineProperty(e,"KeywordCxt",{enumerable:!0,get:function(){return c.KeywordCxt}});var u=Tt();Object.defineProperty(e,"_",{enumerable:!0,get:function(){return u._}}),Object.defineProperty(e,"str",{enumerable:!0,get:function(){return u.str}}),Object.defineProperty(e,"stringify",{enumerable:!0,get:function(){return u.stringify}}),Object.defineProperty(e,"nil",{enumerable:!0,get:function(){return u.nil}}),Object.defineProperty(e,"Name",{enumerable:!0,get:function(){return u.Name}}),Object.defineProperty(e,"CodeGen",{enumerable:!0,get:function(){return u.CodeGen}});var d=qt();Object.defineProperty(e,"ValidationError",{enumerable:!0,get:function(){return d.default}});var p=Ut();Object.defineProperty(e,"MissingRefError",{enumerable:!0,get:function(){return p.default}})}),Dr=u((e,t)=>{t.exports={HEX:{0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,a:10,A:10,b:11,B:11,c:12,C:12,d:13,D:13,e:14,E:14,f:15,F:15}}}),Fr=u((e,t)=>{var{HEX:r}=Dr();function i(e){if(o(e,".")<3)return{host:e,isIPV4:!1};let t=e.match(/^(\b[01]?\d{1,2}|\b2[0-4]\d|\b25[0-5])(\.([01]?\d{1,2}|2[0-4]\d|25[0-5])){3}$/u)||[],[r]=t;return r?{host:a(r,"."),isIPV4:!0}:{host:e,isIPV4:!1}}function n(e){let t="",i=!0;for(let n of e){if("0"!==n&&!0===i&&(i=!1),void 0===r[n])return;i||(t+=n)}return t}function s(e,t={}){if(o(e,":")<2)return{host:e,isIPV6:!1};let r=function(e){let t=0,r={error:!1,address:"",zone:""},i=[],s=[],a=!1,o=!1,l=!1;function c(){if(s.length){if(!1===a){let e=n(s.join(""));if(void 0===e)return r.error=!0,!1;i.push(e)}s.length=0}return!0}for(let n=0;n<e.length;n++){let u=e[n];if("["!==u&&"]"!==u){if(":"===u){if(!0===o&&(l=!0),!c())break;if(t++,i.push(":"),t>7){r.error=!0;break}n-1>=0&&":"===e[n-1]&&(o=!0);continue}if("%"!==u){s.push(u);continue}if(!c())break;a=!0}}return s.length&&(a?r.zone=s.join(""):i.push(l?s.join(""):n(s.join("")))),r.address=i.join(""),r}(e);if(r.error)return{host:e,isIPV6:!1};{let e=r.address,t=r.address;return r.zone&&(e+="%"+r.zone,t+="%25"+r.zone),{host:e,escapedHost:t,isIPV6:!0}}}function a(e,t){let r="",i=!0,n=e.length;for(let s=0;s<n;s++){let a=e[s];"0"===a&&i?(s+1<=n&&e[s+1]===t||s+1===n)&&(r+=a,i=!1):(i=a===t,r+=a)}return r}function o(e,t){let r=0;for(let i=0;i<e.length;i++)e[i]===t&&r++;return r}var l=/^\.\.?\//u,c=/^\/\.(?:\/|$)/u,u=/^\/\.\.(?:\/|$)/u,d=/^\/?(?:.|\n)*?(?=\/|$)/u;t.exports={recomposeAuthority:function(e,t){let r=[];if(void 0!==e.userinfo&&(r.push(e.userinfo),r.push("@")),void 0!==e.host){let t=unescape(e.host),n=i(t);if(n.isIPV4)t=n.host;else{let r=s(n.host,{isIPV4:!1});t=!0===r.isIPV6?`[${r.escapedHost}]`:e.host}r.push(t)}return("number"==typeof e.port||"string"==typeof e.port)&&(r.push(":"),r.push(String(e.port))),r.length?r.join(""):void 0},normalizeComponentEncoding:function(e,t){let r=!0!==t?escape:unescape;return void 0!==e.scheme&&(e.scheme=r(e.scheme)),void 0!==e.userinfo&&(e.userinfo=r(e.userinfo)),void 0!==e.host&&(e.host=r(e.host)),void 0!==e.path&&(e.path=r(e.path)),void 0!==e.query&&(e.query=r(e.query)),void 0!==e.fragment&&(e.fragment=r(e.fragment)),e},removeDotSegments:function(e){let t=[];for(;e.length;)if(e.match(l))e=e.replace(l,"");else if(e.match(c))e=e.replace(c,"/");else if(e.match(u))e=e.replace(u,"/"),t.pop();else if("."===e||".."===e)e="";else{let r=e.match(d);if(!r)throw new Error("Unexpected dot segment condition");{let i=r[0];e=e.slice(i.length),t.push(i)}}return t.join("")},normalizeIPv4:i,normalizeIPv6:s,stringToHexStripped:n}}),Mr=u((e,t)=>{var r=/^[\da-f]{8}\b-[\da-f]{4}\b-[\da-f]{4}\b-[\da-f]{4}\b-[\da-f]{12}$/iu,i=/([\da-z][\d\-a-z]{0,31}):((?:[\w!$'()*+,\-.:;=@]|%[\da-f]{2})+)/iu;function n(e){return"boolean"==typeof e.secure?e.secure:"wss"===String(e.scheme).toLowerCase()}function s(e){return e.host||(e.error=e.error||"HTTP URIs must have a host."),e}function a(e){let t="https"===String(e.scheme).toLowerCase();return(e.port===(t?443:80)||""===e.port)&&(e.port=void 0),e.path||(e.path="/"),e}var o={scheme:"http",domainHost:!0,parse:s,serialize:a},l={scheme:"ws",domainHost:!0,parse:function(e){return e.secure=n(e),e.resourceName=(e.path||"/")+(e.query?"?"+e.query:""),e.path=void 0,e.query=void 0,e},serialize:function(e){if((e.port===(n(e)?443:80)||""===e.port)&&(e.port=void 0),"boolean"==typeof e.secure&&(e.scheme=e.secure?"wss":"ws",e.secure=void 0),e.resourceName){let[t,r]=e.resourceName.split("?");e.path=t&&"/"!==t?t:void 0,e.query=r,e.resourceName=void 0}return e.fragment=void 0,e}},c={scheme:"urn",parse:function(e,t){if(!e.path)return e.error="URN can not be parsed",e;let r=e.path.match(i);if(r){let i=t.scheme||e.scheme||"urn";e.nid=r[1].toLowerCase(),e.nss=r[2];let n=d[`${i}:${t.nid||e.nid}`];e.path=void 0,n&&(e=n.parse(e,t))}else e.error=e.error||"URN can not be parsed.";return e},serialize:function(e,t){let r=t.scheme||e.scheme||"urn",i=e.nid.toLowerCase(),n=d[`${r}:${t.nid||i}`];n&&(e=n.serialize(e,t));let s=e;return s.path=`${i||t.nid}:${e.nss}`,t.skipEscape=!0,s},skipNormalize:!0},u={scheme:"urn:uuid",parse:function(e,t){let i=e;return i.uuid=i.nss,i.nss=void 0,!t.tolerant&&(!i.uuid||!r.test(i.uuid))&&(i.error=i.error||"UUID is not valid."),i},serialize:function(e){let t=e;return t.nss=(e.uuid||"").toLowerCase(),t},skipNormalize:!0},d={http:o,https:{scheme:"https",domainHost:o.domainHost,parse:s,serialize:a},ws:l,wss:{scheme:"wss",domainHost:l.domainHost,parse:l.parse,serialize:l.serialize},urn:c,"urn:uuid":u};t.exports=d}),zr=u((e,t)=>{var{normalizeIPv6:r,normalizeIPv4:i,removeDotSegments:n,recomposeAuthority:s,normalizeComponentEncoding:a}=Fr(),o=Mr();function l(e,t,r,i){let s={};return i||(e=p(c(e,r),r),t=p(c(t,r),r)),!(r=r||{}).tolerant&&t.scheme?(s.scheme=t.scheme,s.userinfo=t.userinfo,s.host=t.host,s.port=t.port,s.path=n(t.path||""),s.query=t.query):(void 0!==t.userinfo||void 0!==t.host||void 0!==t.port?(s.userinfo=t.userinfo,s.host=t.host,s.port=t.port,s.path=n(t.path||""),s.query=t.query):(t.path?("/"===t.path.charAt(0)?s.path=n(t.path):(s.path=void 0===e.userinfo&&void 0===e.host&&void 0===e.port||e.path?e.path?e.path.slice(0,e.path.lastIndexOf("/")+1)+t.path:t.path:"/"+t.path,s.path=n(s.path)),s.query=t.query):(s.path=e.path,s.query=void 0!==t.query?t.query:e.query),s.userinfo=e.userinfo,s.host=e.host,s.port=e.port),s.scheme=e.scheme),s.fragment=t.fragment,s}function c(e,t){let r={host:e.host,scheme:e.scheme,userinfo:e.userinfo,port:e.port,path:e.path,query:e.query,nid:e.nid,nss:e.nss,uuid:e.uuid,fragment:e.fragment,reference:e.reference,resourceName:e.resourceName,secure:e.secure,error:""},i=Object.assign({},t),a=[],l=o[(i.scheme||r.scheme||"").toLowerCase()];l&&l.serialize&&l.serialize(r,i),void 0!==r.path&&(i.skipEscape?r.path=unescape(r.path):(r.path=escape(r.path),void 0!==r.scheme&&(r.path=r.path.split("%3A").join(":")))),"suffix"!==i.reference&&r.scheme&&(a.push(r.scheme),a.push(":"));let c=s(r,i);if(void 0!==c&&("suffix"!==i.reference&&a.push("//"),a.push(c),r.path&&"/"!==r.path.charAt(0)&&a.push("/")),void 0!==r.path){let e=r.path;!i.absolutePath&&(!l||!l.absolutePath)&&(e=n(e)),void 0===c&&(e=e.replace(/^\/\//u,"/%2F")),a.push(e)}return void 0!==r.query&&(a.push("?"),a.push(r.query)),void 0!==r.fragment&&(a.push("#"),a.push(r.fragment)),a.join("")}var u=Array.from({length:127},(e,t)=>/[^!"$&'()*+,\-.;=_`a-z{}~]/u.test(String.fromCharCode(t))),d=/^(?:([^#/:?]+):)?(?:\/\/((?:([^#/?@]*)@)?(\[[^#/?\]]+\]|[^#/:?]*)(?::(\d*))?))?([^#?]*)(?:\?([^#]*))?(?:#((?:.|[\n\r])*))?/u;function p(e,t){let n=Object.assign({},t),s={scheme:void 0,userinfo:void 0,host:"",port:void 0,path:"",query:void 0,fragment:void 0},a=-1!==e.indexOf("%");"suffix"===n.reference&&(e=(n.scheme?n.scheme+":":"")+"//"+e);let l=e.match(d);if(l){if(s.scheme=l[1],s.userinfo=l[3],s.host=l[4],s.port=parseInt(l[5],10),s.path=l[6]||"",s.query=l[7],s.fragment=l[8],isNaN(s.port)&&(s.port=l[5]),s.host){let e=i(s.host);s.host=!1===e.isIPV4?r(e.host,{isIPV4:!1}).host.toLowerCase():e.host}s.reference=void 0!==s.scheme||void 0!==s.userinfo||void 0!==s.host||void 0!==s.port||s.path||void 0!==s.query?void 0===s.scheme?"relative":void 0===s.fragment?"absolute":"uri":"same-document",n.reference&&"suffix"!==n.reference&&n.reference!==s.reference&&(s.error=s.error||"URI is not a "+n.reference+" reference.");let e=o[(n.scheme||s.scheme||"").toLowerCase()];if(!n.unicodeSupport&&(!e||!e.unicodeSupport)&&s.host&&(n.domainHost||e&&e.domainHost)&&function(e){let t=0;for(let r=0,i=e.length;r<i;++r)if(t=e.charCodeAt(r),t>126||u[t])return!0;return!1}(s.host))try{s.host=URL.domainToASCII(s.host.toLowerCase())}catch(e){s.error=s.error||"Host's domain name can not be converted to ASCII: "+e}(!e||e&&!e.skipNormalize)&&(a&&void 0!==s.scheme&&(s.scheme=unescape(s.scheme)),a&&void 0!==s.userinfo&&(s.userinfo=unescape(s.userinfo)),a&&void 0!==s.host&&(s.host=unescape(s.host)),void 0!==s.path&&s.path.length&&(s.path=escape(unescape(s.path))),void 0!==s.fragment&&s.fragment.length&&(s.fragment=encodeURI(decodeURI(s.fragment)))),e&&e.parse&&e.parse(s,n)}else s.error=s.error||"URI can not be parsed.";return s}var h={normalize:function(e,t){return"string"==typeof e?e=c(p(e,t),t):"object"==typeof e&&(e=p(c(e,t),t)),e},resolve:function(e,t,r){let i=Object.assign({scheme:"null"},r);return c(l(p(e,i),p(t,i),i,!0),{...i,skipEscape:!0})},resolveComponents:l,equal:function(e,t,r){return"string"==typeof e?(e=unescape(e),e=c(a(p(e,r),!0),{...r,skipEscape:!0})):"object"==typeof e&&(e=c(a(e,!0),{...r,skipEscape:!0})),"string"==typeof t?(t=unescape(t),t=c(a(p(t,r),!0),{...r,skipEscape:!0})):"object"==typeof t&&(t=c(a(t,!0),{...r,skipEscape:!0})),e.toLowerCase()===t.toLowerCase()},serialize:c,parse:p};t.exports=h,t.exports.default=h,t.exports.fastUri=h}),qr=u(e=>{function t(e,t){return{validate:e,compare:t}}Object.defineProperty(e,"__esModule",{value:!0}),e.formatNames=e.fastFormats=e.fullFormats=void 0,e.fullFormats={date:t(n,s),time:t(o(!0),l),"date-time":t(d(!0),p),"iso-time":t(o(),c),"iso-date-time":t(d(),h),duration:/^P(?!$)((\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+S)?)?|(\d+W)?)$/,uri:function(e){return f.test(e)&&m.test(e)},"uri-reference":/^(?:[a-z][a-z0-9+\-.]*:)?(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'"()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?(?:\?(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,"uri-template":/^(?:(?:[^\x00-\x20"'<>%\\^`{|}]|%[0-9a-f]{2})|\{[+#./;?&=,!@|]?(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?(?:,(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?)*\})*$/i,url:/^(?:https?|ftp):\/\/(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z0-9\u{00a1}-\u{ffff}]+-)*[a-z0-9\u{00a1}-\u{ffff}]+)(?:\.(?:[a-z0-9\u{00a1}-\u{ffff}]+-)*[a-z0-9\u{00a1}-\u{ffff}]+)*(?:\.(?:[a-z\u{00a1}-\u{ffff}]{2,})))(?::\d{2,5})?(?:\/[^\s]*)?$/iu,email:/^[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/i,hostname:/^(?=.{1,253}\.?$)[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[-0-9a-z]{0,61}[0-9a-z])?)*\.?$/i,ipv4:/^(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)\.){3}(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)$/,ipv6:/^((([0-9a-f]{1,4}:){7}([0-9a-f]{1,4}|:))|(([0-9a-f]{1,4}:){6}(:[0-9a-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){5}(((:[0-9a-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){4}(((:[0-9a-f]{1,4}){1,3})|((:[0-9a-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){3}(((:[0-9a-f]{1,4}){1,4})|((:[0-9a-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){2}(((:[0-9a-f]{1,4}){1,5})|((:[0-9a-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){1}(((:[0-9a-f]{1,4}){1,6})|((:[0-9a-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9a-f]{1,4}){1,7})|((:[0-9a-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))$/i,regex:function(e){if(w.test(e))return!1;try{return new RegExp(e),!0}catch{return!1}},uuid:/^(?:urn:uuid:)?[0-9a-f]{8}-(?:[0-9a-f]{4}-){3}[0-9a-f]{12}$/i,"json-pointer":/^(?:\/(?:[^~/]|~0|~1)*)*$/,"json-pointer-uri-fragment":/^#(?:\/(?:[a-z0-9_\-.!$&'()*+,;:=@]|%[0-9a-f]{2}|~0|~1)*)*$/i,"relative-json-pointer":/^(?:0|[1-9][0-9]*)(?:#|(?:\/(?:[^~/]|~0|~1)*)*)$/,byte:function(e){return g.lastIndex=0,g.test(e)},int32:{type:"number",validate:function(e){return Number.isInteger(e)&&e<=v&&e>=y}},int64:{type:"number",validate:function(e){return Number.isInteger(e)}},float:{type:"number",validate:b},double:{type:"number",validate:b},password:!0,binary:!0},e.fastFormats={...e.fullFormats,date:t(/^\d\d\d\d-[0-1]\d-[0-3]\d$/,s),time:t(/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i,l),"date-time":t(/^\d\d\d\d-[0-1]\d-[0-3]\dt(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i,p),"iso-time":t(/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)?$/i,c),"iso-date-time":t(/^\d\d\d\d-[0-1]\d-[0-3]\d[t\s](?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)?$/i,h),uri:/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/)?[^\s]*$/i,"uri-reference":/^(?:(?:[a-z][a-z0-9+\-.]*:)?\/?\/)?(?:[^\\\s#][^\s#]*)?(?:#[^\\\s]*)?$/i,email:/^[a-z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?)*$/i},e.formatNames=Object.keys(e.fullFormats);var r=/^(\d\d\d\d)-(\d\d)-(\d\d)$/,i=[0,31,28,31,30,31,30,31,31,30,31,30,31];function n(e){let t=r.exec(e);if(!t)return!1;let n=+t[2],s=+t[3];return n>=1&&n<=12&&s>=1&&s<=(2===n&&function(e){return e%4==0&&(e%100!=0||e%400==0)}(+t[1])?29:i[n])}function s(e,t){if(e&&t)return e>t?1:e<t?-1:0}var a=/^(\d\d):(\d\d):(\d\d(?:\.\d+)?)(z|([+-])(\d\d)(?::?(\d\d))?)?$/i;function o(e){return function(t){let r=a.exec(t);if(!r)return!1;let i=+r[1],n=+r[2],s=+r[3],o="-"===r[5]?-1:1,l=+(r[6]||0),c=+(r[7]||0);if(l>23||c>59||e&&!r[4])return!1;if(i<=23&&n<=59&&s<60)return!0;let u=n-c*o,d=i-l*o-(u<0?1:0);return(23===d||-1===d)&&(59===u||-1===u)&&s<61}}function l(e,t){if(!e||!t)return;let r=new Date("2020-01-01T"+e).valueOf(),i=new Date("2020-01-01T"+t).valueOf();return r&&i?r-i:void 0}function c(e,t){if(!e||!t)return;let r=a.exec(e),i=a.exec(t);return r&&i?(e=r[1]+r[2]+r[3])>(t=i[1]+i[2]+i[3])?1:e<t?-1:0:void 0}var u=/t|\s/i;function d(e){let t=o(e);return function(e){let r=e.split(u);return 2===r.length&&n(r[0])&&t(r[1])}}function p(e,t){if(!e||!t)return;let r=new Date(e).valueOf(),i=new Date(t).valueOf();return r&&i?r-i:void 0}function h(e,t){if(!e||!t)return;let[r,i]=e.split(u),[n,a]=t.split(u),o=s(r,n);return void 0!==o?o||l(i,a):void 0}var f=/\/|:/,m=/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)(?:\?(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,g=/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/gm,y=-(2**31),v=2**31-1;function b(){return!0}var w=/[^\\]\\Z/}),Ur=u(e=>{Object.defineProperty(e,"__esModule",{value:!0}),e.formatLimitDefinition=void 0;var t=Lr(),r=Tt(),i=r.operators,n={formatMaximum:{okStr:"<=",ok:i.LTE,fail:i.GT},formatMinimum:{okStr:">=",ok:i.GTE,fail:i.LT},formatExclusiveMaximum:{okStr:"<",ok:i.LT,fail:i.GTE},formatExclusiveMinimum:{okStr:">",ok:i.GT,fail:i.LTE}},s={message:({keyword:e,schemaCode:t})=>r.str`should be ${n[e].okStr} ${t}`,params:({keyword:e,schemaCode:t})=>r._`{comparison: ${n[e].okStr}, limit: ${t}}`};e.formatLimitDefinition={keyword:Object.keys(n),type:"string",schemaType:"string",$data:!0,error:s,code(e){let{gen:i,data:s,schemaCode:a,keyword:o,it:l}=e,{opts:c,self:u}=l;if(!c.validateFormats)return;let d=new t.KeywordCxt(l,u.RULES.all.format.definition,"format");function p(e){return r._`${e}.compare(${s}, ${a}) ${n[o].fail} 0`}d.$data?function(){let t=i.scopeValue("formats",{ref:u.formats,code:c.code.formats}),n=i.const("fmt",r._`${t}[${d.schemaCode}]`);e.fail$data((0,r.or)(r._`typeof ${n} != "object"`,r._`${n} instanceof RegExp`,r._`typeof ${n}.compare != "function"`,p(n)))}():function(){let t=d.schema,n=u.formats[t];if(!n||!0===n)return;if("object"!=typeof n||n instanceof RegExp||"function"!=typeof n.compare)throw new Error(`"${o}": format "${t}" does not define "compare" function`);let s=i.scopeValue("formats",{key:t,ref:n,code:c.code.formats?r._`${c.code.formats}${(0,r.getProperty)(t)}`:void 0});e.fail$data(p(s))}()},dependencies:["format"]},e.default=t=>(t.addKeyword(e.formatLimitDefinition),t)}),Br=u((e,t)=>{Object.defineProperty(e,"__esModule",{value:!0});var r=qr(),i=Ur(),n=Tt(),s=new n.Name("fullFormats"),a=new n.Name("fastFormats"),o=(e,t={keywords:!0})=>{if(Array.isArray(t))return l(e,t,r.fullFormats,s),e;let[n,o]="fast"===t.mode?[r.fastFormats,a]:[r.fullFormats,s];return l(e,t.formats||r.formatNames,n,o),t.keywords&&(0,i.default)(e),e};function l(e,t,r,i){var s,a;null!==(s=(a=e.opts.code).formats)&&void 0!==s||(a.formats=n._`require("ajv-formats/dist/formats").${i}`);for(let i of t)e.addFormat(i,r[i])}o.get=(e,t="full")=>{let i=("fast"===t?r.fastFormats:r.fullFormats)[e];if(!i)throw new Error(`Unknown format "${e}"`);return i},t.exports=e=o,Object.defineProperty(e,"__esModule",{value:!0}),e.default=o}),Hr=u((e,t)=>{var r=Lr(),i=zr(),n=Br(),s=fe()({proto:!0});t.exports=class e{constructor(e){this.ajv=new r({...e,strictSchema:!1,validateSchema:!1,allowUnionTypes:!0,uriResolver:i}),n(this.ajv),this.ajv.addKeyword({keyword:"fjs_type",type:"object",errors:!1,validate:(e,t)=>t instanceof Date}),this._ajvSchemas={},this._ajvOptions=e||{}}addSchema(e,t){let r=e.$id||t;if(void 0!==e.$id&&"#"===e.$id[0]&&(r=t+e.$id),void 0===this.ajv.refs[r]&&void 0===this.ajv.schemas[r]){let t=s(e);this.convertSchemaToAjvFormat(t),this.ajv.addSchema(t,r),this._ajvSchemas[r]=e}}validate(e,t){return this.ajv.validate(e,t)}convertSchemaToAjvFormat(e){if(null!==e){"string"===e.type?(e.fjs_type="string",e.type=["string","object"]):Array.isArray(e.type)&&e.type.includes("string")&&!e.type.includes("object")&&(e.fjs_type="string",e.type.push("object"));for(let t in e)"object"==typeof e[t]&&this.convertSchemaToAjvFormat(e[t])}}getState(){return{ajvOptions:this._ajvOptions,ajvSchemas:this._ajvSchemas}}static restoreFromState(t){let r=new e(t.ajvOptions);for(let[e,i]of Object.entries(t.ajvSchemas))r.ajv.addSchema(i,e);return r}}}),Vr=u((e,t)=>{t.exports=class e{constructor(e,t,r="#"){this.schema=e,this.schemaId=t,this.jsonPointer=r}getPropertyLocation(t){return new e(this.schema[t],this.schemaId,this.jsonPointer+"/"+t)}getSchemaRef(){return this.schemaId+this.jsonPointer}}}),Gr=u((e,t)=>{t.exports=d,t.exports.default=d;var r={$schema:"http://json-schema.org/draft-07/schema#",$id:"http://json-schema.org/draft-07/schema#",title:"Core schema meta-schema",definitions:{schemaArray:{type:"array",minItems:1,items:{$ref:"#"}},nonNegativeInteger:{type:"integer",minimum:0},nonNegativeIntegerDefault0:{allOf:[{$ref:"#/definitions/nonNegativeInteger"},{default:0}]},simpleTypes:{enum:["array","boolean","integer","null","number","object","string"]},stringArray:{type:"array",items:{type:"string"},uniqueItems:!0,default:[]}},type:["object","boolean"],properties:{$id:{type:"string",format:"uri-reference"},$schema:{type:"string",format:"uri"},$ref:{type:"string",format:"uri-reference"},$comment:{type:"string"},title:{type:"string"},description:{type:"string"},default:!0,readOnly:{type:"boolean",default:!1},examples:{type:"array",items:!0},multipleOf:{type:"number",exclusiveMinimum:0},maximum:{type:"number"},exclusiveMaximum:{type:"number"},minimum:{type:"number"},exclusiveMinimum:{type:"number"},maxLength:{$ref:"#/definitions/nonNegativeInteger"},minLength:{$ref:"#/definitions/nonNegativeIntegerDefault0"},pattern:{type:"string",format:"regex"},additionalItems:{$ref:"#"},items:{anyOf:[{$ref:"#"},{$ref:"#/definitions/schemaArray"}],default:!0},maxItems:{$ref:"#/definitions/nonNegativeInteger"},minItems:{$ref:"#/definitions/nonNegativeIntegerDefault0"},uniqueItems:{type:"boolean",default:!1},contains:{$ref:"#"},maxProperties:{$ref:"#/definitions/nonNegativeInteger"},minProperties:{$ref:"#/definitions/nonNegativeIntegerDefault0"},required:{$ref:"#/definitions/stringArray"},additionalProperties:{$ref:"#"},definitions:{type:"object",additionalProperties:{$ref:"#"},default:{}},properties:{type:"object",additionalProperties:{$ref:"#"},default:{}},patternProperties:{type:"object",additionalProperties:{$ref:"#"},propertyNames:{format:"regex"},default:{}},dependencies:{type:"object",additionalProperties:{anyOf:[{$ref:"#"},{$ref:"#/definitions/stringArray"}]}},propertyNames:{$ref:"#"},const:!0,enum:{type:"array",items:!0,minItems:1,uniqueItems:!0},type:{anyOf:[{$ref:"#/definitions/simpleTypes"},{type:"array",items:{$ref:"#/definitions/simpleTypes"},minItems:1,uniqueItems:!0}]},format:{type:"string"},contentMediaType:{type:"string"},contentEncoding:{type:"string"},if:{$ref:"#"},then:{$ref:"#"},else:{$ref:"#"},allOf:{$ref:"#/definitions/schemaArray"},anyOf:{$ref:"#/definitions/schemaArray"},oneOf:{$ref:"#/definitions/schemaArray"},not:{$ref:"#"}},default:!0},i={enum:["array","boolean","integer","null","number","object","string"]},n=/^(?:[a-z][a-z0-9+\-.]*:)?(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'"()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?(?:\?(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,s=qr().fullFormats.uri,a=qr().fullFormats.regex;function o(e,{instancePath:t="",rootData:r=e}={}){return"number"!=typeof e||e%1||isNaN(e)||!isFinite(e)?(o.errors=[{instancePath:t,schemaPath:"#/definitions/nonNegativeInteger/type",keyword:"type",params:{type:"integer"},message:"must be integer"}],!1):"number"==typeof e&&isFinite(e)&&(e<0||isNaN(e))?(o.errors=[{instancePath:t,schemaPath:"#/definitions/nonNegativeInteger/minimum",keyword:"minimum",params:{comparison:">=",limit:0},message:"must be >= 0"}],!1):(o.errors=null,!0)}var l={validate:d};function c(e,{instancePath:t="",rootData:r=e}={}){let i=null,n=0;if(0===n){if(!Array.isArray(e))return c.errors=[{instancePath:t,schemaPath:"#/type",keyword:"type",params:{type:"array"},message:"must be array"}],!1;if(e.length<1)return c.errors=[{instancePath:t,schemaPath:"#/minItems",keyword:"minItems",params:{limit:1},message:"must NOT have fewer than 1 items"}],!1;{let s=e.length;for(let a=0;a<s;a++){let s=n;if(l.validate(e[a],{instancePath:t+"/"+a,parentData:e,parentDataProperty:a,rootData:r})||(i=null===i?l.validate.errors:i.concat(l.validate.errors),n=i.length),s!==n)break}}}return c.errors=i,0===n}var u=or().default;function d(e,{instancePath:t="",rootData:l=e}={}){let p=null,h=0;if((!e||"object"!=typeof e||Array.isArray(e))&&"boolean"!=typeof e)return d.errors=[{instancePath:t,schemaPath:"#/type",keyword:"type",params:{type:r.type},message:"must be object,boolean"}],!1;if(0===h&&e&&"object"==typeof e&&!Array.isArray(e)){if(void 0!==e.$id){let r=e.$id,i=h;if(h===i&&h===i){if("string"!=typeof r)return d.errors=[{instancePath:t+"/$id",schemaPath:"#/properties/%24id/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;if(!n.test(r))return d.errors=[{instancePath:t+"/$id",schemaPath:"#/properties/%24id/format",keyword:"format",params:{format:"uri-reference"},message:'must match format "uri-reference"'}],!1}var f=i===h}else f=!0;if(f){if(void 0!==e.$schema){let r=e.$schema,i=h;if(h===i&&h===i){if("string"!=typeof r)return d.errors=[{instancePath:t+"/$schema",schemaPath:"#/properties/%24schema/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;if(!s(r))return d.errors=[{instancePath:t+"/$schema",schemaPath:"#/properties/%24schema/format",keyword:"format",params:{format:"uri"},message:'must match format "uri"'}],!1}f=i===h}else f=!0;if(f){if(void 0!==e.$ref){let r=e.$ref,i=h;if(h===i&&h===i){if("string"!=typeof r)return d.errors=[{instancePath:t+"/$ref",schemaPath:"#/properties/%24ref/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;if(!n.test(r))return d.errors=[{instancePath:t+"/$ref",schemaPath:"#/properties/%24ref/format",keyword:"format",params:{format:"uri-reference"},message:'must match format "uri-reference"'}],!1}f=i===h}else f=!0;if(f){if(void 0!==e.$comment){let r=h;if("string"!=typeof e.$comment)return d.errors=[{instancePath:t+"/$comment",schemaPath:"#/properties/%24comment/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;f=r===h}else f=!0;if(f){if(void 0!==e.title){let r=h;if("string"!=typeof e.title)return d.errors=[{instancePath:t+"/title",schemaPath:"#/properties/title/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;f=r===h}else f=!0;if(f){if(void 0!==e.description){let r=h;if("string"!=typeof e.description)return d.errors=[{instancePath:t+"/description",schemaPath:"#/properties/description/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;f=r===h}else f=!0;if(f){if(void 0!==e.readOnly){let r=h;if("boolean"!=typeof e.readOnly)return d.errors=[{instancePath:t+"/readOnly",schemaPath:"#/properties/readOnly/type",keyword:"type",params:{type:"boolean"},message:"must be boolean"}],!1;f=r===h}else f=!0;if(f){if(void 0!==e.examples){let r=h;if(h===r&&!Array.isArray(e.examples))return d.errors=[{instancePath:t+"/examples",schemaPath:"#/properties/examples/type",keyword:"type",params:{type:"array"},message:"must be array"}],!1;f=r===h}else f=!0;if(f){if(void 0!==e.multipleOf){let r=e.multipleOf,i=h;if(h===i){if("number"!=typeof r||!isFinite(r))return d.errors=[{instancePath:t+"/multipleOf",schemaPath:"#/properties/multipleOf/type",keyword:"type",params:{type:"number"},message:"must be number"}],!1;if(r<=0||isNaN(r))return d.errors=[{instancePath:t+"/multipleOf",schemaPath:"#/properties/multipleOf/exclusiveMinimum",keyword:"exclusiveMinimum",params:{comparison:">",limit:0},message:"must be > 0"}],!1}f=i===h}else f=!0;if(f){if(void 0!==e.maximum){let r=e.maximum,i=h;if("number"!=typeof r||!isFinite(r))return d.errors=[{instancePath:t+"/maximum",schemaPath:"#/properties/maximum/type",keyword:"type",params:{type:"number"},message:"must be number"}],!1;f=i===h}else f=!0;if(f){if(void 0!==e.exclusiveMaximum){let r=e.exclusiveMaximum,i=h;if("number"!=typeof r||!isFinite(r))return d.errors=[{instancePath:t+"/exclusiveMaximum",schemaPath:"#/properties/exclusiveMaximum/type",keyword:"type",params:{type:"number"},message:"must be number"}],!1;f=i===h}else f=!0;if(f){if(void 0!==e.minimum){let r=e.minimum,i=h;if("number"!=typeof r||!isFinite(r))return d.errors=[{instancePath:t+"/minimum",schemaPath:"#/properties/minimum/type",keyword:"type",params:{type:"number"},message:"must be number"}],!1;f=i===h}else f=!0;if(f){if(void 0!==e.exclusiveMinimum){let r=e.exclusiveMinimum,i=h;if("number"!=typeof r||!isFinite(r))return d.errors=[{instancePath:t+"/exclusiveMinimum",schemaPath:"#/properties/exclusiveMinimum/type",keyword:"type",params:{type:"number"},message:"must be number"}],!1;f=i===h}else f=!0;if(f){if(void 0!==e.maxLength){let r=e.maxLength,i=h,n=h;if("number"!=typeof r||r%1||isNaN(r)||!isFinite(r))return d.errors=[{instancePath:t+"/maxLength",schemaPath:"#/definitions/nonNegativeInteger/type",keyword:"type",params:{type:"integer"},message:"must be integer"}],!1;if(h===n&&"number"==typeof r&&isFinite(r)&&(r<0||isNaN(r)))return d.errors=[{instancePath:t+"/maxLength",schemaPath:"#/definitions/nonNegativeInteger/minimum",keyword:"minimum",params:{comparison:">=",limit:0},message:"must be >= 0"}],!1;f=i===h}else f=!0;if(f){if(void 0!==e.minLength){let r=h;o(e.minLength,{instancePath:t+"/minLength",parentData:e,parentDataProperty:"minLength",rootData:l})||(p=null===p?o.errors:p.concat(o.errors),h=p.length),f=r===h}else f=!0;if(f){if(void 0!==e.pattern){let r=e.pattern,i=h;if(h===i&&h===i){if("string"!=typeof r)return d.errors=[{instancePath:t+"/pattern",schemaPath:"#/properties/pattern/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;if(!a(r))return d.errors=[{instancePath:t+"/pattern",schemaPath:"#/properties/pattern/format",keyword:"format",params:{format:"regex"},message:'must match format "regex"'}],!1}f=i===h}else f=!0;if(f){if(void 0!==e.additionalItems){let r=h;d(e.additionalItems,{instancePath:t+"/additionalItems",parentData:e,parentDataProperty:"additionalItems",rootData:l})||(p=null===p?d.errors:p.concat(d.errors),h=p.length),f=r===h}else f=!0;if(f){if(void 0!==e.items){let r=e.items,i=h,n=h,s=!1,a=h;d(r,{instancePath:t+"/items",parentData:e,parentDataProperty:"items",rootData:l})||(p=null===p?d.errors:p.concat(d.errors),h=p.length);var m=a===h;if(s=s||m,!s){let i=h;c(r,{instancePath:t+"/items",parentData:e,parentDataProperty:"items",rootData:l})||(p=null===p?c.errors:p.concat(c.errors),h=p.length),m=i===h,s=s||m}if(!s){let e={instancePath:t+"/items",schemaPath:"#/properties/items/anyOf",keyword:"anyOf",params:{},message:"must match a schema in anyOf"};return null===p?p=[e]:p.push(e),h++,d.errors=p,!1}h=n,null!==p&&(n?p.length=n:p=null),f=i===h}else f=!0;if(f){if(void 0!==e.maxItems){let r=e.maxItems,i=h,n=h;if("number"!=typeof r||r%1||isNaN(r)||!isFinite(r))return d.errors=[{instancePath:t+"/maxItems",schemaPath:"#/definitions/nonNegativeInteger/type",keyword:"type",params:{type:"integer"},message:"must be integer"}],!1;if(h===n&&"number"==typeof r&&isFinite(r)&&(r<0||isNaN(r)))return d.errors=[{instancePath:t+"/maxItems",schemaPath:"#/definitions/nonNegativeInteger/minimum",keyword:"minimum",params:{comparison:">=",limit:0},message:"must be >= 0"}],!1;f=i===h}else f=!0;if(f){if(void 0!==e.minItems){let r=h;o(e.minItems,{instancePath:t+"/minItems",parentData:e,parentDataProperty:"minItems",rootData:l})||(p=null===p?o.errors:p.concat(o.errors),h=p.length),f=r===h}else f=!0;if(f){if(void 0!==e.uniqueItems){let r=h;if("boolean"!=typeof e.uniqueItems)return d.errors=[{instancePath:t+"/uniqueItems",schemaPath:"#/properties/uniqueItems/type",keyword:"type",params:{type:"boolean"},message:"must be boolean"}],!1;f=r===h}else f=!0;if(f){if(void 0!==e.contains){let r=h;d(e.contains,{instancePath:t+"/contains",parentData:e,parentDataProperty:"contains",rootData:l})||(p=null===p?d.errors:p.concat(d.errors),h=p.length),f=r===h}else f=!0;if(f){if(void 0!==e.maxProperties){let r=e.maxProperties,i=h,n=h;if("number"!=typeof r||r%1||isNaN(r)||!isFinite(r))return d.errors=[{instancePath:t+"/maxProperties",schemaPath:"#/definitions/nonNegativeInteger/type",keyword:"type",params:{type:"integer"},message:"must be integer"}],!1;if(h===n&&"number"==typeof r&&isFinite(r)&&(r<0||isNaN(r)))return d.errors=[{instancePath:t+"/maxProperties",schemaPath:"#/definitions/nonNegativeInteger/minimum",keyword:"minimum",params:{comparison:">=",limit:0},message:"must be >= 0"}],!1;f=i===h}else f=!0;if(f){if(void 0!==e.minProperties){let r=h;o(e.minProperties,{instancePath:t+"/minProperties",parentData:e,parentDataProperty:"minProperties",rootData:l})||(p=null===p?o.errors:p.concat(o.errors),h=p.length),f=r===h}else f=!0;if(f){if(void 0!==e.required){let r=e.required,i=h;if(h==h){if(!Array.isArray(r))return d.errors=[{instancePath:t+"/required",schemaPath:"#/definitions/stringArray/type",keyword:"type",params:{type:"array"},message:"must be array"}],!1;{var g=!0;let e=r.length;for(let i=0;i<e;i++){let e=h;if("string"!=typeof r[i])return d.errors=[{instancePath:t+"/required/"+i,schemaPath:"#/definitions/stringArray/items/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;if(!(g=e===h))break}if(g){let e,i=r.length;if(i>1){let n={};for(;i--;){let s=r[i];if("string"==typeof s){if("number"==typeof n[s])return e=n[s],d.errors=[{instancePath:t+"/required",schemaPath:"#/definitions/stringArray/uniqueItems",keyword:"uniqueItems",params:{i,j:e},message:"must NOT have duplicate items (items ## "+e+" and "+i+" are identical)"}],!1;n[s]=i}}}}}}f=i===h}else f=!0;if(f){if(void 0!==e.additionalProperties){let r=h;d(e.additionalProperties,{instancePath:t+"/additionalProperties",parentData:e,parentDataProperty:"additionalProperties",rootData:l})||(p=null===p?d.errors:p.concat(d.errors),h=p.length),f=r===h}else f=!0;if(f){if(void 0!==e.definitions){let r=e.definitions,i=h;if(h===i){if(!r||"object"!=typeof r||Array.isArray(r))return d.errors=[{instancePath:t+"/definitions",schemaPath:"#/properties/definitions/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;for(let e in r){let i=h;if(d(r[e],{instancePath:t+"/definitions/"+e.replace(/~/g,"~0").replace(/\//g,"~1"),parentData:r,parentDataProperty:e,rootData:l})||(p=null===p?d.errors:p.concat(d.errors),h=p.length),i!==h)break}}f=i===h}else f=!0;if(f){if(void 0!==e.properties){let r=e.properties,i=h;if(h===i){if(!r||"object"!=typeof r||Array.isArray(r))return d.errors=[{instancePath:t+"/properties",schemaPath:"#/properties/properties/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;for(let e in r){let i=h;if(d(r[e],{instancePath:t+"/properties/"+e.replace(/~/g,"~0").replace(/\//g,"~1"),parentData:r,parentDataProperty:e,rootData:l})||(p=null===p?d.errors:p.concat(d.errors),h=p.length),i!==h)break}}f=i===h}else f=!0;if(f){if(void 0!==e.patternProperties){let r=e.patternProperties,i=h;if(h===i){if(!r||"object"!=typeof r||Array.isArray(r))return d.errors=[{instancePath:t+"/patternProperties",schemaPath:"#/properties/patternProperties/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;for(let e in r){let r=h;if(h===r&&"string"==typeof e&&!a(e)){let r={instancePath:t+"/patternProperties",schemaPath:"#/properties/patternProperties/propertyNames/format",keyword:"format",params:{format:"regex"},message:'must match format "regex"',propertyName:e};null===p?p=[r]:p.push(r),h++}var y=r===h;if(!y){let r={instancePath:t+"/patternProperties",schemaPath:"#/properties/patternProperties/propertyNames",keyword:"propertyNames",params:{propertyName:e},message:"property name must be valid"};return null===p?p=[r]:p.push(r),h++,d.errors=p,!1}}if(y)for(let e in r){let i=h;if(d(r[e],{instancePath:t+"/patternProperties/"+e.replace(/~/g,"~0").replace(/\//g,"~1"),parentData:r,parentDataProperty:e,rootData:l})||(p=null===p?d.errors:p.concat(d.errors),h=p.length),i!==h)break}}f=i===h}else f=!0;if(f){if(void 0!==e.dependencies){let r=e.dependencies,i=h;if(h===i){if(!r||"object"!=typeof r||Array.isArray(r))return d.errors=[{instancePath:t+"/dependencies",schemaPath:"#/properties/dependencies/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;for(let e in r){let i=r[e],n=h,s=h,a=!1,o=h;d(i,{instancePath:t+"/dependencies/"+e.replace(/~/g,"~0").replace(/\//g,"~1"),parentData:r,parentDataProperty:e,rootData:l})||(p=null===p?d.errors:p.concat(d.errors),h=p.length);var v=o===h;if(a=a||v,!a){let r=h;if(h==h)if(Array.isArray(i)){var b=!0;let r=i.length;for(let n=0;n<r;n++){let r=h;if("string"!=typeof i[n]){let r={instancePath:t+"/dependencies/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/"+n,schemaPath:"#/definitions/stringArray/items/type",keyword:"type",params:{type:"string"},message:"must be string"};null===p?p=[r]:p.push(r),h++}if(!(b=r===h))break}if(b){let r,n=i.length;if(n>1){let s={};for(;n--;){let a=i[n];if("string"==typeof a){if("number"==typeof s[a]){r=s[a];let i={instancePath:t+"/dependencies/"+e.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/definitions/stringArray/uniqueItems",keyword:"uniqueItems",params:{i:n,j:r},message:"must NOT have duplicate items (items ## "+r+" and "+n+" are identical)"};null===p?p=[i]:p.push(i),h++;break}s[a]=n}}}}}else{let r={instancePath:t+"/dependencies/"+e.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/definitions/stringArray/type",keyword:"type",params:{type:"array"},message:"must be array"};null===p?p=[r]:p.push(r),h++}v=r===h,a=a||v}if(!a){let r={instancePath:t+"/dependencies/"+e.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/properties/dependencies/additionalProperties/anyOf",keyword:"anyOf",params:{},message:"must match a schema in anyOf"};return null===p?p=[r]:p.push(r),h++,d.errors=p,!1}if(h=s,null!==p&&(s?p.length=s:p=null),n!==h)break}}f=i===h}else f=!0;if(f){if(void 0!==e.propertyNames){let r=h;d(e.propertyNames,{instancePath:t+"/propertyNames",parentData:e,parentDataProperty:"propertyNames",rootData:l})||(p=null===p?d.errors:p.concat(d.errors),h=p.length),f=r===h}else f=!0;if(f){if(void 0!==e.enum){let r=e.enum,i=h;if(h===i){if(!Array.isArray(r))return d.errors=[{instancePath:t+"/enum",schemaPath:"#/properties/enum/type",keyword:"type",params:{type:"array"},message:"must be array"}],!1;if(r.length<1)return d.errors=[{instancePath:t+"/enum",schemaPath:"#/properties/enum/minItems",keyword:"minItems",params:{limit:1},message:"must NOT have fewer than 1 items"}],!1;{let e,i=r.length;if(i>1)for(;i--;)for(e=i;e--;)if(u(r[i],r[e]))return d.errors=[{instancePath:t+"/enum",schemaPath:"#/properties/enum/uniqueItems",keyword:"uniqueItems",params:{i,j:e},message:"must NOT have duplicate items (items ## "+e+" and "+i+" are identical)"}],!1}}f=i===h}else f=!0;if(f){if(void 0!==e.type){let r=e.type,n=h,s=h,a=!1,o=h;if("array"!==r&&"boolean"!==r&&"integer"!==r&&"null"!==r&&"number"!==r&&"object"!==r&&"string"!==r){let e={instancePath:t+"/type",schemaPath:"#/definitions/simpleTypes/enum",keyword:"enum",params:{allowedValues:i.enum},message:"must be equal to one of the allowed values"};null===p?p=[e]:p.push(e),h++}var w=o===h;if(a=a||w,!a){let e=h;if(h===e)if(Array.isArray(r))if(r.length<1){let e={instancePath:t+"/type",schemaPath:"#/properties/type/anyOf/1/minItems",keyword:"minItems",params:{limit:1},message:"must NOT have fewer than 1 items"};null===p?p=[e]:p.push(e),h++}else{var _=!0;let e=r.length;for(let n=0;n<e;n++){let e=r[n],s=h;if("array"!==e&&"boolean"!==e&&"integer"!==e&&"null"!==e&&"number"!==e&&"object"!==e&&"string"!==e){let e={instancePath:t+"/type/"+n,schemaPath:"#/definitions/simpleTypes/enum",keyword:"enum",params:{allowedValues:i.enum},message:"must be equal to one of the allowed values"};null===p?p=[e]:p.push(e),h++}if(!(_=s===h))break}if(_){let e,i=r.length;if(i>1)e:for(;i--;)for(e=i;e--;)if(u(r[i],r[e])){let r={instancePath:t+"/type",schemaPath:"#/properties/type/anyOf/1/uniqueItems",keyword:"uniqueItems",params:{i,j:e},message:"must NOT have duplicate items (items ## "+e+" and "+i+" are identical)"};null===p?p=[r]:p.push(r),h++;break e}}}else{let e={instancePath:t+"/type",schemaPath:"#/properties/type/anyOf/1/type",keyword:"type",params:{type:"array"},message:"must be array"};null===p?p=[e]:p.push(e),h++}w=e===h,a=a||w}if(!a){let e={instancePath:t+"/type",schemaPath:"#/properties/type/anyOf",keyword:"anyOf",params:{},message:"must match a schema in anyOf"};return null===p?p=[e]:p.push(e),h++,d.errors=p,!1}h=s,null!==p&&(s?p.length=s:p=null),f=n===h}else f=!0;if(f){if(void 0!==e.format){let r=h;if("string"!=typeof e.format)return d.errors=[{instancePath:t+"/format",schemaPath:"#/properties/format/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;f=r===h}else f=!0;if(f){if(void 0!==e.contentMediaType){let r=h;if("string"!=typeof e.contentMediaType)return d.errors=[{instancePath:t+"/contentMediaType",schemaPath:"#/properties/contentMediaType/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;f=r===h}else f=!0;if(f){if(void 0!==e.contentEncoding){let r=h;if("string"!=typeof e.contentEncoding)return d.errors=[{instancePath:t+"/contentEncoding",schemaPath:"#/properties/contentEncoding/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;f=r===h}else f=!0;if(f){if(void 0!==e.if){let r=h;d(e.if,{instancePath:t+"/if",parentData:e,parentDataProperty:"if",rootData:l})||(p=null===p?d.errors:p.concat(d.errors),h=p.length),f=r===h}else f=!0;if(f){if(void 0!==e.then){let r=h;d(e.then,{instancePath:t+"/then",parentData:e,parentDataProperty:"then",rootData:l})||(p=null===p?d.errors:p.concat(d.errors),h=p.length),f=r===h}else f=!0;if(f){if(void 0!==e.else){let r=h;d(e.else,{instancePath:t+"/else",parentData:e,parentDataProperty:"else",rootData:l})||(p=null===p?d.errors:p.concat(d.errors),h=p.length),f=r===h}else f=!0;if(f){if(void 0!==e.allOf){let r=h;c(e.allOf,{instancePath:t+"/allOf",parentData:e,parentDataProperty:"allOf",rootData:l})||(p=null===p?c.errors:p.concat(c.errors),h=p.length),f=r===h}else f=!0;if(f){if(void 0!==e.anyOf){let r=h;c(e.anyOf,{instancePath:t+"/anyOf",parentData:e,parentDataProperty:"anyOf",rootData:l})||(p=null===p?c.errors:p.concat(c.errors),h=p.length),f=r===h}else f=!0;if(f){if(void 0!==e.oneOf){let r=h;c(e.oneOf,{instancePath:t+"/oneOf",parentData:e,parentDataProperty:"oneOf",rootData:l})||(p=null===p?c.errors:p.concat(c.errors),h=p.length),f=r===h}else f=!0;if(f)if(void 0!==e.not){let r=h;d(e.not,{instancePath:t+"/not",parentData:e,parentDataProperty:"not",rootData:l})||(p=null===p?d.errors:p.concat(d.errors),h=p.length),f=r===h}else f=!0}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}return d.errors=p,0===h}}),Wr=u((e,t)=>{var r=class extends Error{constructor(e,t){super(),this.name="JsonSchemaMergeError",this.code="JSON_SCHEMA_MERGE_ERROR",this.message=`Failed to merge "${e}" keyword schemas.`,this.schemas=t}},i=class extends Error{constructor(e,t){super(),this.name="JsonSchemaMergeError",this.code="JSON_SCHEMA_MERGE_ERROR",this.message=`Resolver for "${e}" keyword not found.`,this.schemas=t}},n=class extends Error{constructor(e){super(),this.name="JsonSchemaMergeError",this.code="JSON_SCHEMA_MERGE_ERROR",this.message=`Invalid "onConflict" option: "${e}".`}};t.exports={MergeError:r,ResolverNotFoundError:i,InvalidOnConflictOptionError:n}}),Kr=u((e,t)=>{var r=St(),{MergeError:i}=Wr();function n(e){let t=e[0];for(let r=1;r<e.length;r++)t=t.filter(t=>e[r].includes(t));return t}t.exports={arraysIntersection:function(e,t,r){let s=n(t);if(0===s.length)throw new i(e,t);r[e]=s},hybridArraysIntersection:function(e,t,r){for(let e=0;e<t.length;e++)Array.isArray(t[e])||(t[e]=[t[e]]);let s=n(t);if(0===s.length)throw new i(e,t);r[e]=1===s.length?s[0]:s},arraysUnion:function(e,t,r){let i=[];for(let e of t)for(let t of e)i.includes(t)||i.push(t);r[e]=i},minNumber:function(e,t,r){r[e]=Math.min(...t)},maxNumber:function(e,t,r){r[e]=Math.max(...t)},commonMultiple:function(e,t,r){let i=(e,t)=>t?i(t,e%t):e,n=(e,t)=>e*t/i(e,t),s=1;for(let e of t)for(;e*s%1!=0;)s*=10;let a=t[0]*s;for(let e of t)a=n(a,e*s);r[e]=a/s},allEqual:function(e,t,n){let s=t[0];for(let n=1;n<t.length;n++)if(!r(t[n],s))throw new i(e,t);n[e]=s},booleanAnd:function(e,t,r){for(let i of t)if(!1===i)return void(r[e]=!1);r[e]=!0},booleanOr:function(e,t,r){for(let i of t)if(!0===i)return void(r[e]=!0);r[e]=!1},skip:function(){}}}),Jr=u((e,t)=>{var r=St(),i=Kr(),n=Wr(),s={$id:i.skip,type:i.hybridArraysIntersection,enum:i.arraysIntersection,minLength:i.maxNumber,maxLength:i.minNumber,minimum:i.maxNumber,maximum:i.minNumber,multipleOf:i.commonMultiple,exclusiveMinimum:i.maxNumber,exclusiveMaximum:i.minNumber,minItems:i.maxNumber,maxItems:i.minNumber,maxProperties:i.minNumber,minProperties:i.maxNumber,const:i.allEqual,default:i.allEqual,format:i.allEqual,required:i.arraysUnion,properties:function(e,t,r,i,n){let s={};for(let e of i){let t=e.properties??{};for(let r of Object.keys(t))if(void 0===s[r]){s[r]=[t[r]];for(let t of i){if(e===t)continue;let i=c(t,r);void 0!==i&&s[r].push(i)}}}let a={};for(let e of Object.keys(s))a[e]=p(s[e],n);r[e]=a},patternProperties:u,additionalProperties:a,items:function(e,t,r,i,n){let s=0;for(let e of t)Array.isArray(e)&&(s=Math.max(s,e.length));if(0===s)return void(r[e]=p(t,n));let a=[];for(let e=0;e<s;e++){let t=[];for(let r of i){let i=l(r,e);void 0!==i&&t.push(i)}a[e]=p(t,n)}r[e]=a},additionalItems:function(e,t,r,i,n){let s=!1;for(let e of i)if(Array.isArray(e.items)){s=!0;break}if(!s)return void(r[e]=p(t,n));let a=[];for(let e of i){let t=e.additionalItems;void 0===t&&!Array.isArray(e.items)&&(t=e.items),void 0!==t&&a.push(t)}r[e]=p(a,n)},definitions:u,$defs:u,nullable:i.booleanAnd,oneOf:o,anyOf:o,allOf:i.arraysUnion,not:a,if:function(e,t,r,i,n){for(let e=0;e<i.length;e++){let t={if:i[e].if,then:i[e].then,else:i[e].else};if(void 0!==t.if){if(void 0===r.if){r.if=t.if,void 0!==t.then&&(r.then=t.then),void 0!==t.else&&(r.else=t.else);continue}void 0!==r.then&&(r.then=p([r.then,t],n)),void 0!==r.else&&(r.else=p([r.else,t],n))}}},then:i.skip,else:i.skip,dependencies:d,dependentRequired:d,dependentSchemas:u,propertyNames:a,uniqueItems:i.booleanOr,contains:a};function a(e,t,r,i,n){r[e]=p(t,n)}function o(e,t,r,i,s){if(1===t.length)return void(r[e]=t[0]);let a=function(e){let t=[[]];for(let r of e){let e=[];for(let i of t)for(let t of r)e.push([...i,t]);t=e}return t}(t),o=[];for(let e of a)try{let t=p(e,s);void 0!==t&&o.push(t)}catch(e){if(e instanceof n.MergeError)continue;throw e}r[e]=o}function l(e,t){let{items:r,additionalItems:i}=e;return Array.isArray(r)?t<r.length?r[t]:i:void 0!==r?r:i}function c(e,t){let{properties:r,patternProperties:i,additionalProperties:n}=e;if(void 0!==r?.[t])return r[t];for(let e of Object.keys(i??{}))if(new RegExp(e).test(t))return i[e];return n}function u(e,t,r,i,n){let s={};for(let e of t)for(let t of Object.keys(e))void 0===s[t]&&(s[t]=[]),s[t].push(e[t]);let a={};for(let e of Object.keys(s)){let t=p(s[e],n);a[e]=t}r[e]=a}function d(e,t,r){let i={};for(let e of t)for(let t of Object.keys(e)){void 0===i[t]&&(i[t]=[]);let r=i[t];for(let i of e[t])r.includes(i)||r.push(i)}r[e]=i}function p(e,t){if(0===e.length)return{};if(1===e.length)return e[0];let r={},i={},n=!0;for(let t of e){if(!1===t)return!1;if(!0!==t){n=!1;for(let e of Object.keys(t))void 0===i[e]&&(i[e]=[]),i[e].push(t[e])}}if(n)return!0;for(let n of Object.keys(i))(t.resolvers[n]??t.defaultResolver)(n,i[n],r,e,t);return r}function h(e,t,i,s,a){let o=a.onConflict??"throw";if(1===t.length||"first"===o)return void(i[e]=t[0]);let l=!0;for(let e=1;e<t.length;e++)if(!r(t[e],t[0])){l=!1;break}if(l)i[e]=t[0];else{if("throw"===o)throw new n.ResolverNotFoundError(e,t);if("skip"!==o)throw new n.InvalidOnConflictOptionError(o)}}t.exports={mergeSchemas:function(e,t={}){return void 0===t.defaultResolver&&(t.defaultResolver=h),t.resolvers={...s,...t.resolvers},p(e,t)},keywordsResolvers:s,defaultResolver:h,...n}}),Zr=u((e,t)=>{var{mergeSchemas:r}=Jr();t.exports=function(e){return r(e,{onConflict:"skip"})}}),Yr=u((e,t)=>{t.exports=function(e,t,r,i){let n="";t.validatorSchemasIds.size>0?(n+="const Validator = require('fast-json-stringify/lib/validator')\n",n+=`const validatorState = ${JSON.stringify(i.getState())}\n`,n+="const validator = Validator.restoreFromState(validatorState)\n"):n+="const validator = null\n";let{schema:s,...a}=r.getState();return`\n  'use strict'\n\n  const Serializer = require('fast-json-stringify/lib/serializer')\n  const serializerState = ${JSON.stringify(a)}\n  const serializer = Serializer.restoreFromState(serializerState)\n\n  ${n}\n\n  module.exports = ${e.toString()}(validator, serializer)`},t.exports.dependencies={Serializer:ge(),Validator:Hr()}}),Xr=u((e,t)=>{var{RefResolver:r}=Et(),i=ge(),n=Hr(),s=Vr(),a=Gr(),o=Zr(),l=/'/g,c=2e4,u="default",d=["floor","ceil","round","trunc"],p=["default","json-stringify"],h=0;function f(e,t){if(!a(e)){t=t?`"${t}" `:"";let e=a.errors[0],r=new Error(`${t}schema is invalid: data${e.instancePath} ${e.message}`);throw r.errors=f.errors,r}}function m(e,t){let r=t.schema.$ref,i=r.indexOf("#");-1===i&&(i=r.length);let n=r.slice(0,i)||t.schemaId,a=r.slice(i)||"#",o=e.refResolver.getSchema(n,a);if(null===o)throw new Error(`Cannot find reference "${r}"`);let l=new s(o,n,a);return void 0!==o.$ref?m(e,l):l}function g(e,t){let r=e.refResolver.getSchema(t,"#");return new s(r,t,"#")}function y(e,t){return e.$id&&"#"!==e.$id.charAt(0)?e.$id:t}function v(e,t){f(e),t=t||{};let a={functions:[],functionsCounter:0,functionsNamesBySchema:new Map,options:t,refResolver:new r,rootSchemaId:e.$id||"__fjs_root_"+h++,validatorSchemasIds:new Set,mergedSchemasIds:new Map},o=y(e,a.rootSchemaId);if(a.refResolver.hasSchema(o)||a.refResolver.addSchema(e,a.rootSchemaId),t.schema)for(let e in t.schema){let r=t.schema[e],i=y(r,e);a.refResolver.hasSchema(i)||(f(r,e),a.refResolver.addSchema(r,e))}if(t.rounding&&!d.includes(t.rounding))throw new Error(`Unsupported integer rounding method ${t.rounding}`);if(t.largeArrayMechanism){if(!p.includes(t.largeArrayMechanism))throw new Error(`Unsupported large array mechanism ${t.largeArrayMechanism}`);u=t.largeArrayMechanism}if(t.largeArraySize)if("string"==typeof t.largeArraySize&&Number.isFinite(Number.parseInt(t.largeArraySize,10)))c=Number.parseInt(t.largeArraySize,10);else if("number"==typeof t.largeArraySize&&Number.isInteger(t.largeArraySize))c=t.largeArraySize;else{if("bigint"!=typeof t.largeArraySize)throw new Error(`Unsupported large array size. Expected integer-like, got ${typeof t.largeArraySize} with value ${t.largeArraySize}`);c=Number(t.largeArraySize)}let l=R(a,new s(e,a.rootSchemaId),"input"),m="\n    const JSON_STR_BEGIN_OBJECT = '{'\n    const JSON_STR_END_OBJECT = '}'\n    const JSON_STR_BEGIN_ARRAY = '['\n    const JSON_STR_END_ARRAY = ']'\n    const JSON_STR_COMMA = ','\n    const JSON_STR_COLONS = ':'\n    const JSON_STR_QUOTE = '\"'\n    const JSON_STR_EMPTY_OBJECT = JSON_STR_BEGIN_OBJECT + JSON_STR_END_OBJECT\n    const JSON_STR_EMPTY_ARRAY = JSON_STR_BEGIN_ARRAY + JSON_STR_END_ARRAY\n    const JSON_STR_EMPTY_STRING = JSON_STR_QUOTE + JSON_STR_QUOTE\n    const JSON_STR_NULL = 'null'\n  ";m+="json += anonymous0(input)"===l?`\n    ${a.functions.join("\n")}\n    const main = anonymous0\n    return main\n    `:`\n    function main (input) {\n      let json = ''\n      ${l}\n      return json\n    }\n    ${a.functions.join("\n")}\n    return main\n    `;let g=new i(t),v=new n(t.ajv);for(let e of a.validatorSchemasIds){let t=a.refResolver.getSchema(e);v.addSchema(t,e);let r=a.refResolver.getSchemaDependencies(e);for(let[e,t]of Object.entries(r))v.addSchema(t,e)}if(t.debugMode&&(t.mode="debug"),"debug"===t.mode)return{validator:v,serializer:g,code:`validator\nserializer\n${m}`,ajv:v.ajv};let b=new Function("validator","serializer",m);return"standalone"===t.mode?Yr()(b,a,g,v):b(v,g)}var b=["properties","required","additionalProperties","patternProperties","maxProperties","minProperties","dependencies"],w=["items","additionalItems","maxItems","minItems","uniqueItems","contains"],_=["maxLength","minLength","pattern"],S=["multipleOf","maximum","exclusiveMaximum","minimum","exclusiveMinimum"];function E(e,t,r){for(let t=0;t<r.length;t++){let i=r[t];i.schema.$ref&&(r[t]=m(e,i))}let i=[];for(let t of r){let r=k(e,t.schema,t.schemaId);delete r.$id,i.push(r)}let n=o(i),a=new s(n,t);return e.refResolver.addSchema(n,t),a}function k(e,t,r){let i=Array.isArray(t)?[]:{};void 0!==t.$id&&"#"!==t.$id.charAt(0)&&(r=t.$id);let n=e.mergedSchemasIds.get(t);n&&e.mergedSchemasIds.set(i,n);for(let n in t){let s=t[n];"$ref"===n&&"string"==typeof s&&"#"===s.charAt(0)&&(s=r+s),"object"==typeof s&&null!==s&&(s=k(e,s,r)),i[n]=s}return i}function x(e,t){let r;switch(e){case"null":r="value === null";break;case"string":r='typeof value === \'string\' ||\n      value === null ||\n      value instanceof Date ||\n      value instanceof RegExp ||\n      (\n        typeof value === "object" &&\n        typeof value.toString === "function" &&\n        value.toString !== Object.prototype.toString\n      )';break;case"integer":r="Number.isInteger(value)";break;case"number":r="Number.isFinite(value)";break;case"boolean":r="typeof value === 'boolean'";break;case"object":r="value && typeof value === 'object' && value.constructor === Object";break;case"array":r="Array.isArray(value)";break;default:Array.isArray(e)&&(r=`(${e.map(e=>x(e,t)).join(" || ")})`)}return r}function T(e){return"anonymous"+e.functionsCounter++}function P(e,t,r){let i=t.schema;switch(i.type){case"null":return"json += JSON_STR_NULL";case"string":return"date-time"===i.format?`json += serializer.asDateTime(${r})`:"date"===i.format?`json += serializer.asDate(${r})`:"time"===i.format?`json += serializer.asTime(${r})`:"unsafe"===i.format?`json += serializer.asUnsafeString(${r})`:`\n        if (typeof ${r} !== 'string') {\n          if (${r} === null) {\n            json += JSON_STR_EMPTY_STRING\n          } else if (${r} instanceof Date) {\n            json += JSON_STR_QUOTE + ${r}.toISOString() + JSON_STR_QUOTE\n          } else if (${r} instanceof RegExp) {\n            json += serializer.asString(${r}.source)\n          } else {\n            json += serializer.asString(${r}.toString())\n          }\n        } else {\n          json += serializer.asString(${r})\n        }\n        `;case"integer":return`json += serializer.asInteger(${r})`;case"number":return`json += serializer.asNumber(${r})`;case"boolean":return`json += serializer.asBoolean(${r})`;case"object":return`json += ${function(e,t){let r=t.schema;if(e.functionsNamesBySchema.has(r))return e.functionsNamesBySchema.get(r);let i=T(e);e.functionsNamesBySchema.set(r,i);let n=t.getSchemaRef();n.startsWith(e.rootSchemaId)&&(n=n.replace(e.rootSchemaId,""));let s="\n  ",a=!0===r.nullable;return s+=`\n    // ${n}\n    function ${i} (input) {\n      const obj = ${function(e){return`(${e} && typeof ${e}.toJSON === 'function')\n    ? ${e}.toJSON()\n    : ${e}\n  `}("input")}\n      ${a?"":"if (obj === null) return JSON_STR_EMPTY_OBJECT"}\n\n      ${function(e,t){let r=t.schema,i=t.getPropertyLocation("properties"),n=r.required||[],s=Object.keys(r.properties||{}).sort((e,t)=>{let r=n.includes(e);return r===n.includes(t)?0:r?-1:1}),a=n.includes(s[0]),o="let value\n";for(let e of n)if(!s.includes(e)){let t=JSON.stringify(e);o+=`if (obj[${t}] === undefined) throw new Error('${t.replace(/'/g,"\\'")} is required!')\n`}o+="let json = JSON_STR_BEGIN_OBJECT\n";let l="";a||(o+="let addComma = false\n",l="!addComma && (addComma = true) || (json += JSON_STR_COMMA)");for(let t of s){let r=i.getPropertyLocation(t);r.schema.$ref&&(r=m(e,r));let s=JSON.stringify(t),c=r.schema.default,u=n.includes(t);o+=`\n      value = obj[${s}]\n      if (value !== undefined) {\n        ${l}\n        json += ${JSON.stringify(s+":")}\n        ${R(e,r,"value")}\n      }`,o+=void 0!==c?` else {\n        ${l}\n        json += ${JSON.stringify(s+":"+JSON.stringify(c))}\n      }\n      `:u?` else {\n        throw new Error('${s.replace(/'/g,"\\'")} is required!')\n      }\n      `:"\n",a&&(l="json += ','")}return(r.patternProperties||r.additionalProperties)&&(o+=function(e,t,r){let i=Object.keys(t.schema.properties||{}),n=`\n    const propertiesKeys = ${JSON.stringify(i)}\n    for (const [key, value] of Object.entries(obj)) {\n      if (\n        propertiesKeys.includes(key) ||\n        value === undefined ||\n        typeof value === 'function' ||\n        typeof value === 'symbol'\n      ) continue\n  `,s=t.getPropertyLocation("patternProperties"),a=s.schema;if(void 0!==a)for(let t in a){let i=s.getPropertyLocation(t);n+=`\n        if (/${t.replace(/\\*\//g,"\\/")}/.test(key)) {\n          ${r}\n          json += serializer.asString(key) + JSON_STR_COLONS\n          ${R(e,i,"value")}\n          continue\n        }\n      `}let o=t.getPropertyLocation("additionalProperties").schema;return void 0!==o&&(n+=!0===o?`\n        ${r}\n        json += serializer.asString(key) + JSON_STR_COLONS + JSON.stringify(value)\n      `:`\n        ${r}\n        json += serializer.asString(key) + JSON_STR_COLONS\n        ${R(e,t.getPropertyLocation("additionalProperties"),"value")}\n      `),n+="\n    }\n  ",n}(e,t,l)),o+="\n    return json + JSON_STR_END_OBJECT\n  ",o}(e,t)}\n    }\n  `,e.functions.push(s),i}(e,t)}(${r})`;case"array":return`json += ${function(e,t){let r=t.schema,i=t.getPropertyLocation("items");i.schema=i.schema||{},i.schema.$ref&&(i=m(e,i));let n=i.schema;if(e.functionsNamesBySchema.has(r))return e.functionsNamesBySchema.get(r);let s=T(e);e.functionsNamesBySchema.set(r,s);let a=t.getSchemaRef();a.startsWith(e.rootSchemaId)&&(a=a.replace(e.rootSchemaId,""));let o=`\n    function ${s} (obj) {\n      // ${a}\n  `;if(o+=`\n    ${!0===r.nullable?"":"if (obj === null) return JSON_STR_EMPTY_ARRAY"}\n    if (!Array.isArray(obj)) {\n      throw new TypeError(\`The value of '${a}' does not match schema definition.\`)\n    }\n    const arrayLength = obj.length\n  `,!r.additionalItems&&Array.isArray(n)&&(o+=`\n      if (arrayLength > ${n.length}) {\n        throw new Error(\`Item at ${n.length} does not match schema definition.\`)\n      }\n    `),"json-stringify"===u&&(o+=`if (arrayLength >= ${c}) return JSON.stringify(obj)\n`),o+="\n    const arrayEnd = arrayLength - 1\n    let value\n    let json = ''\n  ",Array.isArray(n)){for(let t=0;t<n.length;t++){let r=n[t];o+=`value = obj[${t}]`;let s=R(e,i.getPropertyLocation(t),"value");o+=`\n        if (${t} < arrayLength) {\n          if (${x(r.type,`[${t}]`)}) {\n            ${s}\n            if (${t} < arrayEnd) {\n              json += JSON_STR_COMMA\n            }\n          } else {\n            throw new Error(\`Item at ${t} does not match schema definition.\`)\n          }\n        }\n        `}r.additionalItems&&(o+=`\n        for (let i = ${n.length}; i < arrayLength; i++) {\n          json += JSON.stringify(obj[i])\n          if (i < arrayEnd) {\n            json += JSON_STR_COMMA\n          }\n        }`)}else o+=`\n      for (let i = 0; i < arrayLength; i++) {\n        ${R(e,i,"obj[i]")}\n        if (i < arrayEnd) {\n          json += JSON_STR_COMMA\n        }\n      }`;return o+="\n    return JSON_STR_BEGIN_ARRAY + json + JSON_STR_END_ARRAY\n  }",e.functions.push(o),s}(e,t)}(${r})`;case void 0:return`json += JSON.stringify(${r})`;default:throw new Error(`${i.type} unsupported`)}}function R(e,t,r){let i=t.schema;if("boolean"==typeof i)return`json += JSON.stringify(${r})`;if(i.$ref&&(i=(t=m(e,t)).schema),i.allOf)return function(e,t,r){let i=t.schema,n=e.mergedSchemasIds.get(i);if(n)return R(e,g(e,n),r);n="__fjs_merged_"+h++,e.mergedSchemasIds.set(i,n);let{allOf:a,...o}=t.schema,l=[new s(o,t.schemaId,t.jsonPointer)],c=t.getPropertyLocation("allOf");for(let e=0;e<a.length;e++)l.push(c.getPropertyLocation(e));return R(e,E(e,n,l),r)}(e,t,r);if(i.anyOf||i.oneOf)return function(e,t,r){e.validatorSchemasIds.add(t.schemaId);let i=t.schema.anyOf?"anyOf":"oneOf",{[i]:n,...a}=t.schema,o=new s(a,t.schemaId,t.jsonPointer),l=t.getPropertyLocation(i),c="";for(let t=0;t<n.length;t++){let i=l.getPropertyLocation(t),n=i.schema,s=e.mergedSchemasIds.get(n),a=null;s?a=g(e,s):(s="__fjs_merged_"+h++,e.mergedSchemasIds.set(n,s),a=E(e,s,[o,i]));let u=R(e,a,r);c+=`\n      ${0===t?"if":"else if"}(validator.validate("${i.getSchemaRef()}", ${r}))\n        ${u}\n    `}let u=t.getSchemaRef();return u.startsWith(e.rootSchemaId)&&(u=u.replace(e.rootSchemaId,"")),c+=`\n    else throw new TypeError(\`The value of '${u}' does not match schema definition.\`)\n  `,c}(e,t,r);if(i.if&&i.then)return function(e,t,r){e.validatorSchemasIds.add(t.schemaId);let{if:i,then:n,else:a,...o}=t.schema,l=new s(o,t.schemaId,t.jsonPointer),c=t.getPropertyLocation("if").getSchemaRef(),u=t.getPropertyLocation("then"),d=e.mergedSchemasIds.get(n),p=null;if(d?p=g(e,d):(d="__fjs_merged_"+h++,e.mergedSchemasIds.set(n,d),p=E(e,d,[l,u])),!a)return`\n      if (validator.validate("${c}", ${r})) {\n        ${R(e,p,r)}\n      } else {\n        ${R(e,l,r)}\n      }\n    `;let f=t.getPropertyLocation("else"),m=e.mergedSchemasIds.get(a),y=null;return m?y=g(e,m):(m="__fjs_merged_"+h++,e.mergedSchemasIds.set(a,m),y=E(e,m,[l,f])),`\n    if (validator.validate("${c}", ${r})) {\n      ${R(e,p,r)}\n    } else {\n      ${R(e,y,r)}\n    }\n  `}(e,t,r);if(void 0===i.type){let e=function(e){for(var t of b)if(t in e)return"object";for(var t of w)if(t in e)return"array";for(var t of _)if(t in e)return"string";for(var t of S)if(t in e)return"number";return e.type}(i);e&&(i.type=e)}let n="",a=i.type,o=!0===i.nullable;return o&&(n+=`\n      if (${r} === null) {\n        json += JSON_STR_NULL\n      } else {\n    `),void 0!==i.const?n+=function(e,t){let r=e.schema,i=r.type,n=Array.isArray(i)&&i.includes("null"),s="";return n&&(s+=`\n      if (${t} === null) {\n        json += JSON_STR_NULL\n      } else {\n    `),s+=`json += '${JSON.stringify(r.const).replace(l,"\\'")}'`,n&&(s+="\n      }\n    "),s}(t,r):Array.isArray(a)?n+=function(e,t,r){let i=t.schema.type.sort(e=>"null"===e?-1:1),n="";i.forEach((i,s)=>{t.schema={...t.schema,type:i};let a=P(e,t,r),o=0===s?"if":"else if";switch(i){case"null":n+=`\n          ${o} (${r} === null)\n            ${a}\n          `;break;case"string":n+=`\n          ${o}(\n            typeof ${r} === "string" ||\n            ${r} === null ||\n            ${r} instanceof Date ||\n            ${r} instanceof RegExp ||\n            (\n              typeof ${r} === "object" &&\n              typeof ${r}.toString === "function" &&\n              ${r}.toString !== Object.prototype.toString\n            )\n          )\n            ${a}\n        `;break;case"array":n+=`\n          ${o}(Array.isArray(${r}))\n            ${a}\n        `;break;case"integer":n+=`\n          ${o}(Number.isInteger(${r}) || ${r} === null)\n            ${a}\n        `;break;default:n+=`\n          ${o}(typeof ${r} === "${i}" || ${r} === null)\n            ${a}\n        `}});let s=t.getSchemaRef();return s.startsWith(e.rootSchemaId)&&(s=s.replace(e.rootSchemaId,"")),n+=`\n    else throw new TypeError(\`The value of '${s}' does not match schema definition.\`)\n  `,n}(e,t,r):n+=P(e,t,r),o&&(n+="\n      }\n    "),n}t.exports=v,t.exports.default=v,t.exports.build=v,t.exports.validLargeArrayMechanisms=p,t.exports.restore=function({code:e,validator:t,serializer:r}){return Function.apply(null,["validator","serializer",e]).apply(null,[t,r])}}),Qr=u((e,t)=>{var r=ei();function i(e={readMode:!0}){if(!0===e.readMode&&"function"!=typeof e.restoreFunction)throw new Error("You must provide a function for the restoreFunction-option when readMode ON");if(!0!==e.readMode&&"function"!=typeof e.storeFunction)throw new Error("You must provide a function for the storeFunction-option when readMode OFF");if(!0===e.readMode)return function(){return function(t){return e.restoreFunction(t)}};let t=r();return function(r,i={}){i.mode="standalone";let n=t(r,i);return function(t){let r=n(t);return e.storeFunction(t,r),new Function(r)}}}t.exports=i,t.exports.default=i}),ei=u((e,t)=>{var r=Xr();function i(){return function(e,t){let r=Object.assign({},t,{schema:e});return n.bind(null,r)}}function n(e,{schema:t}){return e.schema&&t.$id&&e.schema[t.$id]&&(e.schema={...e.schema},delete e.schema[t.$id]),r(t,e)}t.exports=i,t.exports.default=i,t.exports.SerializerSelector=i,t.exports.StandaloneSerializer=Qr()}),ti=u(e=>{Object.defineProperty(e,"__esModule",{value:!0}),e.checkMetadata=void 0;var t=Pt(),r={keyword:"metadata",schemaType:"object",code(e){i(e);let{gen:r,schema:n,it:s}=e;if((0,t.alwaysValidSchema)(s,n))return;let a=r.name("valid");e.subschema({keyword:"metadata",jtdMetadata:!0},a),e.ok(a)}};function i({it:e,keyword:t},r){if(e.jtdMetadata!==r)throw new Error(`JTD: "${t}" cannot be used in this schema location`)}e.checkMetadata=i,e.default=r}),ri=u(e=>{Object.defineProperty(e,"__esModule",{value:!0}),e.hasRef=void 0;var t=Bt(),r=Tt(),i=Ut(),n=Rt(),s=Yt(),a=ti(),o={keyword:"ref",schemaType:"string",code(e){(0,a.checkMetadata)(e);let{gen:o,data:c,schema:u,parentSchema:d,it:p}=e,{schemaEnv:{root:h}}=p,f=o.name("valid");function m(){var a;let c=null===(a=h.schema.definitions)||void 0===a?void 0:a[u];if(!c)throw new i.default(p.opts.uriResolver,"",u,`No definition ${u}`);l(c)||!p.opts.inlineRefs?function(i){let a=t.compileSchema.call(p.self,new t.SchemaEnv({schema:i,root:h,schemaPath:`/definitions/${u}`})),l=(0,s.getValidate)(e,a),c=o.const("_errs",n.default.errors);(0,s.callRef)(e,l,a,a.$async),o.assign(f,r._`${c} === ${n.default.errors}`)}(c):function(t){let i=o.scopeValue("schema",!0===p.opts.code.source?{ref:t,code:(0,r.stringify)(t)}:{ref:t});e.subschema({schema:t,dataTypes:[],schemaPath:r.nil,topSchemaRef:i,errSchemaPath:`/definitions/${u}`},f)}(c)}d.nullable?(o.var(f,r._`${c} === null`),o.if((0,r.not)(f),m)):(o.var(f,!1),m()),e.ok(f)}};function l(e){for(let t in e){let r;if("ref"===t||"object"==typeof(r=e[t])&&l(r))return!0}return!1}e.hasRef=l,e.default=o}),ii=u(e=>{Object.defineProperty(e,"__esModule",{value:!0});var t=/t|\s/i,r=/^(\d\d\d\d)-(\d\d)-(\d\d)$/,i=/^(\d\d):(\d\d):(\d\d)(?:\.\d+)?(?:z|([+-]\d\d)(?::?(\d\d))?)$/i,n=[0,31,28,31,30,31,30,31,31,30,31,30,31];function s(e,r){let n=e.split(t);return 2===n.length&&a(n[0])&&function(e){let t=i.exec(e);if(!t)return!1;let r=+t[1],n=+t[2],s=+t[3];return r<=23&&n<=59&&s<=59||r-+(t[4]||0)===23&&n-+(t[5]||0)===59&&60===s}(n[1])||r&&1===n.length&&a(n[0])}function a(e){let t=r.exec(e);if(!t)return!1;let i=+t[1],s=+t[2],a=+t[3];return s>=1&&s<=12&&a>=1&&(a<=n[s]||2===s&&29===a&&(i%100==0?i%400==0:i%4==0))}e.default=s,s.code='require("ajv/dist/runtime/timestamp").default'}),ni=u(e=>{Object.defineProperty(e,"__esModule",{value:!0}),e.typeErrorParams=e.typeErrorMessage=e.typeError=void 0;var t=Tt();function r({parentSchema:e},t){return e?.nullable?`must be ${t} or null`:`must be ${t}`}function i({parentSchema:e},r){return t._`{type: ${r}, nullable: ${!!e?.nullable}}`}e.typeError=function(e){return{message:t=>r(t,e),params:t=>i(t,e)}},e.typeErrorMessage=r,e.typeErrorParams=i}),si=u(e=>{Object.defineProperty(e,"__esModule",{value:!0}),e.intRange=void 0;var t=Tt(),r=ii(),i=Pt(),n=ti(),s=ni();e.intRange={int8:[-128,127,3],uint8:[0,255,3],int16:[-32768,32767,5],uint16:[0,65535,5],int32:[-2147483648,2147483647,10],uint32:[0,4294967295,10]};var a={message:e=>(0,s.typeErrorMessage)(e,e.schema),params:e=>(0,s.typeErrorParams)(e,e.schema)},o={keyword:"type",schemaType:"string",error:a,code(s){(0,n.checkMetadata)(s);let a,{data:o,schema:l,parentSchema:c,it:u}=s;switch(l){case"boolean":case"string":a=t._`typeof ${o} == ${l}`;break;case"timestamp":a=function(e){let{gen:n,data:s,it:a}=e,{timestamp:o,allowDate:l}=a.opts;if("date"===o)return t._`${s} instanceof Date `;let c=(0,i.useFunc)(n,r.default),u=l?t._`, true`:t.nil,d=t._`typeof ${s} == "string" && ${c}(${s}${u})`;return"string"===o?d:(0,t.or)(t._`${s} instanceof Date`,d)}(s);break;case"float32":case"float64":a=t._`typeof ${o} == "number"`;break;default:{let r=l;if(a=t._`typeof ${o} == "number" && isFinite(${o}) && !(${o} % 1)`,u.opts.int32range||"int32"!==r&&"uint32"!==r){let[i,n]=e.intRange[r];a=t._`${a} && ${o} >= ${i} && ${o} <= ${n}`}else"uint32"===r&&(a=t._`${a} && ${o} >= 0`)}}s.pass(c.nullable?(0,t.or)(t._`${o} === null`,a):a)}};e.default=o}),ai=u(e=>{Object.defineProperty(e,"__esModule",{value:!0}),e.checkNullableObject=e.checkNullable=void 0;var t=Tt();function r({gen:e,data:r,parentSchema:i},n=t.nil){let s=e.name("valid");return i.nullable?(e.let(s,t._`${r} === null`),n=(0,t.not)(s)):e.let(s,!1),[s,n]}e.checkNullable=r,e.checkNullableObject=function(e,i){let[n,s]=r(e,i);return[n,t._`${s} && typeof ${e.data} == "object" && !Array.isArray(${e.data})`]}}),oi=u(e=>{Object.defineProperty(e,"__esModule",{value:!0});var t=Tt(),r=ti(),i=ai(),n={message:"must be equal to one of the allowed values",params:({schemaCode:e})=>t._`{allowedValues: ${e}}`},s={keyword:"enum",schemaType:"array",error:n,code(e){(0,r.checkMetadata)(e);let{gen:n,data:s,schema:a,schemaValue:o,parentSchema:l,it:c}=e;if(0===a.length)throw new Error("enum must have non-empty array");if(a.length!==new Set(a).size)throw new Error("enum items must be unique");let u,d=t._`typeof ${s} == "string"`;if(a.length>=c.opts.loopEnum){let r;[u,r]=(0,i.checkNullable)(e,d),n.if(r,function(){n.forOf("v",o,e=>n.if(t._`${u} = ${s} === ${e}`,()=>n.break()))})}else{if(!Array.isArray(a))throw new Error("ajv implementation error");u=(0,t.and)(d,(0,t.or)(...a.map(e=>t._`${s} === ${e}`))),l.nullable&&(u=(0,t.or)(t._`${s} === null`,u))}e.pass(u)}};e.default=s}),li=u(e=>{Object.defineProperty(e,"__esModule",{value:!0});var t=Pt(),r=jt(),i=Tt(),n=ti(),s=ai(),a={keyword:"elements",schemaType:"object",error:(0,ni().typeError)("array"),code(e){(0,n.checkMetadata)(e);let{gen:a,data:o,schema:l,it:c}=e;if((0,t.alwaysValidSchema)(c,l))return;let[u]=(0,s.checkNullable)(e);a.if((0,i.not)(u),()=>a.if(i._`Array.isArray(${o})`,()=>a.assign(u,(0,r.validateArray)(e)),()=>e.error())),e.ok(u)}};e.default=a}),ci=u(e=>{Object.defineProperty(e,"__esModule",{value:!0}),e.validateProperties=e.error=void 0;var t,r=jt(),i=Pt(),n=Tt(),s=ti(),a=ai(),o=ni();!function(e){e.Additional="additional",e.Missing="missing"}(t||(t={})),e.error={message:e=>{let{params:r}=e;return r.propError?r.propError===t.Additional?"must NOT have additional properties":`must have property '${r.missingProperty}'`:(0,o.typeErrorMessage)(e,"object")},params:e=>{let{params:r}=e;return r.propError?r.propError===t.Additional?n._`{error: ${r.propError}, additionalProperty: ${r.additionalProperty}}`:n._`{error: ${r.propError}, missingProperty: ${r.missingProperty}}`:(0,o.typeErrorParams)(e,"object")}};var l={keyword:"properties",schemaType:"object",error:e.error,code:c};function c(e){(0,s.checkMetadata)(e);let{gen:o,data:l,parentSchema:c,it:u}=e,{additionalProperties:d,nullable:p}=c;if(u.jtdDiscriminator&&p)throw new Error("JTD: nullable inside discriminator mapping");if(function(){let e=c.properties,t=c.optionalProperties;if(!e||!t)return!1;for(let r in e)if(Object.prototype.hasOwnProperty.call(t,r))return!0;return!1}())throw new Error("JTD: properties and optionalProperties have common members");let[h,f]=b("properties"),[m,g]=b("optionalProperties");if(0===f.length&&0===g.length&&d)return;let[y,v]=void 0===u.jtdDiscriminator?(0,a.checkNullableObject)(e,l):[o.let("valid",!1),!0];function b(e){let t=c[e],n=t?(0,r.allSchemaProperties)(t):[];if(u.jtdDiscriminator&&n.some(e=>e===u.jtdDiscriminator))throw new Error(`JTD: discriminator tag used in ${e}`);let s=n.filter(e=>!(0,i.alwaysValidSchema)(u,t[e]));return[n,s]}function w(i,n,s){let a=o.var("valid");for(let t of i)o.if((0,r.propertyInData)(o,l,t,u.opts.ownProperties),()=>_(t,n,a),()=>c(t)),e.ok(a);function c(r){s?(o.assign(a,!1),e.error(!1,{propError:t.Missing,missingProperty:r},{schemaPath:r})):o.assign(a,!0)}}function _(t,r,i){e.subschema({keyword:r,schemaProp:t,dataProp:t},i)}function S(e,t,s,a){let l;if(t.length>8){let t=(0,i.schemaRefOrVal)(u,c[s],s);l=(0,n.not)((0,r.isOwnProperty)(o,t,e)),void 0!==a&&(l=(0,n.and)(l,n._`${e} !== ${a}`))}else if(t.length||void 0!==a){let r=void 0===a?t:[a].concat(t);l=(0,n.and)(...r.map(t=>n._`${e} !== ${t}`))}else l=!0;return l}o.if(v,()=>o.assign(y,!0).block(()=>{w(f,"properties",!0),w(g,"optionalProperties"),d||o.forIn("key",l,r=>{let i=S(r,h,"properties",u.jtdDiscriminator),s=S(r,m,"optionalProperties"),a=!0===i?s:!0===s?i:(0,n.and)(i,s);o.if(a,()=>{u.opts.removeAdditional?o.code(n._`delete ${l}[${r}]`):(e.error(!1,{propError:t.Additional,additionalProperty:r},{instancePath:r,parentSchema:!0}),u.opts.allErrors||o.break())})})})),e.pass(y)}e.validateProperties=c,e.default=l}),ui=u(e=>{Object.defineProperty(e,"__esModule",{value:!0});var t=ci(),r={keyword:"optionalProperties",schemaType:"object",error:t.error,code(e){e.parentSchema.properties||(0,t.validateProperties)(e)}};e.default=r}),di=u(e=>{Object.defineProperty(e,"__esModule",{value:!0});var t=Tt(),r=ti(),i=ai(),n=ni(),s=Nr(),a={message:e=>{let{schema:t,params:r}=e;return r.discrError?r.discrError===s.DiscrError.Tag?`tag "${t}" must be string`:`value of tag "${t}" must be in mapping`:(0,n.typeErrorMessage)(e,"object")},params:e=>{let{schema:r,params:i}=e;return i.discrError?t._`{error: ${i.discrError}, tag: ${r}, tagValue: ${i.tag}}`:(0,n.typeErrorParams)(e,"object")}},o={keyword:"discriminator",schemaType:"string",implements:["mapping"],error:a,code(e){(0,r.checkMetadata)(e);let{gen:n,data:a,schema:o,parentSchema:l}=e,[c,u]=(0,i.checkNullableObject)(e,a);function d(t){let r=n.name("valid");return e.subschema({keyword:"mapping",schemaProp:t,jtdDiscriminator:o},r),r}n.if(u),function(){let r=n.const("tag",t._`${a}${(0,t.getProperty)(o)}`);n.if(t._`${r} === undefined`),e.error(!1,{discrError:s.DiscrError.Tag,tag:r}),n.elseIf(t._`typeof ${r} == "string"`),function(r){n.if(!1);for(let e in l.mapping)n.elseIf(t._`${r} === ${e}`),n.assign(c,d(e));n.else(),e.error(!1,{discrError:s.DiscrError.Mapping,tag:r},{instancePath:o,schemaPath:"mapping",parentSchema:!0}),n.endIf()}(r),n.else(),e.error(!1,{discrError:s.DiscrError.Tag,tag:r},{instancePath:o}),n.endIf()}(),n.elseIf((0,t.not)(c)),e.error(),n.endIf(),e.ok(c)}};e.default=o}),pi=u(e=>{Object.defineProperty(e,"__esModule",{value:!0});var t=Pt(),r=Tt(),i=ti(),n=ai(),s={keyword:"values",schemaType:"object",error:(0,ni().typeError)("object"),code(e){(0,i.checkMetadata)(e);let{gen:s,data:a,schema:o,it:l}=e,[c,u]=(0,n.checkNullableObject)(e,a);(0,t.alwaysValidSchema)(l,o)?s.if((0,r.not)((0,r.or)(u,c)),()=>e.error()):(s.if(u),s.assign(c,function(){let i=s.name("valid");if(l.allErrors){let e=s.let("valid",!0);return n(()=>s.assign(e,!1)),e}return s.var(i,!0),n(()=>s.break()),i;function n(n){s.forIn("key",a,a=>{e.subschema({keyword:"values",dataProp:a,dataPropType:t.Type.Str},i),s.if((0,r.not)(i),n)})}}()),s.elseIf((0,r.not)(c)),e.error(),s.endIf()),e.ok(c)}};e.default=s}),hi=u(e=>{Object.defineProperty(e,"__esModule",{value:!0});var t=jt();e.default={keyword:"union",schemaType:"array",trackErrors:!0,code:t.validateUnion,error:{message:"must match a schema in union"}}}),fi=u(e=>{Object.defineProperty(e,"__esModule",{value:!0});var t=ri(),r=si(),i=oi(),n=li(),s=ci(),a=ui(),o=di(),l=pi(),c=hi(),u=ti();e.default=["definitions",t.default,r.default,i.default,n.default,s.default,a.default,o.default,l.default,c.default,u.default,{keyword:"additionalProperties",schemaType:"boolean"},{keyword:"nullable",schemaType:"boolean"}]}),mi=u(e=>{Object.defineProperty(e,"__esModule",{value:!0});var t=e=>{let t={nullable:{type:"boolean"},metadata:{optionalProperties:{union:{elements:{ref:"schema"}}},additionalProperties:!0}};return e&&(t.definitions={values:{ref:"schema"}}),t},r=e=>({optionalProperties:t(e)}),i=e=>({properties:{ref:{type:"string"}},optionalProperties:t(e)}),n=e=>({properties:{type:{enum:["boolean","timestamp","string","float32","float64","int8","uint8","int16","uint16","int32","uint32"]}},optionalProperties:t(e)}),s=e=>({properties:{enum:{elements:{type:"string"}}},optionalProperties:t(e)}),a=e=>({properties:{elements:{ref:"schema"}},optionalProperties:t(e)}),o=e=>({properties:{properties:{values:{ref:"schema"}}},optionalProperties:{optionalProperties:{values:{ref:"schema"}},additionalProperties:{type:"boolean"},...t(e)}}),l=e=>({properties:{optionalProperties:{values:{ref:"schema"}}},optionalProperties:{additionalProperties:{type:"boolean"},...t(e)}}),c=e=>({properties:{discriminator:{type:"string"},mapping:{values:{metadata:{union:[o(!1),l(!1)]}}}},optionalProperties:t(e)}),u=e=>({properties:{values:{ref:"schema"}},optionalProperties:t(e)}),d=e=>({metadata:{union:[r,i,n,s,a,o,l,c,u].map(t=>t(e))}}),p={definitions:{schema:d(!1)},...d(!0)};e.default=p}),gi=u(e=>{Object.defineProperty(e,"__esModule",{value:!0}),e.jtdForms=void 0,e.jtdForms=["elements","values","discriminator","properties","optionalProperties","enum","type","ref"]}),yi=u(e=>{Object.defineProperty(e,"__esModule",{value:!0});var t=/[\\"\u0000-\u001f\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,r={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};function i(e){return t.lastIndex=0,'"'+(t.test(e)?e.replace(t,e=>{let t=r[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)}):e)+'"'}e.default=i,i.code='require("ajv/dist/runtime/quote").default'}),vi=u(e=>{Object.defineProperty(e,"__esModule",{value:!0});var t=gi(),r=Bt(),i=Tt(),n=Ut(),s=Rt(),a=jt(),o=ri(),l=Pt(),c=yi(),u={elements:function(e){let{gen:t,schema:r,data:n}=e;t.add(s.default.json,i.str`[`);let a=t.let("first",!0);t.forOf("el",n,t=>{v(e,a),p({...e,schema:r.elements,data:t})}),t.add(s.default.json,i.str`]`)},values:function(e){let{gen:t,schema:r,data:n}=e;t.add(s.default.json,i.str`{`);let a=t.let("first",!0);t.forIn("key",n,t=>h(e,t,r.values,a)),t.add(s.default.json,i.str`}`)},discriminator:function(e){let{gen:t,schema:r,data:n}=e,{discriminator:a}=r;t.add(s.default.json,i.str`{${JSON.stringify(a)}:`);let o=t.const("tag",i._`${n}${(0,i.getProperty)(a)}`);g({...e,data:o}),t.if(!1);for(let n in r.mapping){t.elseIf(i._`${o} === ${n}`);let s=r.mapping[n];m({...e,schema:s},a)}t.endIf(),t.add(s.default.json,i.str`}`)},properties:f,optionalProperties:f,enum:g,type:function(e){let{gen:t,schema:r,data:n}=e;switch(r.type){case"boolean":t.add(s.default.json,i._`${n} ? "true" : "false"`);break;case"string":g(e);break;case"timestamp":t.if(i._`${n} instanceof Date`,()=>t.add(s.default.json,i._`'"' + ${n}.toISOString() + '"'`),()=>g(e));break;default:!function({gen:e,data:t}){e.add(s.default.json,i._`"" + ${t}`)}(e)}},ref:function(e){let{gen:t,self:a,data:l,definitions:c,schema:u,schemaEnv:h}=e,{ref:f}=u,m=c[f];if(!m)throw new n.default(a.opts.uriResolver,"",f,`No definition ${f}`);if(!(0,o.hasRef)(m))return p({...e,schema:m});let{root:g}=h,y=d.call(a,new r.SchemaEnv({schema:m,root:g}),c);t.add(s.default.json,i._`${function(e,t){return t.serialize?e.scopeValue("serialize",{ref:t.serialize}):i._`${e.scopeValue("wrapper",{ref:t})}.serialize`}(t,y)}(${l})`)}};function d(e,t){let n=r.getCompilingSchema.call(this,e);if(n)return n;let a,{es5:o,lines:l}=this.opts.code,{ownProperties:c}=this.opts,u=new i.CodeGen(this.scope,{es5:o,lines:l,ownProperties:c}),d=u.scopeName("serialize"),h={self:this,gen:u,schema:e.schema,schemaEnv:e,definitions:t,data:s.default.data};try{this._compilations.add(e),e.serializeName=d,u.func(d,s.default.data,!1,()=>{u.let(s.default.json,i.str``),p(h),u.return(s.default.json)}),u.optimize(this.opts.code.optimize);let t=u.toString();a=`${u.scopeRefs(s.default.scope)}return ${t}`;let r=new Function(`${s.default.scope}`,a)(this.scope.get());this.scope.value(d,{ref:r}),e.serialize=r}catch(t){throw a&&this.logger.error("Error compiling serializer, function code:",a),delete e.serialize,delete e.serializeName,t}finally{this._compilations.delete(e)}return e}function p(e){let r;for(let i of t.jtdForms)if(i in e.schema){r=i;break}!function(e,t){let{gen:r,schema:n,data:a}=e;if(!n.nullable)return t(e);r.if(i._`${a} === undefined || ${a} === null`,()=>r.add(s.default.json,i._`"null"`),()=>t(e))}(e,r?u[r]:y)}function h(e,t,r,n){let{gen:a,data:o}=e;v(e,n),g({...e,data:t}),a.add(s.default.json,i.str`:`);let l=a.const("value",i._`${o}${(0,i.getProperty)(t)}`);p({...e,schema:r,data:l})}function f(e){let{gen:t}=e;t.add(s.default.json,i.str`{`),m(e),t.add(s.default.json,i.str`}`)}function m(e,t){let r,{gen:n,schema:o,data:l}=e,{properties:c,optionalProperties:u}=o,d=y(c),f=y(u),m=function(e){if(t&&e.push(t),new Set(e).size!==e.length)throw new Error("JTD: properties/optionalProperties/disciminator overlap");return e}(d.concat(f)),g=!t;for(let e of d)g?g=!1:n.add(s.default.json,i.str`,`),w(e,c[e],b(e));g&&(r=n.let("first",!0));for(let t of f){let s=b(t);n.if((0,i.and)(i._`${s} !== undefined`,(0,a.isOwnProperty)(n,l,t)),()=>{v(e,r),w(t,u[t],s)})}function y(e){return e?Object.keys(e):[]}function b(e){return n.const("value",i._`${l}${(0,i.getProperty)(e)}`)}function w(t,r,a){n.add(s.default.json,i.str`${JSON.stringify(t)}:`),p({...e,schema:r,data:a})}o.additionalProperties&&n.forIn("key",l,t=>n.if(function(e,t){return!t.length||(0,i.and)(...t.map(t=>i._`${e} !== ${t}`))}(t,m),()=>h(e,t,{},r)))}function g({gen:e,data:t}){e.add(s.default.json,i._`${(0,l.useFunc)(e,c.default)}(${t})`)}function y({gen:e,data:t}){e.add(s.default.json,i._`JSON.stringify(${t})`)}function v({gen:e},t){t?e.if(t,()=>e.assign(t,!1),()=>e.add(s.default.json,i.str`,`)):e.add(s.default.json,i.str`,`)}e.default=d}),bi=u(e=>{Object.defineProperty(e,"__esModule",{value:!0}),e.parseJsonString=e.parseJsonNumber=e.parseJson=void 0;var t=/position\s(\d+)(?: \(line \d+ column \d+\))?$/;function r(e,i){let n,s;r.message=void 0,i&&(e=e.slice(i));try{return r.position=i+e.length,JSON.parse(e)}catch(a){if(s=t.exec(a.message),!s)return void(r.message="unexpected end");n=+s[1];let o=e[n];e=e.slice(0,n),r.position=i+n;try{return JSON.parse(e)}catch{return void(r.message=`unexpected token ${o}`)}}}function i(e,t,r){let n,s="";if(i.message=void 0,"-"===e[t]&&(s+="-",t++),"0"===e[t])s+="0",t++;else if(!a(r))return void o();if(r)return i.position=t,+s;if("."!==e[t]||(s+=".",t++,a())){if(n=e[t],"e"!==n&&"E"!==n||(s+="e",t++,n=e[t],("+"===n||"-"===n)&&(s+=n,t++),a()))return i.position=t,+s;o()}else o();function a(r){let i=!1;for(;n=e[t],n>="0"&&n<="9"&&(void 0===r||r-- >0);)i=!0,s+=n,t++;return i}function o(){i.position=t,i.message=t<e.length?`unexpected token ${e[t]}`:"unexpected end"}}e.parseJson=r,r.message=void 0,r.position=0,r.code='require("ajv/dist/runtime/parseJson").parseJson',e.parseJsonNumber=i,i.message=void 0,i.position=0,i.code='require("ajv/dist/runtime/parseJson").parseJsonNumber';var n={b:"\b",f:"\f",n:"\n",r:"\r",t:"\t",'"':'"',"/":"/","\\":"\\"};function s(e,t){let r,i="";for(s.message=void 0;r=e[t++],'"'!==r;)if("\\"===r)if(r=e[t],r in n)i+=n[r],t++;else{if("u"!==r)return void a(`unexpected token ${r}`);{t++;let n=4,s=0;for(;n--;){if(s<<=4,r=e[t],void 0===r)return void a("unexpected end");if(r=r.toLowerCase(),r>="a"&&r<="f")s+=r.charCodeAt(0)-97+10;else{if(!(r>="0"&&r<="9"))return void a(`unexpected token ${r}`);s+=r.charCodeAt(0)-48}t++}i+=String.fromCharCode(s)}}else{if(void 0===r)return void a("unexpected end");if(!(r.charCodeAt(0)>=32))return void a(`unexpected token ${r}`);i+=r}return s.position=t,i;function a(e){s.position=t,s.message=e}}e.parseJsonString=s,s.message=void 0,s.position=0,s.code='require("ajv/dist/runtime/parseJson").parseJsonString'}),wi=u(e=>{Object.defineProperty(e,"__esModule",{value:!0});var t=gi(),r=Bt(),i=Tt(),n=Ut(),s=Rt(),a=jt(),o=ri(),l=si(),c=bi(),u=Pt(),d=ii(),p={elements:function(e){let{gen:t,schema:r,data:n}=e;O(e,"[");let s=t.let("i",0);t.assign(n,i._`[]`),y(e,"]",()=>{let a=t.let("el");m({...e,schema:r.elements,data:a}),t.assign(i._`${n}[${s}++]`,a)})},values:function(e){let{gen:t,schema:r,data:n}=e;O(e,"{"),t.assign(n,i._`{}`),y(e,"}",()=>function(e,t){let{gen:r}=e,i=r.let("key");E({...e,data:i}),O(e,":"),S(e,i,t)}(e,r.values))},discriminator:function(e){let{gen:t,data:r,schema:n}=e,{discriminator:a,mapping:o}=n;O(e,"{"),t.assign(r,i._`{}`);let l=t.const("pos",s.default.jsonPos),c=t.let("value"),u=t.let("tag");v(e,"}",()=>{let n=t.let("key");E({...e,data:n}),O(e,":"),t.if(i._`${n} === ${a}`,()=>{E({...e,data:u}),t.assign(i._`${r}[${n}]`,u),t.break()},()=>T({...e,data:c}))}),t.assign(s.default.jsonPos,l),t.if(i._`${u} === undefined`),I(e,i.str`discriminator tag not found`);for(let r in o)t.elseIf(i._`${u} === ${r}`),w({...e,schema:o[r]},a);t.else(),I(e,i.str`discriminator value not in schema`),t.endIf()},properties:b,optionalProperties:b,enum:function(e){let{gen:t,data:r,schema:n}=e,a=n.enum;O(e,'"'),t.if(!1);for(let e of a){let n=JSON.stringify(e).slice(1);t.elseIf(i._`${A(n.length)} === ${n}`),t.assign(r,i.str`${e}`),t.add(s.default.jsonPos,n.length)}t.else(),N(e),t.endIf()},type:function(e){let{gen:t,schema:r,data:n,self:s}=e;switch(r.type){case"boolean":g(e);break;case"string":E(e);break;case"timestamp":{E(e);let r=(0,u.useFunc)(t,d.default),{allowDate:a,parseDate:o}=s.opts,l=a?i._`!${r}(${n}, true)`:i._`!${r}(${n})`,c=o?(0,i.or)(l,i._`(${n} = new Date(${n}), false)`,i._`isNaN(${n}.valueOf())`):l;t.if(c,()=>I(e,i.str`invalid timestamp`));break}case"float32":case"float64":k(e);break;default:{let a=r.type;if(s.opts.int32range||"int32"!==a&&"uint32"!==a){let[r,s,o]=l.intRange[a];k(e,o),t.if(i._`${n} < ${r} || ${n} > ${s}`,()=>I(e,i.str`integer out of range`))}else k(e,16),"uint32"===a&&t.if(i._`${n} < 0`,()=>I(e,i.str`integer out of range`))}}},ref:function(e){let{gen:t,self:s,definitions:a,schema:l,schemaEnv:c}=e,{ref:u}=l,d=a[u];if(!d)throw new n.default(s.opts.uriResolver,"",u,`No definition ${u}`);if(!(0,o.hasRef)(d))return m({...e,schema:d});let{root:p}=c;R(e,function(e,t){return t.parse?e.scopeValue("parse",{ref:t.parse}):i._`${e.scopeValue("wrapper",{ref:t})}.parse`}(t,h.call(s,new r.SchemaEnv({schema:d,root:p}),a)),!0)}};function h(e,t){let n=r.getCompilingSchema.call(this,e);if(n)return n;let a,{es5:o,lines:l}=this.opts.code,{ownProperties:c}=this.opts,u=new i.CodeGen(this.scope,{es5:o,lines:l,ownProperties:c}),d=u.scopeName("parse"),p={self:this,gen:u,schema:e.schema,schemaEnv:e,definitions:t,data:s.default.data,parseName:d,char:u.name("c")};try{this._compilations.add(e),e.parseName=d,function(e){let{gen:t,parseName:r,char:n}=e;t.func(r,i._`${s.default.json}, ${s.default.jsonPos}, ${s.default.jsonPart}`,!1,()=>{t.let(s.default.data),t.let(n),t.assign(i._`${r}.message`,f),t.assign(i._`${r}.position`,f),t.assign(s.default.jsonPos,i._`${s.default.jsonPos} || 0`),t.const(s.default.jsonLen,i._`${s.default.json}.length`),m(e),C(e),t.if(s.default.jsonPart,()=>{t.assign(i._`${r}.position`,s.default.jsonPos),t.return(s.default.data)}),t.if(i._`${s.default.jsonPos} === ${s.default.jsonLen}`,()=>t.return(s.default.data)),N(e)})}(p),u.optimize(this.opts.code.optimize);let t=u.toString();a=`${u.scopeRefs(s.default.scope)}return ${t}`;let r=new Function(`${s.default.scope}`,a)(this.scope.get());this.scope.value(d,{ref:r}),e.parse=r}catch(t){throw a&&this.logger.error("Error compiling parser, function code:",a),delete e.parse,delete e.parseName,t}finally{this._compilations.delete(e)}return e}e.default=h;var f=i._`undefined`;function m(e){let r;for(let i of t.jtdForms)if(i in e.schema){r=i;break}r?function(e,t){let{gen:r,schema:i,data:n}=e;if(!i.nullable)return t(e);$(e,"null",t,()=>r.assign(n,null))}(e,p[r]):T(e)}var g=x(!0,x(!1,N));function y(e,t,r){v(e,t,r),O(e,t)}function v(e,t,r){let{gen:n}=e;function a(){$(e,t,()=>{},N)}n.for(i._`;${s.default.jsonPos}<${s.default.jsonLen} && ${A(1)}!==${t};`,()=>{r(),$(e,",",()=>n.break(),a)})}function b(e){let{gen:t,data:r}=e;O(e,"{"),t.assign(r,i._`{}`),w(e)}function w(e,t){let{gen:r,schema:n,data:s}=e,{properties:o,optionalProperties:l,additionalProperties:c}=n;if(y(e,"}",()=>{let n=r.let("key");if(E({...e,data:n}),O(e,":"),r.if(!1),_(e,n,o),_(e,n,l),t){r.elseIf(i._`${n} === ${t}`);let s=r.let("tag");E({...e,data:s})}r.else(),c?T({...e,data:i._`${s}[${n}]`}):I(e,i.str`property ${n} not allowed`),r.endIf()}),o){let t=(0,a.hasPropFunc)(r),n=(0,i.and)(...Object.keys(o).map(e=>i._`${t}.call(${s}, ${e})`));r.if((0,i.not)(n),()=>I(e,i.str`missing required properties`))}}function _(e,t,r={}){let{gen:n}=e;for(let s in r)n.elseIf(i._`${t} === ${s}`),S(e,t,r[s])}function S(e,t,r){m({...e,schema:r,data:i._`${e.data}[${t}]`})}function E(e){O(e,'"'),P(e,c.parseJsonString)}function k(e,t){let{gen:r}=e;C(e),r.if(i._`"-0123456789".indexOf(${A(1)}) < 0`,()=>N(e),()=>P(e,c.parseJsonNumber,t))}function x(e,t){return r=>{let{gen:i,data:n}=r;$(r,`${e}`,()=>t(r),()=>i.assign(n,e))}}function T(e){P(e,c.parseJson)}function P(e,t,r){R(e,(0,u.useFunc)(e.gen,t),r)}function R(e,t,r){let{gen:n,data:a}=e;n.assign(a,i._`${t}(${s.default.json}, ${s.default.jsonPos}${r?i._`, ${r}`:i.nil})`),n.assign(s.default.jsonPos,i._`${t}.position`),n.if(i._`${a} === undefined`,()=>I(e,i._`${t}.message`))}function O(e,t){$(e,t,N)}function $(e,t,r,n){let{gen:a}=e,o=t.length;C(e),a.if(i._`${A(o)} === ${t}`,()=>{a.add(s.default.jsonPos,o),n?.(e)},()=>r(e))}function C({gen:e,char:t}){e.code(i._`while((${t}=${s.default.json}[${s.default.jsonPos}],${t}===" "||${t}==="\\n"||${t}==="\\r"||${t}==="\\t"))${s.default.jsonPos}++;`)}function A(e){return 1===e?i._`${s.default.json}[${s.default.jsonPos}]`:i._`${s.default.json}.slice(${s.default.jsonPos}, ${s.default.jsonPos}+${e})`}function N(e){I(e,i._`"unexpected token " + ${s.default.json}[${s.default.jsonPos}]`)}function I({gen:e,parseName:t},r){e.assign(i._`${t}.message`,r),e.assign(i._`${t}.position`,s.default.jsonPos),e.return(f)}}),_i=u((e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.MissingRefError=e.ValidationError=e.CodeGen=e.Name=e.nil=e.stringify=e.str=e._=e.KeywordCxt=e.Ajv=void 0;var r=Jt(),i=fi(),n=mi(),s=vi(),a=wi(),o="JTD-meta-schema",l=class extends r.default{constructor(e={}){super({...e,jtd:!0})}_addVocabularies(){super._addVocabularies(),this.addVocabulary(i.default)}_addDefaultMetaSchema(){super._addDefaultMetaSchema(),this.opts.meta&&this.addMetaSchema(n.default,o,!1)}defaultMeta(){return this.opts.defaultMeta=super.defaultMeta()||(this.getSchema(o)?o:void 0)}compileSerializer(e){let t=this._addSchema(e);return t.serialize||this._compileSerializer(t)}compileParser(e){let t=this._addSchema(e);return t.parse||this._compileParser(t)}_compileSerializer(e){if(s.default.call(this,e,e.schema.definitions||{}),!e.serialize)throw new Error("ajv implementation error");return e.serialize}_compileParser(e){if(a.default.call(this,e,e.schema.definitions||{}),!e.parse)throw new Error("ajv implementation error");return e.parse}};e.Ajv=l,t.exports=e=l,t.exports.Ajv=l,Object.defineProperty(e,"__esModule",{value:!0}),e.default=l;var c=zt();Object.defineProperty(e,"KeywordCxt",{enumerable:!0,get:function(){return c.KeywordCxt}});var u=Tt();Object.defineProperty(e,"_",{enumerable:!0,get:function(){return u._}}),Object.defineProperty(e,"str",{enumerable:!0,get:function(){return u.str}}),Object.defineProperty(e,"stringify",{enumerable:!0,get:function(){return u.stringify}}),Object.defineProperty(e,"nil",{enumerable:!0,get:function(){return u.nil}}),Object.defineProperty(e,"Name",{enumerable:!0,get:function(){return u.Name}}),Object.defineProperty(e,"CodeGen",{enumerable:!0,get:function(){return u.CodeGen}});var d=qt();Object.defineProperty(e,"ValidationError",{enumerable:!0,get:function(){return d.default}});var p=Ut();Object.defineProperty(e,"MissingRefError",{enumerable:!0,get:function(){return p.default}})}),Si=u((e,t)=>{var r=zr();t.exports=Object.freeze({coerceTypes:"array",useDefaults:!0,removeAdditional:!0,uriResolver:r,addUsedSchema:!1,allErrors:!1})}),Ei=u(e=>{function t(e,t){return{validate:e,compare:t}}Object.defineProperty(e,"__esModule",{value:!0}),e.formatNames=e.fastFormats=e.fullFormats=void 0,e.fullFormats={date:t(n,s),time:t(o,l),"date-time":t(function(e){let t=e.split(c);return 2===t.length&&n(t[0])&&o(t[1],!0)},u),duration:/^P(?!$)((\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+S)?)?|(\d+W)?)$/,uri:function(e){return d.test(e)&&p.test(e)},"uri-reference":/^(?:[a-z][a-z0-9+\-.]*:)?(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'"()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?(?:\?(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,"uri-template":/^(?:(?:[^\x00-\x20"'<>%\\^`{|}]|%[0-9a-f]{2})|\{[+#./;?&=,!@|]?(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?(?:,(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?)*\})*$/i,url:/^(?:https?|ftp):\/\/(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z0-9\u{00a1}-\u{ffff}]+-)*[a-z0-9\u{00a1}-\u{ffff}]+)(?:\.(?:[a-z0-9\u{00a1}-\u{ffff}]+-)*[a-z0-9\u{00a1}-\u{ffff}]+)*(?:\.(?:[a-z\u{00a1}-\u{ffff}]{2,})))(?::\d{2,5})?(?:\/[^\s]*)?$/iu,email:/^[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/i,hostname:/^(?=.{1,253}\.?$)[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[-0-9a-z]{0,61}[0-9a-z])?)*\.?$/i,ipv4:/^(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)$/,ipv6:/^((([0-9a-f]{1,4}:){7}([0-9a-f]{1,4}|:))|(([0-9a-f]{1,4}:){6}(:[0-9a-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){5}(((:[0-9a-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){4}(((:[0-9a-f]{1,4}){1,3})|((:[0-9a-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){3}(((:[0-9a-f]{1,4}){1,4})|((:[0-9a-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){2}(((:[0-9a-f]{1,4}){1,5})|((:[0-9a-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){1}(((:[0-9a-f]{1,4}){1,6})|((:[0-9a-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9a-f]{1,4}){1,7})|((:[0-9a-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))$/i,regex:function(e){if(y.test(e))return!1;try{return new RegExp(e),!0}catch{return!1}},uuid:/^(?:urn:uuid:)?[0-9a-f]{8}-(?:[0-9a-f]{4}-){3}[0-9a-f]{12}$/i,"json-pointer":/^(?:\/(?:[^~/]|~0|~1)*)*$/,"json-pointer-uri-fragment":/^#(?:\/(?:[a-z0-9_\-.!$&'()*+,;:=@]|%[0-9a-f]{2}|~0|~1)*)*$/i,"relative-json-pointer":/^(?:0|[1-9][0-9]*)(?:#|(?:\/(?:[^~/]|~0|~1)*)*)$/,byte:function(e){return h.lastIndex=0,h.test(e)},int32:{type:"number",validate:function(e){return Number.isInteger(e)&&e<=m&&e>=f}},int64:{type:"number",validate:function(e){return Number.isInteger(e)}},float:{type:"number",validate:g},double:{type:"number",validate:g},password:!0,binary:!0},e.fastFormats={...e.fullFormats,date:t(/^\d\d\d\d-[0-1]\d-[0-3]\d$/,s),time:t(/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)?$/i,l),"date-time":t(/^\d\d\d\d-[0-1]\d-[0-3]\d[t\s](?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i,u),uri:/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/)?[^\s]*$/i,"uri-reference":/^(?:(?:[a-z][a-z0-9+\-.]*:)?\/?\/)?(?:[^\\\s#][^\s#]*)?(?:#[^\\\s]*)?$/i,email:/^[a-z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?)*$/i},e.formatNames=Object.keys(e.fullFormats);var r=/^(\d\d\d\d)-(\d\d)-(\d\d)$/,i=[0,31,28,31,30,31,30,31,31,30,31,30,31];function n(e){let t=r.exec(e);if(!t)return!1;let n=+t[2],s=+t[3];return n>=1&&n<=12&&s>=1&&s<=(2===n&&function(e){return e%4==0&&(e%100!=0||e%400==0)}(+t[1])?29:i[n])}function s(e,t){if(e&&t)return e>t?1:e<t?-1:0}var a=/^(\d\d):(\d\d):(\d\d)(\.\d+)?(z|[+-]\d\d(?::?\d\d)?)?$/i;function o(e,t){let r=a.exec(e);if(!r)return!1;let i=+r[1],n=+r[2],s=+r[3];return(i<=23&&n<=59&&s<=59||23===i&&59===n&&60===s)&&(!t||""!==r[5])}function l(e,t){if(!e||!t)return;let r=a.exec(e),i=a.exec(t);return r&&i?(e=r[1]+r[2]+r[3]+(r[4]||""))>(t=i[1]+i[2]+i[3]+(i[4]||""))?1:e<t?-1:0:void 0}var c=/t|\s/i;function u(e,t){if(!e||!t)return;let[r,i]=e.split(c),[n,a]=t.split(c),o=s(r,n);return void 0!==o?o||l(i,a):void 0}var d=/\/|:/,p=/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)(?:\?(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,h=/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/gm,f=-(2**31),m=2**31-1;function g(){return!0}var y=/[^\\]\\Z/}),ki=u(e=>{Object.defineProperty(e,"__esModule",{value:!0}),e.formatLimitDefinition=void 0;var t=Lr(),r=Tt(),i=r.operators,n={formatMaximum:{okStr:"<=",ok:i.LTE,fail:i.GT},formatMinimum:{okStr:">=",ok:i.GTE,fail:i.LT},formatExclusiveMaximum:{okStr:"<",ok:i.LT,fail:i.GTE},formatExclusiveMinimum:{okStr:">",ok:i.GT,fail:i.LTE}},s={message:({keyword:e,schemaCode:t})=>r.str`should be ${n[e].okStr} ${t}`,params:({keyword:e,schemaCode:t})=>r._`{comparison: ${n[e].okStr}, limit: ${t}}`};e.formatLimitDefinition={keyword:Object.keys(n),type:"string",schemaType:"string",$data:!0,error:s,code(e){let{gen:i,data:s,schemaCode:a,keyword:o,it:l}=e,{opts:c,self:u}=l;if(!c.validateFormats)return;let d=new t.KeywordCxt(l,u.RULES.all.format.definition,"format");function p(e){return r._`${e}.compare(${s}, ${a}) ${n[o].fail} 0`}d.$data?function(){let t=i.scopeValue("formats",{ref:u.formats,code:c.code.formats}),n=i.const("fmt",r._`${t}[${d.schemaCode}]`);e.fail$data(r.or(r._`typeof ${n} != "object"`,r._`${n} instanceof RegExp`,r._`typeof ${n}.compare != "function"`,p(n)))}():function(){let t=d.schema,n=u.formats[t];if(!n||!0===n)return;if("object"!=typeof n||n instanceof RegExp||"function"!=typeof n.compare)throw new Error(`"${o}": format "${t}" does not define "compare" function`);let s=i.scopeValue("formats",{key:t,ref:n,code:c.code.formats?r._`${c.code.formats}${r.getProperty(t)}`:void 0});e.fail$data(p(s))}()},dependencies:["format"]},e.default=t=>(t.addKeyword(e.formatLimitDefinition),t)}),xi=u((e,t)=>{Object.defineProperty(e,"__esModule",{value:!0});var r=Ei(),i=ki(),n=Tt(),s=new n.Name("fullFormats"),a=new n.Name("fastFormats"),o=(e,t={keywords:!0})=>{if(Array.isArray(t))return l(e,t,r.fullFormats,s),e;let[n,o]="fast"===t.mode?[r.fastFormats,a]:[r.fullFormats,s];return l(e,t.formats||r.formatNames,n,o),t.keywords&&i.default(e),e};function l(e,t,r,i){var s,a;null!==(s=(a=e.opts.code).formats)&&void 0!==s||(a.formats=n._`require("ajv-formats/dist/formats").${i}`);for(let i of t)e.addFormat(i,r[i])}o.get=(e,t="full")=>{let i=("fast"===t?r.fastFormats:r.fullFormats)[e];if(!i)throw new Error(`Unknown format "${e}"`);return i},t.exports=e=o,Object.defineProperty(e,"__esModule",{value:!0}),e.default=o}),Ti=u((e,t)=>{var r=Lr().default,i=_i(),n=Si();t.exports=class{constructor(e,t){this.ajv="JTD"===t.mode?new i(Object.assign({},n,t.customOptions)):new r(Object.assign({},n,t.customOptions));let s=!0;if(t.plugins&&t.plugins.length>0)for(let e of t.plugins)Array.isArray(e)?(s=s&&"formatsPlugin"!==e[0].name,e[0](this.ajv,e[1])):(s=s&&"formatsPlugin"!==e.name,e(this.ajv));s&&xi()(this.ajv),t.onCreate?.(this.ajv);let a=Object.values(e);for(let e of a)this.ajv.addSchema(e)}buildValidatorFunction({schema:e}){if(e.$id){let t=this.ajv.getSchema(e.$id);if(t)return t}return this.ajv.compile(e)}}}),Pi=u((e,t)=>{var r=_i(),i=Si();t.exports=class{constructor(e,t){this.ajv=new r(Object.assign({},i,t))}buildSerializerFunction({schema:e}){return this.ajv.compileSerializer(e)}}}),Ri=u((e,t)=>{Object.defineProperty(e,"__esModule",{value:!0});var r=xt(),i=kt();function n(e,t){if(!e.opts.code.source)throw new Error("moduleCode: ajv instance must have code.source option");let{_n:n}=e.scope.opts;return"function"==typeof t?function(t){let r=t?.validateName,i=a({},t);return e.opts.code.esm?`"use strict";${n}export const validate = ${r};${n}export default ${r};${n}${i}`:`"use strict";${n}module.exports = ${r};${n}module.exports.default = ${r};${n}${i}`}(t.source):void 0!==t?s(t,function(t){let r=e.getSchema(t);if(!r)throw new Error(`moduleCode: no schema with id ${t}`);return r}):s(e.schemas,t=>t.meta?void 0:e.compile(t.schema));function s(t,r){var s;let o={},l=i._`"use strict";`;for(let c in t){let u=r(t[c]);if(u){let t=a(o,u.source),r=e.opts.code.esm?i._`export const ${(0,i.getEsmExportName)(c)}`:i._`exports${(0,i.getProperty)(c)}`;l=i._`${l}${n}${r} = ${null===(s=u.source)||void 0===s?void 0:s.validateName};${n}${t}`}}return`${l}`}function a(t,s){if(!s)throw new Error('moduleCode: function does not have "source" property');if(c(s.validateName)===r.UsedValueState.Completed)return i.nil;!function(e,r){let{prefix:i}=e;(t[i]=t[i]||new Map).set(e,r)}(s.validateName,r.UsedValueState.Started);let o=e.scope.scopeCode(s.scopeValues,t,function(s){var o;let l=null===(o=s.value)||void 0===o?void 0:o.ref;if("validate"===s.prefix&&"function"==typeof l)return a(t,l.source);if(("root"===s.prefix||"wrapper"===s.prefix)&&"object"==typeof l){let{validate:o,validateName:u}=l;if(!u)throw new Error("ajv internal error");let d=i._`${e.opts.code.es5?r.varKinds.var:r.varKinds.const} ${s} = {validate: ${u}};`;if(c(u)===r.UsedValueState.Started)return d;let p=a(t,o?.source);return i._`${d}${n}${p}`}}),l=new i._Code(`${o}${n}${s.validateCode}`);return s.evaluated?i._`${l}${s.validateName}.evaluated = ${s.evaluated};${n}`:l;function c(e){var r;return null===(r=t[e.prefix])||void 0===r?void 0:r.get(e)}}}t.exports=e=n,Object.defineProperty(e,"__esModule",{value:!0}),e.default=n}),Oi=u((e,t)=>{var r=$i(),i=Ri().default;t.exports=function(e={readMode:!0}){if(!0===e.readMode&&!e.restoreFunction)throw new Error("You must provide a restoreFunction options when readMode ON");if(!0!==e.readMode&&!e.storeFunction)throw new Error("You must provide a storeFunction options when readMode OFF");if(!0===e.readMode)return function(){return function(t){return e.restoreFunction(t)}};let t=r();return function(n,s={}){(!s.customOptions||!s.customOptions.code)&&(s.customOptions=Object.assign({},s.customOptions,{code:{source:!0}}));let a=t(n,s);return function(t){let n=a(t),s=i(a[r.AjvReference].ajv,n);return e.storeFunction(t,s),n}}}}),$i=u((e,t)=>{var r=Symbol.for("fastify.ajv-compiler.reference"),i=Ti(),n=Pi();function s(e){let t=new Map,s=new Map;return e&&!0===e.jtdSerializer?function(e,t){let r=a({},t);if(s.has(r))return s.get(r);let i=new n(e,t),o=i.buildSerializerFunction.bind(i);return s.set(r,o),o}:function(e,n){let s=a(e,n.customOptions);if(t.has(s))return t.get(s);let o=new i(e,n),l=o.buildValidatorFunction.bind(o);return t.set(s,l),void 0!==n.customOptions.code&&(l[r]=o),l}}function a(e,t){return`${JSON.stringify(e)}${JSON.stringify(t)}`}t.exports=s,t.exports.default=s,t.exports.AjvCompiler=s,t.exports.AjvReference=r,t.exports.StandaloneValidator=Oi()}),Ci=u((e,t)=>{var{buildSchemas:r}=me(),i=ei(),n=$i(),s=class{constructor(e,t){this.opts=t||e?.opts,this.addedSchemas=!1,this.compilersFactory=this.opts.compilersFactory,e?(this.schemaBucket=this.opts.bucket(e.getSchemas()),this.validatorCompiler=e.getValidatorCompiler(),this.serializerCompiler=e.getSerializerCompiler(),this.isCustomValidatorCompiler=e.isCustomValidatorCompiler,this.isCustomSerializerCompiler=e.isCustomSerializerCompiler,this.parent=e):(this.schemaBucket=this.opts.bucket(),this.isCustomValidatorCompiler=this.opts.isCustomValidatorCompiler||!1,this.isCustomSerializerCompiler=this.opts.isCustomSerializerCompiler||!1)}add(e){return this.addedSchemas=!0,this.schemaBucket.add(e)}getSchema(e){return this.schemaBucket.getSchema(e)}getSchemas(){return this.schemaBucket.getSchemas()}setValidatorCompiler(e){this.compilersFactory=Object.assign({},this.compilersFactory,{buildValidator:()=>e}),this.validatorCompiler=e,this.isCustomValidatorCompiler=!0}setSerializerCompiler(e){this.compilersFactory=Object.assign({},this.compilersFactory,{buildSerializer:()=>e}),this.serializerCompiler=e,this.isCustomSerializerCompiler=!0}getValidatorCompiler(){return this.validatorCompiler||this.parent&&this.parent.getValidatorCompiler()}getSerializerCompiler(){return this.serializerCompiler||this.parent&&this.parent.getSerializerCompiler()}getSerializerBuilder(){return this.compilersFactory.buildSerializer||this.parent&&this.parent.getSerializerBuilder()}getValidatorBuilder(){return this.compilersFactory.buildValidator||this.parent&&this.parent.getValidatorBuilder()}setupValidator(e){void 0!==this.validatorCompiler&&!this.addedSchemas||(this.validatorCompiler=this.getValidatorBuilder()(this.schemaBucket.getSchemas(),e.ajv))}setupSerializer(e){void 0!==this.serializerCompiler&&!this.addedSchemas||(this.serializerCompiler=this.getSerializerBuilder()(this.schemaBucket.getSchemas(),e.serializerOpts))}};s.buildSchemaController=function(e,t){if(e)return new s(e,t);let a=Object.assign({buildValidator:null,buildSerializer:null},t?.compilersFactory);return a.buildValidator||(a.buildValidator=n()),a.buildSerializer||(a.buildSerializer=i()),new s(void 0,{bucket:t&&t.bucket||r,compilersFactory:a,isCustomValidatorCompiler:"function"==typeof t?.compilersFactory?.buildValidator,isCustomSerializerCompiler:"function"==typeof t?.compilersFactory?.buildValidator})},t.exports=s}),Ai=u((e,t)=>{var r=ht(),i=c("node:assert"),n=Symbol.for("registered-plugin"),{kTestInternals:s}=R(),{exist:a,existReply:o,existRequest:l}=yt(),{FST_ERR_PLUGIN_VERSION_MISMATCH:u,FST_ERR_PLUGIN_NOT_PRESENT_IN_INSTANCE:d}=C(),{FSTWRN002:p}=$();function h(e){return e[Symbol.for("plugin-meta")]}function f(e){let t=m(e);if(t)return t;let r=c.cache;if(r){let t=Object.keys(r);for(let i=0;i<t.length;i++){let n=t[i];if(r[n].exports===e)return n}}return e.name?e.name:null}function m(e){return e[Symbol.for("fastify.display-name")]}function g(e){return!!e[Symbol.for("skip-override")]}function y(e){let t=h(e);if(!t)return;let r=t.dependencies;r&&(i(Array.isArray(r),"The dependencies should be an array of strings"),r.forEach(e=>{i(this[n].indexOf(e)>-1,`The dependency '${e}' of plugin '${t.name}' is not registered`)}))}function v(e){let t=h(e);if(!t)return;let{decorators:r,name:i}=t;r&&(r.fastify&&w(this,"Fastify",r.fastify,i),r.reply&&w(this,"Reply",r.reply,i),r.request&&w(this,"Request",r.request,i))}var b={Fastify:a,Request:l,Reply:o};function w(e,t,r,n){i(Array.isArray(r),"The decorators should be an array of strings"),r.forEach(r=>{let i="string"==typeof n?` required by '${n}'`:"";if(!b[t].call(e,r))throw new d(r,i,t)})}function _(e){let t=h(e);if(!t)return;let i=t.fastify,n=/-rc.+$/.test(this.version);if((!0!==n||!0!==r.gt(this.version,r.coerce(i)))&&i&&!1===r.satisfies(this.version,i,{includePrerelease:n}))throw new u(t.name,i,this.version)}function S(e){let t=h(e);if(!t)return;let r=t.name;return r?(this[n].push(r),r):void 0}function E(e,t){"AsyncFunction"===e.constructor.name&&3===e.length&&p(t||"anonymous")}t.exports={getPluginName:f,getFuncPreview:function(e){return e.toString().split("\n").slice(0,2).map(e=>e.trim()).join(" -- ")},kRegisteredPlugins:n,getDisplayName:m,registerPlugin:function(e){let t=S.call(this,e)||f(e);return E.call(this,e,t),_.call(this,e),v.call(this,e),y.call(this,e),g(e)}},t.exports[s]={shouldSkipOverride:g,getMeta:h,checkDecorators:v,checkDependencies:y}}),Ni=u((e,t)=>{t.exports={getGenReqId:function(e,t){return e.genReqId(t)},reqIdGenFactory:function(e,t){let r=t||function(){let e=0;return function(){return e=e+1&2147483647,`req-${e.toString(36)}`}}();return e?function(e,t){return function(r){return r.headers[e]||t(r)}}(e,r):r}}}),Ii=u((e,t)=>{var r=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,7,7,7,7,7,7,7,7,7,7,7,7,8,7,7,10,9,9,9,11,4,4,4,4,4,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,12,0,0,0,0,24,36,48,60,72,84,96,0,12,12,12,0,0,0,0,0,0,0,0,0,0,0,24,0,0,0,0,0,0,0,0,0,24,24,24,0,0,0,0,0,0,0,0,0,24,24,0,0,0,0,0,0,0,0,0,0,48,48,48,0,0,0,0,0,0,0,0,0,0,48,48,0,0,0,0,0,0,0,0,0,48,0,0,0,0,0,0,0,0,0,0,127,63,63,63,0,31,15,15,15,7,7,7],i={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,a:10,A:10,b:11,B:11,c:12,C:12,d:13,D:13,e:14,E:14,f:15,F:15};function n(e,t){var r=i[e];return void 0===r?255:r<<t}t.exports=function(e){var t=e.indexOf("%");if(-1===t)return e;for(var i=e.length,s="",a=0,o=0,l=t,c=12;t>-1&&t<i;){var u=n(e[t+1],4)|n(e[t+2],0),d=r[u];if(o=o<<6|u&r[364+d],12!==(c=r[256+c+d])){if(0===c)return null;if((t+=3)<i&&37===e.charCodeAt(t))continue;return null}s+=e.slice(a,l),s+=o<=65535?String.fromCharCode(o):String.fromCharCode(55232+(o>>10),56320+(1023&o)),o=0,t=l=e.indexOf("%",a=t+3)}return s+e.slice(a)}}),ji=u((e,t)=>{var r=Ii(),i=/\+/g,n=function(){};n.prototype=Object.create(null),t.exports=function(e){let t=new n;if("string"!=typeof e)return t;let s=e.length,a="",o="",l=-1,c=-1,u=!1,d=!1,p=!1,h=!1,f=!1,m=0;for(let n=0;n<s+1;n++)if(m=n!==s?e.charCodeAt(n):38,38===m){if(f=c>l,f||(c=n),a=e.slice(l+1,c),f||a.length>0){p&&(a=a.replace(i," ")),u&&(a=r(a)||a),f&&(o=e.slice(c+1,n),h&&(o=o.replace(i," ")),d&&(o=r(o)||o));let s=t[a];void 0===s?t[a]=o:s.pop?s.push(o):t[a]=[s,o]}o="",l=n,c=n,u=!1,d=!1,p=!1,h=!1}else 61===m?c<=l?c=n:d=!0:43===m?c>l?h=!0:p=!0:37===m&&(c>l?d=!0:u=!0);return t}}),Li=u((e,t)=>{var r=Array.from({length:256},(e,t)=>"%"+((t<16?"0":"")+t.toString(16)).toUpperCase()),i=new Int8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1,1,1,1,0,0,1,1,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1,0]);t.exports={encodeString:function(e){let t=e.length;if(0===t)return"";let n="",s=0,a=0;e:for(;a<t;a++){let o=e.charCodeAt(a);for(;o<128;){if(1!==i[o]&&(s<a&&(n+=e.slice(s,a)),s=a+1,n+=r[o]),++a===t)break e;o=e.charCodeAt(a)}if(s<a&&(n+=e.slice(s,a)),o<2048)s=a+1,n+=r[192|o>>6]+r[128|63&o];else if(o<55296||o>=57344)s=a+1,n+=r[224|o>>12]+r[128|o>>6&63]+r[128|63&o];else{if(++a,a>=t)throw new Error("URI malformed");s=a+1,o=65536+((1023&o)<<10|1023&e.charCodeAt(a)),n+=r[240|o>>18]+r[128|o>>12&63]+r[128|o>>6&63]+r[128|63&o]}}return 0===s?e:s<t?n+e.slice(s):n}}}),Di=u((e,t)=>{var{encodeString:r}=Li();function i(e){let t=typeof e;return"string"===t?r(e):"bigint"===t?e.toString():"boolean"===t?e?"true":"false":"number"===t&&Number.isFinite(e)?e<1e21?""+e:r(""+e):""}t.exports=function(e){let t="";if(null===e||"object"!=typeof e)return t;let n=Object.keys(e),s=n.length,a=0;for(let o=0;o<s;o++){let s=n[o],l=e[s],c=r(s)+"=";if(o&&(t+="&"),Array.isArray(l)){a=l.length;for(let e=0;e<a;e++)e&&(t+="&"),t+=c,t+=i(l[e])}else t+=c,t+=i(l)}return t}}),Fi=u((e,t)=>{var r=ji(),i=Di(),n={parse:r,stringify:i};t.exports=n,t.exports.default=n,t.exports.parse=r,t.exports.stringify=i}),Mi=u(e=>{Object.defineProperty(e,"__esModule",{value:!0})}),zi=u(e=>{Object.defineProperty(e,"__esModule",{value:!0}),e.types=void 0,function(e){e[e.ROOT=0]="ROOT",e[e.GROUP=1]="GROUP",e[e.POSITION=2]="POSITION",e[e.SET=3]="SET",e[e.RANGE=4]="RANGE",e[e.REPETITION=5]="REPETITION",e[e.REFERENCE=6]="REFERENCE",e[e.CHAR=7]="CHAR"}(e.types||(e.types={}))}),qi=u(e=>{Object.defineProperty(e,"__esModule",{value:!0})}),Ui=u(e=>{var t=e&&e.__createBinding||(Object.create?function(e,t,r,i){void 0===i&&(i=r),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]}),r=e&&e.__exportStar||function(e,r){for(var i in e)"default"!==i&&!Object.prototype.hasOwnProperty.call(r,i)&&t(r,e,i)};Object.defineProperty(e,"__esModule",{value:!0}),r(Mi(),e),r(zi(),e),r(qi(),e)}),Bi=u(e=>{Object.defineProperty(e,"__esModule",{value:!0}),e.anyChar=e.notWhitespace=e.whitespace=e.notInts=e.ints=e.notWords=e.words=void 0;var t=Ui(),r=()=>[{type:t.types.RANGE,from:48,to:57}],i=()=>[{type:t.types.CHAR,value:95},{type:t.types.RANGE,from:97,to:122},{type:t.types.RANGE,from:65,to:90},{type:t.types.RANGE,from:48,to:57}],n=()=>[{type:t.types.CHAR,value:9},{type:t.types.CHAR,value:10},{type:t.types.CHAR,value:11},{type:t.types.CHAR,value:12},{type:t.types.CHAR,value:13},{type:t.types.CHAR,value:32},{type:t.types.CHAR,value:160},{type:t.types.CHAR,value:5760},{type:t.types.RANGE,from:8192,to:8202},{type:t.types.CHAR,value:8232},{type:t.types.CHAR,value:8233},{type:t.types.CHAR,value:8239},{type:t.types.CHAR,value:8287},{type:t.types.CHAR,value:12288},{type:t.types.CHAR,value:65279}];e.words=()=>({type:t.types.SET,set:i(),not:!1}),e.notWords=()=>({type:t.types.SET,set:i(),not:!0}),e.ints=()=>({type:t.types.SET,set:r(),not:!1}),e.notInts=()=>({type:t.types.SET,set:r(),not:!0}),e.whitespace=()=>({type:t.types.SET,set:n(),not:!1}),e.notWhitespace=()=>({type:t.types.SET,set:n(),not:!0}),e.anyChar=()=>({type:t.types.SET,set:[{type:t.types.CHAR,value:10},{type:t.types.CHAR,value:13},{type:t.types.CHAR,value:8232},{type:t.types.CHAR,value:8233}],not:!0})}),Hi=u(e=>{var t=e&&e.__createBinding||(Object.create?function(e,t,r,i){void 0===i&&(i=r),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]}),r=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var i={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&t(i,e,n);return r(i,e),i};Object.defineProperty(e,"__esModule",{value:!0}),e.tokenizeClass=e.strToChars=void 0;var n=Ui(),s=i(Bi());e.strToChars=e=>e.replace(/(\[\\b\])|(\\)?\\(?:u([A-F0-9]{4})|x([A-F0-9]{2})|c([@A-Z[\\\]^?])|([0tnvfr]))/g,(e,t,r,i,n,s,a)=>{if(r)return e;let o=t?8:i?parseInt(i,16):n?parseInt(n,16):s?"@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^ ?".indexOf(s):{0:0,t:9,n:10,v:11,f:12,r:13}[a],l=String.fromCharCode(o);return/[[\]{}^$.|?*+()]/.test(l)?`\\${l}`:l}),e.tokenizeClass=(e,t)=>{var r,i,a,o,l,c,u;let d,p,h=[],f=/\\(?:(w)|(d)|(s)|(W)|(D)|(S))|((?:(?:\\)(.)|([^\]\\]))-(((?:\\)])|(((?:\\)?([^\]])))))|(\])|(?:\\)?([^])/g;for(;null!==(d=f.exec(e));){let e=null!==(u=null!==(c=null!==(l=null!==(o=null!==(a=null!==(i=null!==(r=d[1]&&s.words())&&void 0!==r?r:d[2]&&s.ints())&&void 0!==i?i:d[3]&&s.whitespace())&&void 0!==a?a:d[4]&&s.notWords())&&void 0!==o?o:d[5]&&s.notInts())&&void 0!==l?l:d[6]&&s.notWhitespace())&&void 0!==c?c:d[7]&&{type:n.types.RANGE,from:(d[8]||d[9]).charCodeAt(0),to:(p=d[10]).charCodeAt(p.length-1)})&&void 0!==u?u:(p=d[16])&&{type:n.types.CHAR,value:p.charCodeAt(0)};if(!e)return[h,f.lastIndex];h.push(e)}throw new SyntaxError(`Invalid regular expression: /${t}/: Unterminated character class`)}}),Vi=u(e=>{var t=e&&e.__createBinding||(Object.create?function(e,t,r,i){void 0===i&&(i=r),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]}),r=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var i={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&t(i,e,n);return r(i,e),i};Object.defineProperty(e,"__esModule",{value:!0}),e.tokenizer=void 0;var n=i(Hi()),s=Ui(),a=i(Bi());e.tokenizer=e=>{let t,r=0,i={type:s.types.ROOT,stack:[]},o=i,l=i.stack,c=[],u=[],d=0,p=t=>{throw new SyntaxError(`Invalid regular expression: /${e}/: Nothing to repeat at column ${t-1}`)},h=n.strToChars(e);for(;r<h.length;)switch(t=h[r++]){case"\\":if(r===h.length)throw new SyntaxError(`Invalid regular expression: /${e}/: \\ at end of pattern`);switch(t=h[r++]){case"b":l.push({type:s.types.POSITION,value:"b"});break;case"B":l.push({type:s.types.POSITION,value:"B"});break;case"w":l.push(a.words());break;case"W":l.push(a.notWords());break;case"d":l.push(a.ints());break;case"D":l.push(a.notInts());break;case"s":l.push(a.whitespace());break;case"S":l.push(a.notWhitespace());break;default:if(/\d/.test(t)){let e=t;for(;r<h.length&&/\d/.test(h[r]);)e+=h[r++];let i=parseInt(e,10),n={type:s.types.REFERENCE,value:i};l.push(n),u.push({reference:n,stack:l,index:l.length-1})}else l.push({type:s.types.CHAR,value:t.charCodeAt(0)})}break;case"^":l.push({type:s.types.POSITION,value:"^"});break;case"$":l.push({type:s.types.POSITION,value:"$"});break;case"[":{let t;"^"===h[r]?(t=!0,r++):t=!1;let i=n.tokenizeClass(h.slice(r),e);r+=i[1],l.push({type:s.types.SET,set:i[0],not:t});break}case".":l.push(a.anyChar());break;case"(":{let i={type:s.types.GROUP,stack:[],remember:!0};if("?"===h[r]){if(t=h[r+1],r+=2,"="===t)i.followedBy=!0;else if("!"===t)i.notFollowedBy=!0;else if(":"!==t)throw new SyntaxError(`Invalid regular expression: /${e}/: Invalid group, character '${t}' after '?' at column ${r-1}`);i.remember=!1}else d+=1;l.push(i),c.push(o),o=i,l=i.stack;break}case")":if(0===c.length)throw new SyntaxError(`Invalid regular expression: /${e}/: Unmatched ) at column ${r-1}`);o=c.pop(),l=o.options?o.options[o.options.length-1]:o.stack;break;case"|":{o.options||(o.options=[o.stack],delete o.stack);let e=[];o.options.push(e),l=e;break}case"{":{let e,t,i=/^(\d+)(,(\d+)?)?\}/.exec(h.slice(r));null!==i?(0===l.length&&p(r),e=parseInt(i[1],10),t=i[2]?i[3]?parseInt(i[3],10):1/0:e,r+=i[0].length,l.push({type:s.types.REPETITION,min:e,max:t,value:l.pop()})):l.push({type:s.types.CHAR,value:123});break}case"?":0===l.length&&p(r),l.push({type:s.types.REPETITION,min:0,max:1,value:l.pop()});break;case"+":0===l.length&&p(r),l.push({type:s.types.REPETITION,min:1,max:1/0,value:l.pop()});break;case"*":0===l.length&&p(r),l.push({type:s.types.REPETITION,min:0,max:1/0,value:l.pop()});break;default:l.push({type:s.types.CHAR,value:t.charCodeAt(0)})}if(0!==c.length)throw new SyntaxError(`Invalid regular expression: /${e}/: Unterminated group`);return function(e,t){for(let r of e.reverse())if(t<r.reference.value){r.reference.type=s.types.CHAR;let e=r.reference.value.toString();if(r.reference.value=parseInt(e,8),!/^[0-7]+$/.test(e)){let t=0;for(;"8"!==e[t]&&"9"!==e[t];)t+=1;if(0===t?(r.reference.value=e.charCodeAt(0),t+=1):r.reference.value=parseInt(e.slice(0,t),8),e.length>t){let i=r.stack.splice(r.index+1);for(let i of e.slice(t))r.stack.push({type:s.types.CHAR,value:i.charCodeAt(0)});r.stack.push(...i)}}}}(u,d),i}}),Gi=u(e=>{var t=e&&e.__createBinding||(Object.create?function(e,t,r,i){void 0===i&&(i=r),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]}),r=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var i={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&t(i,e,n);return r(i,e),i};Object.defineProperty(e,"__esModule",{value:!0}),e.NOTANYCHAR=e.WHITESPACE=e.WORDS=e.INTS=void 0;var n=i(Bi()),s=Ui();function a(e){let t={},r=0;for(let i of e)i.type===s.types.CHAR&&(t[i.value]=!0),i.type===s.types.RANGE&&(t[`${i.from}-${i.to}`]=!0),r+=1;return{lookup:()=>Object.assign({},t),len:r}}e.INTS=a(n.ints().set),e.WORDS=a(n.words().set),e.WHITESPACE=a(n.whitespace().set),e.NOTANYCHAR=a(n.anyChar().set)}),Wi=u(e=>{var t=e&&e.__createBinding||(Object.create?function(e,t,r,i){void 0===i&&(i=r),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]}),r=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var i={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&t(i,e,n);return r(i,e),i};Object.defineProperty(e,"__esModule",{value:!0}),e.writeSetTokens=e.setChar=void 0;var n=Ui(),s=i(Gi());function a(e){return 94===e?"\\^":92===e?"\\\\":93===e?"\\]":45===e?"\\-":String.fromCharCode(e)}function o(e,{lookup:t,len:r}){if(r!==e.length)return!1;let i=t();for(let t of e){if(t.type===n.types.SET)return!1;let e=t.type===n.types.CHAR?t.value:`${t.from}-${t.to}`;if(!i[e])return!1;i[e]=!1}return!0}function l(e,t=!1){if(o(e.set,s.INTS))return e.not?"\\D":"\\d";if(o(e.set,s.WORDS))return e.not?"\\W":"\\w";if(e.not&&o(e.set,s.NOTANYCHAR))return".";if(o(e.set,s.WHITESPACE))return e.not?"\\S":"\\s";let r="";for(let t=0;t<e.set.length;t++)r+=c(e.set[t]);let i=`${e.not?"^":""}${r}`;return t?i:`[${i}]`}function c(e){return e.type===n.types.CHAR?a(e.value):e.type===n.types.RANGE?`${a(e.from)}-${a(e.to)}`:l(e,!0)}e.setChar=a,e.writeSetTokens=l}),Ki=u(e=>{Object.defineProperty(e,"__esModule",{value:!0}),e.reconstruct=void 0;var t=Ui(),r=Wi(),i=t=>t.map(e.reconstruct).join(""),n=e=>{if("options"in e)return e.options.map(i).join("|");if("stack"in e)return i(e.stack);throw new Error("options or stack must be Root or Group token")};e.reconstruct=i=>{switch(i.type){case t.types.ROOT:return n(i);case t.types.CHAR:{let e=String.fromCharCode(i.value);return(/[[\\{}$^.|?*+()]/.test(e)?"\\":"")+e}case t.types.POSITION:return"^"===i.value||"$"===i.value?i.value:`\\${i.value}`;case t.types.REFERENCE:return`\\${i.value}`;case t.types.SET:return r.writeSetTokens(i);case t.types.GROUP:return`(${i.remember?"":i.followedBy?"?=":i.notFollowedBy?"?!":"?:"}${n(i)})`;case t.types.REPETITION:{let t,{min:r,max:n}=i;return t=0===r&&1===n?"?":1===r&&n===1/0?"+":0===r&&n===1/0?"*":n===1/0?`{${r},}`:r===n?`{${r}}`:`{${r},${n}}`,`${e.reconstruct(i.value)}${t}`}case t.types.RANGE:return`${r.setChar(i.from)}-${r.setChar(i.to)}`;default:throw new Error(`Invalid token type ${i}`)}}}),Ji=u((e,t)=>{var r=e&&e.__createBinding||(Object.create?function(e,t,r,i){void 0===i&&(i=r),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]}),i=e&&e.__exportStar||function(e,t){for(var i in e)"default"!==i&&!Object.prototype.hasOwnProperty.call(t,i)&&r(t,e,i)};Object.defineProperty(e,"__esModule",{value:!0}),e.types=void 0;var n=Ui();Object.defineProperty(e,"types",{enumerable:!0,get:function(){return n.types}}),i(Vi(),e),i(Ki(),e);var s=Vi(),a=Ki();i(Ui(),e),e.default=s.tokenizer,t.exports=s.tokenizer,t.exports.types=n.types,t.exports.reconstruct=a.reconstruct}),Zi=u((e,t)=>{var r=Ji(),i=r.types;function n(e,t){t||(t={});let n=void 0===t.limit?25:t.limit;!function(e){return"[object RegExp]"==={}.toString.call(e)}(e)?"string"!=typeof e&&(e=String(e)):e=e.source;try{e=r(e)}catch{return!1}let s=0;return function e(t,r){let a,o,l;if(t.type===i.REPETITION&&(r++,s++,r>1||s>n))return!1;if(t.options)for(a=0,l=t.options.length;a<l;a++)if(o=e({stack:t.options[a]},r),!o)return!1;let c=t.stack||t.value&&t.value.stack;if(!c)return!0;for(a=0;a<c.length;a++)if(o=e(c[a],r),!o)return!1;return!0}(e,0)}t.exports=n,t.exports.default=n,t.exports.safeRegex=n}),Yi=u((e,t)=>{t.exports={name:"__fmw_internal_strategy_merged_tree_http_method__",storage:function(){let e={};return{get:t=>e[t]||null,set:(t,r)=>{e[t]=r}}},deriveConstraint:e=>e.method,mustMatchWhenDerived:!0}}),Xi=u((e,t)=>{var r=St(),i=Yi(),n=Symbol("treeData");function s(e,t=""){let r="",i=Object.keys(e);for(let a=0;a<i.length;a++){let o=i[a],l=e[o],c=a===i.length-1,u=c?"    ":"│   ";r+=t+(c?"└── ":"├── ")+o+(l[n]||"").split("\n").join("\n"+t+u)+"\n",r+=s(l,t+u)}return r}function a(e){return Array.isArray(e)?e.map(e=>a(e)):"symbol"==typeof e?e.toString():"function"==typeof e?function(e){let t=e.name||"";return t=t.replace("bound","").trim(),t=(t||"anonymous")+"()",t}(e):e}function o(e){let t={...e.opts.constraints},r=t[i.name];return delete t[i.name],{...e,method:r,opts:{constraints:t}}}function l(e){let t=` (${e.method})`,r=e.opts.constraints||{};return 0!==Object.keys(r).length&&(t+=" "+JSON.stringify(r)),t+=function(e){let t="";for(let[r,i]of Object.entries(e))t+=`\n• (${r}) ${i}`;return t}(e.metaData),t}function c(e,t,i,s){if((e.isLeafNode||!1!==s.commonPrefix)&&(t=t[i=i||"(empty root node)"]={},e.isLeafNode&&(t[n]=function(e,t,i){let n=e.routes;return void 0===i.method&&(n=n.map(o)),n=n.map(e=>(e.metaData=function(e,t){if(!t.includeMeta)return{};let r=t.buildPrettyMeta(e),i={},n=t.includeMeta;Array.isArray(n)||(n=Reflect.ownKeys(r));for(let e of n){if(!Object.prototype.hasOwnProperty.call(r,e))continue;let t=e.toString(),n=r[e];if(null!=n){let e=JSON.stringify(a(n));i[t]=e}}return i}(e,i),e)),void 0===i.method&&(n=function(e){return e.reduce((e,t)=>{for(let i of e)if(r(t.opts.constraints,i.opts.constraints)&&r(t.metaData,i.metaData))return i.method+=", "+t.method,e;return e.push(t),e},[])}(n)),n.map(l).join(`\n${t}`)}(e,i,s)),i=""),e.staticChildren)for(let r of Object.values(e.staticChildren))c(r,t,i+r.prefix,s);if(e.parametricChildren)for(let r of Object.values(e.parametricChildren))c(r,t,i+Array.from(r.nodePaths).join("|"),s);e.wildcardChild&&c(e.wildcardChild,t,"*",s)}t.exports={prettyPrintTree:function(e,t){let r={};return c(e,r,e.prefix,t),s(r)}}}),Qi=u((e,t)=>{var r=Yi();t.exports=class{constructor(){this.unconstrainedHandler=null,this.constraints=[],this.handlers=[],this.constrainedHandlerStores=null}getMatchingHandler(e){return void 0===e?this.unconstrainedHandler:this._getHandlerMatchingConstraints(e)}addHandler(e,t){let i=t.params,n=t.opts.constraints||{},s={params:i,constraints:n,handler:t.handler,store:t.store||null,_createParamsObject:this._compileCreateParamsObject(i)},a=Object.keys(n);0===a.length&&(this.unconstrainedHandler=s);for(let e of a)this.constraints.includes(e)||("version"===e?this.constraints.unshift(e):this.constraints.push(e));let o=a.includes(r.name);if(!o&&this.handlers.length>=31)throw new Error("find-my-way supports a maximum of 31 route handlers per node when there are constraints, limit reached");this.handlers.push(s),this.handlers.sort((e,t)=>Object.keys(e.constraints).length-Object.keys(t.constraints).length),o||this._compileGetHandlerMatchingConstraints(e,n)}_compileCreateParamsObject(e){let t=[];for(let r=0;r<e.length;r++)t.push(`'${e[r]}': paramsArray[${r}]`);return new Function("paramsArray",`return {${t.join(",")}}`)}_getHandlerMatchingConstraints(){return null}_buildConstraintStore(e,t){for(let r=0;r<this.handlers.length;r++){let i=this.handlers[r].constraints[t];if(void 0!==i){let t=e.get(i)||0;t|=1<<r,e.set(i,t)}}}_constrainedIndexBitmask(e){let t=0;for(let r=0;r<this.handlers.length;r++)void 0!==this.handlers[r].constraints[e]&&(t|=1<<r);return~t}_compileGetHandlerMatchingConstraints(e){this.constrainedHandlerStores={};for(let t of this.constraints){let r=e.newStoreForConstraint(t);this.constrainedHandlerStores[t]=r,this._buildConstraintStore(r,t)}let t=[];t.push(`\n    let candidates = ${(1<<this.handlers.length)-1}\n    let mask, matches\n    `);for(let r of this.constraints)t.push(`\n      mask = ${this._constrainedIndexBitmask(r)}\n      value = derivedConstraints.${r}\n      `),t.push(`\n      if (value === undefined) {\n        candidates &= mask\n      } else {\n        matches = this.constrainedHandlerStores.${r}.get(value) || 0\n        candidates &= ${e.strategies[r].mustMatchWhenDerived?"matches":"(matches | mask)"}\n      }\n      if (candidates === 0) return null;\n      `);for(let r in e.strategies)e.strategies[r].mustMatchWhenDerived&&!this.constraints.includes(r)&&t.push(`if (derivedConstraints.${r} !== undefined) return null`);t.push("return this.handlers[Math.floor(Math.log2(candidates))]"),this._getHandlerMatchingConstraints=new Function("derivedConstraints",t.join("\n"))}}}),en=u((e,t)=>{var r=Qi(),i={STATIC:0,PARAMETRIC:1,WILDCARD:2},n=class{constructor(){this.isLeafNode=!1,this.routes=null,this.handlerStorage=null}addRoute(e,t){null===this.routes&&(this.routes=[]),null===this.handlerStorage&&(this.handlerStorage=new r),this.isLeafNode=!0,this.routes.push(e),this.handlerStorage.addHandler(t,e)}},s=class extends n{constructor(){super(),this.staticChildren={}}findStaticMatchingChild(e,t){let r=this.staticChildren[e.charAt(t)];return void 0!==r&&r.matchPrefix(e,t)?r:null}getStaticChild(e,t=0){if(e.length===t)return this;let r=this.findStaticMatchingChild(e,t);return r?r.getStaticChild(e,t+r.prefix.length):null}createStaticChild(e){if(0===e.length)return this;let t=this.staticChildren[e.charAt(0)];if(t){let r=1;for(;r<t.prefix.length;r++)if(e.charCodeAt(r)!==t.prefix.charCodeAt(r)){t=t.split(this,r);break}return t.createStaticChild(e.slice(r))}let r=e.charAt(0);return this.staticChildren[r]=new a(e),this.staticChildren[r]}},a=class e extends s{constructor(e){super(),this.prefix=e,this.wildcardChild=null,this.parametricChildren=[],this.kind=i.STATIC,this._compilePrefixMatch()}getParametricChild(e){let t=e&&e.source;return this.parametricChildren.find(e=>(e.regex&&e.regex.source)===t)||null}createParametricChild(e,t,r){let i=this.getParametricChild(e);return i?(i.nodePaths.add(r),i):(i=new o(e,t,r),this.parametricChildren.push(i),this.parametricChildren.sort((e,t)=>e.isRegex?t.isRegex?null===e.staticSuffix?1:null===t.staticSuffix?-1:t.staticSuffix.endsWith(e.staticSuffix)?1:e.staticSuffix.endsWith(t.staticSuffix)?-1:0:-1:1),i)}getWildcardChild(){return this.wildcardChild}createWildcardChild(){return this.wildcardChild=this.getWildcardChild()||new l,this.wildcardChild}split(t,r){let i=this.prefix.slice(0,r),n=this.prefix.slice(r);this.prefix=n,this._compilePrefixMatch();let s=new e(i);return s.staticChildren[n.charAt(0)]=this,t.staticChildren[i.charAt(0)]=s,s}getNextNode(e,t,r,i){let n=this.findStaticMatchingChild(e,t),s=0;if(null===n){if(0===this.parametricChildren.length)return this.wildcardChild;n=this.parametricChildren[0],s=1}null!==this.wildcardChild&&r.push({paramsCount:i,brotherPathIndex:t,brotherNode:this.wildcardChild});for(let e=this.parametricChildren.length-1;e>=s;e--)r.push({paramsCount:i,brotherPathIndex:t,brotherNode:this.parametricChildren[e]});return n}_compilePrefixMatch(){if(1===this.prefix.length)return void(this.matchPrefix=()=>!0);let e=[];for(let t=1;t<this.prefix.length;t++){let r=this.prefix.charCodeAt(t);e.push(`path.charCodeAt(i + ${t}) === ${r}`)}this.matchPrefix=new Function("path","i",`return ${e.join(" && ")}`)}},o=class extends s{constructor(e,t,r){super(),this.isRegex=!!e,this.regex=e||null,this.staticSuffix=t||null,this.kind=i.PARAMETRIC,this.nodePaths=new Set([r])}getNextNode(e,t){return this.findStaticMatchingChild(e,t)}},l=class extends n{constructor(){super(),this.kind=i.WILDCARD}getNextNode(){return null}};t.exports={StaticNode:a,ParametricNode:o,WildcardNode:l,NODE_TYPES:i}}),tn=u((e,t)=>{var r=c("node:assert");function i(){if(!(this instanceof i))return new i;this.store={},this.maxMajor=0,this.maxMinors={},this.maxPatches={}}i.prototype.set=function(e,t){if("string"!=typeof e)throw new TypeError("Version should be a string");let[r,i,n]=e.split(".");if(isNaN(r))throw new TypeError("Major version must be a numeric value");return r=Number(r),i=Number(i)||0,n=Number(n)||0,r>=this.maxMajor&&(this.maxMajor=r,this.store.x=t,this.store["*"]=t,this.store["x.x"]=t,this.store["x.x.x"]=t),i>=(this.maxMinors[r]||0)&&(this.maxMinors[r]=i,this.store[`${r}.x`]=t,this.store[`${r}.x.x`]=t),n>=(this.maxPatches[`${r}.${i}`]||0)&&(this.maxPatches[`${r}.${i}`]=n,this.store[`${r}.${i}.x`]=t),this.store[`${r}.${i}.${n}`]=t,this},i.prototype.get=function(e){return this.store[e]},t.exports={name:"version",mustMatchWhenDerived:!0,storage:i,validate(e){r("string"==typeof e,"Version should be a string")}}}),rn=u((e,t)=>{var r=c("node:assert");t.exports={name:"host",mustMatchWhenDerived:!1,storage:function(){let e={},t=[];return{get:r=>{let i=e[r];if(i)return i;for(let e of t)if(e.host.test(r))return e.value},set:(r,i)=>{r instanceof RegExp?t.push({host:r,value:i}):e[r]=i}}},validate(e){r("string"==typeof e||"[object RegExp]"===Object.prototype.toString.call(e),"Host should be a string or a RegExp")}}}),nn=u((e,t)=>{var r=tn(),i=rn(),n=c("node:assert");t.exports=class{constructor(e){if(this.strategies={version:r,host:i},this.strategiesInUse=new Set,this.asyncStrategiesInUse=new Set,e)for(let t of Object.values(e))this.addConstraintStrategy(t)}isStrategyUsed(e){return this.strategiesInUse.has(e)||this.asyncStrategiesInUse.has(e)}hasConstraintStrategy(e){let t=this.strategies[e];return void 0!==t&&(t.isCustom||this.isStrategyUsed(e))}addConstraintStrategy(e){if(n("string"==typeof e.name&&""!==e.name,"strategy.name is required."),n(e.storage&&"function"==typeof e.storage,"strategy.storage function is required."),n(e.deriveConstraint&&"function"==typeof e.deriveConstraint,"strategy.deriveConstraint function is required."),this.strategies[e.name]&&this.strategies[e.name].isCustom)throw new Error(`There already exists a custom constraint with the name ${e.name}.`);if(this.isStrategyUsed(e.name))throw new Error(`There already exists a route with ${e.name} constraint.`);e.isCustom=!0,e.isAsync=3===e.deriveConstraint.length,this.strategies[e.name]=e,e.mustMatchWhenDerived&&this.noteUsage({[e.name]:e})}deriveConstraints(e,t,r){let i=this.deriveSyncConstraints(e,t);if(void 0===r)return i;this.deriveAsyncConstraints(i,e,t,r)}deriveSyncConstraints(e,t){}noteUsage(e){if(e){let t=this.strategiesInUse.size;for(let t in e)this.strategies[t].isAsync?this.asyncStrategiesInUse.add(t):this.strategiesInUse.add(t);t!==this.strategiesInUse.size&&this._buildDeriveConstraints()}}newStoreForConstraint(e){if(!this.strategies[e])throw new Error(`No strategy registered for constraint key ${e}`);return this.strategies[e].storage()}validateConstraints(e){for(let t in e){let r=e[t];if(typeof r>"u")throw new Error("Can't pass an undefined constraint value, must pass null or no key at all");let i=this.strategies[t];if(!i)throw new Error(`No strategy registered for constraint key ${t}`);i.validate&&i.validate(r)}}deriveAsyncConstraints(e,t,r,i){let n=this.asyncStrategiesInUse.size;if(0!==n){e=e||{};for(let s of this.asyncStrategiesInUse)this.strategies[s].deriveConstraint(t,r,(t,r)=>{null===t?(e[s]=r,0===--n&&i(null,e)):i(t)})}else i(null,e)}_buildDeriveConstraints(){if(0===this.strategiesInUse.size)return;let e=["return {"];for(let t of this.strategiesInUse){let r=this.strategies[t];e.push(r.isCustom?`  ${r.name}: this.strategies.${t}.deriveConstraint(req, ctx),`:"version"===t?"   version: req.headers['accept-version'],":"   host: req.headers.host || req.headers[':authority'],")}e.push("}"),this.deriveSyncConstraints=new Function("req","ctx",e.join("\n")).bind(this)}}}),sn=u((e,t)=>{t.exports=["ACL","BIND","CHECKOUT","CONNECT","COPY","DELETE","GET","HEAD","LINK","LOCK","M-SEARCH","MERGE","MKACTIVITY","MKCALENDAR","MKCOL","MOVE","NOTIFY","OPTIONS","PATCH","POST","PROPFIND","PROPPATCH","PURGE","PUT","REBIND","REPORT","SEARCH","SOURCE","SUBSCRIBE","TRACE","UNBIND","UNLINK","UNLOCK","UNSUBSCRIBE"]}),an=u((e,t)=>{function r(e,t){return 50===e?53===t?"%":51===t?"#":52===t?"$":54===t?"&":66===t||98===t?"+":67===t||99===t?",":70===t||102===t?"/":null:51===e?65===t||97===t?":":66===t||98===t?";":68===t||100===t?"=":70===t||102===t?"?":null:52===e&&48===t?"@":null}t.exports={safeDecodeURI:function(e,t){let i=!1,n=!1,s="";for(let a=1;a<e.length;a++){let o=e.charCodeAt(a);if(37===o){let t=e.charCodeAt(a+1),s=e.charCodeAt(a+2);null===r(t,s)?i=!0:(n=!0,50===t&&53===s&&(i=!0,e=e.slice(0,a+1)+"25"+e.slice(a+1),a+=2),a+=2)}else if(63===o||35===o||59===o&&t){s=e.slice(a+1),e=e.slice(0,a);break}}return{path:i?decodeURI(e):e,querystring:s,shouldDecodeParam:n}},safeDecodeURIComponent:function(e){let t=e.indexOf("%");if(-1===t)return e;let i="",n=t;for(let s=t;s<e.length;s++)if(37===e.charCodeAt(s)){let t=r(e.charCodeAt(s+1),e.charCodeAt(s+2));i+=e.slice(n,s)+t,n=s+3}return e.slice(0,t)+i+e.slice(n)}}}),on=u((e,t)=>{var r=c("node:assert"),i=Fi(),n=Zi(),s=St(),{prettyPrintTree:a}=Xi(),{StaticNode:o,NODE_TYPES:l}=en(),u=nn(),d=sn(),p=Yi(),{safeDecodeURI:h,safeDecodeURIComponent:f}=an(),m=/^https?:\/\/.*?\//,g=/(\/:[^/()]*?)\?(\/?)/;if(!n(m))throw new Error("the FULL_PATH_REGEXP is not safe, update this module");if(!n(g))throw new Error("the OPTIONAL_PARAM_REGEXP is not safe, update this module");function y(e){if(!(this instanceof y))return new y(e);this._opts=e=e||{},e.defaultRoute?(r("function"==typeof e.defaultRoute,"The default route must be a function"),this.defaultRoute=e.defaultRoute):this.defaultRoute=null,e.onBadUrl?(r("function"==typeof e.onBadUrl,"The bad url handler must be a function"),this.onBadUrl=e.onBadUrl):this.onBadUrl=null,e.buildPrettyMeta?(r("function"==typeof e.buildPrettyMeta,"buildPrettyMeta must be a function"),this.buildPrettyMeta=e.buildPrettyMeta):this.buildPrettyMeta=E,e.querystringParser?(r("function"==typeof e.querystringParser,"querystringParser must be a function"),this.querystringParser=e.querystringParser):this.querystringParser=e=>""===e?{}:i.parse(e),this.caseSensitive=void 0===e.caseSensitive||e.caseSensitive,this.ignoreTrailingSlash=e.ignoreTrailingSlash||!1,this.ignoreDuplicateSlashes=e.ignoreDuplicateSlashes||!1,this.maxParamLength=e.maxParamLength||100,this.allowUnsafeRegex=e.allowUnsafeRegex||!1,this.constrainer=new u(e.constraints),this.useSemicolonDelimiter=e.useSemicolonDelimiter||!1,this.routes=[],this.trees={}}y.prototype.on=function(e,t,i,n,s){"function"==typeof i&&(void 0!==n&&(s=n),n=i,i={}),r("string"==typeof t,"Path should be a string"),r(t.length>0,"The path could not be empty"),r("/"===t[0]||"*"===t[0],"The first character of a path should be `/` or `*`"),r("function"==typeof n,"Handler should be a function");let a=t.match(g);if(a){r(t.length===a.index+a[0].length,"Optional Parameter needs to be the last parameter of the path");let o=t.replace(g,"$1$2"),l=t.replace(g,"$2")||"/";return this.on(e,o,i,n,s),void this.on(e,l,i,n,s)}let o=t;this.ignoreDuplicateSlashes&&(t=b(t)),this.ignoreTrailingSlash&&(t=w(t));let l=Array.isArray(e)?e:[e];for(let e of l)r("string"==typeof e,"Method should be a string"),r(d.includes(e),`Method '${e}' is not an http method.`),this._on(e,t,i,n,s,o)},y.prototype._on=function(e,t,i,a,l){let c={};void 0!==i.constraints&&(r("object"==typeof i.constraints&&null!==i.constraints,"Constraints should be an object"),0!==Object.keys(i.constraints).length&&(c=i.constraints)),this.constrainer.validateConstraints(c),this.constrainer.noteUsage(c),void 0===this.trees[e]&&(this.trees[e]=new o("/"));let u=t;if("*"===u&&0!==this.trees[e].prefix.length){let t=this.trees[e];this.trees[e]=new o(""),this.trees[e].staticChildren["/"]=t}let d=this.trees[e],p=d.prefix.length,h=[];for(let e=0;e<=u.length;e++){if(58===u.charCodeAt(e)&&58===u.charCodeAt(e+1)){e++;continue}let t=58===u.charCodeAt(e)&&58!==u.charCodeAt(e+1),i=42===u.charCodeAt(e);if(t||i||e===u.length&&e!==p){let t=u.slice(p,e);this.caseSensitive||(t=t.toLowerCase()),t=t.split("::").join(":"),t=t.split("%").join("%25"),d=d.createStaticChild(t)}if(t){let t=!1,i=!0,s="",a=[],o=e+1;for(let l=o;;l++){let c=u.charCodeAt(l),f=40===c,m=45===c||46===c,g=47===c||l===u.length;if(f||m||g){let c=u.slice(o,l);if(h.push(c),t=t||f||m,f){let e=S(u,l),t=u.slice(l,e+1);this.allowUnsafeRegex||r(n(new RegExp(t)),`The regex '${t}' is not safe!`),a.push(_(t)),l=e+1,i=!0}else a.push(i?"(.*?)":`(${s}|(?:(?!${s}).)*)`),i=!1;let y=l;for(;l<u.length;l++){let e=u.charCodeAt(l);if(47===e)break;if(58===e){if(58!==u.charCodeAt(l+1))break;l++}}let b=u.slice(y,l);if(b&&(b=b.split("::").join(":"),b=b.split("%").join("%25"),a.push(s=v(b))),o=l+1,g||47===u.charCodeAt(l)||l===u.length){let r=t?"()"+b:b,i=u.slice(e,l);u=u.slice(0,e+1)+r+u.slice(l),e+=r.length;let n=t?new RegExp("^"+a.join("")+"$"):null;d=d.createParametricChild(n,b||null,i),p=e+1;break}}}}else if(i&&(h.push("*"),d=d.createWildcardChild(),p=e+1,e!==u.length-1))throw new Error("Wildcard must be the last character in the route")}this.caseSensitive||(u=u.toLowerCase()),"*"===u&&(u="/*");for(let t of this.routes)if(t.method===e&&t.pattern===u&&s(t.opts.constraints||{},c))throw new Error(`Method '${e}' already declared for route '${u}' with constraints '${JSON.stringify(c)}'`);let f={method:e,path:t,pattern:u,params:h,opts:i,handler:a,store:l};this.routes.push(f),d.addRoute(f,this.constrainer)},y.prototype.hasRoute=function(e,t,r){return null!==this.findRoute(e,t,r)},y.prototype.findRoute=function(e,t,i={}){if(void 0===this.trees[e])return null;let a=t,o=this.trees[e],l=o.prefix.length,c=[];for(let e=0;e<=a.length;e++){if(58===a.charCodeAt(e)&&58===a.charCodeAt(e+1)){e++;continue}let t=58===a.charCodeAt(e)&&58!==a.charCodeAt(e+1),i=42===a.charCodeAt(e);if(t||i||e===a.length&&e!==l){let t=a.slice(l,e);if(this.caseSensitive||(t=t.toLowerCase()),t=t.split("::").join(":"),t=t.split("%").join("%25"),o=o.getStaticChild(t),null===o)return null}if(t){let t=!1,i=!0,s="",u=[],d=e+1;for(let p=d;;p++){let h=a.charCodeAt(p),f=40===h,m=45===h||46===h,g=47===h||p===a.length;if(f||m||g){let h=a.slice(d,p);if(c.push(h),t=t||f||m,f){let e=S(a,p),t=a.slice(p,e+1);this.allowUnsafeRegex||r(n(new RegExp(t)),`The regex '${t}' is not safe!`),u.push(_(t)),p=e+1,i=!1}else u.push(i?"(.*?)":`(${s}|(?:(?!${s}).)*)`),i=!1;let y=p;for(;p<a.length;p++){let e=a.charCodeAt(p);if(47===e)break;if(58===e){if(58!==a.charCodeAt(p+1))break;p++}}let b=a.slice(y,p);if(b&&(b=b.split("::").join(":"),b=b.split("%").join("%25"),u.push(s=v(b))),d=p+1,g||47===a.charCodeAt(p)||p===a.length){let r=t?"()"+b:b,i=a.slice(e,p);a=a.slice(0,e+1)+r+a.slice(p),e+=r.length;let n=t?new RegExp("^"+u.join("")+"$"):null;if(o=o.getParametricChild(n,b||null,i),null===o)return null;l=e+1;break}}}}else if(i&&(c.push("*"),o=o.getWildcardChild(),l=e+1,e!==a.length-1))throw new Error("Wildcard must be the last character in the route")}this.caseSensitive||(a=a.toLowerCase());for(let t of this.routes)if(t.method===e&&t.pattern===a&&s(t.opts.constraints||{},i))return{handler:t.handler,store:t.store,params:t.params};return null},y.prototype.hasConstraintStrategy=function(e){return this.constrainer.hasConstraintStrategy(e)},y.prototype.addConstraintStrategy=function(e){this.constrainer.addConstraintStrategy(e),this._rebuild(this.routes)},y.prototype.reset=function(){this.trees={},this.routes=[]},y.prototype.off=function(e,t,i){r("string"==typeof t,"Path should be a string"),r(t.length>0,"The path could not be empty"),r("/"===t[0]||"*"===t[0],"The first character of a path should be `/` or `*`"),r(typeof i>"u"||"object"==typeof i&&!Array.isArray(i)&&null!==i,"Constraints should be an object or undefined.");let n=t.match(g);if(n){r(t.length===n.index+n[0].length,"Optional Parameter needs to be the last parameter of the path");let s=t.replace(g,"$1$2"),a=t.replace(g,"$2");return this.off(e,s,i),void this.off(e,a,i)}this.ignoreDuplicateSlashes&&(t=b(t)),this.ignoreTrailingSlash&&(t=w(t));let s=Array.isArray(e)?e:[e];for(let e of s)this._off(e,t,i)},y.prototype._off=function(e,t,i){function n(r){return e!==r.method||t!==r.path}r("string"==typeof e,"Method should be a string"),r(d.includes(e),`Method '${e}' is not an http method.`);let a=this.routes.filter(i?function(e){return n(e)||!s(i,e.opts.constraints||{})}:n);this._rebuild(a)},y.prototype.lookup=function(e,t,r,i){if("function"==typeof r&&(i=r,r=void 0),void 0===i){let i=this.constrainer.deriveConstraints(e,r),n=this.find(e.method,e.url,i);return this.callHandler(n,e,t,r)}this.constrainer.deriveConstraints(e,r,(n,s)=>{if(null===n)try{let n=this.find(e.method,e.url,s),a=this.callHandler(n,e,t,r);i(null,a)}catch(e){i(e)}else i(n)})},y.prototype.callHandler=function(e,t,r,i){return null===e?this._defaultRoute(t,r,i):void 0===i?e.handler(t,r,e.params,e.store,e.searchParams):e.handler.call(i,t,r,e.params,e.store,e.searchParams)},y.prototype.find=function(e,t,r){let i,n,s,a=this.trees[e];if(void 0===a)return null;47!==t.charCodeAt(0)&&(t=t.replace(m,"/")),this.ignoreDuplicateSlashes&&(t=b(t));try{i=h(t,this.useSemicolonDelimiter),t=i.path,n=i.querystring,s=i.shouldDecodeParam}catch{return this._onBadUrl(t)}this.ignoreTrailingSlash&&(t=w(t));let o=t;!1===this.caseSensitive&&(t=t.toLowerCase());let c=this.maxParamLength,u=a.prefix.length,d=[],p=t.length,g=[];for(;;){if(u===p&&a.isLeafNode){let e=a.handlerStorage.getMatchingHandler(r);if(null!==e)return{handler:e.handler,store:e.store,params:e._createParamsObject(d),searchParams:this.querystringParser(n)}}let e=a.getNextNode(t,u,g,d.length);if(null===e){if(0===g.length)return null;let t=g.pop();u=t.brotherPathIndex,d.splice(t.paramsCount),e=t.brotherNode}if(a=e,a.kind===l.STATIC){u+=a.prefix.length;continue}if(a.kind===l.WILDCARD){let e=o.slice(u);s&&(e=f(e)),d.push(e),u=p;continue}let i=o.indexOf("/",u);-1===i&&(i=p);let h=o.slice(u,i);if(s&&(h=f(h)),a.isRegex){let e=a.regex.exec(h);if(null===e)continue;for(let t=1;t<e.length;t++){let r=e[t];if(r.length>c)return null;d.push(r)}}else{if(h.length>c)return null;d.push(h)}u=i}},y.prototype._rebuild=function(e){this.reset();for(let t of e){let{method:e,path:r,opts:i,handler:n,store:s}=t;this._on(e,r,i,n,s)}},y.prototype._defaultRoute=function(e,t,r){if(null!==this.defaultRoute)return void 0===r?this.defaultRoute(e,t):this.defaultRoute.call(r,e,t);t.statusCode=404,t.end()},y.prototype._onBadUrl=function(e){if(null===this.onBadUrl)return null;let t=this.onBadUrl;return{handler:(r,i,n)=>t(e,r,i),params:{},store:null}},y.prototype.prettyPrint=function(e={}){let t=e.method;e.buildPrettyMeta=this.buildPrettyMeta.bind(this);let r=null;if(void 0===t){let{version:e,host:t,...i}=this.constrainer.strategies;i[p.name]=p;let n=new y({...this._opts,constraints:i}),s=this.routes.map(e=>{let t={...e.opts.constraints,[p.name]:e.method};return{...e,method:"MERGED",opts:{constraints:t}}});n._rebuild(s),r=n.trees.MERGED}else r=this.trees[t];return null==r?"(empty tree)":a(r,e)};for(let e in d){if(!d.hasOwnProperty(e))continue;let t=d[e],r=t.toLowerCase();y.prototype[r]=function(e,r,i){return this.on(t,e,r,i)}}function v(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function b(e){return e.replace(/\/\/+/g,"/")}function w(e){return e.length>1&&47===e.charCodeAt(e.length-1)?e.slice(0,-1):e}function _(e){return 94===e.charCodeAt(1)&&(e=e.slice(0,1)+e.slice(2)),36===e.charCodeAt(e.length-2)&&(e=e.slice(0,e.length-2)+e.slice(e.length-1)),e}function S(e,t){let r=1;for(;t<e.length;)if("\\"!==e[++t]){if(")"===e[t]?r--:"("===e[t]&&r++,!r)return t}else t++;throw new TypeError('Invalid regexp expression in "'+e+'"')}function E(e){return e&&e.store?Object.assign({},e.store):{}}y.prototype.all=function(e,t,r){this.on(d,e,t,r)},t.exports=y}),ln=u((e,t)=>{function r(e,t,r,i){if(void 0===r)return t.header("content-length","0"),i(null,null);if("function"==typeof r.resume)return r.on("error",e=>{t.log.error({err:e},"Error on Stream found for HEAD route")}),r.resume(),i(null,null);let n=""+Buffer.byteLength(r);t.header("content-length",n),i(null,null)}t.exports={parseHeadOnSendHandlers:function(e){return null==e?r:Array.isArray(e)?[...e,r]:[e,r]}}}),cn=u((e,t)=>{var r=on(),i=mt(),n=L(),{onRequestAbortHookRunner:s,lifecycleHooks:a,preParsingHookRunner:o,onTimeoutHookRunner:l,onRequestHookRunner:c}=A(),{supportedMethods:u}=gt(),{normalizeSchema:d}=me(),{parseHeadOnSendHandlers:p}=ln(),{FSTDEP007:h,FSTDEP008:f,FSTDEP014:m}=$(),{compileSchemasForValidation:g,compileSchemasForSerialization:y}=I(),{FST_ERR_SCH_VALIDATION_BUILD:v,FST_ERR_SCH_SERIALIZATION_BUILD:b,FST_ERR_DEFAULT_ROUTE_INVALID_TYPE:w,FST_ERR_DUPLICATED_ROUTE:_,FST_ERR_INVALID_URL:S,FST_ERR_HOOK_INVALID_HANDLER:E,FST_ERR_ROUTE_OPTIONS_NOT_OBJ:k,FST_ERR_ROUTE_DUPLICATED_HANDLER:x,FST_ERR_ROUTE_HANDLER_NOT_FN:T,FST_ERR_ROUTE_MISSING_HANDLER:P,FST_ERR_ROUTE_METHOD_NOT_SUPPORTED:O,FST_ERR_ROUTE_METHOD_INVALID:N,FST_ERR_ROUTE_BODY_VALIDATION_SCHEMA_NOT_SUPPORTED:j,FST_ERR_ROUTE_BODY_LIMIT_OPTION_NOT_INT:D,FST_ERR_HOOK_INVALID_ASYNC_HANDLER:F}=C(),{kRoutePrefix:M,kLogLevel:z,kLogSerializers:q,kHooks:U,kSchemaController:B,kOptions:H,kReplySerializerDefault:V,kReplyIsError:G,kRequestPayloadStream:W,kDisableRequestLogging:K,kSchemaErrorFormatter:J,kErrorHandler:Z,kHasBeenDecorated:Y,kRequestAcceptVersion:X,kRouteByFastify:Q,kRouteContext:ee}=R(),{buildErrorHandler:te}=ve(),{createChildLogger:re}=he(),{getGenReqId:ie}=Ni();function ne(e,t){t&&e.log.error({err:t},"onRequestAborted hook failed")}function se(){let{context:e,request:t,reply:r}=this._meta;l(e.onTimeout,t,r,de)}function ae(e){if("string"!=typeof e)throw new N;if(e=e.toUpperCase(),-1===u.indexOf(e))throw new O(e);return e}function oe(e,t,r){if(("GET"===e||"HEAD"===e)&&r&&r.body)throw new j(e,t)}function le(e){if(void 0!==e&&(!Number.isInteger(e)||e<=0))throw new D(e)}function ce(e,t,r){if(!0!==r.sent){if(null!=e)return r[G]=!0,void r.send(e);t[W]=t.raw,null!==t[ee].preParsing?o(t[ee].preParsing,t,r,n):n(null,t,r)}}function ue(){this.keepAliveConnections.delete(this.socket)}function de(){}t.exports={buildRouting:function(e){let t,n,o,l,u,R,O,$,C,A,N,I,j,L=r(e.config),D=!1;return{setup(e,r){t=r.avvio,n=r.fourOhFour,o=r.logger,l=r.hasLogger,u=r.setupResponseListeners,R=r.throwIfAlreadyStarted,I=r.validateHTTPVersion,N=e.exposeHeadRoutes,O=e.disableRequestLogging,$=e.ignoreTrailingSlash,C=e.ignoreDuplicateSlashes,A=!Object.prototype.hasOwnProperty.call(e,"return503OnClosing")||e.return503OnClosing,j=r.keepAliveConnections},routing:L.lookup.bind(L),route:ee,hasRoute:function({options:e}){let t=e.method?.toUpperCase()??"";return null!==W({...e,method:t})},prepareRoute:G,getDefaultRoute:function(){return m(),L.defaultRoute},setDefaultRoute:function(e){if(m(),"function"!=typeof e)throw new w;L.defaultRoute=e},routeHandler:de,closeRoutes:()=>{D=!0},printRoutes:L.prettyPrint.bind(L),addConstraintStrategy:function(e){return R("Cannot add constraint strategy!"),L.addConstraintStrategy(e)},hasConstraintStrategy:function(e){return L.hasConstraintStrategy(e)},isAsyncConstraint:function(){return L.constrainer.asyncStrategiesInUse.size>0},findRoute:W};function G({method:e,url:t,options:r,handler:i,isFastify:n}){if("string"!=typeof t)throw new S(typeof t);if(i||"function"!=typeof r){if(i&&"function"==typeof i){if("[object Object]"!==Object.prototype.toString.call(r))throw new k(e,t);if(r.handler)throw"function"==typeof r.handler?new x(e,t):new T(e,t)}}else i=r,r={};return r=Object.assign({},r,{method:e,url:t,path:t,handler:i||r&&r.handler}),ee.call(this,{options:r,isFastify:n})}function W(e){let t=L.find(e.method,e.url||"",e.constraints);return t?{handler:t.handler,params:t.params,searchParams:t.searchParams}:null}function ee({options:e,isFastify:r}){let s={...e},{exposeHeadRoute:o}=s,l=null!=o?o:N,c="GET"===s.method||Array.isArray(s.method)&&s.method.includes("GET"),u="HEAD"===s.method||Array.isArray(s.method)&&s.method.includes("HEAD"),m=l&&c?{...e}:null;R("Cannot add route!");let w=s.url||s.path||"";if(Array.isArray(s.method))for(var S=0;S<s.method.length;++S)s.method[S]=ae(s.method[S]),oe(s.method[S],w,s.schema);else s.method=ae(s.method),oe(s.method,w,s.schema);if(!s.handler)throw new P(s.method,w);if(void 0!==s.errorHandler&&"function"!=typeof s.errorHandler)throw new T(s.method,w);le(s.bodyLimit);let k=this[M];if("/"===w&&k.length>0&&"HEAD"!==s.method)switch(s.prefixTrailingSlash){case"slash":x.call(this,{path:w,isFastify:r});break;case"no-slash":x.call(this,{path:"",isFastify:r});break;default:x.call(this,{path:"",isFastify:r}),!0!==$&&(!0!==C||!k.endsWith("/"))&&x.call(this,{path:w,prefixing:!0,isFastify:r})}else"/"===w[0]&&k.endsWith("/")?x.call(this,{path:w.slice(1),isFastify:r}):x.call(this,{path:w,isFastify:r});return this;function x({path:e,prefixing:r=!1,isFastify:w=!1}){let S=k+e;if(s.url=S,s.path=S,s.routePath=e,s.prefix=k,s.logLevel=s.logLevel||this[z],(this[q]||s.logSerializers)&&(s.logSerializers=Object.assign(Object.create(this[q]),s.logSerializers)),null==s.attachValidation&&(s.attachValidation=!1),!1===r)for(let e of this[U].onRoute)e.call(this,s);for(let e of a)if(s&&e in s)if(Array.isArray(s[e]))for(let t of s[e]){if("function"!=typeof t)throw new E(e,Object.prototype.toString.call(t));if("onSend"===e||"preSerialization"===e||"onError"===e||"preParsing"===e){if("AsyncFunction"===t.constructor.name&&4===t.length)throw new F}else if("onRequestAbort"===e){if("AsyncFunction"===t.constructor.name&&1!==t.length)throw new F}else if("AsyncFunction"===t.constructor.name&&3===t.length)throw new F}else if(void 0!==s[e]&&"function"!=typeof s[e])throw new E(e,Object.prototype.toString.call(s[e]));let x=s.constraints||{},T={...s.config,url:S,method:s.method},P=new i({schema:s.schema,handler:s.handler.bind(this),config:T,errorHandler:s.errorHandler,childLoggerFactory:s.childLoggerFactory,bodyLimit:s.bodyLimit,logLevel:s.logLevel,logSerializers:s.logSerializers,attachValidation:s.attachValidation,schemaErrorFormatter:s.schemaErrorFormatter,replySerializer:this[V],validatorCompiler:s.validatorCompiler,serializerCompiler:s.serializerCompiler,exposeHeadRoute:l,prefixTrailingSlash:s.prefixTrailingSlash||"both",server:this,isFastify:w});s.version&&(f(),x.version=s.version);let R=L.findRoute("HEAD",s.url,x),O=null!==R;u&&O&&!P[Q]&&R.store[Q]&&L.off("HEAD",s.url,x);try{L.on(s.method,s.url,{constraints:x},de,P)}catch(e){if(!P[Q])throw e.message.includes(`Method '${s.method}' already declared for route`)?new _(s.method,s.url):e}if(this.after((e,r)=>{P.errorHandler=s.errorHandler?te(this[Z],s.errorHandler):this[Z],P._parserOptions.limit=s.bodyLimit||null,P.logLevel=s.logLevel,P.logSerializers=s.logSerializers,P.attachValidation=s.attachValidation,P[V]=this[V],P.schemaErrorFormatter=s.schemaErrorFormatter||this[J]||P.schemaErrorFormatter,t.once("preReady",()=>{for(let e of a){let t=this[U][e].concat(s[e]||[]).map(e=>e.bind(this));P[e]=t.length?t:null}for(;!P.Request[Y]&&P.Request.parent;)P.Request=P.Request.parent;for(;!P.Reply[Y]&&P.Reply.parent;)P.Reply=P.Reply.parent;if(n.setContext(this,P),s.schema){P.schema=d(s,P.schema,this.initialConfig);let e=this[B];!s.validatorCompiler&&(s.schema.body||s.schema.headers||s.schema.querystring||s.schema.params)&&e.setupValidator(this[H]);try{g(P,s.validatorCompiler||e.validatorCompiler,"function"==typeof s?.validatorCompiler||e.isCustomValidatorCompiler)}catch(e){throw new v(s.method,S,e.message)}s.schema.response&&!s.serializerCompiler&&e.setupSerializer(this[H]);try{y(P,s.serializerCompiler||e.serializerCompiler)}catch(e){throw new b(s.method,S,e.message)}}}),r(e)}),l&&c&&!u&&!O){let t=p(m.onSend);G.call(this,{method:"HEAD",url:e,options:{...m,onSend:t},isFastify:!0})}else O&&o&&h()}}function de(e,t,r,i,n){let a=ie(i.server,e),d={level:i.logLevel};i.logSerializers&&(d.serializers=i.logSerializers);let p=re(i,o,e,a,d);if(p[K]=O,!I(e.httpVersion)){p.info({res:{statusCode:505}},"request aborted - invalid HTTP version");let e='{"error":"HTTP Version Not Supported","message":"HTTP Version Not Supported","statusCode":505}';return t.writeHead(505,{"Content-Type":"application/json","Content-Length":e.length}),void t.end(e)}if(!0===D&&(2!==e.httpVersionMajor&&t.setHeader("Connection","close"),A))return t.writeHead(503,{"Content-Type":"application/json","Content-Length":"80"}),t.end('{"error":"Service Unavailable","message":"Service Unavailable","statusCode":503}'),void p.info({res:{statusCode:503}},"request aborted - refusing to accept new requests as server is closing");"keep-alive"===String.prototype.toLowerCase.call(e.headers.connection||"")&&!1===j.has(e.socket)&&(j.add(e.socket),e.socket.on("close",ue.bind({keepAliveConnections:j,socket:e.socket}))),void 0!==e.headers[X]&&(e.headers["accept-version"]=e.headers[X],e.headers[X]=void 0);let h=new i.Request(a,r,e,n,p,i),f=new i.Reply(t,h,p);!1===O&&p.info({req:h},"incoming request"),(!0===l||null!==i.onResponse)&&u(f),null!==i.onRequest?c(i.onRequest,h,f,ce):ce(null,h,f),null!==i.onRequestAbort&&e.on("close",()=>{e.aborted&&s(i.onRequestAbort,h,ne.bind(null,f))}),null!==i.onTimeout&&(h.raw.socket._meta||h.raw.socket.on("timeout",se),h.raw.socket._meta={context:i,request:h,reply:f})}},validateBodyLimitOption:le}}),un=u((e,t)=>{var r=on(),i=be(),n=ft(),s=mt(),{kRoutePrefix:a,kCanSetNotFoundHandler:o,kFourOhFourLevelInstance:l,kFourOhFourContext:c,kHooks:u,kErrorHandler:d}=R(),{lifecycleHooks:p}=A(),{buildErrorHandler:h}=ve(),{FST_ERR_NOT_FOUND:f}=C(),{createChildLogger:m}=he(),{getGenReqId:g}=Ni();t.exports=function(e){let{logger:t,disableRequestLogging:y}=e,v=r({onBadUrl:function(e,r,s){let a=this[l][c],o=g(a.server,r),u=m(a,t,r,o),d=new n(o,null,r,null,u,a),p=new i(s,d,u);b(d,p)},defaultRoute:function(e,r){let s=this[l][c],a=g(s.server,e),o=m(s,t,e,a);o.info({req:e},"incoming request");let u=new n(a,null,e,null,o,s),d=new i(r,u,o);u.log.warn("the default handler for 404 did not catch this, this is likely a fastify bug, please report it"),u.log.warn(v.prettyPrint()),d.code(404).send(new f)}}),b=null;return{router:v,setNotFoundHandler:function(e,t,r,i){void 0===this[o]&&(this[o]=!0),void 0===this[c]&&(this[c]=null);let n=this,s=this[a]||"/";if(!1===this[o])throw new Error(`Not found handler already set for Fastify instance with prefix: '${s}'`);"object"==typeof e&&(e.preHandler&&(e.preHandler=Array.isArray(e.preHandler)?e.preHandler.map(e=>e.bind(n)):e.preHandler.bind(n)),e.preValidation&&(e.preValidation=Array.isArray(e.preValidation)?e.preValidation.map(e=>e.bind(n)):e.preValidation.bind(n))),"function"==typeof e&&(t=e,e=void 0),e=e||{},t?(this[l][o]=!1,t=t.bind(this),b=t):(t=w,b=w),this.after((n,a)=>{_.call(this,s,e,t,r,i),a(n)})},setContext:function(e,t){let r=Object.assign({},e[c]);r.onSend=t.onSend,t[c]=r},arrange404:function(e){e[l]=e,e[o]=!0,v.onBadUrl=v.onBadUrl.bind(e),v.defaultRoute=v.defaultRoute.bind(e)}};function w(e,t){let{url:r,method:i}=e.raw,n=`Route ${i}:${r} not found`;y||e.log.info(n),t.code(404).send({message:n,error:"Not Found",statusCode:404})}function _(e,t,r,i,n){let a=new s({schema:t.schema,handler:r,config:t.config||{},server:this});i.once("preReady",()=>{let e=this[c];for(let r of p){let i=this[u][r].concat(t[r]||[]).map(e=>e.bind(this));e[r]=i.length?i:null}e.errorHandler=t.errorHandler?h(this[d],t.errorHandler):this[d]}),null===this[c]||"/"!==e?(this[l][c]=a,v.all(e+(e.endsWith("/")?"*":"/*"),n,a),v.all(e,n,a)):Object.assign(this[c],a)}}}),dn=u((e,t)=>{t.exports=s,t.exports.default=s;var r={type:"object",additionalProperties:!1,properties:{connectionTimeout:{type:"integer",default:0},keepAliveTimeout:{type:"integer",default:72e3},forceCloseConnections:{oneOf:[{type:"string",pattern:"idle"},{type:"boolean"}]},maxRequestsPerSocket:{type:"integer",default:0,nullable:!0},requestTimeout:{type:"integer",default:0},bodyLimit:{type:"integer",default:1048576},caseSensitive:{type:"boolean",default:!0},allowUnsafeRegex:{type:"boolean",default:!1},http2:{type:"boolean"},https:{if:{not:{oneOf:[{type:"boolean"},{type:"null"},{type:"object",additionalProperties:!1,required:["allowHTTP1"],properties:{allowHTTP1:{type:"boolean"}}}]}},then:{setDefaultValue:!0}},ignoreTrailingSlash:{type:"boolean",default:!1},ignoreDuplicateSlashes:{type:"boolean",default:!1},disableRequestLogging:{type:"boolean",default:!1},jsonShorthand:{type:"boolean",default:!0},maxParamLength:{type:"integer",default:100},onProtoPoisoning:{type:"string",default:"error"},onConstructorPoisoning:{type:"string",default:"error"},pluginTimeout:{type:"integer",default:1e4},requestIdHeader:{anyOf:[{enum:[!1]},{type:"string"}],default:"request-id"},requestIdLogLabel:{type:"string",default:"reqId"},http2SessionTimeout:{type:"integer",default:72e3},exposeHeadRoutes:{type:"boolean",default:!0},useSemicolonDelimiter:{type:"boolean",default:!0},versioning:{type:"object",additionalProperties:!0,required:["storage","deriveVersion"],properties:{storage:{},deriveVersion:{}}},constraints:{type:"object",additionalProperties:{type:"object",required:["name","storage","validate","deriveConstraint"],additionalProperties:!0,properties:{name:{type:"string"},storage:{},validate:{},deriveConstraint:{}}}}}},i=Object.prototype.hasOwnProperty,n=new RegExp("idle","u");function s(e,{instancePath:t="",rootData:a=e}={}){let o=null,l=0;if(0===l){if(!e||"object"!=typeof e||Array.isArray(e))return s.errors=[{instancePath:t,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;{void 0===e.connectionTimeout&&(e.connectionTimeout=0),void 0===e.keepAliveTimeout&&(e.keepAliveTimeout=72e3),void 0===e.maxRequestsPerSocket&&(e.maxRequestsPerSocket=0),void 0===e.requestTimeout&&(e.requestTimeout=0),void 0===e.bodyLimit&&(e.bodyLimit=1048576),void 0===e.caseSensitive&&(e.caseSensitive=!0),void 0===e.allowUnsafeRegex&&(e.allowUnsafeRegex=!1),void 0===e.ignoreTrailingSlash&&(e.ignoreTrailingSlash=!1),void 0===e.ignoreDuplicateSlashes&&(e.ignoreDuplicateSlashes=!1),void 0===e.disableRequestLogging&&(e.disableRequestLogging=!1),void 0===e.jsonShorthand&&(e.jsonShorthand=!0),void 0===e.maxParamLength&&(e.maxParamLength=100),void 0===e.onProtoPoisoning&&(e.onProtoPoisoning="error"),void 0===e.onConstructorPoisoning&&(e.onConstructorPoisoning="error"),void 0===e.pluginTimeout&&(e.pluginTimeout=1e4),void 0===e.requestIdHeader&&(e.requestIdHeader="request-id"),void 0===e.requestIdLogLabel&&(e.requestIdLogLabel="reqId"),void 0===e.http2SessionTimeout&&(e.http2SessionTimeout=72e3),void 0===e.exposeHeadRoutes&&(e.exposeHeadRoutes=!0),void 0===e.useSemicolonDelimiter&&(e.useSemicolonDelimiter=!0);let a=l;for(let t in e)i.call(r.properties,t)||delete e[t];if(a===l){let i=e.connectionTimeout,a=l;if("number"!=typeof i||i%1||isNaN(i)||!isFinite(i)){let r,n=typeof i;if(void 0===r){if("boolean"!==n&&null!==i&&("string"!==n||!i||i!=+i||i%1))return s.errors=[{instancePath:t+"/connectionTimeout",schemaPath:"#/properties/connectionTimeout/type",keyword:"type",params:{type:"integer"},message:"must be integer"}],!1;r=+i}void 0!==r&&(i=r,void 0!==e&&(e.connectionTimeout=r))}if(u=a===l){let i=e.keepAliveTimeout,a=l;if("number"!=typeof i||i%1||isNaN(i)||!isFinite(i)){let r,n=typeof i;if(void 0===r){if("boolean"!==n&&null!==i&&("string"!==n||!i||i!=+i||i%1))return s.errors=[{instancePath:t+"/keepAliveTimeout",schemaPath:"#/properties/keepAliveTimeout/type",keyword:"type",params:{type:"integer"},message:"must be integer"}],!1;r=+i}void 0!==r&&(i=r,void 0!==e&&(e.keepAliveTimeout=r))}if(u=a===l){if(void 0!==e.forceCloseConnections){let r=e.forceCloseConnections,i=l,a=l,d=!1,p=null,h=l;if("string"!=typeof r){let i,n=typeof r;if(void 0===i)if("number"==n||"boolean"==n)i=""+r;else if(null===r)i="";else{let e={instancePath:t+"/forceCloseConnections",schemaPath:"#/properties/forceCloseConnections/oneOf/0/type",keyword:"type",params:{type:"string"},message:"must be string"};null===o?o=[e]:o.push(e),l++}void 0!==i&&(r=i,void 0!==e&&(e.forceCloseConnections=i))}if(l===h&&"string"==typeof r&&!n.test(r)){let e={instancePath:t+"/forceCloseConnections",schemaPath:"#/properties/forceCloseConnections/oneOf/0/pattern",keyword:"pattern",params:{pattern:"idle"},message:'must match pattern "idle"'};null===o?o=[e]:o.push(e),l++}h===l&&(d=!0,p=0);let f=l;if("boolean"!=typeof r){let i;if(void 0===i)if("false"===r||0===r||null===r)i=!1;else if("true"===r||1===r)i=!0;else{let e={instancePath:t+"/forceCloseConnections",schemaPath:"#/properties/forceCloseConnections/oneOf/1/type",keyword:"type",params:{type:"boolean"},message:"must be boolean"};null===o?o=[e]:o.push(e),l++}void 0!==i&&(r=i,void 0!==e&&(e.forceCloseConnections=i))}var c;if((c=f===l)&&d?(d=!1,p=[p,1]):c&&(d=!0,p=1),!d){let e={instancePath:t+"/forceCloseConnections",schemaPath:"#/properties/forceCloseConnections/oneOf",keyword:"oneOf",params:{passingSchemas:p},message:"must match exactly one schema in oneOf"};return null===o?o=[e]:o.push(e),l++,s.errors=o,!1}l=a,null!==o&&(a?o.length=a:o=null);var u=i===l}else u=!0;if(u){let i=e.maxRequestsPerSocket,n=l;if(("number"!=typeof i||i%1||isNaN(i)||!isFinite(i))&&null!==i){let r,n=typeof i;if(void 0===r)if("boolean"===n||null===i||"string"===n&&i&&i==+i&&!(i%1))r=+i;else{if(""!==i&&0!==i&&!1!==i)return s.errors=[{instancePath:t+"/maxRequestsPerSocket",schemaPath:"#/properties/maxRequestsPerSocket/type",keyword:"type",params:{type:"integer"},message:"must be integer"}],!1;r=null}void 0!==r&&(i=r,void 0!==e&&(e.maxRequestsPerSocket=r))}if(u=n===l){let i=e.requestTimeout,n=l;if("number"!=typeof i||i%1||isNaN(i)||!isFinite(i)){let r,n=typeof i;if(void 0===r){if("boolean"!==n&&null!==i&&("string"!==n||!i||i!=+i||i%1))return s.errors=[{instancePath:t+"/requestTimeout",schemaPath:"#/properties/requestTimeout/type",keyword:"type",params:{type:"integer"},message:"must be integer"}],!1;r=+i}void 0!==r&&(i=r,void 0!==e&&(e.requestTimeout=r))}if(u=n===l){let i=e.bodyLimit,n=l;if("number"!=typeof i||i%1||isNaN(i)||!isFinite(i)){let r,n=typeof i;if(void 0===r){if("boolean"!==n&&null!==i&&("string"!==n||!i||i!=+i||i%1))return s.errors=[{instancePath:t+"/bodyLimit",schemaPath:"#/properties/bodyLimit/type",keyword:"type",params:{type:"integer"},message:"must be integer"}],!1;r=+i}void 0!==r&&(i=r,void 0!==e&&(e.bodyLimit=r))}if(u=n===l){let i=e.caseSensitive,n=l;if("boolean"!=typeof i){let r;if(void 0===r)if("false"===i||0===i||null===i)r=!1;else{if("true"!==i&&1!==i)return s.errors=[{instancePath:t+"/caseSensitive",schemaPath:"#/properties/caseSensitive/type",keyword:"type",params:{type:"boolean"},message:"must be boolean"}],!1;r=!0}void 0!==r&&(i=r,void 0!==e&&(e.caseSensitive=r))}if(u=n===l){let i=e.allowUnsafeRegex,n=l;if("boolean"!=typeof i){let r;if(void 0===r)if("false"===i||0===i||null===i)r=!1;else{if("true"!==i&&1!==i)return s.errors=[{instancePath:t+"/allowUnsafeRegex",schemaPath:"#/properties/allowUnsafeRegex/type",keyword:"type",params:{type:"boolean"},message:"must be boolean"}],!1;r=!0}void 0!==r&&(i=r,void 0!==e&&(e.allowUnsafeRegex=r))}if(u=n===l){if(void 0!==e.http2){let r=e.http2,i=l;if("boolean"!=typeof r){let i;if(void 0===i)if("false"===r||0===r||null===r)i=!1;else{if("true"!==r&&1!==r)return s.errors=[{instancePath:t+"/http2",schemaPath:"#/properties/http2/type",keyword:"type",params:{type:"boolean"},message:"must be boolean"}],!1;i=!0}void 0!==i&&(r=i,void 0!==e&&(e.http2=i))}u=i===l}else u=!0;if(u){if(void 0!==e.https){let r=e.https,i=l,n=l,a=!0,c=l,h=l,f=l,m=l,g=!1,y=null,v=l;if("boolean"!=typeof r){let t;if(void 0===t)if("false"===r||0===r||null===r)t=!1;else if("true"===r||1===r)t=!0;else{let e={};null===o?o=[e]:o.push(e),l++}void 0!==t&&(r=t,void 0!==e&&(e.https=t))}(d=v===l)&&(g=!0,y=0);let b=l;if(null!==r){let t;if(void 0===t)if(""===r||0===r||!1===r)t=null;else{let e={};null===o?o=[e]:o.push(e),l++}void 0!==t&&(r=t,void 0!==e&&(e.https=t))}if((d=b===l)&&g)g=!1,y=[y,1];else{d&&(g=!0,y=1);let e=l;if(l===e)if(r&&"object"==typeof r&&!Array.isArray(r)){let e;if(void 0===r.allowHTTP1&&(e="allowHTTP1")){let e={};null===o?o=[e]:o.push(e),l++}else{let e=l;for(let e in r)"allowHTTP1"!==e&&delete r[e];if(e===l&&void 0!==r.allowHTTP1){let e=r.allowHTTP1;if("boolean"!=typeof e){let t;if(void 0===t)if("false"===e||0===e||null===e)t=!1;else if("true"===e||1===e)t=!0;else{let e={};null===o?o=[e]:o.push(e),l++}void 0!==t&&(e=t,void 0!==r&&(r.allowHTTP1=t))}}}}else{let e={};null===o?o=[e]:o.push(e),l++}var d;(d=e===l)&&g?(g=!1,y=[y,2]):d&&(g=!0,y=2)}if(g)l=m,null!==o&&(m?o.length=m:o=null);else{let e={};null===o?o=[e]:o.push(e),l++}if(f===l){let e={};null===o?o=[e]:o.push(e),l++}else l=h,null!==o&&(h?o.length=h:o=null);var p=c===l;if(l=n,null!==o&&(n?o.length=n:o=null),p){let t=l;e.https=!0,a=p=t===l}if(!a){let e={instancePath:t+"/https",schemaPath:"#/properties/https/if",keyword:"if",params:{failingKeyword:"then"},message:'must match "then" schema'};return null===o?o=[e]:o.push(e),l++,s.errors=o,!1}u=i===l}else u=!0;if(u){let i=e.ignoreTrailingSlash,n=l;if("boolean"!=typeof i){let r;if(void 0===r)if("false"===i||0===i||null===i)r=!1;else{if("true"!==i&&1!==i)return s.errors=[{instancePath:t+"/ignoreTrailingSlash",schemaPath:"#/properties/ignoreTrailingSlash/type",keyword:"type",params:{type:"boolean"},message:"must be boolean"}],!1;r=!0}void 0!==r&&(i=r,void 0!==e&&(e.ignoreTrailingSlash=r))}if(u=n===l){let i=e.ignoreDuplicateSlashes,n=l;if("boolean"!=typeof i){let r;if(void 0===r)if("false"===i||0===i||null===i)r=!1;else{if("true"!==i&&1!==i)return s.errors=[{instancePath:t+"/ignoreDuplicateSlashes",schemaPath:"#/properties/ignoreDuplicateSlashes/type",keyword:"type",params:{type:"boolean"},message:"must be boolean"}],!1;r=!0}void 0!==r&&(i=r,void 0!==e&&(e.ignoreDuplicateSlashes=r))}if(u=n===l){let i=e.disableRequestLogging,n=l;if("boolean"!=typeof i){let r;if(void 0===r)if("false"===i||0===i||null===i)r=!1;else{if("true"!==i&&1!==i)return s.errors=[{instancePath:t+"/disableRequestLogging",schemaPath:"#/properties/disableRequestLogging/type",keyword:"type",params:{type:"boolean"},message:"must be boolean"}],!1;r=!0}void 0!==r&&(i=r,void 0!==e&&(e.disableRequestLogging=r))}if(u=n===l){let i=e.jsonShorthand,n=l;if("boolean"!=typeof i){let r;if(void 0===r)if("false"===i||0===i||null===i)r=!1;else{if("true"!==i&&1!==i)return s.errors=[{instancePath:t+"/jsonShorthand",schemaPath:"#/properties/jsonShorthand/type",keyword:"type",params:{type:"boolean"},message:"must be boolean"}],!1;r=!0}void 0!==r&&(i=r,void 0!==e&&(e.jsonShorthand=r))}if(u=n===l){let i=e.maxParamLength,n=l;if("number"!=typeof i||i%1||isNaN(i)||!isFinite(i)){let r,n=typeof i;if(void 0===r){if("boolean"!==n&&null!==i&&("string"!==n||!i||i!=+i||i%1))return s.errors=[{instancePath:t+"/maxParamLength",schemaPath:"#/properties/maxParamLength/type",keyword:"type",params:{type:"integer"},message:"must be integer"}],!1;r=+i}void 0!==r&&(i=r,void 0!==e&&(e.maxParamLength=r))}if(u=n===l){let i=e.onProtoPoisoning,n=l;if("string"!=typeof i){let r,n=typeof i;if(void 0===r)if("number"==n||"boolean"==n)r=""+i;else{if(null!==i)return s.errors=[{instancePath:t+"/onProtoPoisoning",schemaPath:"#/properties/onProtoPoisoning/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;r=""}void 0!==r&&(i=r,void 0!==e&&(e.onProtoPoisoning=r))}if(u=n===l){let i=e.onConstructorPoisoning,n=l;if("string"!=typeof i){let r,n=typeof i;if(void 0===r)if("number"==n||"boolean"==n)r=""+i;else{if(null!==i)return s.errors=[{instancePath:t+"/onConstructorPoisoning",schemaPath:"#/properties/onConstructorPoisoning/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;r=""}void 0!==r&&(i=r,void 0!==e&&(e.onConstructorPoisoning=r))}if(u=n===l){let i=e.pluginTimeout,n=l;if("number"!=typeof i||i%1||isNaN(i)||!isFinite(i)){let r,n=typeof i;if(void 0===r){if("boolean"!==n&&null!==i&&("string"!==n||!i||i!=+i||i%1))return s.errors=[{instancePath:t+"/pluginTimeout",schemaPath:"#/properties/pluginTimeout/type",keyword:"type",params:{type:"integer"},message:"must be integer"}],!1;r=+i}void 0!==r&&(i=r,void 0!==e&&(e.pluginTimeout=r))}if(u=n===l){let i=e.requestIdHeader,n=l,a=l,c=!1,d=l;if(!1!==i){let e={instancePath:t+"/requestIdHeader",schemaPath:"#/properties/requestIdHeader/anyOf/0/enum",keyword:"enum",params:{allowedValues:r.properties.requestIdHeader.anyOf[0].enum},message:"must be equal to one of the allowed values"};null===o?o=[e]:o.push(e),l++}var h=d===l;if(c=c||h,!c){let r=l;if("string"!=typeof i){let r,n=typeof i;if(void 0===r)if("number"==n||"boolean"==n)r=""+i;else if(null===i)r="";else{let e={instancePath:t+"/requestIdHeader",schemaPath:"#/properties/requestIdHeader/anyOf/1/type",keyword:"type",params:{type:"string"},message:"must be string"};null===o?o=[e]:o.push(e),l++}void 0!==r&&(i=r,void 0!==e&&(e.requestIdHeader=r))}h=r===l,c=c||h}if(!c){let e={instancePath:t+"/requestIdHeader",schemaPath:"#/properties/requestIdHeader/anyOf",keyword:"anyOf",params:{},message:"must match a schema in anyOf"};return null===o?o=[e]:o.push(e),l++,s.errors=o,!1}if(l=a,null!==o&&(a?o.length=a:o=null),u=n===l){let r=e.requestIdLogLabel,i=l;if("string"!=typeof r){let i,n=typeof r;if(void 0===i)if("number"==n||"boolean"==n)i=""+r;else{if(null!==r)return s.errors=[{instancePath:t+"/requestIdLogLabel",schemaPath:"#/properties/requestIdLogLabel/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;i=""}void 0!==i&&(r=i,void 0!==e&&(e.requestIdLogLabel=i))}if(u=i===l){let r=e.http2SessionTimeout,i=l;if("number"!=typeof r||r%1||isNaN(r)||!isFinite(r)){let i,n=typeof r;if(void 0===i){if("boolean"!==n&&null!==r&&("string"!==n||!r||r!=+r||r%1))return s.errors=[{instancePath:t+"/http2SessionTimeout",schemaPath:"#/properties/http2SessionTimeout/type",keyword:"type",params:{type:"integer"},message:"must be integer"}],!1;i=+r}void 0!==i&&(r=i,void 0!==e&&(e.http2SessionTimeout=i))}if(u=i===l){let r=e.exposeHeadRoutes,i=l;if("boolean"!=typeof r){let i;if(void 0===i)if("false"===r||0===r||null===r)i=!1;else{if("true"!==r&&1!==r)return s.errors=[{instancePath:t+"/exposeHeadRoutes",schemaPath:"#/properties/exposeHeadRoutes/type",keyword:"type",params:{type:"boolean"},message:"must be boolean"}],!1;i=!0}void 0!==i&&(r=i,void 0!==e&&(e.exposeHeadRoutes=i))}if(u=i===l){let r=e.useSemicolonDelimiter,i=l;if("boolean"!=typeof r){let i;if(void 0===i)if("false"===r||0===r||null===r)i=!1;else{if("true"!==r&&1!==r)return s.errors=[{instancePath:t+"/useSemicolonDelimiter",schemaPath:"#/properties/useSemicolonDelimiter/type",keyword:"type",params:{type:"boolean"},message:"must be boolean"}],!1;i=!0}void 0!==i&&(r=i,void 0!==e&&(e.useSemicolonDelimiter=i))}if(u=i===l){if(void 0!==e.versioning){let r=e.versioning,i=l;if(l===i){if(!r||"object"!=typeof r||Array.isArray(r))return s.errors=[{instancePath:t+"/versioning",schemaPath:"#/properties/versioning/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;{let e;if(void 0===r.storage&&(e="storage")||void 0===r.deriveVersion&&(e="deriveVersion"))return s.errors=[{instancePath:t+"/versioning",schemaPath:"#/properties/versioning/required",keyword:"required",params:{missingProperty:e},message:"must have required property '"+e+"'"}],!1}}u=i===l}else u=!0;if(u)if(void 0!==e.constraints){let r=e.constraints,i=l;if(l===i){if(!r||"object"!=typeof r||Array.isArray(r))return s.errors=[{instancePath:t+"/constraints",schemaPath:"#/properties/constraints/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;for(let e in r){let i=r[e],n=l;if(l===n){if(!i||"object"!=typeof i||Array.isArray(i))return s.errors=[{instancePath:t+"/constraints/"+e.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/properties/constraints/additionalProperties/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;{let r;if(void 0===i.name&&(r="name")||void 0===i.storage&&(r="storage")||void 0===i.validate&&(r="validate")||void 0===i.deriveConstraint&&(r="deriveConstraint"))return s.errors=[{instancePath:t+"/constraints/"+e.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/properties/constraints/additionalProperties/required",keyword:"required",params:{missingProperty:r},message:"must have required property '"+r+"'"}],!1;if(void 0!==i.name){let r=i.name;if("string"!=typeof r){let n,a=typeof r;if(void 0===n)if("number"==a||"boolean"==a)n=""+r;else{if(null!==r)return s.errors=[{instancePath:t+"/constraints/"+e.replace(/~/g,"~0").replace(/\//g,"~1")+"/name",schemaPath:"#/properties/constraints/additionalProperties/properties/name/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;n=""}void 0!==n&&(r=n,void 0!==i&&(i.name=n))}}}}if(n!==l)break}}u=i===l}else u=!0}}}}}}}}}}}}}}}}}}}}}}}}}}return s.errors=o,0===l}t.exports.defaultInitOptions={connectionTimeout:0,keepAliveTimeout:72e3,maxRequestsPerSocket:0,requestTimeout:0,bodyLimit:1048576,caseSensitive:!0,allowUnsafeRegex:!1,disableRequestLogging:!1,jsonShorthand:!0,ignoreTrailingSlash:!1,ignoreDuplicateSlashes:!1,maxParamLength:100,onProtoPoisoning:"error",onConstructorPoisoning:"error",pluginTimeout:1e4,requestIdHeader:"request-id",requestIdLogLabel:"reqId",http2SessionTimeout:72e3,exposeHeadRoutes:!0,useSemicolonDelimiter:!0}}),pn=u((e,t)=>{var r=dn(),i=fe()({circles:!0,proto:!1}),{FST_ERR_INIT_OPTS_INVALID:n}=C();function s(e){let t=Object.getOwnPropertyNames(e);for(let r of t){let t=e[r];ArrayBuffer.isView(t)&&!(t instanceof DataView)||(e[r]=t&&"object"==typeof t?s(t):t)}return Object.freeze(e)}t.exports=function(e){let t=i(e);if(!r(t)){let e=new n(JSON.stringify(r.errors.map(e=>e.message)));throw e.errors=r.errors,e}return s(t)},t.exports.defaultInitOptions=r.defaultInitOptions,t.exports.utils={deepFreezeObject:s}}),hn=u((e,t)=>{var{kAvvioBoot:r,kChildren:i,kRoutePrefix:n,kLogLevel:s,kLogSerializers:a,kHooks:o,kSchemaController:l,kContentTypeParser:c,kReply:u,kRequest:d,kFourOhFour:p,kPluginNameChain:h}=R(),f=be(),m=ft(),g=Ci(),y=_t(),{buildHooks:v}=A(),b=Ai();t.exports=function(e,t,w){let _=b.registerPlugin.call(e,t),S=b.getPluginName(t)||b.getFuncPreview(t);if(_)return e[h].push(S),e;let E=Object.create(e);e[i].push(E),E.ready=e[r].bind(E),E[i]=[],E[u]=f.buildReply(E[u]),E[d]=m.buildRequest(E[d]),E[c]=y.helpers.buildContentTypeParser(E[c]),E[o]=v(E[o]),E[n]=function(e,t){return t?(e.endsWith("/")&&"/"===t[0]?t=t.slice(1):"/"!==t[0]&&(t="/"+t),e+t):e}(E[n],w.prefix),E[s]=w.logLevel||E[s],E[l]=g.buildSchemaController(e[l]),E.getSchema=E[l].getSchema.bind(E[l]),E.getSchemas=E[l].getSchemas.bind(E[l]),E[b.kRegisteredPlugins]=Object.create(E[b.kRegisteredPlugins]),E[h]=[S],(E[a]||w.logSerializers)&&(E[a]=Object.assign(Object.create(E[a]),w.logSerializers)),w.prefix&&E[p].arrange404(E);for(let e of E[o].onRegister)e.call(this,E,w);return E}}),fn=u((e,t)=>{t.exports=function(){return{[Symbol.iterator]:function*(){},add(){},delete(){},has:()=>!0}}}),mn=u(e=>{e.parse=function(e,t){if("string"!=typeof e)throw new TypeError("argument str must be a string");var i={},n=e.length;if(n<2)return i;var s=t&&t.decode||c,a=0,d=0,p=0;do{if(-1===(d=e.indexOf("=",a)))break;if(-1===(p=e.indexOf(";",a)))p=n;else if(d>p){a=e.lastIndexOf(";",d-1)+1;continue}var h=o(e,a,d),f=l(e,d,h),m=e.slice(h,f);if(!r.call(i,m)){var g=o(e,d+1,p),y=l(e,p,g);34===e.charCodeAt(g)&&34===e.charCodeAt(y-1)&&(g++,y--);var v=e.slice(g,y);i[m]=u(v,s)}a=p+1}while(a<n);return i},e.serialize=function(e,r,o){var l=o&&o.encode||encodeURIComponent;if("function"!=typeof l)throw new TypeError("option encode is invalid");if(!i.test(e))throw new TypeError("argument name is invalid");var c=l(r);if(!n.test(c))throw new TypeError("argument val is invalid");var u=e+"="+c;if(!o)return u;if(null!=o.maxAge){var d=Math.floor(o.maxAge);if(!isFinite(d))throw new TypeError("option maxAge is invalid");u+="; Max-Age="+d}if(o.domain){if(!s.test(o.domain))throw new TypeError("option domain is invalid");u+="; Domain="+o.domain}if(o.path){if(!a.test(o.path))throw new TypeError("option path is invalid");u+="; Path="+o.path}if(o.expires){var p=o.expires;if(!function(e){return"[object Date]"===t.call(e)}(p)||isNaN(p.valueOf()))throw new TypeError("option expires is invalid");u+="; Expires="+p.toUTCString()}if(o.httpOnly&&(u+="; HttpOnly"),o.secure&&(u+="; Secure"),o.partitioned&&(u+="; Partitioned"),o.priority)switch("string"==typeof o.priority?o.priority.toLowerCase():o.priority){case"low":u+="; Priority=Low";break;case"medium":u+="; Priority=Medium";break;case"high":u+="; Priority=High";break;default:throw new TypeError("option priority is invalid")}if(o.sameSite)switch("string"==typeof o.sameSite?o.sameSite.toLowerCase():o.sameSite){case!0:u+="; SameSite=Strict";break;case"lax":u+="; SameSite=Lax";break;case"strict":u+="; SameSite=Strict";break;case"none":u+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}return u};var t=Object.prototype.toString,r=Object.prototype.hasOwnProperty,i=/^[!#$%&'*+\-.^_`|~0-9A-Za-z]+$/,n=/^("?)[\u0021\u0023-\u002B\u002D-\u003A\u003C-\u005B\u005D-\u007E]*\1$/,s=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,a=/^[\u0020-\u003A\u003D-\u007E]*$/;function o(e,t,r){do{var i=e.charCodeAt(t);if(32!==i&&9!==i)return t}while(++t<r);return r}function l(e,t,r){for(;t>r;){var i=e.charCodeAt(--t);if(32!==i&&9!==i)return t+1}return r}function c(e){return-1!==e.indexOf("%")?decodeURIComponent(e):e}function u(e,t){try{return t(e)}catch{return e}}}),gn=u((e,t)=>{var{URL:r}=c("node:url"),i="http://localhost";t.exports=function(e,t){("string"==typeof e||"[object String]"===Object.prototype.toString.call(e))&&e.startsWith("//")&&(e=i+e);let n="object"==typeof e?Object.assign(new r(i),e):new r(e,i);if("string"==typeof t){t=new URLSearchParams(t);for(let e of t.keys()){n.searchParams.delete(e);for(let r of t.getAll(e))n.searchParams.append(e,r)}}else{let r=Object.assign({},e.query,t);for(let e in r){let t=r[e];if(Array.isArray(t)){n.searchParams.delete(e);for(let r of t)n.searchParams.append(e,r)}else n.searchParams.set(e,t)}}return n}}),yn=u((e,t)=>{var r,{randomUUID:i}=c("node:crypto"),{Readable:n}=c("node:stream");t.exports.isFormDataLike=function(e){return e&&"object"==typeof e&&"function"==typeof e.append&&"function"==typeof e.delete&&"function"==typeof e.get&&"function"==typeof e.getAll&&"function"==typeof e.has&&"function"==typeof e.set&&"FormData"===e[Symbol.toStringTag]},t.exports.formDataToStream=function(e){r=r??new TextEncoder;let t=`----formdata-${i()}`,s=`--${t}\r\nContent-Disposition: form-data`,a=e=>e.replace(/\n/g,"%0A").replace(/\r/g,"%0D").replace(/"/g,"%22"),o=e=>e.replace(/\r?\n|\r/g,"\r\n"),l=new Uint8Array([13,10]);return{stream:n.from(async function*(){for(let[t,i]of e)if("string"==typeof i)yield r.encode(`${s}; name="${a(o(t))}"\r\n\r\n`),yield r.encode(`${o(i)}\r\n`);else{let e=`${s}; name="${a(o(t))}"`;i.name&&(e+=`; filename="${a(i.name)}"`),e+=`\r\nContent-Type: ${i.type||"application/octet-stream"}\r\n\r\n`,yield r.encode(e),i.stream?yield*i.stream():yield i,yield l}yield r.encode(`--${t}--`)}()),contentType:`multipart/form-data; boundary=${t}`}}}),vn=u((e,t)=>{var{Readable:r,addAbortSignal:i}=c("node:stream"),n=c("node:util"),s=mn(),a=c("node:assert"),{createDeprecation:o}=O(),l=gn(),{isFormDataLike:u,formDataToStream:d}=yn(),{EventEmitter:p}=c("node:events"),h=o({name:"FastifyDeprecationLightMyRequest",code:"FST_LIGHTMYREQUEST_DEP01",message:'You are accessing "request.connection", use "request.socket" instead.'}),f=class extends p{constructor(e){super(),this.remoteAddress=e}};function m(e){return new function(t){g.call(t,{...e,Request:void 0}),Object.assign(this,t);for(let e of Object.keys(g.prototype))this.constructor.prototype[e]=g.prototype[e];return n.inherits(this.constructor,e.Request),this}(this)}function g(e){r.call(this,{autoDestroy:!1});let t=l(e.url||e.path,e.query);this.url=t.pathname+t.search,this.aborted=!1,this.httpVersionMajor=1,this.httpVersionMinor=1,this.httpVersion="1.1",this.method=e.method?e.method.toUpperCase():"GET",this.headers={},this.rawHeaders=[];let n=e.headers||{};for(let e in n){let t=e.toLowerCase();if(("user-agent"===t||"content-type"===t)&&void 0===n[e]){this.headers[t]=void 0;continue}let r=n[e];a(void 0!==r,'invalid value "undefined" for header '+e),this.headers[t]=""+r}if("user-agent"in this.headers||(this.headers["user-agent"]="lightMyRequest"),this.headers.host=this.headers.host||e.authority||function(e){return e.port?e.host:e.hostname+("https:"===e.protocol?":443":":80")}(t),e.cookies){let{cookies:t}=e,r=Object.keys(t).map(e=>s.serialize(e,t[e]));this.headers.cookie&&r.unshift(this.headers.cookie),this.headers.cookie=r.join("; ")}this.socket=new f(e.remoteAddress||"127.0.0.1"),Object.defineProperty(this,"connection",{get(){return h(),this.socket},configurable:!0});let o=e.payload||e.body||null,c=o&&"function"==typeof o.resume;if(u(o)){let e=d(o);o=e.stream,c=!0,this.headers["content-type"]=e.contentType}o&&"string"!=typeof o&&!c&&!Buffer.isBuffer(o)&&(o=JSON.stringify(o),"content-type"in this.headers||(this.headers["content-type"]="application/json")),o&&!c&&!Object.prototype.hasOwnProperty.call(this.headers,"content-length")&&(this.headers["content-length"]=(Buffer.isBuffer(o)?o.length:Buffer.byteLength(o)).toString());for(let e of Object.keys(this.headers))this.rawHeaders.push(e,this.headers[e]);this._lightMyRequest={payload:o,isDone:!1,simulate:e.simulate||{}};let p=e.signal;return p&&i(p,this),this}n.inherits(g,r),n.inherits(m,g),g.prototype.prepare=function(e){let t=this._lightMyRequest.payload;if(!t||"function"!=typeof t.resume)return e();let r=[];t.on("data",e=>r.push(Buffer.from(e))),t.on("end",()=>{let t=Buffer.concat(r);return this.headers["content-length"]=this.headers["content-length"]||""+t.length,this._lightMyRequest.payload=t,e()}),t.resume()},g.prototype._read=function(e){setImmediate(()=>{this._lightMyRequest.isDone||(this._lightMyRequest.isDone=!0,this._lightMyRequest.payload&&(this._lightMyRequest.simulate.split?(this.push(this._lightMyRequest.payload.slice(0,1)),this.push(this._lightMyRequest.payload.slice(1))):this.push(this._lightMyRequest.payload)),this._lightMyRequest.simulate.error&&this.emit("error",new Error("Simulated")),this._lightMyRequest.simulate.close&&this.emit("close")),!1!==this._lightMyRequest.simulate.end&&this.push(null)})},g.prototype.destroy=function(e){this.destroyed||this._lightMyRequest.isDone||(this.destroyed=!0,e&&(this._error=!0,process.nextTick(()=>this.emit("error",e))),process.nextTick(()=>this.emit("close")))},t.exports=g,t.exports.Request=g,t.exports.CustomRequest=m}),bn=u((e,t)=>{var r={decodeValues:!0,map:!1,silent:!1};function i(e){return"string"!=typeof e||e in{}}function n(){return Object.create(null)}function s(e){return"string"==typeof e&&!!e.trim()}function a(e,t){var a=e.split(";").filter(s),o=function(e){var t="",r="",i=e.split("=");return i.length>1?(t=i.shift(),r=i.join("=")):r=e,{name:t,value:r}}(a.shift()),l=o.name,c=o.value;if(t=t?Object.assign({},r,t):r,i(l))return null;try{c=t.decodeValues?decodeURIComponent(c):c}catch(e){console.error("set-cookie-parser: failed to decode cookie value. Set options.decodeValues=false to disable decoding.",e)}var u=n();return u.name=l,u.value=c,a.forEach(function(e){var t=e.split("="),r=t.shift().trimLeft().toLowerCase();if(!i(r)){var n=t.join("=");if("expires"===r)u.expires=new Date(n);else if("max-age"===r){var s=parseInt(n,10);Number.isNaN(s)||(u.maxAge=s)}else"secure"===r?u.secure=!0:"httponly"===r?u.httpOnly=!0:"samesite"===r?u.sameSite=n:"partitioned"===r?u.partitioned=!0:r&&(u[r]=n)}}),u}function o(e,t){if(t=t?Object.assign({},r,t):r,!e)return t.map?n():[];if(e.headers)if("function"==typeof e.headers.getSetCookie)e=e.headers.getSetCookie();else if(e.headers["set-cookie"])e=e.headers["set-cookie"];else{var o=e.headers[Object.keys(e.headers).find(function(e){return"set-cookie"===e.toLowerCase()})];!o&&e.headers.cookie&&!t.silent&&console.warn("Warning: set-cookie-parser appears to have been called on a request object. It is designed to parse Set-Cookie headers from responses, not Cookie headers from requests. Set the option {silent: true} to suppress this warning."),e=o}if(Array.isArray(e)||(e=[e]),t.map){var l=n();return e.filter(s).reduce(function(e,r){var n=a(r,t);return n&&!i(n.name)&&(e[n.name]=n),e},l)}return e.filter(s).map(function(e){return a(e,t)}).filter(Boolean)}t.exports=o,t.exports.parse=o,t.exports.parseString=a,t.exports.splitCookiesString=function(e){if(Array.isArray(e))return e;if("string"!=typeof e)return[];var t,r,i,n,s,a=[],o=0;function l(){for(;o<e.length&&/\s/.test(e.charAt(o));)o+=1;return o<e.length}function c(){return"="!==(r=e.charAt(o))&&";"!==r&&","!==r}for(;o<e.length;){for(t=o,s=!1;l();)if(","===(r=e.charAt(o))){for(i=o,o+=1,l(),n=o;o<e.length&&c();)o+=1;o<e.length&&"="===e.charAt(o)?(s=!0,o=n,a.push(e.substring(t,i)),t=o):o=i+1}else o+=1;(!s||o>=e.length)&&a.push(e.substring(t,e.length))}return a}}),wn=u((e,t)=>{var r=c("node:http"),{Writable:i,Readable:n}=c("node:stream"),s=c("node:util"),a=bn();function o(e,t,s){r.ServerResponse.call(this,e),this._lightMyRequest={headers:null,trailers:{},payloadChunks:[]},this.setHeader("foo","bar"),this.removeHeader("foo"),this.assignSocket(new i({write(e,t,r){setImmediate(r)}})),this._promiseCallback="function"==typeof s;let o=!1,c=e=>{if(o=!0,this._promiseCallback)return process.nextTick(()=>t(e));process.nextTick(()=>t(null,e))},u=e=>{if(!o){if(o=!0,this._promiseCallback)return process.nextTick(()=>s(e));process.nextTick(()=>t(e,null))}};this.once("finish",()=>{let t=function(e){null===e._lightMyRequest.headers&&l(e),function(e){let t=e._lightMyRequest.headers;for(let e of Object.keys(t)){let r=t[e];t[e]=Array.isArray(r)?r.map(e=>""+e):""+r}}(e);let t={raw:{res:e},headers:e._lightMyRequest.headers,statusCode:e.statusCode,statusMessage:e.statusMessage,trailers:{},get cookies(){return a.parse(this)}},r=Buffer.concat(e._lightMyRequest.payloadChunks);return t.rawPayload=r,t.payload=r.toString(),t.body=t.payload,t.trailers=e._lightMyRequest.trailers,t.json=function(){return JSON.parse(t.payload)},t.stream=function(){return n.from(e._lightMyRequest.payloadChunks)},t}(this);t.raw.req=e,c(t)}),this.connection.once("error",u),this.once("error",u),this.once("close",u)}function l(e){e._lightMyRequest.headers=Object.assign({},e.getHeaders()),["Date","Connection","Transfer-Encoding"].forEach(t=>{let r=new RegExp("\\r\\n"+t+": ([^\\r]*)\\r\\n"),i=e._header.match(r);i&&(e._lightMyRequest.headers[t.toLowerCase()]=i[1])})}s.inherits(o,r.ServerResponse),o.prototype.setTimeout=function(e,t){return this.timeoutHandle=setTimeout(()=>{this.emit("timeout")},e),this.on("timeout",t),this},o.prototype.writeHead=function(){let e=r.ServerResponse.prototype.writeHead.apply(this,arguments);return l(this),e},o.prototype.write=function(e,t,i){return this.timeoutHandle&&clearTimeout(this.timeoutHandle),r.ServerResponse.prototype.write.call(this,e,t,i),this._lightMyRequest.payloadChunks.push(Buffer.from(e,t)),!0},o.prototype.end=function(e,t,i){e&&this.write(e,t),r.ServerResponse.prototype.end.call(this,i),this.emit("finish"),this.destroy()},o.prototype.destroy=function(e){this.destroyed||(this.destroyed=!0,e&&process.nextTick(()=>this.emit("error",e)),process.nextTick(()=>this.emit("close")))},o.prototype.addTrailers=function(e){for(let t in e)this._lightMyRequest.trailers[t.toLowerCase().trim()]=e[t].toString().trim()},t.exports=o}),_n=u((e,t)=>{t.exports=i,t.exports.default=i;var r={type:"object",properties:{url:{oneOf:[{type:"string"},{type:"object",properties:{protocol:{type:"string"},hostname:{type:"string"},pathname:{type:"string"}},additionalProperties:!0,required:["pathname"]}]},path:{oneOf:[{type:"string"},{type:"object",properties:{protocol:{type:"string"},hostname:{type:"string"},pathname:{type:"string"}},additionalProperties:!0,required:["pathname"]}]},cookies:{type:"object",additionalProperties:!0},headers:{type:"object",additionalProperties:!0},query:{anyOf:[{type:"object",additionalProperties:!0},{type:"string"}]},simulate:{type:"object",properties:{end:{type:"boolean"},split:{type:"boolean"},error:{type:"boolean"},close:{type:"boolean"}}},authority:{type:"string"},remoteAddress:{type:"string"},method:{type:"string",enum:["ACL","BIND","CHECKOUT","CONNECT","COPY","DELETE","GET","HEAD","LINK","LOCK","M-SEARCH","MERGE","MKACTIVITY","MKCALENDAR","MKCOL","MOVE","NOTIFY","OPTIONS","PATCH","POST","PROPFIND","PROPPATCH","PURGE","PUT","REBIND","REPORT","SEARCH","SOURCE","SUBSCRIBE","TRACE","UNBIND","UNLINK","UNLOCK","UNSUBSCRIBE","acl","bind","checkout","connect","copy","delete","get","head","link","lock","m-search","merge","mkactivity","mkcalendar","mkcol","move","notify","options","patch","post","propfind","proppatch","purge","put","rebind","report","search","source","subscribe","trace","unbind","unlink","unlock","unsubscribe"]},validate:{type:"boolean"}},additionalProperties:!0,oneOf:[{required:["url"]},{required:["path"]}]};function i(e,{instancePath:t="",rootData:n=e}={}){let s=null,a=0,o=a,l=!1,c=null,u=a;if(e&&"object"==typeof e&&!Array.isArray(e)){let r;if(void 0===e.url&&(r="url")){let e={instancePath:t,schemaPath:"#/oneOf/0/required",keyword:"required",params:{missingProperty:r},message:"must have required property '"+r+"'"};null===s?s=[e]:s.push(e),a++}}u===a&&(l=!0,c=0);let d=a;if(e&&"object"==typeof e&&!Array.isArray(e)){let r;if(void 0===e.path&&(r="path")){let e={instancePath:t,schemaPath:"#/oneOf/1/required",keyword:"required",params:{missingProperty:r},message:"must have required property '"+r+"'"};null===s?s=[e]:s.push(e),a++}}var p;if((p=d===a)&&l?(l=!1,c=[c,1]):p&&(l=!0,c=1),!l){let e={instancePath:t,schemaPath:"#/oneOf",keyword:"oneOf",params:{passingSchemas:c},message:"must match exactly one schema in oneOf"};return null===s?s=[e]:s.push(e),a++,i.errors=s,!1}if(a=o,null!==s&&(o?s.length=o:s=null),0===a){if(!e||"object"!=typeof e||Array.isArray(e))return i.errors=[{instancePath:t,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;if(void 0!==e.url){let r=e.url,n=a,o=a,l=!1,c=null,u=a;if("string"!=typeof r){let i,n=typeof r;if(void 0===i)if("number"==n||"boolean"==n)i=""+r;else if(null===r)i="";else{let e={instancePath:t+"/url",schemaPath:"#/properties/url/oneOf/0/type",keyword:"type",params:{type:"string"},message:"must be string"};null===s?s=[e]:s.push(e),a++}void 0!==i&&(r=i,void 0!==e&&(e.url=i))}u===a&&(l=!0,c=0);let d=a;if(a===d)if(r&&"object"==typeof r&&!Array.isArray(r)){let e;if(void 0===r.pathname&&(e="pathname")){let r={instancePath:t+"/url",schemaPath:"#/properties/url/oneOf/1/required",keyword:"required",params:{missingProperty:e},message:"must have required property '"+e+"'"};null===s?s=[r]:s.push(r),a++}else{if(void 0!==r.protocol){let e=r.protocol,i=a;if("string"!=typeof e){let i,n=typeof e;if(void 0===i)if("number"==n||"boolean"==n)i=""+e;else if(null===e)i="";else{let e={instancePath:t+"/url/protocol",schemaPath:"#/properties/url/oneOf/1/properties/protocol/type",keyword:"type",params:{type:"string"},message:"must be string"};null===s?s=[e]:s.push(e),a++}void 0!==i&&(e=i,void 0!==r&&(r.protocol=i))}var h=i===a}else h=!0;if(h){if(void 0!==r.hostname){let e=r.hostname,i=a;if("string"!=typeof e){let i,n=typeof e;if(void 0===i)if("number"==n||"boolean"==n)i=""+e;else if(null===e)i="";else{let e={instancePath:t+"/url/hostname",schemaPath:"#/properties/url/oneOf/1/properties/hostname/type",keyword:"type",params:{type:"string"},message:"must be string"};null===s?s=[e]:s.push(e),a++}void 0!==i&&(e=i,void 0!==r&&(r.hostname=i))}h=i===a}else h=!0;if(h)if(void 0!==r.pathname){let e=r.pathname,i=a;if("string"!=typeof e){let i,n=typeof e;if(void 0===i)if("number"==n||"boolean"==n)i=""+e;else if(null===e)i="";else{let e={instancePath:t+"/url/pathname",schemaPath:"#/properties/url/oneOf/1/properties/pathname/type",keyword:"type",params:{type:"string"},message:"must be string"};null===s?s=[e]:s.push(e),a++}void 0!==i&&(e=i,void 0!==r&&(r.pathname=i))}h=i===a}else h=!0}}}else{let e={instancePath:t+"/url",schemaPath:"#/properties/url/oneOf/1/type",keyword:"type",params:{type:"object"},message:"must be object"};null===s?s=[e]:s.push(e),a++}var f;if((f=d===a)&&l?(l=!1,c=[c,1]):f&&(l=!0,c=1),!l){let e={instancePath:t+"/url",schemaPath:"#/properties/url/oneOf",keyword:"oneOf",params:{passingSchemas:c},message:"must match exactly one schema in oneOf"};return null===s?s=[e]:s.push(e),a++,i.errors=s,!1}a=o,null!==s&&(o?s.length=o:s=null);var m=n===a}else m=!0;if(m){if(void 0!==e.path){let r=e.path,n=a,o=a,l=!1,c=null,u=a;if("string"!=typeof r){let i,n=typeof r;if(void 0===i)if("number"==n||"boolean"==n)i=""+r;else if(null===r)i="";else{let e={instancePath:t+"/path",schemaPath:"#/properties/path/oneOf/0/type",keyword:"type",params:{type:"string"},message:"must be string"};null===s?s=[e]:s.push(e),a++}void 0!==i&&(r=i,void 0!==e&&(e.path=i))}u===a&&(l=!0,c=0);let d=a;if(a===d)if(r&&"object"==typeof r&&!Array.isArray(r)){let e;if(void 0===r.pathname&&(e="pathname")){let r={instancePath:t+"/path",schemaPath:"#/properties/path/oneOf/1/required",keyword:"required",params:{missingProperty:e},message:"must have required property '"+e+"'"};null===s?s=[r]:s.push(r),a++}else{if(void 0!==r.protocol){let e=r.protocol,i=a;if("string"!=typeof e){let i,n=typeof e;if(void 0===i)if("number"==n||"boolean"==n)i=""+e;else if(null===e)i="";else{let e={instancePath:t+"/path/protocol",schemaPath:"#/properties/path/oneOf/1/properties/protocol/type",keyword:"type",params:{type:"string"},message:"must be string"};null===s?s=[e]:s.push(e),a++}void 0!==i&&(e=i,void 0!==r&&(r.protocol=i))}var g=i===a}else g=!0;if(g){if(void 0!==r.hostname){let e=r.hostname,i=a;if("string"!=typeof e){let i,n=typeof e;if(void 0===i)if("number"==n||"boolean"==n)i=""+e;else if(null===e)i="";else{let e={instancePath:t+"/path/hostname",schemaPath:"#/properties/path/oneOf/1/properties/hostname/type",keyword:"type",params:{type:"string"},message:"must be string"};null===s?s=[e]:s.push(e),a++}void 0!==i&&(e=i,void 0!==r&&(r.hostname=i))}g=i===a}else g=!0;if(g)if(void 0!==r.pathname){let e=r.pathname,i=a;if("string"!=typeof e){let i,n=typeof e;if(void 0===i)if("number"==n||"boolean"==n)i=""+e;else if(null===e)i="";else{let e={instancePath:t+"/path/pathname",schemaPath:"#/properties/path/oneOf/1/properties/pathname/type",keyword:"type",params:{type:"string"},message:"must be string"};null===s?s=[e]:s.push(e),a++}void 0!==i&&(e=i,void 0!==r&&(r.pathname=i))}g=i===a}else g=!0}}}else{let e={instancePath:t+"/path",schemaPath:"#/properties/path/oneOf/1/type",keyword:"type",params:{type:"object"},message:"must be object"};null===s?s=[e]:s.push(e),a++}var y;if((y=d===a)&&l?(l=!1,c=[c,1]):y&&(l=!0,c=1),!l){let e={instancePath:t+"/path",schemaPath:"#/properties/path/oneOf",keyword:"oneOf",params:{passingSchemas:c},message:"must match exactly one schema in oneOf"};return null===s?s=[e]:s.push(e),a++,i.errors=s,!1}a=o,null!==s&&(o?s.length=o:s=null),m=n===a}else m=!0;if(m){if(void 0!==e.cookies){let r=e.cookies,n=a;if(a===n&&(!r||"object"!=typeof r||Array.isArray(r)))return i.errors=[{instancePath:t+"/cookies",schemaPath:"#/properties/cookies/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;m=n===a}else m=!0;if(m){if(void 0!==e.headers){let r=e.headers,n=a;if(a===n&&(!r||"object"!=typeof r||Array.isArray(r)))return i.errors=[{instancePath:t+"/headers",schemaPath:"#/properties/headers/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;m=n===a}else m=!0;if(m){if(void 0!==e.query){let r=e.query,n=a,o=a,l=!1,c=a;if(a===c&&(!r||"object"!=typeof r||Array.isArray(r))){let e={instancePath:t+"/query",schemaPath:"#/properties/query/anyOf/0/type",keyword:"type",params:{type:"object"},message:"must be object"};null===s?s=[e]:s.push(e),a++}var v=c===a;if(l=l||v,!l){let i=a;if("string"!=typeof r){let i,n=typeof r;if(void 0===i)if("number"==n||"boolean"==n)i=""+r;else if(null===r)i="";else{let e={instancePath:t+"/query",schemaPath:"#/properties/query/anyOf/1/type",keyword:"type",params:{type:"string"},message:"must be string"};null===s?s=[e]:s.push(e),a++}void 0!==i&&(r=i,void 0!==e&&(e.query=i))}v=i===a,l=l||v}if(!l){let e={instancePath:t+"/query",schemaPath:"#/properties/query/anyOf",keyword:"anyOf",params:{},message:"must match a schema in anyOf"};return null===s?s=[e]:s.push(e),a++,i.errors=s,!1}a=o,null!==s&&(o?s.length=o:s=null),m=n===a}else m=!0;if(m){if(void 0!==e.simulate){let r=e.simulate,n=a;if(a===n){if(!r||"object"!=typeof r||Array.isArray(r))return i.errors=[{instancePath:t+"/simulate",schemaPath:"#/properties/simulate/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;if(void 0!==r.end){let e=r.end,n=a;if("boolean"!=typeof e){let n;if(void 0===n)if("false"===e||0===e||null===e)n=!1;else{if("true"!==e&&1!==e)return i.errors=[{instancePath:t+"/simulate/end",schemaPath:"#/properties/simulate/properties/end/type",keyword:"type",params:{type:"boolean"},message:"must be boolean"}],!1;n=!0}void 0!==n&&(e=n,void 0!==r&&(r.end=n))}var b=n===a}else b=!0;if(b){if(void 0!==r.split){let e=r.split,n=a;if("boolean"!=typeof e){let n;if(void 0===n)if("false"===e||0===e||null===e)n=!1;else{if("true"!==e&&1!==e)return i.errors=[{instancePath:t+"/simulate/split",schemaPath:"#/properties/simulate/properties/split/type",keyword:"type",params:{type:"boolean"},message:"must be boolean"}],!1;n=!0}void 0!==n&&(e=n,void 0!==r&&(r.split=n))}b=n===a}else b=!0;if(b){if(void 0!==r.error){let e=r.error,n=a;if("boolean"!=typeof e){let n;if(void 0===n)if("false"===e||0===e||null===e)n=!1;else{if("true"!==e&&1!==e)return i.errors=[{instancePath:t+"/simulate/error",schemaPath:"#/properties/simulate/properties/error/type",keyword:"type",params:{type:"boolean"},message:"must be boolean"}],!1;n=!0}void 0!==n&&(e=n,void 0!==r&&(r.error=n))}b=n===a}else b=!0;if(b)if(void 0!==r.close){let e=r.close,n=a;if("boolean"!=typeof e){let n;if(void 0===n)if("false"===e||0===e||null===e)n=!1;else{if("true"!==e&&1!==e)return i.errors=[{instancePath:t+"/simulate/close",schemaPath:"#/properties/simulate/properties/close/type",keyword:"type",params:{type:"boolean"},message:"must be boolean"}],!1;n=!0}void 0!==n&&(e=n,void 0!==r&&(r.close=n))}b=n===a}else b=!0}}}m=n===a}else m=!0;if(m){if(void 0!==e.authority){let r=e.authority,n=a;if("string"!=typeof r){let n,s=typeof r;if(void 0===n)if("number"==s||"boolean"==s)n=""+r;else{if(null!==r)return i.errors=[{instancePath:t+"/authority",schemaPath:"#/properties/authority/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;n=""}void 0!==n&&(r=n,void 0!==e&&(e.authority=n))}m=n===a}else m=!0;if(m){if(void 0!==e.remoteAddress){let r=e.remoteAddress,n=a;if("string"!=typeof r){let n,s=typeof r;if(void 0===n)if("number"==s||"boolean"==s)n=""+r;else{if(null!==r)return i.errors=[{instancePath:t+"/remoteAddress",schemaPath:"#/properties/remoteAddress/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;n=""}void 0!==n&&(r=n,void 0!==e&&(e.remoteAddress=n))}m=n===a}else m=!0;if(m){if(void 0!==e.method){let n=e.method,s=a;if("string"!=typeof n){let r,s=typeof n;if(void 0===r)if("number"==s||"boolean"==s)r=""+n;else{if(null!==n)return i.errors=[{instancePath:t+"/method",schemaPath:"#/properties/method/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;r=""}void 0!==r&&(n=r,void 0!==e&&(e.method=r))}if("ACL"!==n&&"BIND"!==n&&"CHECKOUT"!==n&&"CONNECT"!==n&&"COPY"!==n&&"DELETE"!==n&&"GET"!==n&&"HEAD"!==n&&"LINK"!==n&&"LOCK"!==n&&"M-SEARCH"!==n&&"MERGE"!==n&&"MKACTIVITY"!==n&&"MKCALENDAR"!==n&&"MKCOL"!==n&&"MOVE"!==n&&"NOTIFY"!==n&&"OPTIONS"!==n&&"PATCH"!==n&&"POST"!==n&&"PROPFIND"!==n&&"PROPPATCH"!==n&&"PURGE"!==n&&"PUT"!==n&&"REBIND"!==n&&"REPORT"!==n&&"SEARCH"!==n&&"SOURCE"!==n&&"SUBSCRIBE"!==n&&"TRACE"!==n&&"UNBIND"!==n&&"UNLINK"!==n&&"UNLOCK"!==n&&"UNSUBSCRIBE"!==n&&"acl"!==n&&"bind"!==n&&"checkout"!==n&&"connect"!==n&&"copy"!==n&&"delete"!==n&&"get"!==n&&"head"!==n&&"link"!==n&&"lock"!==n&&"m-search"!==n&&"merge"!==n&&"mkactivity"!==n&&"mkcalendar"!==n&&"mkcol"!==n&&"move"!==n&&"notify"!==n&&"options"!==n&&"patch"!==n&&"post"!==n&&"propfind"!==n&&"proppatch"!==n&&"purge"!==n&&"put"!==n&&"rebind"!==n&&"report"!==n&&"search"!==n&&"source"!==n&&"subscribe"!==n&&"trace"!==n&&"unbind"!==n&&"unlink"!==n&&"unlock"!==n&&"unsubscribe"!==n)return i.errors=[{instancePath:t+"/method",schemaPath:"#/properties/method/enum",keyword:"enum",params:{allowedValues:r.properties.method.enum},message:"must be equal to one of the allowed values"}],!1;m=s===a}else m=!0;if(m)if(void 0!==e.validate){let r=e.validate,n=a;if("boolean"!=typeof r){let n;if(void 0===n)if("false"===r||0===r||null===r)n=!1;else{if("true"!==r&&1!==r)return i.errors=[{instancePath:t+"/validate",schemaPath:"#/properties/validate/type",keyword:"type",params:{type:"boolean"},message:"must be boolean"}],!1;n=!0}void 0!==n&&(r=n,void 0!==e&&(e.validate=n))}m=n===a}else m=!0}}}}}}}}}return i.errors=s,0===a}}),Sn=u((e,t)=>{var r=c("node:assert"),i=vn(),n=wn(),s="The dispatch function has already been invoked",a=_n();function o(e,t,r){return void 0===r?new d(e,t):u(e,t,r)}function l(e,t,r,i){return r.once("error",function(e){this.destroyed&&i.destroy(e)}),r.once("close",function(){this.destroyed&&!this._error&&i.destroy()}),r.prepare(()=>e.call(t,r,i))}function u(e,t,s){if(!1!==(t="string"==typeof t?{url:t}:t).validate&&(r("function"==typeof e,"dispatchFunc should be a function"),!a(t)))throw new Error(a.errors.map(e=>e.message));let o=t.server||{},c=t.Request?i.CustomRequest:i;if(e.request&&e.request.app===e&&(Object.setPrototypeOf(Object.getPrototypeOf(e.request),c.prototype),Object.setPrototypeOf(Object.getPrototypeOf(e.response),n.prototype)),"function"==typeof s){let r=new c(t),i=new n(r,s);return l(e,o,r,i)}return new Promise((r,i)=>{let s=new c(t),a=new n(s,r,i);l(e,o,s,a)})}function d(e,t){this.option="string"==typeof t?{url:t}:Object.assign({},t),this.dispatch=e,this._hasInvoked=!1,this._promise=null,!1!==this.option.autoStart&&process.nextTick(()=>{this._hasInvoked||this.end()})}["delete","get","head","options","patch","post","put","trace"].forEach(e=>{d.prototype[e]=function(t){if(!0===this._hasInvoked||this._promise)throw new Error(s);return this.option.url=t,this.option.method=e.toUpperCase(),this}}),["body","cookies","headers","payload","query"].forEach(e=>{d.prototype[e]=function(t){if(!0===this._hasInvoked||this._promise)throw new Error(s);return this.option[e]=t,this}}),d.prototype.end=function(e){if(!0===this._hasInvoked||this._promise)throw new Error(s);if(this._hasInvoked=!0,"function"!=typeof e)return this._promise=u(this.dispatch,this.option),this._promise;u(this.dispatch,this.option,e)},Object.getOwnPropertyNames(Promise.prototype).forEach(e=>{"constructor"!==e&&(d.prototype[e]=function(...t){if(!this._promise){if(!0===this._hasInvoked)throw new Error(s);this._hasInvoked=!0,this._promise=u(this.dispatch,this.option)}return this._promise[e](...t)})}),t.exports=o,t.exports.default=o,t.exports.inject=o,t.exports.isInjection=function(e){return e instanceof i||e instanceof n||e&&e.constructor&&"_CustomLMRRequest"===e.constructor.name}}),En=u((e,t)=>{var r,i=P(),n=c("node:http"),{kAvvioBoot:s,kChildren:a,kServerBindings:o,kBodyLimit:l,kRoutePrefix:u,kLogLevel:d,kLogSerializers:p,kHooks:h,kSchemaController:f,kRequestAcceptVersion:m,kReplySerializerDefault:g,kContentTypeParser:y,kReply:v,kRequest:b,kFourOhFour:w,kState:_,kOptions:S,kPluginNameChain:E,kSchemaErrorFormatter:k,kErrorHandler:x,kKeepAliveConnections:T,kChildLoggerFactory:O,kGenReqId:I}=R(),{createServer:j,compileValidateHTTPVersion:L}=N(),D=be(),F=ft(),M=mt(),{supportedMethods:z}=gt(),q=yt(),U=_t(),B=Ci(),{Hooks:H,hookRunnerApplication:V,supportedHooks:G}=A(),{createLogger:W,createChildLogger:K,defaultChildLoggerFactory:J}=he(),Z=Ai(),{getGenReqId:Y,reqIdGenFactory:X}=Ni(),{buildRouting:Q,validateBodyLimitOption:ee}=cn(),te=un(),re=pn(),ie=hn(),{FSTDEP009:ne}=$(),se=fn(),{appendStackTrace:ae,AVVIO_ERRORS_MAP:oe,...le}=C(),{defaultInitOptions:ce}=re,{FST_ERR_ASYNC_CONSTRAINT:ue,FST_ERR_BAD_URL:de,FST_ERR_FORCE_CLOSE_CONNECTIONS_IDLE_NOT_AVAILABLE:pe,FST_ERR_OPTIONS_NOT_OBJ:fe,FST_ERR_QSP_NOT_FN:me,FST_ERR_SCHEMA_CONTROLLER_BUCKET_OPT_NOT_FN:ge,FST_ERR_AJV_CUSTOM_OPTIONS_OPT_NOT_OBJ:ye,FST_ERR_AJV_CUSTOM_OPTIONS_OPT_NOT_ARR:we,FST_ERR_VERSION_CONSTRAINT_NOT_STR:_e,FST_ERR_INSTANCE_ALREADY_LISTENING:Se,FST_ERR_REOPENED_CLOSE_SERVER:Ee,FST_ERR_ROUTE_REWRITE_NOT_STR:ke,FST_ERR_SCHEMA_ERROR_FORMATTER_NOT_FN:xe,FST_ERR_ERROR_HANDLER_NOT_FN:Te}=le,{buildErrorHandler:Pe}=ve();function Re(e){let t={};return["errorHandler","logLevel","logSerializers"].concat(G).forEach(r=>{t[r]=e.store[r]}),Object.assign({},t)}function Oe(e){if("object"!=typeof(e=e||{}))throw new fe;if(e.querystringParser&&"function"!=typeof e.querystringParser)throw new me(typeof e.querystringParser);if(e.schemaController&&e.schemaController.bucket&&"function"!=typeof e.schemaController.bucket)throw new ge(typeof e.schemaController.bucket);ee(e.bodyLimit);let t=!1!==e.requestIdHeader&&(e.requestIdHeader||ce.requestIdHeader).toLowerCase(),P=X(t,e.genReqId),R=e.requestIdLogLabel||"reqId",$=e.bodyLimit||ce.bodyLimit,C=e.disableRequestLogging||!1,A=Object.assign({customOptions:{},plugins:[]},e.ajv),N=e.frameworkErrors;if(!A.customOptions||"[object Object]"!==Object.prototype.toString.call(A.customOptions))throw new ye(typeof A.customOptions);if(!A.plugins||!Array.isArray(A.plugins))throw new we(typeof A.plugins);let{logger:he,hasLogger:ve}=W(e);e.connectionTimeout=e.connectionTimeout||ce.connectionTimeout,e.keepAliveTimeout=e.keepAliveTimeout||ce.keepAliveTimeout,e.maxRequestsPerSocket=e.maxRequestsPerSocket||ce.maxRequestsPerSocket,e.requestTimeout=e.requestTimeout||ce.requestTimeout,e.logger=he,e.requestIdHeader=t,e.requestIdLogLabel=R,e.disableRequestLogging=C,e.ajv=A,e.clientErrorHandler=e.clientErrorHandler||function(e,t){if("ECONNRESET"===e.code||t.destroyed)return;let r,i,s,a;"ERR_HTTP_REQUEST_TIMEOUT"===e.code?(i="408",s=n.STATUS_CODES[i],r=`{"error":"${s}","message":"Client Timeout","statusCode":408}`,a="timeout"):"HPE_HEADER_OVERFLOW"===e.code?(i="431",s=n.STATUS_CODES[i],r=`{"error":"${s}","message":"Exceeded maximum allowed HTTP header size","statusCode":431}`,a="header_overflow"):(i="400",s=n.STATUS_CODES[i],r=`{"error":"${s}","message":"Client Error","statusCode":400}`,a="error"),this.log.trace({err:e},`client ${a}`),t.writable&&t.write(`HTTP/1.1 ${i} ${s}\r\nContent-Length: ${r.length}\r\nContent-Type: application/json\r\n\r\n${r}`),t.destroy(e)};let be=re(e);e.exposeHeadRoutes=be.exposeHeadRoutes;let xe=e.constraints;e.versioning&&(ne(),xe={...xe,version:{name:"version",mustMatchWhenDerived:!0,storage:e.versioning.storage,deriveConstraint:e.versioning.deriveVersion,validate(e){if("string"!=typeof e)throw new _e}}});let Oe=Q({config:{defaultRoute:function(e,t){void 0!==e.headers["accept-version"]&&(e.headers[m]=e.headers["accept-version"],e.headers["accept-version"]=void 0),Ce.router.lookup(e,t)},onBadUrl:function(e,t,r){if(N){let i=Y(He.server,t),n=K(He,he,t,i),s=new F(i,null,t,null,n,He),a=new D(r,s,n);return!1===C&&n.info({req:s},"incoming request"),N(new de(e),s,a)}let i=`{"error":"Bad Request","code":"FST_ERR_BAD_URL","message":"'${e}' is not a valid url component","statusCode":400}`;r.writeHead(400,{"Content-Type":"application/json","Content-Length":i.length}),r.end(i)},constraints:xe,ignoreTrailingSlash:e.ignoreTrailingSlash||ce.ignoreTrailingSlash,ignoreDuplicateSlashes:e.ignoreDuplicateSlashes||ce.ignoreDuplicateSlashes,maxParamLength:e.maxParamLength||ce.maxParamLength,caseSensitive:e.caseSensitive,allowUnsafeRegex:e.allowUnsafeRegex||ce.allowUnsafeRegex,buildPrettyMeta:Re,querystringParser:e.querystringParser,useSemicolonDelimiter:e.useSemicolonDelimiter??ce.useSemicolonDelimiter}}),Ce=te(e),Ae=function(e,{rewriteUrl:t}){let r;return function(i,n){if(void 0===r&&(r=e.isAsyncConstraint()),t){i.originalUrl=i.url;let e=t.call(qe,i);if("string"==typeof e)i.url=e;else{let t=new ke(i.url,typeof e);i.destroy(t)}}e.routing(i,n,function(e,t,r){if(!1!==e)return function(e){if(e){if(N){let e=Y(He.server,t),i=K(He,he,t,e),n=new F(e,null,t,null,i,He),s=new D(r,n,i);return!1===C&&i.info({req:n},"incoming request"),N(new ue,n,s)}let e='{"error":"Internal Server Error","message":"Unexpected error from async constraint","statusCode":500}';r.writeHead(500,{"Content-Type":"application/json","Content-Length":e.length}),r.end(e)}}}(r,i,n))}}(Oe,e);e.http2SessionTimeout=be.http2SessionTimeout;let{server:Ne,listen:Ie}=j(e,Ae),je="function"==typeof Ne.closeAllConnections,Le="function"==typeof Ne.closeIdleConnections,De=e.forceCloseConnections;if("idle"===De&&!Le)throw new pe;"boolean"!=typeof De&&(De=!!Le&&"idle");let Fe=je||!0!==De?se():new Set,Me=D.setupResponseListeners,ze=B.buildSchemaController(null,e.schemaController),qe={[_]:{listening:!1,closing:!1,started:!1,ready:!1,booting:!1,readyPromise:null},[T]:Fe,[S]:e,[a]:[],[o]:[],[l]:$,[u]:"",[d]:"",[p]:null,[h]:new H,[f]:ze,[k]:null,[x]:Pe(),[O]:J,[g]:null,[y]:new U($,e.onProtoPoisoning||ce.onProtoPoisoning,e.onConstructorPoisoning||ce.onConstructorPoisoning),[v]:D.buildReply(D),[b]:F.buildRequest(F,e.trustProxy),[w]:Ce,[Z.kRegisteredPlugins]:[],[E]:["fastify"],[s]:null,[I]:P,routing:Ae,getDefaultRoute:Oe.getDefaultRoute.bind(Oe),setDefaultRoute:Oe.setDefaultRoute.bind(Oe),delete:function(e,t,r){return Oe.prepareRoute.call(this,{method:"DELETE",url:e,options:t,handler:r})},get:function(e,t,r){return Oe.prepareRoute.call(this,{method:"GET",url:e,options:t,handler:r})},head:function(e,t,r){return Oe.prepareRoute.call(this,{method:"HEAD",url:e,options:t,handler:r})},patch:function(e,t,r){return Oe.prepareRoute.call(this,{method:"PATCH",url:e,options:t,handler:r})},post:function(e,t,r){return Oe.prepareRoute.call(this,{method:"POST",url:e,options:t,handler:r})},put:function(e,t,r){return Oe.prepareRoute.call(this,{method:"PUT",url:e,options:t,handler:r})},options:function(e,t,r){return Oe.prepareRoute.call(this,{method:"OPTIONS",url:e,options:t,handler:r})},all:function(e,t,r){return Oe.prepareRoute.call(this,{method:z,url:e,options:t,handler:r})},route:function(e){return Oe.route.call(this,{options:e})},hasRoute:function(e){return Oe.hasRoute.call(this,{options:e})},findRoute:function(e){return Oe.findRoute(e)},log:he,withTypeProvider:function(){return this},addHook:function(e,t){if(Ve('Cannot call "addHook"!'),null==t)throw new le.FST_ERR_HOOK_INVALID_HANDLER(e,t);if("onSend"===e||"preSerialization"===e||"onError"===e||"preParsing"===e){if("AsyncFunction"===t.constructor.name&&4===t.length)throw new le.FST_ERR_HOOK_INVALID_ASYNC_HANDLER}else if("onReady"===e||"onListen"===e){if("AsyncFunction"===t.constructor.name&&0!==t.length)throw new le.FST_ERR_HOOK_INVALID_ASYNC_HANDLER}else if("onRequestAbort"===e){if("AsyncFunction"===t.constructor.name&&1!==t.length)throw new le.FST_ERR_HOOK_INVALID_ASYNC_HANDLER}else if("AsyncFunction"===t.constructor.name&&3===t.length)throw new le.FST_ERR_HOOK_INVALID_ASYNC_HANDLER;return"onClose"===e?this.onClose(t.bind(this)):"onReady"===e||"onListen"===e||"onRoute"===e?this[h].add(e,t):this.after((i,n)=>{r.call(this,e,t),n(i)}),this;function r(e,t){this[h].add(e,t),this[a].forEach(i=>r.call(i,e,t))}},addSchema:function(e){return Ve('Cannot call "addSchema"!'),this[f].add(e),this[a].forEach(t=>t.addSchema(e)),this},getSchema:ze.getSchema.bind(ze),getSchemas:ze.getSchemas.bind(ze),setValidatorCompiler:function(e){return Ve('Cannot call "setValidatorCompiler"!'),this[f].setValidatorCompiler(e),this},setSerializerCompiler:function(e){return Ve('Cannot call "setSerializerCompiler"!'),this[f].setSerializerCompiler(e),this},setSchemaController:function(e){Ve('Cannot call "setSchemaController"!');let t=this[f],r=B.buildSchemaController(t,Object.assign({},t.opts,e));return this[f]=r,this.getSchema=r.getSchema.bind(r),this.getSchemas=r.getSchemas.bind(r),this},setReplySerializer:function(e){return Ve('Cannot call "setReplySerializer"!'),this[g]=e,this},setSchemaErrorFormatter:function(e){return Ve('Cannot call "setSchemaErrorFormatter"!'),$e(e),this[k]=e.bind(this),this},setGenReqId:function(e){return Ve('Cannot call "setGenReqId"!'),this[I]=X(this[S].requestIdHeader,e),this},addContentTypeParser:U.helpers.addContentTypeParser,hasContentTypeParser:U.helpers.hasContentTypeParser,getDefaultJsonParser:U.defaultParsers.getDefaultJsonParser,defaultTextParser:U.defaultParsers.defaultTextParser,removeContentTypeParser:U.helpers.removeContentTypeParser,removeAllContentTypeParsers:U.helpers.removeAllContentTypeParsers,register:null,after:null,ready:null,onClose:null,close:null,printPlugins:null,hasPlugin:function(e){return this[Z.kRegisteredPlugins].includes(e)||this[E].includes(e)},listen:Ie,server:Ne,addresses:function(){let e=this[o].map(e=>e.address());return e.push(this.server.address()),e.filter(e=>e)},decorate:q.add,hasDecorator:q.exist,decorateReply:q.decorateReply,decorateRequest:q.decorateRequest,hasRequestDecorator:q.existRequest,hasReplyDecorator:q.existReply,inject:function(e,t){if(void 0===r&&(r=Sn()),qe[_].started){if(qe[_].closing){let e=new Ee;return t?void t(e):Promise.reject(e)}return r(Ae,e,t)}if(!t)return r((e,t)=>{this.ready(function(r){r?t.emit("error",r):Ae(e,t)})},e);this.ready(i=>{i?t(i,null):r(Ae,e,t)})},printRoutes:function(e={}){return e.includeMeta=e.includeHooks?e.includeMeta?G.concat(e.includeMeta):G:e.includeMeta,Oe.printRoutes(e)},setNotFoundHandler:function(e,t){return Ve('Cannot call "setNotFoundHandler"!'),Ce.setNotFoundHandler.call(this,e,t,Be,Oe.routeHandler),this},setErrorHandler:function(e){if(Ve('Cannot call "setErrorHandler"!'),"function"!=typeof e)throw new Te;return this[x]=Pe(this[x],e.bind(this)),this},setChildLoggerFactory:function(e){return Ve('Cannot call "setChildLoggerFactory"!'),this[O]=e,this},initialConfig:be,addConstraintStrategy:Oe.addConstraintStrategy.bind(Oe),hasConstraintStrategy:Oe.hasConstraintStrategy.bind(Oe)};Object.defineProperties(qe,{listeningOrigin:{get(){let e=this.addresses().slice(-1).pop();return"string"==typeof e?e:`${this[S].https?"https":"http"}://${"IPv6"===e.family?`[${e.address}]`:e.address}:${e.port}`}},pluginName:{configurable:!0,get(){return this[E].length>1?this[E].join(" -> "):this[E][0]}},prefix:{configurable:!0,get(){return this[u]}},validatorCompiler:{configurable:!0,get(){return this[f].getValidatorCompiler()}},serializerCompiler:{configurable:!0,get(){return this[f].getSerializerCompiler()}},childLoggerFactory:{configurable:!0,get(){return this[O]}},version:{configurable:!0,get:()=>"4.29.1"},errorHandler:{configurable:!0,get(){return this[x].func}},genReqId:{configurable:!0,get(){return this[I]}}}),e.schemaErrorFormatter&&($e(e.schemaErrorFormatter),qe[k]=e.schemaErrorFormatter.bind(qe));let Ue=Number(e.pluginTimeout),Be=i(qe,{autostart:!1,timeout:!1===isNaN(Ue)?Ue:ce.pluginTimeout,expose:{use:"register"}});Be.override=ie,Be.on("start",()=>qe[_].started=!0),qe[s]=qe.ready,qe.ready=function(e){if(null!==this[_].readyPromise)return null!=e?void this[_].readyPromise.then(()=>e(null,qe),e):this[_].readyPromise;let t,r;if(process.nextTick(function(){qe[s]((e,t)=>{e||qe[_].started||qe[_].ready||qe[_].booting?i(e):(qe[_].booting=!0,V("onReady",qe[s],qe,i)),t()})}),this[_].readyPromise=new Promise(function(e,i){t=e,r=i}),!e)return this[_].readyPromise;function i(e){if(e=null!=e&&null!=oe[e.code]?ae(e,new oe[e.code](e.message)):e)return r(e);t(qe),qe[_].booting=!1,qe[_].ready=!0,qe[_].promise=null}this[_].readyPromise.then(()=>e(null,qe),e)},qe.printPlugins=Be.prettyPrint.bind(Be),Be.once("preReady",()=>{qe.onClose((t,r)=>{qe[_].closing=!0,Oe.closeRoutes(),V("preClose",qe[s],qe,function(){if(qe[_].listening)if("idle"===De)t.server.closeIdleConnections();else if(je&&De)t.server.closeAllConnections();else if(!0===De)for(let e of qe[T])e.destroy(),qe[T].delete(e);!e.serverFactory||qe[_].listening?t.server.close(function(e){e&&"ERR_SERVER_NOT_RUNNING"!==e.code?r(null):r()}):process.nextTick(r,null)})})});let He=new M({server:qe,config:{}});qe.setNotFoundHandler(),Ce.arrange404(qe),Oe.setup(e,{avvio:Be,fourOhFour:Ce,logger:he,hasLogger:ve,setupResponseListeners:Me,throwIfAlreadyStarted:Ve,validateHTTPVersion:L(e),keepAliveConnections:Fe}),Ne.on("clientError",e.clientErrorHandler.bind(qe));try{let e=c("node:diagnostics_channel").channel("fastify.initialization");e.hasSubscribers&&e.publish({fastify:qe})}catch{}return"asyncDispose"in Symbol&&(qe[Symbol.asyncDispose]=function(){return qe.close()}),qe;function Ve(e){if(qe[_].started)throw new Se(e)}}function $e(e){if("function"!=typeof e)throw new xe(typeof e);if("AsyncFunction"===e.constructor.name)throw new xe("AsyncFunction")}t.exports=Oe,t.exports.errorCodes=le,t.exports.fastify=Oe,t.exports.default=Oe}),kn=u((e,t)=>{function r(e,t,r){e instanceof RegExp&&(e=i(e,r)),t instanceof RegExp&&(t=i(t,r));var s=n(e,t,r);return s&&{start:s[0],end:s[1],pre:r.slice(0,s[0]),body:r.slice(s[0]+e.length,s[1]),post:r.slice(s[1]+t.length)}}function i(e,t){var r=t.match(e);return r?r[0]:null}function n(e,t,r){var i,n,s,a,o,l=r.indexOf(e),c=r.indexOf(t,l+1),u=l;if(l>=0&&c>0){if(e===t)return[l,c];for(i=[],s=r.length;u>=0&&!o;)u==l?(i.push(u),l=r.indexOf(e,u+1)):1==i.length?o=[i.pop(),c]:((n=i.pop())<s&&(s=n,a=c),c=r.indexOf(t,u+1)),u=l<c&&l>=0?l:c;i.length&&(o=[s,a])}return o}t.exports=r,r.range=n}),xn=u((e,t)=>{var r=kn();t.exports=function(e){return e?("{}"===e.substr(0,2)&&(e="\\{\\}"+e.substr(2)),m(function(e){return e.split("\\\\").join(i).split("\\{").join(n).split("\\}").join(s).split("\\,").join(a).split("\\.").join(o)}(e),!0).map(c)):[]};var i="\0SLASH"+Math.random()+"\0",n="\0OPEN"+Math.random()+"\0",s="\0CLOSE"+Math.random()+"\0",a="\0COMMA"+Math.random()+"\0",o="\0PERIOD"+Math.random()+"\0";function l(e){return parseInt(e,10)==e?parseInt(e,10):e.charCodeAt(0)}function c(e){return e.split(i).join("\\").split(n).join("{").split(s).join("}").split(a).join(",").split(o).join(".")}function u(e){if(!e)return[""];var t=[],i=r("{","}",e);if(!i)return e.split(",");var n=i.body,s=i.post,a=i.pre.split(",");a[a.length-1]+="{"+n+"}";var o=u(s);return s.length&&(a[a.length-1]+=o.shift(),a.push.apply(a,o)),t.push.apply(t,a),t}function d(e){return"{"+e+"}"}function p(e){return/^-?0\d/.test(e)}function h(e,t){return e<=t}function f(e,t){return e>=t}function m(e,t){var i=[],n=r("{","}",e);if(!n)return[e];var a=n.pre,o=n.post.length?m(n.post,!1):[""];if(/\$$/.test(n.pre))for(var c=0;c<o.length;c++)i.push(N=a+"{"+n.body+"}"+o[c]);else{var g,y,v=/^-?\d+\.\.-?\d+(?:\.\.-?\d+)?$/.test(n.body),b=/^[a-zA-Z]\.\.[a-zA-Z](?:\.\.-?\d+)?$/.test(n.body),w=v||b,_=n.body.indexOf(",")>=0;if(!w&&!_)return n.post.match(/,(?!,).*\}/)?m(e=n.pre+"{"+n.body+s+n.post):[e];if(w)g=n.body.split(/\.\./);else if(1===(g=u(n.body)).length&&1===(g=m(g[0],!1).map(d)).length)return o.map(function(e){return n.pre+g[0]+e});if(w){var S=l(g[0]),E=l(g[1]),k=Math.max(g[0].length,g[1].length),x=3==g.length?Math.abs(l(g[2])):1,T=h;E<S&&(x*=-1,T=f);var P=g.some(p);y=[];for(var R=S;T(R,E);R+=x){var O;if(b)"\\"===(O=String.fromCharCode(R))&&(O="");else if(O=String(R),P){var $=k-O.length;if($>0){var C=new Array($+1).join("0");O=R<0?"-"+C+O.slice(1):C+O}}y.push(O)}}else{y=[];for(var A=0;A<g.length;A++)y.push.apply(y,m(g[A],!1))}for(A=0;A<y.length;A++)for(c=0;c<o.length;c++){var N=a+y[A]+o[c];(!t||w||N)&&i.push(N)}}return i}}),Tn=u(e=>{Object.defineProperty(e,"__esModule",{value:!0}),e.assertValidPattern=void 0,e.assertValidPattern=e=>{if("string"!=typeof e)throw new TypeError("invalid pattern");if(e.length>65536)throw new TypeError("pattern is too long")}}),Pn=u(e=>{Object.defineProperty(e,"__esModule",{value:!0}),e.parseClass=void 0;var t={"[:alnum:]":["\\p{L}\\p{Nl}\\p{Nd}",!0],"[:alpha:]":["\\p{L}\\p{Nl}",!0],"[:ascii:]":["\\x00-\\x7f",!1],"[:blank:]":["\\p{Zs}\\t",!0],"[:cntrl:]":["\\p{Cc}",!0],"[:digit:]":["\\p{Nd}",!0],"[:graph:]":["\\p{Z}\\p{C}",!0,!0],"[:lower:]":["\\p{Ll}",!0],"[:print:]":["\\p{C}",!0],"[:punct:]":["\\p{P}",!0],"[:space:]":["\\p{Z}\\t\\r\\n\\v\\f",!0],"[:upper:]":["\\p{Lu}",!0],"[:word:]":["\\p{L}\\p{Nl}\\p{Nd}\\p{Pc}",!0],"[:xdigit:]":["A-Fa-f0-9",!1]},r=e=>e.replace(/[[\]\\-]/g,"\\$&"),i=e=>e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),n=e=>e.join("");e.parseClass=(e,s)=>{let a=s;if("["!==e.charAt(a))throw new Error("not in a brace expression");let o=[],l=[],c=a+1,u=!1,d=!1,p=!1,h=!1,f=a,m="";e:for(;c<e.length;){let i=e.charAt(c);if("!"!==i&&"^"!==i||c!==a+1){if("]"===i&&u&&!p){f=c+1;break}if(u=!0,"\\"!==i||p){if("["===i&&!p)for(let[r,[i,n,s]]of Object.entries(t))if(e.startsWith(r,c)){if(m)return["$.",!1,e.length-a,!0];c+=r.length,s?l.push(i):o.push(i),d=d||n;continue e}p=!1,m?(i>m?o.push(r(m)+"-"+r(i)):i===m&&o.push(r(i)),m="",c++):e.startsWith("-]",c+1)?(o.push(r(i+"-")),c+=2):e.startsWith("-",c+1)?(m=i,c+=2):(o.push(r(i)),c++)}else p=!0,c++}else h=!0,c++}if(f<c)return["",!1,0,!1];if(!o.length&&!l.length)return["$.",!1,e.length-a,!0];if(0===l.length&&1===o.length&&/^\\?.$/.test(o[0])&&!h){let e=2===o[0].length?o[0].slice(-1):o[0];return[i(e),!1,f-a,!1]}let g="["+(h?"^":"")+n(o)+"]",y="["+(h?"":"^")+n(l)+"]";return[o.length&&l.length?"("+g+"|"+y+")":o.length?g:y,d,f-a,!0]}}),Rn=u(e=>{Object.defineProperty(e,"__esModule",{value:!0}),e.unescape=void 0,e.unescape=(e,{windowsPathsNoEscape:t=!1}={})=>t?e.replace(/\[([^\/\\])\]/g,"$1"):e.replace(/((?!\\).|^)\[([^\/\\])\]/g,"$1$2").replace(/\\([^\/])/g,"$1")}),On=u(e=>{Object.defineProperty(e,"__esModule",{value:!0}),e.AST=void 0;var t=Pn(),r=Rn(),i=new Set(["!","?","+","*","@"]),n=e=>i.has(e),s="(?!\\.)",a=new Set(["[","."]),o=new Set(["..","."]),l=new Set("().*{}+?[]^$\\!"),c=e=>e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),u="[^/]",d=u+"*?",p=u+"+?";e.AST=class e{type;#e;#t;#r=!1;#i=[];#n;#l;#a;#o=!1;#c;#s;#u=!1;constructor(e,t,r={}){this.type=e,e&&(this.#t=!0),this.#n=t,this.#e=this.#n?this.#n.#e:this,this.#c=this.#e===this?r:this.#e.#c,this.#a=this.#e===this?[]:this.#e.#a,"!"===e&&!this.#e.#o&&this.#a.push(this),this.#l=this.#n?this.#n.#i.length:0}get hasMagic(){if(void 0!==this.#t)return this.#t;for(let e of this.#i)if("string"!=typeof e&&(e.type||e.hasMagic))return this.#t=!0;return this.#t}toString(){return void 0!==this.#s?this.#s:this.#s=this.type?this.type+"("+this.#i.map(e=>String(e)).join("|")+")":this.#i.map(e=>String(e)).join("")}#p(){if(this!==this.#e)throw new Error("should only call on root");if(this.#o)return this;let e;for(this.toString(),this.#o=!0;e=this.#a.pop();){if("!"!==e.type)continue;let t=e,r=t.#n;for(;r;){for(let i=t.#l+1;!r.type&&i<r.#i.length;i++)for(let t of e.#i){if("string"==typeof t)throw new Error("string part in extglob AST??");t.copyIn(r.#i[i])}t=r,r=t.#n}}return this}push(...t){for(let r of t)if(""!==r){if("string"!=typeof r&&!(r instanceof e&&r.#n===this))throw new Error("invalid part: "+r);this.#i.push(r)}}toJSON(){let e=null===this.type?this.#i.slice().map(e=>"string"==typeof e?e:e.toJSON()):[this.type,...this.#i.map(e=>e.toJSON())];return this.isStart()&&!this.type&&e.unshift([]),this.isEnd()&&(this===this.#e||this.#e.#o&&"!"===this.#n?.type)&&e.push({}),e}isStart(){if(this.#e===this)return!0;if(!this.#n?.isStart())return!1;if(0===this.#l)return!0;let t=this.#n;for(let r=0;r<this.#l;r++){let i=t.#i[r];if(!(i instanceof e&&"!"===i.type))return!1}return!0}isEnd(){if(this.#e===this||"!"===this.#n?.type)return!0;if(!this.#n?.isEnd())return!1;if(!this.type)return this.#n?.isEnd();let e=this.#n?this.#n.#i.length:0;return this.#l===e-1}copyIn(e){this.push("string"==typeof e?e:e.clone(this))}clone(t){let r=new e(this.type,t);for(let e of this.#i)r.copyIn(e);return r}static#d(t,r,i,s){let a=!1,o=!1,l=-1,c=!1;if(null===r.type){let u=i,d="";for(;u<t.length;){let i=t.charAt(u++);if(a||"\\"===i)a=!a,d+=i;else if(o)u===l+1?("^"===i||"!"===i)&&(c=!0):"]"===i&&!(u===l+2&&c)&&(o=!1),d+=i;else if("["!==i){if(!s.noext&&n(i)&&"("===t.charAt(u)){r.push(d),d="";let n=new e(i,r);u=e.#d(t,n,u,s),r.push(n);continue}d+=i}else o=!0,l=u,c=!1,d+=i}return r.push(d),u}let u=i+1,d=new e(null,r),p=[],h="";for(;u<t.length;){let i=t.charAt(u++);if(a||"\\"===i)a=!a,h+=i;else if(o)u===l+1?("^"===i||"!"===i)&&(c=!0):"]"===i&&!(u===l+2&&c)&&(o=!1),h+=i;else if("["!==i){if(n(i)&&"("===t.charAt(u)){d.push(h),h="";let r=new e(i,d);d.push(r),u=e.#d(t,r,u,s);continue}if("|"!==i){if(")"===i)return""===h&&0===r.#i.length&&(r.#u=!0),d.push(h),h="",r.push(...p,d),u;h+=i}else d.push(h),h="",p.push(d),d=new e(null,r)}else o=!0,l=u,c=!1,h+=i}return r.type=null,r.#t=void 0,r.#i=[t.substring(i-1)],u}static fromGlob(t,r={}){let i=new e(null,void 0,r);return e.#d(t,i,0,r),i}toMMPattern(){if(this!==this.#e)return this.#e.toMMPattern();let e=this.toString(),[t,r,i,n]=this.toRegExpSource();if(!(i||this.#t||this.#c.nocase&&!this.#c.nocaseMagicOnly&&e.toUpperCase()!==e.toLowerCase()))return r;let s=(this.#c.nocase?"i":"")+(n?"u":"");return Object.assign(new RegExp(`^${t}$`,s),{_src:t,_glob:e})}get options(){return this.#c}toRegExpSource(t){let i=t??!!this.#c.dot;if(this.#e===this&&this.#p(),!this.type){let n=this.isStart()&&this.isEnd(),l=this.#i.map(r=>{let[i,s,a,o]="string"==typeof r?e.#h(r,this.#t,n):r.toRegExpSource(t);return this.#t=this.#t||a,this.#r=this.#r||o,i}).join(""),c="";if(this.isStart()&&"string"==typeof this.#i[0]&&(1!==this.#i.length||!o.has(this.#i[0]))){let e=a,r=i&&e.has(l.charAt(0))||l.startsWith("\\.")&&e.has(l.charAt(2))||l.startsWith("\\.\\.")&&e.has(l.charAt(4)),n=!i&&!t&&e.has(l.charAt(0));c=r?"(?!(?:^|/)\\.\\.?(?:$|/))":n?s:""}let u="";return this.isEnd()&&this.#e.#o&&"!"===this.#n?.type&&(u="(?:$|\\/)"),[c+l+u,(0,r.unescape)(l),this.#t=!!this.#t,this.#r]}let n="*"===this.type||"+"===this.type,l="!"===this.type?"(?:(?!(?:":"(?:",c=this.#f(i);if(this.isStart()&&this.isEnd()&&!c&&"!"!==this.type){let e=this.toString();return this.#i=[e],this.type=null,this.#t=void 0,[e,(0,r.unescape)(this.toString()),!1,!1]}let u=!n||t||i?"":this.#f(!0);u===c&&(u=""),u&&(c=`(?:${c})(?:${u})*?`);let h="";return h="!"===this.type&&this.#u?(this.isStart()&&!i?s:"")+p:l+c+("!"===this.type?"))"+(!this.isStart()||i||t?"":s)+d+")":"@"===this.type?")":"?"===this.type?")?":"+"===this.type&&u?")":"*"===this.type&&u?")?":`)${this.type}`),[h,(0,r.unescape)(c),this.#t=!!this.#t,this.#r]}#f(e){return this.#i.map(t=>{if("string"==typeof t)throw new Error("string type in extglob ast??");let[r,i,n,s]=t.toRegExpSource(e);return this.#r=this.#r||s,r}).filter(e=>!(this.isStart()&&this.isEnd()&&!e)).join("|")}static#h(e,i,n=!1){let s=!1,a="",o=!1;for(let r=0;r<e.length;r++){let h=e.charAt(r);if(s)s=!1,a+=(l.has(h)?"\\":"")+h;else if("\\"!==h){if("["===h){let[n,s,l,c]=(0,t.parseClass)(e,r);if(l){a+=n,o=o||s,r+=l-1,i=i||c;continue}}"*"!==h?"?"!==h?a+=c(h):(a+=u,i=!0):(a+=n&&"*"===e?p:d,i=!0)}else r===e.length-1?a+="\\\\":s=!0}return[a,(0,r.unescape)(e),!!i,o]}}}),$n=u(e=>{Object.defineProperty(e,"__esModule",{value:!0}),e.escape=void 0,e.escape=(e,{windowsPathsNoEscape:t=!1}={})=>t?e.replace(/[?*()[\]]/g,"[$&]"):e.replace(/[?*()[\]\\]/g,"\\$&")}),Cn=u(e=>{var t=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(e,"__esModule",{value:!0}),e.unescape=e.escape=e.AST=e.Minimatch=e.match=e.makeRe=e.braceExpand=e.defaults=e.filter=e.GLOBSTAR=e.sep=e.minimatch=void 0;var r=t(xn()),i=Tn(),n=On(),s=$n(),a=Rn();e.minimatch=(e,t,r={})=>((0,i.assertValidPattern)(t),!(!r.nocomment&&"#"===t.charAt(0))&&new $(t,r).match(e));var o=/^\*+([^+@!?\*\[\(]*)$/,l=e=>t=>!t.startsWith(".")&&t.endsWith(e),c=e=>t=>t.endsWith(e),u=e=>(e=e.toLowerCase(),t=>!t.startsWith(".")&&t.toLowerCase().endsWith(e)),d=e=>(e=e.toLowerCase(),t=>t.toLowerCase().endsWith(e)),p=/^\*+\.\*+$/,h=e=>!e.startsWith(".")&&e.includes("."),f=e=>"."!==e&&".."!==e&&e.includes("."),m=/^\.\*+$/,g=e=>"."!==e&&".."!==e&&e.startsWith("."),y=/^\*+$/,v=e=>0!==e.length&&!e.startsWith("."),b=e=>0!==e.length&&"."!==e&&".."!==e,w=/^\?+([^+@!?\*\[\(]*)?$/,_=([e,t=""])=>{let r=x([e]);return t?(t=t.toLowerCase(),e=>r(e)&&e.toLowerCase().endsWith(t)):r},S=([e,t=""])=>{let r=T([e]);return t?(t=t.toLowerCase(),e=>r(e)&&e.toLowerCase().endsWith(t)):r},E=([e,t=""])=>{let r=T([e]);return t?e=>r(e)&&e.endsWith(t):r},k=([e,t=""])=>{let r=x([e]);return t?e=>r(e)&&e.endsWith(t):r},x=([e])=>{let t=e.length;return e=>e.length===t&&!e.startsWith(".")},T=([e])=>{let t=e.length;return e=>e.length===t&&"."!==e&&".."!==e},P="object"==typeof process&&process?"object"==typeof process.env&&process.env&&process.env.__MINIMATCH_TESTING_PLATFORM__||process.platform:"posix";e.sep="win32"===P?"\\":"/",e.minimatch.sep=e.sep,e.GLOBSTAR=Symbol("globstar **"),e.minimatch.GLOBSTAR=e.GLOBSTAR,e.filter=(t,r={})=>i=>(0,e.minimatch)(i,t,r),e.minimatch.filter=e.filter;var R=(e,t={})=>Object.assign({},e,t);e.defaults=t=>{if(!t||"object"!=typeof t||!Object.keys(t).length)return e.minimatch;let r=e.minimatch;return Object.assign((e,i,n={})=>r(e,i,R(t,n)),{Minimatch:class extends r.Minimatch{constructor(e,r={}){super(e,R(t,r))}static defaults(e){return r.defaults(R(t,e)).Minimatch}},AST:class extends r.AST{constructor(e,r,i={}){super(e,r,R(t,i))}static fromGlob(e,i={}){return r.AST.fromGlob(e,R(t,i))}},unescape:(e,i={})=>r.unescape(e,R(t,i)),escape:(e,i={})=>r.escape(e,R(t,i)),filter:(e,i={})=>r.filter(e,R(t,i)),defaults:e=>r.defaults(R(t,e)),makeRe:(e,i={})=>r.makeRe(e,R(t,i)),braceExpand:(e,i={})=>r.braceExpand(e,R(t,i)),match:(e,i,n={})=>r.match(e,i,R(t,n)),sep:r.sep,GLOBSTAR:e.GLOBSTAR})},e.minimatch.defaults=e.defaults,e.braceExpand=(e,t={})=>((0,i.assertValidPattern)(e),t.nobrace||!/\{(?:(?!\{).)*\}/.test(e)?[e]:(0,r.default)(e)),e.minimatch.braceExpand=e.braceExpand,e.makeRe=(e,t={})=>new $(e,t).makeRe(),e.minimatch.makeRe=e.makeRe,e.match=(e,t,r={})=>{let i=new $(t,r);return e=e.filter(e=>i.match(e)),i.options.nonull&&!e.length&&e.push(t),e},e.minimatch.match=e.match;var O=/[?*]|[+@!]\(.*?\)|\[|\]/,$=class{options;set;pattern;windowsPathsNoEscape;nonegate;negate;comment;empty;preserveMultipleSlashes;partial;globSet;globParts;nocase;isWindows;platform;windowsNoMagicRoot;regexp;constructor(e,t={}){(0,i.assertValidPattern)(e),this.options=t=t||{},this.pattern=e,this.platform=t.platform||P,this.isWindows="win32"===this.platform,this.windowsPathsNoEscape=!!t.windowsPathsNoEscape||!1===t.allowWindowsEscape,this.windowsPathsNoEscape&&(this.pattern=this.pattern.replace(/\\/g,"/")),this.preserveMultipleSlashes=!!t.preserveMultipleSlashes,this.regexp=null,this.negate=!1,this.nonegate=!!t.nonegate,this.comment=!1,this.empty=!1,this.partial=!!t.partial,this.nocase=!!this.options.nocase,this.windowsNoMagicRoot=void 0!==t.windowsNoMagicRoot?t.windowsNoMagicRoot:!(!this.isWindows||!this.nocase),this.globSet=[],this.globParts=[],this.set=[],this.make()}hasMagic(){if(this.options.magicalBraces&&this.set.length>1)return!0;for(let e of this.set)for(let t of e)if("string"!=typeof t)return!0;return!1}debug(...e){}make(){let e=this.pattern,t=this.options;if(!t.nocomment&&"#"===e.charAt(0))return void(this.comment=!0);if(!e)return void(this.empty=!0);this.parseNegate(),this.globSet=[...new Set(this.braceExpand())],t.debug&&(this.debug=(...e)=>console.error(...e)),this.debug(this.pattern,this.globSet);let r=this.globSet.map(e=>this.slashSplit(e));this.globParts=this.preprocess(r),this.debug(this.pattern,this.globParts);let i=this.globParts.map((e,t,r)=>{if(this.isWindows&&this.windowsNoMagicRoot){let t=!(""!==e[0]||""!==e[1]||"?"!==e[2]&&O.test(e[2])||O.test(e[3])),r=/^[a-z]:/i.test(e[0]);if(t)return[...e.slice(0,4),...e.slice(4).map(e=>this.parse(e))];if(r)return[e[0],...e.slice(1).map(e=>this.parse(e))]}return e.map(e=>this.parse(e))});if(this.debug(this.pattern,i),this.set=i.filter(e=>-1===e.indexOf(!1)),this.isWindows)for(let e=0;e<this.set.length;e++){let t=this.set[e];""===t[0]&&""===t[1]&&"?"===this.globParts[e][2]&&"string"==typeof t[3]&&/^[a-z]:$/i.test(t[3])&&(t[2]="?")}this.debug(this.pattern,this.set)}preprocess(e){if(this.options.noglobstar)for(let t=0;t<e.length;t++)for(let r=0;r<e[t].length;r++)"**"===e[t][r]&&(e[t][r]="*");let{optimizationLevel:t=1}=this.options;return t>=2?(e=this.firstPhasePreProcess(e),e=this.secondPhasePreProcess(e)):e=t>=1?this.levelOneOptimize(e):this.adjascentGlobstarOptimize(e),e}adjascentGlobstarOptimize(e){return e.map(e=>{let t=-1;for(;-1!==(t=e.indexOf("**",t+1));){let r=t;for(;"**"===e[r+1];)r++;r!==t&&e.splice(t,r-t)}return e})}levelOneOptimize(e){return e.map(e=>0===(e=e.reduce((e,t)=>{let r=e[e.length-1];return"**"===t&&"**"===r?e:".."===t&&r&&".."!==r&&"."!==r&&"**"!==r?(e.pop(),e):(e.push(t),e)},[])).length?[""]:e)}levelTwoFileOptimize(e){Array.isArray(e)||(e=this.slashSplit(e));let t=!1;do{if(t=!1,!this.preserveMultipleSlashes){for(let r=1;r<e.length-1;r++){let i=e[r];1===r&&""===i&&""===e[0]||("."===i||""===i)&&(t=!0,e.splice(r,1),r--)}"."===e[0]&&2===e.length&&("."===e[1]||""===e[1])&&(t=!0,e.pop())}let r=0;for(;-1!==(r=e.indexOf("..",r+1));){let i=e[r-1];i&&"."!==i&&".."!==i&&"**"!==i&&(t=!0,e.splice(r-1,2),r-=2)}}while(t);return 0===e.length?[""]:e}firstPhasePreProcess(e){let t=!1;do{t=!1;for(let r of e){let i=-1;for(;-1!==(i=r.indexOf("**",i+1));){let n=i;for(;"**"===r[n+1];)n++;n>i&&r.splice(i+1,n-i);let s=r[i+2],a=r[i+3];if(".."!==r[i+1]||!s||"."===s||".."===s||!a||"."===a||".."===a)continue;t=!0,r.splice(i,1);let o=r.slice(0);o[i]="**",e.push(o),i--}if(!this.preserveMultipleSlashes){for(let e=1;e<r.length-1;e++){let i=r[e];1===e&&""===i&&""===r[0]||("."===i||""===i)&&(t=!0,r.splice(e,1),e--)}"."===r[0]&&2===r.length&&("."===r[1]||""===r[1])&&(t=!0,r.pop())}let n=0;for(;-1!==(n=r.indexOf("..",n+1));){let e=r[n-1];e&&"."!==e&&".."!==e&&"**"!==e&&(t=!0,r.splice(n-1,2,...1===n&&"**"===r[n+1]?["."]:[]),0===r.length&&r.push(""),n-=2)}}}while(t);return e}secondPhasePreProcess(e){for(let t=0;t<e.length-1;t++)for(let r=t+1;r<e.length;r++){let i=this.partsMatch(e[t],e[r],!this.preserveMultipleSlashes);if(i){e[t]=[],e[r]=i;break}}return e.filter(e=>e.length)}partsMatch(e,t,r=!1){let i=0,n=0,s=[],a="";for(;i<e.length&&n<t.length;)if(e[i]===t[n])s.push("b"===a?t[n]:e[i]),i++,n++;else if(r&&"**"===e[i]&&t[n]===e[i+1])s.push(e[i]),i++;else if(r&&"**"===t[n]&&e[i]===t[n+1])s.push(t[n]),n++;else if("*"!==e[i]||!t[n]||!this.options.dot&&t[n].startsWith(".")||"**"===t[n]){if("*"!==t[n]||!e[i]||!this.options.dot&&e[i].startsWith(".")||"**"===e[i])return!1;if("a"===a)return!1;a="b",s.push(t[n]),i++,n++}else{if("b"===a)return!1;a="a",s.push(e[i]),i++,n++}return e.length===t.length&&s}parseNegate(){if(this.nonegate)return;let e=this.pattern,t=!1,r=0;for(let i=0;i<e.length&&"!"===e.charAt(i);i++)t=!t,r++;r&&(this.pattern=e.slice(r)),this.negate=t}matchOne(t,r,i=!1){let n=this.options;if(this.isWindows){let e="string"==typeof t[0]&&/^[a-z]:$/i.test(t[0]),i=!e&&""===t[0]&&""===t[1]&&"?"===t[2]&&/^[a-z]:$/i.test(t[3]),n="string"==typeof r[0]&&/^[a-z]:$/i.test(r[0]),s=i?3:e?0:void 0,a=!n&&""===r[0]&&""===r[1]&&"?"===r[2]&&"string"==typeof r[3]&&/^[a-z]:$/i.test(r[3])?3:n?0:void 0;if("number"==typeof s&&"number"==typeof a){let[e,i]=[t[s],r[a]];e.toLowerCase()===i.toLowerCase()&&(r[a]=e,a>s?r=r.slice(a):s>a&&(t=t.slice(s)))}}let{optimizationLevel:s=1}=this.options;s>=2&&(t=this.levelTwoFileOptimize(t)),this.debug("matchOne",this,{file:t,pattern:r}),this.debug("matchOne",t.length,r.length);for(var a=0,o=0,l=t.length,c=r.length;a<l&&o<c;a++,o++){this.debug("matchOne loop");var u=r[o],d=t[a];if(this.debug(r,u,d),!1===u)return!1;if(u===e.GLOBSTAR){this.debug("GLOBSTAR",[r,u,d]);var p=a,h=o+1;if(h===c){for(this.debug("** at the end");a<l;a++)if("."===t[a]||".."===t[a]||!n.dot&&"."===t[a].charAt(0))return!1;return!0}for(;p<l;){var f=t[p];if(this.debug("\nglobstar while",t,p,r,h,f),this.matchOne(t.slice(p),r.slice(h),i))return this.debug("globstar found match!",p,l,f),!0;if("."===f||".."===f||!n.dot&&"."===f.charAt(0)){this.debug("dot detected!",t,p,r,h);break}this.debug("globstar swallow a segment, and continue"),p++}return!(!i||(this.debug("\n>>> no match, partial?",t,p,r,h),p!==l))}let s;if("string"==typeof u?(s=d===u,this.debug("string match",u,d,s)):(s=u.test(d),this.debug("pattern match",u,d,s)),!s)return!1}if(a===l&&o===c)return!0;if(a===l)return i;if(o===c)return a===l-1&&""===t[a];throw new Error("wtf?")}braceExpand(){return(0,e.braceExpand)(this.pattern,this.options)}parse(t){(0,i.assertValidPattern)(t);let r=this.options;if("**"===t)return e.GLOBSTAR;if(""===t)return"";let s,a=null;(s=t.match(y))?a=r.dot?b:v:(s=t.match(o))?a=(r.nocase?r.dot?d:u:r.dot?c:l)(s[1]):(s=t.match(w))?a=(r.nocase?r.dot?S:_:r.dot?E:k)(s):(s=t.match(p))?a=r.dot?f:h:(s=t.match(m))&&(a=g);let x=n.AST.fromGlob(t,this.options).toMMPattern();return a&&"object"==typeof x&&Reflect.defineProperty(x,"test",{value:a}),x}makeRe(){if(this.regexp||!1===this.regexp)return this.regexp;let t=this.set;if(!t.length)return this.regexp=!1,this.regexp;let r=this.options,i=r.noglobstar?"[^/]*?":r.dot?"(?:(?!(?:\\/|^)(?:\\.{1,2})($|\\/)).)*?":"(?:(?!(?:\\/|^)\\.).)*?",n=new Set(r.nocase?["i"]:[]),s=t.map(t=>{let r=t.map(t=>{if(t instanceof RegExp)for(let e of t.flags.split(""))n.add(e);return"string"==typeof t?(e=>e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"))(t):t===e.GLOBSTAR?e.GLOBSTAR:t._src});return r.forEach((t,n)=>{let s=r[n+1],a=r[n-1];t!==e.GLOBSTAR||a===e.GLOBSTAR||(void 0===a?void 0!==s&&s!==e.GLOBSTAR?r[n+1]="(?:\\/|"+i+"\\/)?"+s:r[n]=i:void 0===s?r[n-1]=a+"(?:\\/|"+i+")?":s!==e.GLOBSTAR&&(r[n-1]=a+"(?:\\/|\\/"+i+"\\/)"+s,r[n+1]=e.GLOBSTAR))}),r.filter(t=>t!==e.GLOBSTAR).join("/")}).join("|"),[a,o]=t.length>1?["(?:",")"]:["",""];s="^"+a+s+o+"$",this.negate&&(s="^(?!"+s+").+$");try{this.regexp=new RegExp(s,[...n].join(""))}catch{this.regexp=!1}return this.regexp}slashSplit(e){return this.preserveMultipleSlashes?e.split("/"):this.isWindows&&/^\/\/[^\/]+/.test(e)?["",...e.split(/\/+/)]:e.split(/\/+/)}match(e,t=this.partial){if(this.debug("match",e,this.pattern),this.comment)return!1;if(this.empty)return""===e;if("/"===e&&t)return!0;let r=this.options;this.isWindows&&(e=e.split("\\").join("/"));let i=this.slashSplit(e);this.debug(this.pattern,"split",i);let n=this.set;this.debug(this.pattern,"set",n);let s=i[i.length-1];if(!s)for(let e=i.length-2;!s&&e>=0;e--)s=i[e];for(let e=0;e<n.length;e++){let a=n[e],o=i;if(r.matchBase&&1===a.length&&(o=[s]),this.matchOne(o,a,t))return!!r.flipNegate||!this.negate}return!r.flipNegate&&this.negate}static defaults(t){return e.minimatch.defaults(t).Minimatch}};e.Minimatch=$;var C=On();Object.defineProperty(e,"AST",{enumerable:!0,get:function(){return C.AST}});var A=$n();Object.defineProperty(e,"escape",{enumerable:!0,get:function(){return A.escape}});var N=Rn();Object.defineProperty(e,"unescape",{enumerable:!0,get:function(){return N.unescape}}),e.minimatch.AST=n.AST,e.minimatch.Minimatch=$,e.minimatch.escape=s.escape,e.minimatch.unescape=a.unescape}),An=u(e=>{Object.defineProperty(e,"__esModule",{value:!0}),e.LRUCache=void 0;var t="object"==typeof performance&&performance&&"function"==typeof performance.now?performance:Date,r=new Set,i="object"==typeof process&&process?process:{},n=(e,t,r,n)=>{"function"==typeof i.emitWarning?i.emitWarning(e,t,r,n):console.error(`[${r}] ${t}: ${e}`)},s=globalThis.AbortController,a=globalThis.AbortSignal;if(typeof s>"u"){a=class{onabort;_onabort=[];reason;aborted=!1;addEventListener(e,t){this._onabort.push(t)}},s=class{constructor(){t()}signal=new a;abort(e){if(!this.signal.aborted){this.signal.reason=e,this.signal.aborted=!0;for(let t of this.signal._onabort)t(e);this.signal.onabort?.(e)}}};let e="1"!==i.env?.LRU_CACHE_IGNORE_AC_WARNING,t=()=>{e&&(e=!1,n("AbortController is not defined. If using lru-cache in node 14, load an AbortController polyfill from the `node-abort-controller` package. A minimal polyfill is provided for use by LRUCache.fetch(), but it should not be relied upon in other contexts (eg, passing it to other APIs that use AbortController/AbortSignal might have undesirable effects). You may disable this with LRU_CACHE_IGNORE_AC_WARNING=1 in the env.","NO_ABORT_CONTROLLER","ENOTSUP",t))}}Symbol("type");var o=e=>e&&e===Math.floor(e)&&e>0&&isFinite(e),l=e=>o(e)?e<=Math.pow(2,8)?Uint8Array:e<=Math.pow(2,16)?Uint16Array:e<=Math.pow(2,32)?Uint32Array:e<=Number.MAX_SAFE_INTEGER?c:null:null,c=class extends Array{constructor(e){super(e),this.fill(0)}},u=class e{heap;length;static#e=!1;static create(t){let r=l(t);if(!r)return[];e.#e=!0;let i=new e(t,r);return e.#e=!1,i}constructor(t,r){if(!e.#e)throw new TypeError("instantiate Stack using Stack.create(n)");this.heap=new r(t),this.length=0}push(e){this.heap[this.length++]=e}pop(){return this.heap[--this.length]}},d=class e{#e;#t;#r;#i;#n;#l;ttl;ttlResolution;ttlAutopurge;updateAgeOnGet;updateAgeOnHas;allowStale;noDisposeOnSet;noUpdateTTL;maxEntrySize;sizeCalculation;noDeleteOnFetchRejection;noDeleteOnStaleGet;allowStaleOnFetchAbort;allowStaleOnFetchRejection;ignoreFetchAbort;#a;#o;#c;#s;#u;#p;#d;#f;#h;#m;#g;#y;#v;#b;#w;#_;#S;static unsafeExposeInternals(e){return{starts:e.#v,ttls:e.#b,sizes:e.#y,keyMap:e.#c,keyList:e.#s,valList:e.#u,next:e.#p,prev:e.#d,get head(){return e.#f},get tail(){return e.#h},free:e.#m,isBackgroundFetch:t=>e.#E(t),backgroundFetch:(t,r,i,n)=>e.#k(t,r,i,n),moveToTail:t=>e.#x(t),indexes:t=>e.#T(t),rindexes:t=>e.#P(t),isStale:t=>e.#R(t)}}get max(){return this.#e}get maxSize(){return this.#t}get calculatedSize(){return this.#o}get size(){return this.#a}get fetchMethod(){return this.#n}get memoMethod(){return this.#l}get dispose(){return this.#r}get disposeAfter(){return this.#i}constructor(t){let{max:i=0,ttl:s,ttlResolution:a=1,ttlAutopurge:c,updateAgeOnGet:d,updateAgeOnHas:p,allowStale:h,dispose:f,disposeAfter:m,noDisposeOnSet:g,noUpdateTTL:y,maxSize:v=0,maxEntrySize:b=0,sizeCalculation:w,fetchMethod:_,memoMethod:S,noDeleteOnFetchRejection:E,noDeleteOnStaleGet:k,allowStaleOnFetchRejection:x,allowStaleOnFetchAbort:T,ignoreFetchAbort:P}=t;if(0!==i&&!o(i))throw new TypeError("max option must be a nonnegative integer");let R=i?l(i):Array;if(!R)throw new Error("invalid max value: "+i);if(this.#e=i,this.#t=v,this.maxEntrySize=b||this.#t,this.sizeCalculation=w,this.sizeCalculation){if(!this.#t&&!this.maxEntrySize)throw new TypeError("cannot set sizeCalculation without setting maxSize or maxEntrySize");if("function"!=typeof this.sizeCalculation)throw new TypeError("sizeCalculation set to non-function")}if(void 0!==S&&"function"!=typeof S)throw new TypeError("memoMethod must be a function if defined");if(this.#l=S,void 0!==_&&"function"!=typeof _)throw new TypeError("fetchMethod must be a function if specified");if(this.#n=_,this.#_=!!_,this.#c=new Map,this.#s=new Array(i).fill(void 0),this.#u=new Array(i).fill(void 0),this.#p=new R(i),this.#d=new R(i),this.#f=0,this.#h=0,this.#m=u.create(i),this.#a=0,this.#o=0,"function"==typeof f&&(this.#r=f),"function"==typeof m?(this.#i=m,this.#g=[]):(this.#i=void 0,this.#g=void 0),this.#w=!!this.#r,this.#S=!!this.#i,this.noDisposeOnSet=!!g,this.noUpdateTTL=!!y,this.noDeleteOnFetchRejection=!!E,this.allowStaleOnFetchRejection=!!x,this.allowStaleOnFetchAbort=!!T,this.ignoreFetchAbort=!!P,0!==this.maxEntrySize){if(0!==this.#t&&!o(this.#t))throw new TypeError("maxSize must be a positive integer if specified");if(!o(this.maxEntrySize))throw new TypeError("maxEntrySize must be a positive integer if specified");this.#O()}if(this.allowStale=!!h,this.noDeleteOnStaleGet=!!k,this.updateAgeOnGet=!!d,this.updateAgeOnHas=!!p,this.ttlResolution=o(a)||0===a?a:1,this.ttlAutopurge=!!c,this.ttl=s||0,this.ttl){if(!o(this.ttl))throw new TypeError("ttl must be a positive integer if specified");this.#$()}if(0===this.#e&&0===this.ttl&&0===this.#t)throw new TypeError("At least one of max, maxSize, or ttl is required");if(!this.ttlAutopurge&&!this.#e&&!this.#t){let t="LRU_CACHE_UNBOUNDED";(e=>!r.has(e))(t)&&(r.add(t),n("TTL caching without ttlAutopurge, max, or maxSize can result in unbounded memory consumption.","UnboundedCacheWarning",t,e))}}getRemainingTTL(e){return this.#c.has(e)?1/0:0}#$(){let e=new c(this.#e),r=new c(this.#e);this.#b=e,this.#v=r,this.#C=(i,n,s=t.now())=>{if(r[i]=0!==n?s:0,e[i]=n,0!==n&&this.ttlAutopurge){let e=setTimeout(()=>{this.#R(i)&&this.#A(this.#s[i],"expire")},n+1);e.unref&&e.unref()}},this.#N=i=>{r[i]=0!==e[i]?t.now():0},this.#I=(t,s)=>{if(e[s]){let a=e[s],o=r[s];if(!a||!o)return;t.ttl=a,t.start=o,t.now=i||n(),t.remainingTTL=a-(t.now-o)}};let i=0,n=()=>{let e=t.now();if(this.ttlResolution>0){i=e;let t=setTimeout(()=>i=0,this.ttlResolution);t.unref&&t.unref()}return e};this.getRemainingTTL=t=>{let s=this.#c.get(t);if(void 0===s)return 0;let a=e[s],o=r[s];return a&&o?a-((i||n())-o):1/0},this.#R=t=>{let s=r[t],a=e[t];return!!a&&!!s&&(i||n())-s>a}}#N=()=>{};#I=()=>{};#C=()=>{};#R=()=>!1;#O(){let e=new c(this.#e);this.#o=0,this.#y=e,this.#j=t=>{this.#o-=e[t],e[t]=0},this.#L=(e,t,r,i)=>{if(this.#E(t))return 0;if(!o(r)){if(!i)throw new TypeError("invalid size value (must be positive integer). When maxSize or maxEntrySize is used, sizeCalculation or size must be set.");if("function"!=typeof i)throw new TypeError("sizeCalculation must be a function");if(r=i(t,e),!o(r))throw new TypeError("sizeCalculation return invalid (expect positive integer)")}return r},this.#D=(t,r,i)=>{if(e[t]=r,this.#t){let r=this.#t-e[t];for(;this.#o>r;)this.#F(!0)}this.#o+=e[t],i&&(i.entrySize=r,i.totalCalculatedSize=this.#o)}}#j=e=>{};#D=(e,t,r)=>{};#L=(e,t,r,i)=>{if(r||i)throw new TypeError("cannot set size without setting maxSize or maxEntrySize on cache");return 0};*#T({allowStale:e=this.allowStale}={}){if(this.#a)for(let t=this.#h;this.#M(t)&&((e||!this.#R(t))&&(yield t),t!==this.#f);)t=this.#d[t]}*#P({allowStale:e=this.allowStale}={}){if(this.#a)for(let t=this.#f;this.#M(t)&&((e||!this.#R(t))&&(yield t),t!==this.#h);)t=this.#p[t]}#M(e){return void 0!==e&&this.#c.get(this.#s[e])===e}*entries(){for(let e of this.#T())void 0!==this.#u[e]&&void 0!==this.#s[e]&&!this.#E(this.#u[e])&&(yield[this.#s[e],this.#u[e]])}*rentries(){for(let e of this.#P())void 0!==this.#u[e]&&void 0!==this.#s[e]&&!this.#E(this.#u[e])&&(yield[this.#s[e],this.#u[e]])}*keys(){for(let e of this.#T()){let t=this.#s[e];void 0!==t&&!this.#E(this.#u[e])&&(yield t)}}*rkeys(){for(let e of this.#P()){let t=this.#s[e];void 0!==t&&!this.#E(this.#u[e])&&(yield t)}}*values(){for(let e of this.#T())void 0!==this.#u[e]&&!this.#E(this.#u[e])&&(yield this.#u[e])}*rvalues(){for(let e of this.#P())void 0!==this.#u[e]&&!this.#E(this.#u[e])&&(yield this.#u[e])}[Symbol.iterator](){return this.entries()}[Symbol.toStringTag]="LRUCache";find(e,t={}){for(let r of this.#T()){let i=this.#u[r],n=this.#E(i)?i.__staleWhileFetching:i;if(void 0!==n&&e(n,this.#s[r],this))return this.get(this.#s[r],t)}}forEach(e,t=this){for(let r of this.#T()){let i=this.#u[r],n=this.#E(i)?i.__staleWhileFetching:i;void 0!==n&&e.call(t,n,this.#s[r],this)}}rforEach(e,t=this){for(let r of this.#P()){let i=this.#u[r],n=this.#E(i)?i.__staleWhileFetching:i;void 0!==n&&e.call(t,n,this.#s[r],this)}}purgeStale(){let e=!1;for(let t of this.#P({allowStale:!0}))this.#R(t)&&(this.#A(this.#s[t],"expire"),e=!0);return e}info(e){let r=this.#c.get(e);if(void 0===r)return;let i=this.#u[r],n=this.#E(i)?i.__staleWhileFetching:i;if(void 0===n)return;let s={value:n};if(this.#b&&this.#v){let e=this.#b[r],i=this.#v[r];if(e&&i){let r=e-(t.now()-i);s.ttl=r,s.start=Date.now()}}return this.#y&&(s.size=this.#y[r]),s}dump(){let e=[];for(let r of this.#T({allowStale:!0})){let i=this.#s[r],n=this.#u[r],s=this.#E(n)?n.__staleWhileFetching:n;if(void 0===s||void 0===i)continue;let a={value:s};if(this.#b&&this.#v){a.ttl=this.#b[r];let e=t.now()-this.#v[r];a.start=Math.floor(Date.now()-e)}this.#y&&(a.size=this.#y[r]),e.unshift([i,a])}return e}load(e){this.clear();for(let[r,i]of e){if(i.start){let e=Date.now()-i.start;i.start=t.now()-e}this.set(r,i.value,i)}}set(e,t,r={}){if(void 0===t)return this.delete(e),this;let{ttl:i=this.ttl,start:n,noDisposeOnSet:s=this.noDisposeOnSet,sizeCalculation:a=this.sizeCalculation,status:o}=r,{noUpdateTTL:l=this.noUpdateTTL}=r,c=this.#L(e,t,r.size||0,a);if(this.maxEntrySize&&c>this.maxEntrySize)return o&&(o.set="miss",o.maxEntrySizeExceeded=!0),this.#A(e,"set"),this;let u=0===this.#a?void 0:this.#c.get(e);if(void 0===u)u=0===this.#a?this.#h:0!==this.#m.length?this.#m.pop():this.#a===this.#e?this.#F(!1):this.#a,this.#s[u]=e,this.#u[u]=t,this.#c.set(e,u),this.#p[this.#h]=u,this.#d[u]=this.#h,this.#h=u,this.#a++,this.#D(u,c,o),o&&(o.set="add"),l=!1;else{this.#x(u);let r=this.#u[u];if(t!==r){if(this.#_&&this.#E(r)){r.__abortController.abort(new Error("replaced"));let{__staleWhileFetching:t}=r;void 0!==t&&!s&&(this.#w&&this.#r?.(t,e,"set"),this.#S&&this.#g?.push([t,e,"set"]))}else s||(this.#w&&this.#r?.(r,e,"set"),this.#S&&this.#g?.push([r,e,"set"]));if(this.#j(u),this.#D(u,c,o),this.#u[u]=t,o){o.set="replace";let e=r&&this.#E(r)?r.__staleWhileFetching:r;void 0!==e&&(o.oldValue=e)}}else o&&(o.set="update")}if(0!==i&&!this.#b&&this.#$(),this.#b&&(l||this.#C(u,i,n),o&&this.#I(o,u)),!s&&this.#S&&this.#g){let e,t=this.#g;for(;e=t?.shift();)this.#i?.(...e)}return this}pop(){try{for(;this.#a;){let e=this.#u[this.#f];if(this.#F(!0),this.#E(e)){if(e.__staleWhileFetching)return e.__staleWhileFetching}else if(void 0!==e)return e}}finally{if(this.#S&&this.#g){let e,t=this.#g;for(;e=t?.shift();)this.#i?.(...e)}}}#F(e){let t=this.#f,r=this.#s[t],i=this.#u[t];return this.#_&&this.#E(i)?i.__abortController.abort(new Error("evicted")):(this.#w||this.#S)&&(this.#w&&this.#r?.(i,r,"evict"),this.#S&&this.#g?.push([i,r,"evict"])),this.#j(t),e&&(this.#s[t]=void 0,this.#u[t]=void 0,this.#m.push(t)),1===this.#a?(this.#f=this.#h=0,this.#m.length=0):this.#f=this.#p[t],this.#c.delete(r),this.#a--,t}has(e,t={}){let{updateAgeOnHas:r=this.updateAgeOnHas,status:i}=t,n=this.#c.get(e);if(void 0!==n){let e=this.#u[n];if(this.#E(e)&&void 0===e.__staleWhileFetching)return!1;if(!this.#R(n))return r&&this.#N(n),i&&(i.has="hit",this.#I(i,n)),!0;i&&(i.has="stale",this.#I(i,n))}else i&&(i.has="miss");return!1}peek(e,t={}){let{allowStale:r=this.allowStale}=t,i=this.#c.get(e);if(void 0===i||!r&&this.#R(i))return;let n=this.#u[i];return this.#E(n)?n.__staleWhileFetching:n}#k(e,t,r,i){let n=void 0===t?void 0:this.#u[t];if(this.#E(n))return n;let a=new s,{signal:o}=r;o?.addEventListener("abort",()=>a.abort(o.reason),{signal:a.signal});let l={signal:a.signal,options:r,context:i},c=(i,n=!1)=>{let{aborted:s}=a.signal,o=r.ignoreFetchAbort&&void 0!==i;return r.status&&(s&&!n?(r.status.fetchAborted=!0,r.status.fetchError=a.signal.reason,o&&(r.status.fetchAbortIgnored=!0)):r.status.fetchResolved=!0),!s||o||n?(this.#u[t]===d&&(void 0===i?d.__staleWhileFetching?this.#u[t]=d.__staleWhileFetching:this.#A(e,"fetch"):(r.status&&(r.status.fetchUpdated=!0),this.set(e,i,l.options))),i):u(a.signal.reason)},u=i=>{let{aborted:n}=a.signal,s=n&&r.allowStaleOnFetchAbort,o=s||r.allowStaleOnFetchRejection,l=d;if(this.#u[t]===d&&((o||r.noDeleteOnFetchRejection)&&void 0!==l.__staleWhileFetching?s||(this.#u[t]=l.__staleWhileFetching):this.#A(e,"fetch")),o)return r.status&&void 0!==l.__staleWhileFetching&&(r.status.returnedStale=!0),l.__staleWhileFetching;if(l.__returned===l)throw i};r.status&&(r.status.fetchDispatched=!0);let d=new Promise((t,i)=>{let s=this.#n?.(e,n,l);s&&s instanceof Promise&&s.then(e=>t(void 0===e?void 0:e),i),a.signal.addEventListener("abort",()=>{(!r.ignoreFetchAbort||r.allowStaleOnFetchAbort)&&(t(void 0),r.allowStaleOnFetchAbort&&(t=e=>c(e,!0)))})}).then(c,e=>(r.status&&(r.status.fetchRejected=!0,r.status.fetchError=e),u(e))),p=Object.assign(d,{__abortController:a,__staleWhileFetching:n,__returned:void 0});return void 0===t?(this.set(e,p,{...l.options,status:void 0}),t=this.#c.get(e)):this.#u[t]=p,p}#E(e){if(!this.#_)return!1;let t=e;return!!t&&t instanceof Promise&&t.hasOwnProperty("__staleWhileFetching")&&t.__abortController instanceof s}async fetch(e,t={}){let{allowStale:r=this.allowStale,updateAgeOnGet:i=this.updateAgeOnGet,noDeleteOnStaleGet:n=this.noDeleteOnStaleGet,ttl:s=this.ttl,noDisposeOnSet:a=this.noDisposeOnSet,size:o=0,sizeCalculation:l=this.sizeCalculation,noUpdateTTL:c=this.noUpdateTTL,noDeleteOnFetchRejection:u=this.noDeleteOnFetchRejection,allowStaleOnFetchRejection:d=this.allowStaleOnFetchRejection,ignoreFetchAbort:p=this.ignoreFetchAbort,allowStaleOnFetchAbort:h=this.allowStaleOnFetchAbort,context:f,forceRefresh:m=!1,status:g,signal:y}=t;if(!this.#_)return g&&(g.fetch="get"),this.get(e,{allowStale:r,updateAgeOnGet:i,noDeleteOnStaleGet:n,status:g});let v={allowStale:r,updateAgeOnGet:i,noDeleteOnStaleGet:n,ttl:s,noDisposeOnSet:a,size:o,sizeCalculation:l,noUpdateTTL:c,noDeleteOnFetchRejection:u,allowStaleOnFetchRejection:d,allowStaleOnFetchAbort:h,ignoreFetchAbort:p,status:g,signal:y},b=this.#c.get(e);if(void 0===b){g&&(g.fetch="miss");let t=this.#k(e,b,v,f);return t.__returned=t}{let t=this.#u[b];if(this.#E(t)){let e=r&&void 0!==t.__staleWhileFetching;return g&&(g.fetch="inflight",e&&(g.returnedStale=!0)),e?t.__staleWhileFetching:t.__returned=t}let n=this.#R(b);if(!m&&!n)return g&&(g.fetch="hit"),this.#x(b),i&&this.#N(b),g&&this.#I(g,b),t;let s=this.#k(e,b,v,f),a=void 0!==s.__staleWhileFetching&&r;return g&&(g.fetch=n?"stale":"refresh",a&&n&&(g.returnedStale=!0)),a?s.__staleWhileFetching:s.__returned=s}}async forceFetch(e,t={}){let r=await this.fetch(e,t);if(void 0===r)throw new Error("fetch() returned undefined");return r}memo(e,t={}){let r=this.#l;if(!r)throw new Error("no memoMethod provided to constructor");let{context:i,forceRefresh:n,...s}=t,a=this.get(e,s);if(!n&&void 0!==a)return a;let o=r(e,a,{options:s,context:i});return this.set(e,o,s),o}get(e,t={}){let{allowStale:r=this.allowStale,updateAgeOnGet:i=this.updateAgeOnGet,noDeleteOnStaleGet:n=this.noDeleteOnStaleGet,status:s}=t,a=this.#c.get(e);if(void 0!==a){let t=this.#u[a],o=this.#E(t);return s&&this.#I(s,a),this.#R(a)?(s&&(s.get="stale"),o?(s&&r&&void 0!==t.__staleWhileFetching&&(s.returnedStale=!0),r?t.__staleWhileFetching:void 0):(n||this.#A(e,"expire"),s&&r&&(s.returnedStale=!0),r?t:void 0)):(s&&(s.get="hit"),o?t.__staleWhileFetching:(this.#x(a),i&&this.#N(a),t))}s&&(s.get="miss")}#z(e,t){this.#d[t]=e,this.#p[e]=t}#x(e){e!==this.#h&&(e===this.#f?this.#f=this.#p[e]:this.#z(this.#d[e],this.#p[e]),this.#z(this.#h,e),this.#h=e)}delete(e){return this.#A(e,"delete")}#A(e,t){let r=!1;if(0!==this.#a){let i=this.#c.get(e);if(void 0!==i)if(r=!0,1===this.#a)this.#q(t);else{this.#j(i);let r=this.#u[i];if(this.#E(r)?r.__abortController.abort(new Error("deleted")):(this.#w||this.#S)&&(this.#w&&this.#r?.(r,e,t),this.#S&&this.#g?.push([r,e,t])),this.#c.delete(e),this.#s[i]=void 0,this.#u[i]=void 0,i===this.#h)this.#h=this.#d[i];else if(i===this.#f)this.#f=this.#p[i];else{let e=this.#d[i];this.#p[e]=this.#p[i];let t=this.#p[i];this.#d[t]=this.#d[i]}this.#a--,this.#m.push(i)}}if(this.#S&&this.#g?.length){let e,t=this.#g;for(;e=t?.shift();)this.#i?.(...e)}return r}clear(){return this.#q("delete")}#q(e){for(let t of this.#P({allowStale:!0})){let r=this.#u[t];if(this.#E(r))r.__abortController.abort(new Error("deleted"));else{let i=this.#s[t];this.#w&&this.#r?.(r,i,e),this.#S&&this.#g?.push([r,i,e])}}if(this.#c.clear(),this.#u.fill(void 0),this.#s.fill(void 0),this.#b&&this.#v&&(this.#b.fill(0),this.#v.fill(0)),this.#y&&this.#y.fill(0),this.#f=0,this.#h=0,this.#m.length=0,this.#o=0,this.#a=0,this.#S&&this.#g){let e,t=this.#g;for(;e=t?.shift();)this.#i?.(...e)}}};e.LRUCache=d}),Nn=u(e=>{var t=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(e,"__esModule",{value:!0}),e.Minipass=e.isWritable=e.isReadable=e.isStream=void 0;var r="object"==typeof process&&process?process:{stdout:null,stderr:null},i=c("node:events"),n=t(c("node:stream")),s=c("node:string_decoder");e.isStream=t=>!!t&&"object"==typeof t&&(t instanceof U||t instanceof n.default||(0,e.isReadable)(t)||(0,e.isWritable)(t)),e.isReadable=e=>!!e&&"object"==typeof e&&e instanceof i.EventEmitter&&"function"==typeof e.pipe&&e.pipe!==n.default.Writable.prototype.pipe,e.isWritable=e=>!!e&&"object"==typeof e&&e instanceof i.EventEmitter&&"function"==typeof e.write&&"function"==typeof e.end;var a=Symbol("EOF"),o=Symbol("maybeEmitEnd"),l=Symbol("emittedEnd"),u=Symbol("emittingEnd"),d=Symbol("emittedError"),p=Symbol("closed"),h=Symbol("read"),f=Symbol("flush"),m=Symbol("flushChunk"),g=Symbol("encoding"),y=Symbol("decoder"),v=Symbol("flowing"),b=Symbol("paused"),w=Symbol("resume"),_=Symbol("buffer"),S=Symbol("pipes"),E=Symbol("bufferLength"),k=Symbol("bufferPush"),x=Symbol("bufferShift"),T=Symbol("objectMode"),P=Symbol("destroyed"),R=Symbol("error"),O=Symbol("emitData"),$=Symbol("emitEnd"),C=Symbol("emitEnd2"),A=Symbol("async"),N=Symbol("abort"),I=Symbol("aborted"),j=Symbol("signal"),L=Symbol("dataListeners"),D=Symbol("discarded"),F=e=>Promise.resolve().then(e),M=e=>e(),z=class{src;dest;opts;ondrain;constructor(e,t,r){this.src=e,this.dest=t,this.opts=r,this.ondrain=()=>e[w](),this.dest.on("drain",this.ondrain)}unpipe(){this.dest.removeListener("drain",this.ondrain)}proxyErrors(e){}end(){this.unpipe(),this.opts.end&&this.dest.end()}},q=class extends z{unpipe(){this.src.removeListener("error",this.proxyErrors),super.unpipe()}constructor(e,t,r){super(e,t,r),this.proxyErrors=e=>t.emit("error",e),e.on("error",this.proxyErrors)}},U=class extends i.EventEmitter{[v]=!1;[b]=!1;[S]=[];[_]=[];[T];[g];[A];[y];[a]=!1;[l]=!1;[u]=!1;[p]=!1;[d]=null;[E]=0;[P]=!1;[j];[I]=!1;[L]=0;[D]=!1;writable=!0;readable=!0;constructor(...e){let t=e[0]||{};if(super(),t.objectMode&&"string"==typeof t.encoding)throw new TypeError("Encoding and objectMode may not be used together");(e=>!!e.objectMode)(t)?(this[T]=!0,this[g]=null):(e=>!e.objectMode&&!!e.encoding&&"buffer"!==e.encoding)(t)?(this[g]=t.encoding,this[T]=!1):(this[T]=!1,this[g]=null),this[A]=!!t.async,this[y]=this[g]?new s.StringDecoder(this[g]):null,t&&!0===t.debugExposeBuffer&&Object.defineProperty(this,"buffer",{get:()=>this[_]}),t&&!0===t.debugExposePipes&&Object.defineProperty(this,"pipes",{get:()=>this[S]});let{signal:r}=t;r&&(this[j]=r,r.aborted?this[N]():r.addEventListener("abort",()=>this[N]()))}get bufferLength(){return this[E]}get encoding(){return this[g]}set encoding(e){throw new Error("Encoding must be set at instantiation time")}setEncoding(e){throw new Error("Encoding must be set at instantiation time")}get objectMode(){return this[T]}set objectMode(e){throw new Error("objectMode must be set at instantiation time")}get async(){return this[A]}set async(e){this[A]=this[A]||!!e}[N](){this[I]=!0,this.emit("abort",this[j]?.reason),this.destroy(this[j]?.reason)}get aborted(){return this[I]}set aborted(e){}write(e,t,r){if(this[I])return!1;if(this[a])throw new Error("write after end");if(this[P])return this.emit("error",Object.assign(new Error("Cannot call write after a stream was destroyed"),{code:"ERR_STREAM_DESTROYED"})),!0;"function"==typeof t&&(r=t,t="utf8"),t||(t="utf8");let i=this[A]?F:M;if(!this[T]&&!Buffer.isBuffer(e))if((e=>!Buffer.isBuffer(e)&&ArrayBuffer.isView(e))(e))e=Buffer.from(e.buffer,e.byteOffset,e.byteLength);else if((e=>e instanceof ArrayBuffer||!!e&&"object"==typeof e&&e.constructor&&"ArrayBuffer"===e.constructor.name&&e.byteLength>=0)(e))e=Buffer.from(e);else if("string"!=typeof e)throw new Error("Non-contiguous data written to non-objectMode stream");return this[T]?(this[v]&&0!==this[E]&&this[f](!0),this[v]?this.emit("data",e):this[k](e),0!==this[E]&&this.emit("readable"),r&&i(r),this[v]):e.length?("string"==typeof e&&!(t===this[g]&&!this[y]?.lastNeed)&&(e=Buffer.from(e,t)),Buffer.isBuffer(e)&&this[g]&&(e=this[y].write(e)),this[v]&&0!==this[E]&&this[f](!0),this[v]?this.emit("data",e):this[k](e),0!==this[E]&&this.emit("readable"),r&&i(r),this[v]):(0!==this[E]&&this.emit("readable"),r&&i(r),this[v])}read(e){if(this[P])return null;if(this[D]=!1,0===this[E]||0===e||e&&e>this[E])return this[o](),null;this[T]&&(e=null),this[_].length>1&&!this[T]&&(this[_]=[this[g]?this[_].join(""):Buffer.concat(this[_],this[E])]);let t=this[h](e||null,this[_][0]);return this[o](),t}[h](e,t){if(this[T])this[x]();else{let r=t;e===r.length||null===e?this[x]():"string"==typeof r?(this[_][0]=r.slice(e),t=r.slice(0,e),this[E]-=e):(this[_][0]=r.subarray(e),t=r.subarray(0,e),this[E]-=e)}return this.emit("data",t),!this[_].length&&!this[a]&&this.emit("drain"),t}end(e,t,r){return"function"==typeof e&&(r=e,e=void 0),"function"==typeof t&&(r=t,t="utf8"),void 0!==e&&this.write(e,t),r&&this.once("end",r),this[a]=!0,this.writable=!1,(this[v]||!this[b])&&this[o](),this}[w](){this[P]||(!this[L]&&!this[S].length&&(this[D]=!0),this[b]=!1,this[v]=!0,this.emit("resume"),this[_].length?this[f]():this[a]?this[o]():this.emit("drain"))}resume(){return this[w]()}pause(){this[v]=!1,this[b]=!0,this[D]=!1}get destroyed(){return this[P]}get flowing(){return this[v]}get paused(){return this[b]}[k](e){this[E]+=this[T]?1:e.length,this[_].push(e)}[x](){return this[E]-=this[T]?1:this[_][0].length,this[_].shift()}[f](e=!1){do{}while(this[m](this[x]())&&this[_].length);!e&&!this[_].length&&!this[a]&&this.emit("drain")}[m](e){return this.emit("data",e),this[v]}pipe(e,t){if(this[P])return e;this[D]=!1;let i=this[l];return(t=t||{}).end=e!==r.stdout&&e!==r.stderr&&!1!==t.end,t.proxyErrors=!!t.proxyErrors,i?t.end&&e.end():(this[S].push(t.proxyErrors?new q(this,e,t):new z(this,e,t)),this[A]?F(()=>this[w]()):this[w]()),e}unpipe(e){let t=this[S].find(t=>t.dest===e);t&&(1===this[S].length?(this[v]&&0===this[L]&&(this[v]=!1),this[S]=[]):this[S].splice(this[S].indexOf(t),1),t.unpipe())}addListener(e,t){return this.on(e,t)}on(e,t){let r=super.on(e,t);if("data"===e)this[D]=!1,this[L]++,!this[S].length&&!this[v]&&this[w]();else if("readable"===e&&0!==this[E])super.emit("readable");else if((e=>"end"===e||"finish"===e||"prefinish"===e)(e)&&this[l])super.emit(e),this.removeAllListeners(e);else if("error"===e&&this[d]){let e=t;this[A]?F(()=>e.call(this,this[d])):e.call(this,this[d])}return r}removeListener(e,t){return this.off(e,t)}off(e,t){let r=super.off(e,t);return"data"===e&&(this[L]=this.listeners("data").length,0===this[L]&&!this[D]&&!this[S].length&&(this[v]=!1)),r}removeAllListeners(e){let t=super.removeAllListeners(e);return("data"===e||void 0===e)&&(this[L]=0,!this[D]&&!this[S].length&&(this[v]=!1)),t}get emittedEnd(){return this[l]}[o](){!this[u]&&!this[l]&&!this[P]&&0===this[_].length&&this[a]&&(this[u]=!0,this.emit("end"),this.emit("prefinish"),this.emit("finish"),this[p]&&this.emit("close"),this[u]=!1)}emit(e,...t){let r=t[0];if("error"!==e&&"close"!==e&&e!==P&&this[P])return!1;if("data"===e)return!(!this[T]&&!r)&&(this[A]?(F(()=>this[O](r)),!0):this[O](r));if("end"===e)return this[$]();if("close"===e){if(this[p]=!0,!this[l]&&!this[P])return!1;let e=super.emit("close");return this.removeAllListeners("close"),e}if("error"===e){this[d]=r,super.emit(R,r);let e=!(this[j]&&!this.listeners("error").length)&&super.emit("error",r);return this[o](),e}if("resume"===e){let e=super.emit("resume");return this[o](),e}if("finish"===e||"prefinish"===e){let t=super.emit(e);return this.removeAllListeners(e),t}let i=super.emit(e,...t);return this[o](),i}[O](e){for(let t of this[S])!1===t.dest.write(e)&&this.pause();let t=!this[D]&&super.emit("data",e);return this[o](),t}[$](){return!this[l]&&(this[l]=!0,this.readable=!1,this[A]?(F(()=>this[C]()),!0):this[C]())}[C](){if(this[y]){let e=this[y].end();if(e){for(let t of this[S])t.dest.write(e);this[D]||super.emit("data",e)}}for(let e of this[S])e.end();let e=super.emit("end");return this.removeAllListeners("end"),e}async collect(){let e=Object.assign([],{dataLength:0});this[T]||(e.dataLength=0);let t=this.promise();return this.on("data",t=>{e.push(t),this[T]||(e.dataLength+=t.length)}),await t,e}async concat(){if(this[T])throw new Error("cannot concat in objectMode");let e=await this.collect();return this[g]?e.join(""):Buffer.concat(e,e.dataLength)}async promise(){return new Promise((e,t)=>{this.on(P,()=>t(new Error("stream destroyed"))),this.on("error",e=>t(e)),this.on("end",()=>e())})}[Symbol.asyncIterator](){this[D]=!1;let e=!1,t=async()=>(this.pause(),e=!0,{value:void 0,done:!0});return{next:()=>{if(e)return t();let r=this.read();if(null!==r)return Promise.resolve({done:!1,value:r});if(this[a])return t();let i,n,s=e=>{this.off("data",o),this.off("end",l),this.off(P,c),t(),n(e)},o=e=>{this.off("error",s),this.off("end",l),this.off(P,c),this.pause(),i({value:e,done:!!this[a]})},l=()=>{this.off("error",s),this.off("data",o),this.off(P,c),t(),i({done:!0,value:void 0})},c=()=>s(new Error("stream destroyed"));return new Promise((e,t)=>{n=t,i=e,this.once(P,c),this.once("error",s),this.once("end",l),this.once("data",o)})},throw:t,return:t,[Symbol.asyncIterator](){return this}}}[Symbol.iterator](){this[D]=!1;let e=!1,t=()=>(this.pause(),this.off(R,t),this.off(P,t),this.off("end",t),e=!0,{done:!0,value:void 0});return this.once("end",t),this.once(R,t),this.once(P,t),{next:()=>{if(e)return t();let r=this.read();return null===r?t():{done:!1,value:r}},throw:t,return:t,[Symbol.iterator](){return this}}}destroy(e){return this[P]?(e?this.emit("error",e):this.emit(P),this):(this[P]=!0,this[D]=!0,this[_].length=0,this[E]=0,"function"==typeof this.close&&!this[p]&&this.close(),e?this.emit("error",e):this.emit(P),this)}static get isStream(){return e.isStream}};e.Minipass=U}),In=u(e=>{var t=e&&e.__createBinding||(Object.create?function(e,t,r,i){void 0===i&&(i=r);var n=Object.getOwnPropertyDescriptor(t,r);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,i,n)}:function(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]}),r=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var i={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&t(i,e,n);return r(i,e),i};Object.defineProperty(e,"__esModule",{value:!0}),e.PathScurry=e.Path=e.PathScurryDarwin=e.PathScurryPosix=e.PathScurryWin32=e.PathScurryBase=e.PathPosix=e.PathWin32=e.PathBase=e.ChildrenCache=e.ResolveCache=void 0;var n=An(),s=c("node:path"),a=c("node:url"),o=c("fs"),l=i(c("node:fs")),u=o.realpathSync.native,d=c("node:fs/promises"),p=Nn(),h={lstatSync:o.lstatSync,readdir:o.readdir,readdirSync:o.readdirSync,readlinkSync:o.readlinkSync,realpathSync:u,promises:{lstat:d.lstat,readdir:d.readdir,readlink:d.readlink,realpath:d.realpath}},f=e=>e&&e!==h&&e!==l?{...h,...e,promises:{...h.promises,...e.promises||{}}}:h,m=/^\\\\\?\\([a-z]:)\\?$/i,g=/[\\\/]/,y=10,v=15,b=-16,w=128,_=e=>e.isFile()?8:e.isDirectory()?4:e.isSymbolicLink()?y:e.isCharacterDevice()?2:e.isBlockDevice()?6:e.isSocket()?12:e.isFIFO()?1:0,S=new Map,E=e=>{let t=S.get(e);if(t)return t;let r=e.normalize("NFKD");return S.set(e,r),r},k=new Map,x=e=>{let t=k.get(e);if(t)return t;let r=E(e.toLowerCase());return k.set(e,r),r},T=class extends n.LRUCache{constructor(){super({max:256})}};e.ResolveCache=T;var P=class extends n.LRUCache{constructor(e=16384){super({maxSize:e,sizeCalculation:e=>e.length+1})}};e.ChildrenCache=P;var R=Symbol("PathScurry setAsCwd"),O=class{name;root;roots;parent;nocase;isCWD=!1;#e;#t;get dev(){return this.#t}#r;get mode(){return this.#r}#i;get nlink(){return this.#i}#n;get uid(){return this.#n}#l;get gid(){return this.#l}#a;get rdev(){return this.#a}#o;get blksize(){return this.#o}#c;get ino(){return this.#c}#s;get size(){return this.#s}#u;get blocks(){return this.#u}#p;get atimeMs(){return this.#p}#d;get mtimeMs(){return this.#d}#f;get ctimeMs(){return this.#f}#h;get birthtimeMs(){return this.#h}#m;get atime(){return this.#m}#g;get mtime(){return this.#g}#y;get ctime(){return this.#y}#v;get birthtime(){return this.#v}#b;#w;#_;#S;#$;#N;#I;#C;#R;#O;get parentPath(){return(this.parent||this).fullpath()}get path(){return this.parentPath}constructor(e,t=0,r,i,n,s,a){this.name=e,this.#b=n?x(e):E(e),this.#I=1023&t,this.nocase=n,this.roots=i,this.root=r||this,this.#C=s,this.#_=a.fullpath,this.#$=a.relative,this.#N=a.relativePosix,this.parent=a.parent,this.#e=this.parent?this.parent.#e:f(a.fs)}depth(){return void 0!==this.#w?this.#w:this.#w=this.parent?this.parent.depth()+1:0}childrenCache(){return this.#C}resolve(e){if(!e)return this;let t=this.getRootString(e),r=e.substring(t.length).split(this.splitSep);return t?this.getRoot(t).#j(r):this.#j(r)}#j(e){let t=this;for(let r of e)t=t.child(r);return t}children(){let e=this.#C.get(this);if(e)return e;let t=Object.assign([],{provisional:0});return this.#C.set(this,t),this.#I&=-17,t}child(e,t){if(""===e||"."===e)return this;if(".."===e)return this.parent||this;let r=this.children(),i=this.nocase?x(e):E(e);for(let e of r)if(e.#b===i)return e;let n=this.#_?this.#_+(this.parent?this.sep:"")+e:void 0,s=this.newChild(e,0,{...t,parent:this,fullpath:n});return this.canReaddir()||(s.#I|=w),r.push(s),s}relative(){if(this.isCWD)return"";if(void 0!==this.#$)return this.#$;let e=this.name,t=this.parent;if(!t)return this.#$=this.name;let r=t.relative();return r+(r&&t.parent?this.sep:"")+e}relativePosix(){if("/"===this.sep)return this.relative();if(this.isCWD)return"";if(void 0!==this.#N)return this.#N;let e=this.name,t=this.parent;if(!t)return this.#N=this.fullpathPosix();let r=t.relativePosix();return r+(r&&t.parent?"/":"")+e}fullpath(){if(void 0!==this.#_)return this.#_;let e=this.name,t=this.parent;if(!t)return this.#_=this.name;let r=t.fullpath()+(t.parent?this.sep:"")+e;return this.#_=r}fullpathPosix(){if(void 0!==this.#S)return this.#S;if("/"===this.sep)return this.#S=this.fullpath();if(!this.parent){let e=this.fullpath().replace(/\\/g,"/");return/^[a-z]:\//i.test(e)?this.#S=`//?/${e}`:this.#S=e}let e=this.parent,t=e.fullpathPosix();return this.#S=t+(t&&e.parent?"/":"")+this.name}isUnknown(){return 0===(this.#I&v)}isType(e){return this[`is${e}`]()}getType(){return this.isUnknown()?"Unknown":this.isDirectory()?"Directory":this.isFile()?"File":this.isSymbolicLink()?"SymbolicLink":this.isFIFO()?"FIFO":this.isCharacterDevice()?"CharacterDevice":this.isBlockDevice()?"BlockDevice":this.isSocket()?"Socket":"Unknown"}isFile(){return 8===(this.#I&v)}isDirectory(){return 4===(this.#I&v)}isCharacterDevice(){return 2===(this.#I&v)}isBlockDevice(){return 6===(this.#I&v)}isFIFO(){return 1===(this.#I&v)}isSocket(){return 12===(this.#I&v)}isSymbolicLink(){return(this.#I&y)===y}lstatCached(){return 32&this.#I?this:void 0}readlinkCached(){return this.#R}realpathCached(){return this.#O}readdirCached(){let e=this.children();return e.slice(0,e.provisional)}canReadlink(){if(this.#R)return!0;if(!this.parent)return!1;let e=this.#I&v;return!(0!==e&&e!==y||256&this.#I||this.#I&w)}calledReaddir(){return!!(16&this.#I)}isENOENT(){return!!(this.#I&w)}isNamed(e){return this.nocase?this.#b===x(e):this.#b===E(e)}async readlink(){let e=this.#R;if(e)return e;if(this.canReadlink()&&this.parent)try{let e=await this.#e.promises.readlink(this.fullpath()),t=(await this.parent.realpath())?.resolve(e);if(t)return this.#R=t}catch(e){return void this.#E(e.code)}}readlinkSync(){let e=this.#R;if(e)return e;if(this.canReadlink()&&this.parent)try{let e=this.#e.readlinkSync(this.fullpath()),t=this.parent.realpathSync()?.resolve(e);if(t)return this.#R=t}catch(e){return void this.#E(e.code)}}#D(e){this.#I|=16;for(let t=e.provisional;t<e.length;t++){let r=e[t];r&&r.#L()}}#L(){this.#I&w||(this.#I=(this.#I|w)&b,this.#T())}#T(){let e=this.children();e.provisional=0;for(let t of e)t.#L()}#P(){this.#I|=512,this.#M()}#M(){if(64&this.#I)return;let e=this.#I;4===(e&v)&&(e&=b),this.#I=64|e,this.#T()}#F(e=""){"ENOTDIR"===e||"EPERM"===e?this.#M():"ENOENT"===e?this.#L():this.children().provisional=0}#k(e=""){"ENOTDIR"===e?this.parent.#M():"ENOENT"===e&&this.#L()}#E(e=""){let t=this.#I;t|=256,"ENOENT"===e&&(t|=w),("EINVAL"===e||"UNKNOWN"===e)&&(t&=b),this.#I=t,"ENOTDIR"===e&&this.parent&&this.parent.#M()}#z(e,t){return this.#A(e,t)||this.#x(e,t)}#x(e,t){let r=_(e),i=this.newChild(e.name,r,{parent:this}),n=i.#I&v;return 4!==n&&n!==y&&0!==n&&(i.#I|=64),t.unshift(i),t.provisional++,i}#A(e,t){for(let r=t.provisional;r<t.length;r++){let i=t[r];if((this.nocase?x(e.name):E(e.name))===i.#b)return this.#q(e,i,r,t)}}#q(e,t,r,i){let n=t.name;return t.#I=t.#I&b|_(e),n!==e.name&&(t.name=e.name),r!==i.provisional&&(r===i.length-1?i.pop():i.splice(r,1),i.unshift(t)),i.provisional++,t}async lstat(){if(0===(this.#I&w))try{return this.#U(await this.#e.promises.lstat(this.fullpath())),this}catch(e){this.#k(e.code)}}lstatSync(){if(0===(this.#I&w))try{return this.#U(this.#e.lstatSync(this.fullpath())),this}catch(e){this.#k(e.code)}}#U(e){let{atime:t,atimeMs:r,birthtime:i,birthtimeMs:n,blksize:s,blocks:a,ctime:o,ctimeMs:l,dev:c,gid:u,ino:d,mode:p,mtime:h,mtimeMs:f,nlink:m,rdev:g,size:v,uid:w}=e;this.#m=t,this.#p=r,this.#v=i,this.#h=n,this.#o=s,this.#u=a,this.#y=o,this.#f=l,this.#t=c,this.#l=u,this.#c=d,this.#r=p,this.#g=h,this.#d=f,this.#i=m,this.#a=g,this.#s=v,this.#n=w;let S=_(e);this.#I=this.#I&b|S|32,0!==S&&4!==S&&S!==y&&(this.#I|=64)}#B=[];#H=!1;#V(e){this.#H=!1;let t=this.#B.slice();this.#B.length=0,t.forEach(t=>t(null,e))}readdirCB(e,t=!1){if(!this.canReaddir())return void(t?e(null,[]):queueMicrotask(()=>e(null,[])));let r=this.children();if(this.calledReaddir()){let i=r.slice(0,r.provisional);return void(t?e(null,i):queueMicrotask(()=>e(null,i)))}if(this.#B.push(e),this.#H)return;this.#H=!0;let i=this.fullpath();this.#e.readdir(i,{withFileTypes:!0},(e,t)=>{if(e)this.#F(e.code),r.provisional=0;else{for(let e of t)this.#z(e,r);this.#D(r)}this.#V(r.slice(0,r.provisional))})}#G;async readdir(){if(!this.canReaddir())return[];let e=this.children();if(this.calledReaddir())return e.slice(0,e.provisional);let t=this.fullpath();if(this.#G)await this.#G;else{let r=()=>{};this.#G=new Promise(e=>r=e);try{for(let r of await this.#e.promises.readdir(t,{withFileTypes:!0}))this.#z(r,e);this.#D(e)}catch(t){this.#F(t.code),e.provisional=0}this.#G=void 0,r()}return e.slice(0,e.provisional)}readdirSync(){if(!this.canReaddir())return[];let e=this.children();if(this.calledReaddir())return e.slice(0,e.provisional);let t=this.fullpath();try{for(let r of this.#e.readdirSync(t,{withFileTypes:!0}))this.#z(r,e);this.#D(e)}catch(t){this.#F(t.code),e.provisional=0}return e.slice(0,e.provisional)}canReaddir(){if(704&this.#I)return!1;let e=v&this.#I;return 0===e||4===e||e===y}shouldWalk(e,t){return!(4&~this.#I)&&!(704&this.#I)&&!e.has(this)&&(!t||t(this))}async realpath(){if(this.#O)return this.#O;if(!(896&this.#I))try{let e=await this.#e.promises.realpath(this.fullpath());return this.#O=this.resolve(e)}catch{this.#P()}}realpathSync(){if(this.#O)return this.#O;if(!(896&this.#I))try{let e=this.#e.realpathSync(this.fullpath());return this.#O=this.resolve(e)}catch{this.#P()}}[R](e){if(e===this)return;e.isCWD=!1,this.isCWD=!0;let t=new Set([]),r=[],i=this;for(;i&&i.parent;)t.add(i),i.#$=r.join(this.sep),i.#N=r.join("/"),i=i.parent,r.push("..");for(i=e;i&&i.parent&&!t.has(i);)i.#$=void 0,i.#N=void 0,i=i.parent}};e.PathBase=O;var $=class e extends O{sep="\\";splitSep=g;constructor(e,t=0,r,i,n,s,a){super(e,t,r,i,n,s,a)}newChild(t,r=0,i={}){return new e(t,r,this.root,this.roots,this.nocase,this.childrenCache(),i)}getRootString(e){return s.win32.parse(e).root}getRoot(e){if(e=(e=>e.replace(/\//g,"\\").replace(m,"$1\\"))(e.toUpperCase()),e===this.root.name)return this.root;for(let[t,r]of Object.entries(this.roots))if(this.sameRoot(e,t))return this.roots[e]=r;return this.roots[e]=new N(e,this).root}sameRoot(e,t=this.root.name){return(e=e.toUpperCase().replace(/\//g,"\\").replace(m,"$1\\"))===t}};e.PathWin32=$;var C=class e extends O{splitSep="/";sep="/";constructor(e,t=0,r,i,n,s,a){super(e,t,r,i,n,s,a)}getRootString(e){return e.startsWith("/")?"/":""}getRoot(e){return this.root}newChild(t,r=0,i={}){return new e(t,r,this.root,this.roots,this.nocase,this.childrenCache(),i)}};e.PathPosix=C;var A=class{root;rootPath;roots;cwd;#e;#t;#r;nocase;#i;constructor(e=process.cwd(),t,r,{nocase:i,childrenCacheSize:n=16384,fs:s=h}={}){this.#i=f(s),(e instanceof URL||e.startsWith("file://"))&&(e=(0,a.fileURLToPath)(e));let o=t.resolve(e);this.roots=Object.create(null),this.rootPath=this.parseRootPath(o),this.#e=new T,this.#t=new T,this.#r=new P(n);let l=o.substring(this.rootPath.length).split(r);if(1===l.length&&!l[0]&&l.pop(),void 0===i)throw new TypeError("must provide nocase setting to PathScurryBase ctor");this.nocase=i,this.root=this.newRoot(this.#i),this.roots[this.rootPath]=this.root;let c=this.root,u=l.length-1,d=t.sep,p=this.rootPath,m=!1;for(let e of l){let t=u--;c=c.child(e,{relative:new Array(t).fill("..").join(d),relativePosix:new Array(t).fill("..").join("/"),fullpath:p+=(m?"":d)+e}),m=!0}this.cwd=c}depth(e=this.cwd){return"string"==typeof e&&(e=this.cwd.resolve(e)),e.depth()}childrenCache(){return this.#r}resolve(...e){let t="";for(let r=e.length-1;r>=0;r--){let i=e[r];if(i&&"."!==i&&(t=t?`${i}/${t}`:i,this.isAbsolute(i)))break}let r=this.#e.get(t);if(void 0!==r)return r;let i=this.cwd.resolve(t).fullpath();return this.#e.set(t,i),i}resolvePosix(...e){let t="";for(let r=e.length-1;r>=0;r--){let i=e[r];if(i&&"."!==i&&(t=t?`${i}/${t}`:i,this.isAbsolute(i)))break}let r=this.#t.get(t);if(void 0!==r)return r;let i=this.cwd.resolve(t).fullpathPosix();return this.#t.set(t,i),i}relative(e=this.cwd){return"string"==typeof e&&(e=this.cwd.resolve(e)),e.relative()}relativePosix(e=this.cwd){return"string"==typeof e&&(e=this.cwd.resolve(e)),e.relativePosix()}basename(e=this.cwd){return"string"==typeof e&&(e=this.cwd.resolve(e)),e.name}dirname(e=this.cwd){return"string"==typeof e&&(e=this.cwd.resolve(e)),(e.parent||e).fullpath()}async readdir(e=this.cwd,t={withFileTypes:!0}){"string"==typeof e?e=this.cwd.resolve(e):e instanceof O||(t=e,e=this.cwd);let{withFileTypes:r}=t;if(e.canReaddir()){let t=await e.readdir();return r?t:t.map(e=>e.name)}return[]}readdirSync(e=this.cwd,t={withFileTypes:!0}){"string"==typeof e?e=this.cwd.resolve(e):e instanceof O||(t=e,e=this.cwd);let{withFileTypes:r=!0}=t;return e.canReaddir()?r?e.readdirSync():e.readdirSync().map(e=>e.name):[]}async lstat(e=this.cwd){return"string"==typeof e&&(e=this.cwd.resolve(e)),e.lstat()}lstatSync(e=this.cwd){return"string"==typeof e&&(e=this.cwd.resolve(e)),e.lstatSync()}async readlink(e=this.cwd,{withFileTypes:t}={withFileTypes:!1}){"string"==typeof e?e=this.cwd.resolve(e):e instanceof O||(t=e.withFileTypes,e=this.cwd);let r=await e.readlink();return t?r:r?.fullpath()}readlinkSync(e=this.cwd,{withFileTypes:t}={withFileTypes:!1}){"string"==typeof e?e=this.cwd.resolve(e):e instanceof O||(t=e.withFileTypes,e=this.cwd);let r=e.readlinkSync();return t?r:r?.fullpath()}async realpath(e=this.cwd,{withFileTypes:t}={withFileTypes:!1}){"string"==typeof e?e=this.cwd.resolve(e):e instanceof O||(t=e.withFileTypes,e=this.cwd);let r=await e.realpath();return t?r:r?.fullpath()}realpathSync(e=this.cwd,{withFileTypes:t}={withFileTypes:!1}){"string"==typeof e?e=this.cwd.resolve(e):e instanceof O||(t=e.withFileTypes,e=this.cwd);let r=e.realpathSync();return t?r:r?.fullpath()}async walk(e=this.cwd,t={}){"string"==typeof e?e=this.cwd.resolve(e):e instanceof O||(t=e,e=this.cwd);let{withFileTypes:r=!0,follow:i=!1,filter:n,walkFilter:s}=t,a=[];(!n||n(e))&&a.push(r?e:e.fullpath());let o=new Set,l=(e,t)=>{o.add(e),e.readdirCB((e,c)=>{if(e)return t(e);let u=c.length;if(!u)return t();let d=()=>{0===--u&&t()};for(let e of c)(!n||n(e))&&a.push(r?e:e.fullpath()),i&&e.isSymbolicLink()?e.realpath().then(e=>e?.isUnknown()?e.lstat():e).then(e=>e?.shouldWalk(o,s)?l(e,d):d()):e.shouldWalk(o,s)?l(e,d):d()},!0)},c=e;return new Promise((e,t)=>{l(c,r=>{if(r)return t(r);e(a)})})}walkSync(e=this.cwd,t={}){"string"==typeof e?e=this.cwd.resolve(e):e instanceof O||(t=e,e=this.cwd);let{withFileTypes:r=!0,follow:i=!1,filter:n,walkFilter:s}=t,a=[];(!n||n(e))&&a.push(r?e:e.fullpath());let o=new Set([e]);for(let e of o){let t=e.readdirSync();for(let e of t){(!n||n(e))&&a.push(r?e:e.fullpath());let t=e;if(e.isSymbolicLink()){if(!i||!(t=e.realpathSync()))continue;t.isUnknown()&&t.lstatSync()}t.shouldWalk(o,s)&&o.add(t)}}return a}[Symbol.asyncIterator](){return this.iterate()}iterate(e=this.cwd,t={}){return"string"==typeof e?e=this.cwd.resolve(e):e instanceof O||(t=e,e=this.cwd),this.stream(e,t)[Symbol.asyncIterator]()}[Symbol.iterator](){return this.iterateSync()}*iterateSync(e=this.cwd,t={}){"string"==typeof e?e=this.cwd.resolve(e):e instanceof O||(t=e,e=this.cwd);let{withFileTypes:r=!0,follow:i=!1,filter:n,walkFilter:s}=t;(!n||n(e))&&(yield r?e:e.fullpath());let a=new Set([e]);for(let e of a){let t=e.readdirSync();for(let e of t){(!n||n(e))&&(yield r?e:e.fullpath());let t=e;if(e.isSymbolicLink()){if(!i||!(t=e.realpathSync()))continue;t.isUnknown()&&t.lstatSync()}t.shouldWalk(a,s)&&a.add(t)}}}stream(e=this.cwd,t={}){"string"==typeof e?e=this.cwd.resolve(e):e instanceof O||(t=e,e=this.cwd);let{withFileTypes:r=!0,follow:i=!1,filter:n,walkFilter:s}=t,a=new p.Minipass({objectMode:!0});(!n||n(e))&&a.write(r?e:e.fullpath());let o=new Set,l=[e],c=0,u=()=>{let e=!1;for(;!e;){let t=l.shift();if(!t)return void(0===c&&a.end());c++,o.add(t);let d=(t,h,f=!1)=>{if(t)return a.emit("error",t);if(i&&!f){let e=[];for(let t of h)t.isSymbolicLink()&&e.push(t.realpath().then(e=>e?.isUnknown()?e.lstat():e));if(e.length)return void Promise.all(e).then(()=>d(null,h,!0))}for(let t of h)t&&(!n||n(t))&&(a.write(r?t:t.fullpath())||(e=!0));c--;for(let e of h){let t=e.realpathCached()||e;t.shouldWalk(o,s)&&l.push(t)}e&&!a.flowing?a.once("drain",u):p||u()},p=!0;t.readdirCB(d,!0),p=!1}};return u(),a}streamSync(e=this.cwd,t={}){"string"==typeof e?e=this.cwd.resolve(e):e instanceof O||(t=e,e=this.cwd);let{withFileTypes:r=!0,follow:i=!1,filter:n,walkFilter:s}=t,a=new p.Minipass({objectMode:!0}),o=new Set;(!n||n(e))&&a.write(r?e:e.fullpath());let l=[e],c=0,u=()=>{let e=!1;for(;!e;){let t=l.shift();if(!t)return void(0===c&&a.end());c++,o.add(t);let u=t.readdirSync();for(let t of u)(!n||n(t))&&(a.write(r?t:t.fullpath())||(e=!0));c--;for(let e of u){let t=e;if(e.isSymbolicLink()){if(!i||!(t=e.realpathSync()))continue;t.isUnknown()&&t.lstatSync()}t.shouldWalk(o,s)&&l.push(t)}}e&&!a.flowing&&a.once("drain",u)};return u(),a}chdir(e=this.cwd){let t=this.cwd;this.cwd="string"==typeof e?this.cwd.resolve(e):e,this.cwd[R](t)}};e.PathScurryBase=A;var N=class extends A{sep="\\";constructor(e=process.cwd(),t={}){let{nocase:r=!0}=t;super(e,s.win32,"\\",{...t,nocase:r}),this.nocase=r;for(let e=this.cwd;e;e=e.parent)e.nocase=this.nocase}parseRootPath(e){return s.win32.parse(e).root.toUpperCase()}newRoot(e){return new $(this.rootPath,4,void 0,this.roots,this.nocase,this.childrenCache(),{fs:e})}isAbsolute(e){return e.startsWith("/")||e.startsWith("\\")||/^[a-z]:(\/|\\)/i.test(e)}};e.PathScurryWin32=N;var I=class extends A{sep="/";constructor(e=process.cwd(),t={}){let{nocase:r=!1}=t;super(e,s.posix,"/",{...t,nocase:r}),this.nocase=r}parseRootPath(e){return"/"}newRoot(e){return new C(this.rootPath,4,void 0,this.roots,this.nocase,this.childrenCache(),{fs:e})}isAbsolute(e){return e.startsWith("/")}};e.PathScurryPosix=I;var j=class extends I{constructor(e=process.cwd(),t={}){let{nocase:r=!0}=t;super(e,{...t,nocase:r})}};e.PathScurryDarwin=j,e.Path="win32"===process.platform?$:C,e.PathScurry="win32"===process.platform?N:"darwin"===process.platform?j:I}),jn=u(e=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Pattern=void 0;var t=Cn();e.Pattern=class e{#e;#t;#r;length;#i;#n;#l;#a;#o;#c;#s=!0;constructor(e,t,r,i){if(!(e=>e.length>=1)(e))throw new TypeError("empty pattern list");if(!(e=>e.length>=1)(t))throw new TypeError("empty glob list");if(t.length!==e.length)throw new TypeError("mismatched pattern list and glob list lengths");if(this.length=e.length,r<0||r>=this.length)throw new TypeError("index out of range");if(this.#e=e,this.#t=t,this.#r=r,this.#i=i,0===this.#r)if(this.isUNC()){let[e,t,r,i,...n]=this.#e,[s,a,o,l,...c]=this.#t;""===n[0]&&(n.shift(),c.shift());let u=[e,t,r,i,""].join("/"),d=[s,a,o,l,""].join("/");this.#e=[u,...n],this.#t=[d,...c],this.length=this.#e.length}else if(this.isDrive()||this.isAbsolute()){let[e,...t]=this.#e,[r,...i]=this.#t;""===t[0]&&(t.shift(),i.shift());let n=r+"/";this.#e=[e+"/",...t],this.#t=[n,...i],this.length=this.#e.length}}pattern(){return this.#e[this.#r]}isString(){return"string"==typeof this.#e[this.#r]}isGlobstar(){return this.#e[this.#r]===t.GLOBSTAR}isRegExp(){return this.#e[this.#r]instanceof RegExp}globString(){return this.#l=this.#l||(0===this.#r?this.isAbsolute()?this.#t[0]+this.#t.slice(1).join("/"):this.#t.join("/"):this.#t.slice(this.#r).join("/"))}hasMore(){return this.length>this.#r+1}rest(){return void 0!==this.#n?this.#n:this.hasMore()?(this.#n=new e(this.#e,this.#t,this.#r+1,this.#i),this.#n.#c=this.#c,this.#n.#o=this.#o,this.#n.#a=this.#a,this.#n):this.#n=null}isUNC(){let e=this.#e;return void 0!==this.#o?this.#o:this.#o="win32"===this.#i&&0===this.#r&&""===e[0]&&""===e[1]&&"string"==typeof e[2]&&!!e[2]&&"string"==typeof e[3]&&!!e[3]}isDrive(){let e=this.#e;return void 0!==this.#a?this.#a:this.#a="win32"===this.#i&&0===this.#r&&this.length>1&&"string"==typeof e[0]&&/^[a-z]:$/i.test(e[0])}isAbsolute(){let e=this.#e;return void 0!==this.#c?this.#c:this.#c=""===e[0]&&e.length>1||this.isDrive()||this.isUNC()}root(){let e=this.#e[0];return"string"==typeof e&&this.isAbsolute()&&0===this.#r?e:""}checkFollowGlobstar(){return!(0===this.#r||!this.isGlobstar()||!this.#s)}markFollowGlobstar(){return!(0===this.#r||!this.isGlobstar()||!this.#s||(this.#s=!1,0))}}}),Ln=u(e=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Ignore=void 0;var t=Cn(),r=jn(),i="object"==typeof process&&process&&"string"==typeof process.platform?process.platform:"linux";e.Ignore=class{relative;relativeChildren;absolute;absoluteChildren;platform;mmopts;constructor(e,{nobrace:t,nocase:r,noext:n,noglobstar:s,platform:a=i}){this.relative=[],this.absolute=[],this.relativeChildren=[],this.absoluteChildren=[],this.platform=a,this.mmopts={dot:!0,nobrace:t,nocase:r,noext:n,noglobstar:s,optimizationLevel:2,platform:a,nocomment:!0,nonegate:!0};for(let t of e)this.add(t)}add(e){let i=new t.Minimatch(e,this.mmopts);for(let e=0;e<i.set.length;e++){let n=i.set[e],s=i.globParts[e];if(!n||!s)throw new Error("invalid pattern object");for(;"."===n[0]&&"."===s[0];)n.shift(),s.shift();let a=new r.Pattern(n,s,0,this.platform),o=new t.Minimatch(a.globString(),this.mmopts),l="**"===s[s.length-1],c=a.isAbsolute();c?this.absolute.push(o):this.relative.push(o),l&&(c?this.absoluteChildren.push(o):this.relativeChildren.push(o))}}ignored(e){let t=e.fullpath(),r=`${t}/`,i=e.relative()||".",n=`${i}/`;for(let e of this.relative)if(e.match(i)||e.match(n))return!0;for(let e of this.absolute)if(e.match(t)||e.match(r))return!0;return!1}childrenIgnored(e){let t=e.fullpath()+"/",r=(e.relative()||".")+"/";for(let e of this.relativeChildren)if(e.match(r))return!0;for(let e of this.absoluteChildren)if(e.match(t))return!0;return!1}}}),Dn=u(e=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Processor=e.SubWalks=e.MatchRecord=e.HasWalkedCache=void 0;var t=Cn(),r=class e{store;constructor(e=new Map){this.store=e}copy(){return new e(new Map(this.store))}hasWalked(e,t){return this.store.get(e.fullpath())?.has(t.globString())}storeWalked(e,t){let r=e.fullpath(),i=this.store.get(r);i?i.add(t.globString()):this.store.set(r,new Set([t.globString()]))}};e.HasWalkedCache=r;var i=class{store=new Map;add(e,t,r){let i=(t?2:0)|(r?1:0),n=this.store.get(e);this.store.set(e,void 0===n?i:i&n)}entries(){return[...this.store.entries()].map(([e,t])=>[e,!!(2&t),!!(1&t)])}};e.MatchRecord=i;var n=class{store=new Map;add(e,t){if(!e.canReaddir())return;let r=this.store.get(e);r?r.find(e=>e.globString()===t.globString())||r.push(t):this.store.set(e,[t])}get(e){let t=this.store.get(e);if(!t)throw new Error("attempting to walk unknown path");return t}entries(){return this.keys().map(e=>[e,this.store.get(e)])}keys(){return[...this.store.keys()].filter(e=>e.canReaddir())}};e.SubWalks=n,e.Processor=class e{hasWalkedCache;matches=new i;subwalks=new n;patterns;follow;dot;opts;constructor(e,t){this.opts=e,this.follow=!!e.follow,this.dot=!!e.dot,this.hasWalkedCache=t?t.copy():new r}processPatterns(e,r){this.patterns=r;let i=r.map(t=>[e,t]);for(let[e,r]of i){this.hasWalkedCache.storeWalked(e,r);let i=r.root(),n=r.isAbsolute()&&!1!==this.opts.absolute;if(i){e=e.resolve("/"===i&&void 0!==this.opts.root?this.opts.root:i);let t=r.rest();if(!t){this.matches.add(e,!0,!1);continue}r=t}if(e.isENOENT())continue;let s,a,o=!1;for(;"string"==typeof(s=r.pattern())&&(a=r.rest());)e=e.resolve(s),r=a,o=!0;if(s=r.pattern(),a=r.rest(),o){if(this.hasWalkedCache.hasWalked(e,r))continue;this.hasWalkedCache.storeWalked(e,r)}if("string"==typeof s){let t=".."===s||""===s||"."===s;this.matches.add(e.resolve(s),n,t);continue}if(s===t.GLOBSTAR){(!e.isSymbolicLink()||this.follow||r.checkFollowGlobstar())&&this.subwalks.add(e,r);let t=a?.pattern(),i=a?.rest();if(a&&(""!==t&&"."!==t||i)){if(".."===t){let t=e.parent||e;i?this.hasWalkedCache.hasWalked(t,i)||this.subwalks.add(t,i):this.matches.add(t,n,!0)}}else this.matches.add(e,n,""===t||"."===t)}else s instanceof RegExp&&this.subwalks.add(e,r)}return this}subwalkTargets(){return this.subwalks.keys()}child(){return new e(this.opts,this.hasWalkedCache)}filterEntries(e,r){let i=this.subwalks.get(e),n=this.child();for(let e of r)for(let r of i){let i=r.isAbsolute(),s=r.pattern(),a=r.rest();s===t.GLOBSTAR?n.testGlobstar(e,r,a,i):s instanceof RegExp?n.testRegExp(e,s,a,i):n.testString(e,s,a,i)}return n}testGlobstar(e,t,r,i){if((this.dot||!e.name.startsWith("."))&&(t.hasMore()||this.matches.add(e,i,!1),e.canReaddir()&&(this.follow||!e.isSymbolicLink()?this.subwalks.add(e,t):e.isSymbolicLink()&&(r&&t.checkFollowGlobstar()?this.subwalks.add(e,r):t.markFollowGlobstar()&&this.subwalks.add(e,t)))),r){let t=r.pattern();"string"==typeof t&&".."!==t&&""!==t&&"."!==t?this.testString(e,t,r.rest(),i):".."===t?this.subwalks.add(e.parent||e,r):t instanceof RegExp&&this.testRegExp(e,t,r.rest(),i)}}testRegExp(e,t,r,i){t.test(e.name)&&(r?this.subwalks.add(e,r):this.matches.add(e,i,!1))}testString(e,t,r,i){e.isNamed(t)&&(r?this.subwalks.add(e,r):this.matches.add(e,i,!1))}}}),Fn=u(e=>{Object.defineProperty(e,"__esModule",{value:!0}),e.GlobStream=e.GlobWalker=e.GlobUtil=void 0;var t=Nn(),r=Ln(),i=Dn(),n=class{path;patterns;opts;seen=new Set;paused=!1;aborted=!1;#e=[];#t;#r;signal;maxDepth;includeChildMatches;constructor(e,t,i){if(this.patterns=e,this.path=t,this.opts=i,this.#r=i.posix||"win32"!==i.platform?"/":"\\",this.includeChildMatches=!1!==i.includeChildMatches,(i.ignore||!this.includeChildMatches)&&(this.#t=((e,t)=>"string"==typeof e?new r.Ignore([e],t):Array.isArray(e)?new r.Ignore(e,t):e)(i.ignore??[],i),!this.includeChildMatches&&"function"!=typeof this.#t.add))throw new Error("cannot ignore child matches, ignore lacks add() method.");this.maxDepth=i.maxDepth||1/0,i.signal&&(this.signal=i.signal,this.signal.addEventListener("abort",()=>{this.#e.length=0}))}#i(e){return this.seen.has(e)||!!this.#t?.ignored?.(e)}#n(e){return!!this.#t?.childrenIgnored?.(e)}pause(){this.paused=!0}resume(){if(this.signal?.aborted)return;let e;for(this.paused=!1;!this.paused&&(e=this.#e.shift());)e()}onResume(e){this.signal?.aborted||(this.paused?this.#e.push(e):e())}async matchCheck(e,t){if(t&&this.opts.nodir)return;let r;if(this.opts.realpath){if(r=e.realpathCached()||await e.realpath(),!r)return;e=r}let i=e.isUnknown()||this.opts.stat?await e.lstat():e;if(this.opts.follow&&this.opts.nodir&&i?.isSymbolicLink()){let e=await i.realpath();e&&(e.isUnknown()||this.opts.stat)&&await e.lstat()}return this.matchCheckTest(i,t)}matchCheckTest(e,t){return!e||!(this.maxDepth===1/0||e.depth()<=this.maxDepth)||t&&!e.canReaddir()||this.opts.nodir&&e.isDirectory()||this.opts.nodir&&this.opts.follow&&e.isSymbolicLink()&&e.realpathCached()?.isDirectory()||this.#i(e)?void 0:e}matchCheckSync(e,t){if(t&&this.opts.nodir)return;let r;if(this.opts.realpath){if(r=e.realpathCached()||e.realpathSync(),!r)return;e=r}let i=e.isUnknown()||this.opts.stat?e.lstatSync():e;if(this.opts.follow&&this.opts.nodir&&i?.isSymbolicLink()){let e=i.realpathSync();e&&(e?.isUnknown()||this.opts.stat)&&e.lstatSync()}return this.matchCheckTest(i,t)}matchFinish(e,t){if(this.#i(e))return;if(!this.includeChildMatches&&this.#t?.add){let t=`${e.relativePosix()}/**`;this.#t.add(t)}let r=void 0===this.opts.absolute?t:this.opts.absolute;this.seen.add(e);let i=this.opts.mark&&e.isDirectory()?this.#r:"";if(this.opts.withFileTypes)this.matchEmit(e);else if(r){let t=this.opts.posix?e.fullpathPosix():e.fullpath();this.matchEmit(t+i)}else{let t=this.opts.posix?e.relativePosix():e.relative(),r=this.opts.dotRelative&&!t.startsWith(".."+this.#r)?"."+this.#r:"";this.matchEmit(t?r+t+i:"."+i)}}async match(e,t,r){let i=await this.matchCheck(e,r);i&&this.matchFinish(i,t)}matchSync(e,t,r){let i=this.matchCheckSync(e,r);i&&this.matchFinish(i,t)}walkCB(e,t,r){this.signal?.aborted&&r(),this.walkCB2(e,t,new i.Processor(this.opts),r)}walkCB2(e,t,r,i){if(this.#n(e))return i();if(this.signal?.aborted&&i(),this.paused)return void this.onResume(()=>this.walkCB2(e,t,r,i));r.processPatterns(e,t);let n=1,s=()=>{0===--n&&i()};for(let[e,t,i]of r.matches.entries())this.#i(e)||(n++,this.match(e,t,i).then(()=>s()));for(let e of r.subwalkTargets()){if(this.maxDepth!==1/0&&e.depth()>=this.maxDepth)continue;n++;let t=e.readdirCached();e.calledReaddir()?this.walkCB3(e,t,r,s):e.readdirCB((t,i)=>this.walkCB3(e,i,r,s),!0)}s()}walkCB3(e,t,r,i){r=r.filterEntries(e,t);let n=1,s=()=>{0===--n&&i()};for(let[e,t,i]of r.matches.entries())this.#i(e)||(n++,this.match(e,t,i).then(()=>s()));for(let[e,t]of r.subwalks.entries())n++,this.walkCB2(e,t,r.child(),s);s()}walkCBSync(e,t,r){this.signal?.aborted&&r(),this.walkCB2Sync(e,t,new i.Processor(this.opts),r)}walkCB2Sync(e,t,r,i){if(this.#n(e))return i();if(this.signal?.aborted&&i(),this.paused)return void this.onResume(()=>this.walkCB2Sync(e,t,r,i));r.processPatterns(e,t);let n=1,s=()=>{0===--n&&i()};for(let[e,t,i]of r.matches.entries())this.#i(e)||this.matchSync(e,t,i);for(let e of r.subwalkTargets()){if(this.maxDepth!==1/0&&e.depth()>=this.maxDepth)continue;n++;let t=e.readdirSync();this.walkCB3Sync(e,t,r,s)}s()}walkCB3Sync(e,t,r,i){r=r.filterEntries(e,t);let n=1,s=()=>{0===--n&&i()};for(let[e,t,i]of r.matches.entries())this.#i(e)||this.matchSync(e,t,i);for(let[e,t]of r.subwalks.entries())n++,this.walkCB2Sync(e,t,r.child(),s);s()}};e.GlobUtil=n,e.GlobWalker=class extends n{matches=new Set;constructor(e,t,r){super(e,t,r)}matchEmit(e){this.matches.add(e)}async walk(){if(this.signal?.aborted)throw this.signal.reason;return this.path.isUnknown()&&await this.path.lstat(),await new Promise((e,t)=>{this.walkCB(this.path,this.patterns,()=>{this.signal?.aborted?t(this.signal.reason):e(this.matches)})}),this.matches}walkSync(){if(this.signal?.aborted)throw this.signal.reason;return this.path.isUnknown()&&this.path.lstatSync(),this.walkCBSync(this.path,this.patterns,()=>{if(this.signal?.aborted)throw this.signal.reason}),this.matches}},e.GlobStream=class extends n{results;constructor(e,r,i){super(e,r,i),this.results=new t.Minipass({signal:this.signal,objectMode:!0}),this.results.on("drain",()=>this.resume()),this.results.on("resume",()=>this.resume())}matchEmit(e){this.results.write(e),this.results.flowing||this.pause()}stream(){let e=this.path;return e.isUnknown()?e.lstat().then(()=>{this.walkCB(e,this.patterns,()=>this.results.end())}):this.walkCB(e,this.patterns,()=>this.results.end()),this.results}streamSync(){return this.path.isUnknown()&&this.path.lstatSync(),this.walkCBSync(this.path,this.patterns,()=>this.results.end()),this.results}}}),Mn=u(e=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Glob=void 0;var t=Cn(),r=c("node:url"),i=In(),n=jn(),s=Fn(),a="object"==typeof process&&process&&"string"==typeof process.platform?process.platform:"linux",o=class{absolute;cwd;root;dot;dotRelative;follow;ignore;magicalBraces;mark;matchBase;maxDepth;nobrace;nocase;nodir;noext;noglobstar;pattern;platform;realpath;scurry;stat;signal;windowsPathsNoEscape;withFileTypes;includeChildMatches;opts;patterns;constructor(e,s){if(!s)throw new TypeError("glob options required");if(this.withFileTypes=!!s.withFileTypes,this.signal=s.signal,this.follow=!!s.follow,this.dot=!!s.dot,this.dotRelative=!!s.dotRelative,this.nodir=!!s.nodir,this.mark=!!s.mark,s.cwd?(s.cwd instanceof URL||s.cwd.startsWith("file://"))&&(s.cwd=(0,r.fileURLToPath)(s.cwd)):this.cwd="",this.cwd=s.cwd||"",this.root=s.root,this.magicalBraces=!!s.magicalBraces,this.nobrace=!!s.nobrace,this.noext=!!s.noext,this.realpath=!!s.realpath,this.absolute=s.absolute,this.includeChildMatches=!1!==s.includeChildMatches,this.noglobstar=!!s.noglobstar,this.matchBase=!!s.matchBase,this.maxDepth="number"==typeof s.maxDepth?s.maxDepth:1/0,this.stat=!!s.stat,this.ignore=s.ignore,this.withFileTypes&&void 0!==this.absolute)throw new Error("cannot set absolute and withFileTypes:true");if("string"==typeof e&&(e=[e]),this.windowsPathsNoEscape=!!s.windowsPathsNoEscape||!1===s.allowWindowsEscape,this.windowsPathsNoEscape&&(e=e.map(e=>e.replace(/\\/g,"/"))),this.matchBase){if(s.noglobstar)throw new TypeError("base matching requires globstar");e=e.map(e=>e.includes("/")?e:`./**/${e}`)}if(this.pattern=e,this.platform=s.platform||a,this.opts={...s,platform:this.platform},s.scurry){if(this.scurry=s.scurry,void 0!==s.nocase&&s.nocase!==s.scurry.nocase)throw new Error("nocase option contradicts provided scurry option")}else this.scurry=new("win32"===s.platform?i.PathScurryWin32:"darwin"===s.platform?i.PathScurryDarwin:s.platform?i.PathScurryPosix:i.PathScurry)(this.cwd,{nocase:s.nocase,fs:s.fs});this.nocase=this.scurry.nocase;let o="darwin"===this.platform||"win32"===this.platform,l={...s,dot:this.dot,matchBase:this.matchBase,nobrace:this.nobrace,nocase:this.nocase,nocaseMagicOnly:o,nocomment:!0,noext:this.noext,nonegate:!0,optimizationLevel:2,platform:this.platform,windowsPathsNoEscape:this.windowsPathsNoEscape,debug:!!this.opts.debug},c=this.pattern.map(e=>new t.Minimatch(e,l)),[u,d]=c.reduce((e,t)=>(e[0].push(...t.set),e[1].push(...t.globParts),e),[[],[]]);this.patterns=u.map((e,t)=>{let r=d[t];if(!r)throw new Error("invalid pattern object");return new n.Pattern(e,r,0,this.platform)})}async walk(){return[...await new s.GlobWalker(this.patterns,this.scurry.cwd,{...this.opts,maxDepth:this.maxDepth!==1/0?this.maxDepth+this.scurry.cwd.depth():1/0,platform:this.platform,nocase:this.nocase,includeChildMatches:this.includeChildMatches}).walk()]}walkSync(){return[...new s.GlobWalker(this.patterns,this.scurry.cwd,{...this.opts,maxDepth:this.maxDepth!==1/0?this.maxDepth+this.scurry.cwd.depth():1/0,platform:this.platform,nocase:this.nocase,includeChildMatches:this.includeChildMatches}).walkSync()]}stream(){return new s.GlobStream(this.patterns,this.scurry.cwd,{...this.opts,maxDepth:this.maxDepth!==1/0?this.maxDepth+this.scurry.cwd.depth():1/0,platform:this.platform,nocase:this.nocase,includeChildMatches:this.includeChildMatches}).stream()}streamSync(){return new s.GlobStream(this.patterns,this.scurry.cwd,{...this.opts,maxDepth:this.maxDepth!==1/0?this.maxDepth+this.scurry.cwd.depth():1/0,platform:this.platform,nocase:this.nocase,includeChildMatches:this.includeChildMatches}).streamSync()}iterateSync(){return this.streamSync()[Symbol.iterator]()}[Symbol.iterator](){return this.iterateSync()}iterate(){return this.stream()[Symbol.asyncIterator]()}[Symbol.asyncIterator](){return this.iterate()}};e.Glob=o}),zn=u(e=>{Object.defineProperty(e,"__esModule",{value:!0}),e.hasMagic=void 0;var t=Cn();e.hasMagic=(e,r={})=>{Array.isArray(e)||(e=[e]);for(let i of e)if(new t.Minimatch(i,r).hasMagic())return!0;return!1}}),qn=u(e=>{Object.defineProperty(e,"__esModule",{value:!0}),e.glob=e.sync=e.iterate=e.iterateSync=e.stream=e.streamSync=e.Ignore=e.hasMagic=e.Glob=e.unescape=e.escape=void 0,e.globStreamSync=l,e.globStream=c,e.globSync=u,e.globIterateSync=p,e.globIterate=h;var t=Cn(),r=Mn(),i=zn(),n=Cn();Object.defineProperty(e,"escape",{enumerable:!0,get:function(){return n.escape}}),Object.defineProperty(e,"unescape",{enumerable:!0,get:function(){return n.unescape}});var s=Mn();Object.defineProperty(e,"Glob",{enumerable:!0,get:function(){return s.Glob}});var a=zn();Object.defineProperty(e,"hasMagic",{enumerable:!0,get:function(){return a.hasMagic}});var o=Ln();function l(e,t={}){return new r.Glob(e,t).streamSync()}function c(e,t={}){return new r.Glob(e,t).stream()}function u(e,t={}){return new r.Glob(e,t).walkSync()}async function d(e,t={}){return new r.Glob(e,t).walk()}function p(e,t={}){return new r.Glob(e,t).iterateSync()}function h(e,t={}){return new r.Glob(e,t).iterate()}Object.defineProperty(e,"Ignore",{enumerable:!0,get:function(){return o.Ignore}}),e.streamSync=l,e.stream=Object.assign(c,{sync:l}),e.iterateSync=p,e.iterate=Object.assign(h,{sync:p}),e.sync=Object.assign(u,{stream:l,iterate:p}),e.glob=Object.assign(d,{glob:d,globSync:u,sync:e.sync,globStream:c,stream:e.stream,globStreamSync:l,streamSync:e.streamSync,globIterate:h,iterate:e.iterate,globIterateSync:p,iterateSync:e.iterateSync,Glob:r.Glob,hasMagic:i.hasMagic,escape:t.escape,unescape:t.unescape}),e.glob.glob=e.glob}),Un=u((e,t)=>{var r=/at\s{1}(?:.*\.)?plugin\s{1}.*\n\s*(.*)/,i=/(\w*(\.\w*)*)\..*/;function n(e){let t=e.match(r);return t?t[1].split(/[/\\]/).slice(-1)[0].match(i)[1]:"anonymous"}t.exports=function(e){if(e.name.length>0)return e.name;let t=Error.stackTraceLimit;Error.stackTraceLimit=10;try{throw new Error("anonymous function")}catch(e){return Error.stackTraceLimit=t,n(e.stack)}},t.exports.extractPluginName=n}),Bn=u((e,t)=>{t.exports=function(e){return"@"===e[0]&&(e=e.slice(1).replace("/","-")),e.replace(/-(.)/g,function(e,t){return t.toUpperCase()})}}),Hn=u((e,t)=>{var r=Un(),i=Bn(),n=0;function s(e,t={}){let s=!1;if(typeof e.default<"u"&&(e=e.default),"function"!=typeof e)throw new TypeError(`fastify-plugin expects a function, instead got a '${typeof e}'`);if("string"==typeof t&&(t={fastify:t}),"object"!=typeof t||Array.isArray(t)||null===t)throw new TypeError("The options object should be an object");if(void 0!==t.fastify&&"string"!=typeof t.fastify)throw new TypeError(`fastify-plugin expects a version string, instead got '${typeof t.fastify}'`);t.name||(s=!0,t.name=r(e)+"-auto-"+n++),e[Symbol.for("skip-override")]=!0!==t.encapsulate,e[Symbol.for("fastify.display-name")]=t.name,e[Symbol.for("plugin-meta")]=t,e.default||(e.default=e);let a=i(t.name);return!s&&!e[a]&&(e[a]=e),e}t.exports=s,t.exports.default=s,t.exports.fastifyPlugin=s}),Vn=u((e,t)=>{t.exports.isUtf8MimeType=function(e){let t=e.length;return t>21&&0===e.indexOf("application/javascript")||t>14&&0===e.indexOf("application/json")||t>5&&0===e.indexOf("text/")}}),Gn=u((e,t)=>{function r(){this._types=Object.create(null),this._extensions=Object.create(null);for(let e=0;e<arguments.length;e++)this.define(arguments[e]);this.define=this.define.bind(this),this.getType=this.getType.bind(this),this.getExtension=this.getExtension.bind(this)}r.prototype.define=function(e,t){for(let r in e){let i=e[r].map(function(e){return e.toLowerCase()});r=r.toLowerCase();for(let e=0;e<i.length;e++){let n=i[e];if("*"!==n[0]){if(!t&&n in this._types)throw new Error('Attempt to change mapping for "'+n+'" extension from "'+this._types[n]+'" to "'+r+'". Pass `force=true` to allow this, otherwise remove "'+n+'" from the list of extensions for "'+r+'".');this._types[n]=r}}if(t||!this._extensions[r]){let e=i[0];this._extensions[r]="*"!==e[0]?e:e.substr(1)}}},r.prototype.getType=function(e){let t=(e=String(e)).replace(/^.*[/\\]/,"").toLowerCase(),r=t.replace(/^.*\./,"").toLowerCase();return(r.length<t.length-1||!(t.length<e.length))&&this._types[r]||null},r.prototype.getExtension=function(e){return(e=/^\s*([^;\s]*)/.test(e)&&RegExp.$1)&&this._extensions[e.toLowerCase()]||null},t.exports=r}),Wn=u((e,t)=>{t.exports={"application/andrew-inset":["ez"],"application/applixware":["aw"],"application/atom+xml":["atom"],"application/atomcat+xml":["atomcat"],"application/atomdeleted+xml":["atomdeleted"],"application/atomsvc+xml":["atomsvc"],"application/atsc-dwd+xml":["dwd"],"application/atsc-held+xml":["held"],"application/atsc-rsat+xml":["rsat"],"application/bdoc":["bdoc"],"application/calendar+xml":["xcs"],"application/ccxml+xml":["ccxml"],"application/cdfx+xml":["cdfx"],"application/cdmi-capability":["cdmia"],"application/cdmi-container":["cdmic"],"application/cdmi-domain":["cdmid"],"application/cdmi-object":["cdmio"],"application/cdmi-queue":["cdmiq"],"application/cu-seeme":["cu"],"application/dash+xml":["mpd"],"application/davmount+xml":["davmount"],"application/docbook+xml":["dbk"],"application/dssc+der":["dssc"],"application/dssc+xml":["xdssc"],"application/ecmascript":["es","ecma"],"application/emma+xml":["emma"],"application/emotionml+xml":["emotionml"],"application/epub+zip":["epub"],"application/exi":["exi"],"application/express":["exp"],"application/fdt+xml":["fdt"],"application/font-tdpfr":["pfr"],"application/geo+json":["geojson"],"application/gml+xml":["gml"],"application/gpx+xml":["gpx"],"application/gxf":["gxf"],"application/gzip":["gz"],"application/hjson":["hjson"],"application/hyperstudio":["stk"],"application/inkml+xml":["ink","inkml"],"application/ipfix":["ipfix"],"application/its+xml":["its"],"application/java-archive":["jar","war","ear"],"application/java-serialized-object":["ser"],"application/java-vm":["class"],"application/javascript":["js","mjs"],"application/json":["json","map"],"application/json5":["json5"],"application/jsonml+json":["jsonml"],"application/ld+json":["jsonld"],"application/lgr+xml":["lgr"],"application/lost+xml":["lostxml"],"application/mac-binhex40":["hqx"],"application/mac-compactpro":["cpt"],"application/mads+xml":["mads"],"application/manifest+json":["webmanifest"],"application/marc":["mrc"],"application/marcxml+xml":["mrcx"],"application/mathematica":["ma","nb","mb"],"application/mathml+xml":["mathml"],"application/mbox":["mbox"],"application/mediaservercontrol+xml":["mscml"],"application/metalink+xml":["metalink"],"application/metalink4+xml":["meta4"],"application/mets+xml":["mets"],"application/mmt-aei+xml":["maei"],"application/mmt-usd+xml":["musd"],"application/mods+xml":["mods"],"application/mp21":["m21","mp21"],"application/mp4":["mp4s","m4p"],"application/msword":["doc","dot"],"application/mxf":["mxf"],"application/n-quads":["nq"],"application/n-triples":["nt"],"application/node":["cjs"],"application/octet-stream":["bin","dms","lrf","mar","so","dist","distz","pkg","bpk","dump","elc","deploy","exe","dll","deb","dmg","iso","img","msi","msp","msm","buffer"],"application/oda":["oda"],"application/oebps-package+xml":["opf"],"application/ogg":["ogx"],"application/omdoc+xml":["omdoc"],"application/onenote":["onetoc","onetoc2","onetmp","onepkg"],"application/oxps":["oxps"],"application/p2p-overlay+xml":["relo"],"application/patch-ops-error+xml":["xer"],"application/pdf":["pdf"],"application/pgp-encrypted":["pgp"],"application/pgp-signature":["asc","sig"],"application/pics-rules":["prf"],"application/pkcs10":["p10"],"application/pkcs7-mime":["p7m","p7c"],"application/pkcs7-signature":["p7s"],"application/pkcs8":["p8"],"application/pkix-attr-cert":["ac"],"application/pkix-cert":["cer"],"application/pkix-crl":["crl"],"application/pkix-pkipath":["pkipath"],"application/pkixcmp":["pki"],"application/pls+xml":["pls"],"application/postscript":["ai","eps","ps"],"application/provenance+xml":["provx"],"application/pskc+xml":["pskcxml"],"application/raml+yaml":["raml"],"application/rdf+xml":["rdf","owl"],"application/reginfo+xml":["rif"],"application/relax-ng-compact-syntax":["rnc"],"application/resource-lists+xml":["rl"],"application/resource-lists-diff+xml":["rld"],"application/rls-services+xml":["rs"],"application/route-apd+xml":["rapd"],"application/route-s-tsid+xml":["sls"],"application/route-usd+xml":["rusd"],"application/rpki-ghostbusters":["gbr"],"application/rpki-manifest":["mft"],"application/rpki-roa":["roa"],"application/rsd+xml":["rsd"],"application/rss+xml":["rss"],"application/rtf":["rtf"],"application/sbml+xml":["sbml"],"application/scvp-cv-request":["scq"],"application/scvp-cv-response":["scs"],"application/scvp-vp-request":["spq"],"application/scvp-vp-response":["spp"],"application/sdp":["sdp"],"application/senml+xml":["senmlx"],"application/sensml+xml":["sensmlx"],"application/set-payment-initiation":["setpay"],"application/set-registration-initiation":["setreg"],"application/shf+xml":["shf"],"application/sieve":["siv","sieve"],"application/smil+xml":["smi","smil"],"application/sparql-query":["rq"],"application/sparql-results+xml":["srx"],"application/srgs":["gram"],"application/srgs+xml":["grxml"],"application/sru+xml":["sru"],"application/ssdl+xml":["ssdl"],"application/ssml+xml":["ssml"],"application/swid+xml":["swidtag"],"application/tei+xml":["tei","teicorpus"],"application/thraud+xml":["tfi"],"application/timestamped-data":["tsd"],"application/toml":["toml"],"application/trig":["trig"],"application/ttml+xml":["ttml"],"application/ubjson":["ubj"],"application/urc-ressheet+xml":["rsheet"],"application/urc-targetdesc+xml":["td"],"application/voicexml+xml":["vxml"],"application/wasm":["wasm"],"application/widget":["wgt"],"application/winhlp":["hlp"],"application/wsdl+xml":["wsdl"],"application/wspolicy+xml":["wspolicy"],"application/xaml+xml":["xaml"],"application/xcap-att+xml":["xav"],"application/xcap-caps+xml":["xca"],"application/xcap-diff+xml":["xdf"],"application/xcap-el+xml":["xel"],"application/xcap-ns+xml":["xns"],"application/xenc+xml":["xenc"],"application/xhtml+xml":["xhtml","xht"],"application/xliff+xml":["xlf"],"application/xml":["xml","xsl","xsd","rng"],"application/xml-dtd":["dtd"],"application/xop+xml":["xop"],"application/xproc+xml":["xpl"],"application/xslt+xml":["*xsl","xslt"],"application/xspf+xml":["xspf"],"application/xv+xml":["mxml","xhvml","xvml","xvm"],"application/yang":["yang"],"application/yin+xml":["yin"],"application/zip":["zip"],"audio/3gpp":["*3gpp"],"audio/adpcm":["adp"],"audio/amr":["amr"],"audio/basic":["au","snd"],"audio/midi":["mid","midi","kar","rmi"],"audio/mobile-xmf":["mxmf"],"audio/mp3":["*mp3"],"audio/mp4":["m4a","mp4a"],"audio/mpeg":["mpga","mp2","mp2a","mp3","m2a","m3a"],"audio/ogg":["oga","ogg","spx","opus"],"audio/s3m":["s3m"],"audio/silk":["sil"],"audio/wav":["wav"],"audio/wave":["*wav"],"audio/webm":["weba"],"audio/xm":["xm"],"font/collection":["ttc"],"font/otf":["otf"],"font/ttf":["ttf"],"font/woff":["woff"],"font/woff2":["woff2"],"image/aces":["exr"],"image/apng":["apng"],"image/avif":["avif"],"image/bmp":["bmp"],"image/cgm":["cgm"],"image/dicom-rle":["drle"],"image/emf":["emf"],"image/fits":["fits"],"image/g3fax":["g3"],"image/gif":["gif"],"image/heic":["heic"],"image/heic-sequence":["heics"],"image/heif":["heif"],"image/heif-sequence":["heifs"],"image/hej2k":["hej2"],"image/hsj2":["hsj2"],"image/ief":["ief"],"image/jls":["jls"],"image/jp2":["jp2","jpg2"],"image/jpeg":["jpeg","jpg","jpe"],"image/jph":["jph"],"image/jphc":["jhc"],"image/jpm":["jpm"],"image/jpx":["jpx","jpf"],"image/jxr":["jxr"],"image/jxra":["jxra"],"image/jxrs":["jxrs"],"image/jxs":["jxs"],"image/jxsc":["jxsc"],"image/jxsi":["jxsi"],"image/jxss":["jxss"],"image/ktx":["ktx"],"image/ktx2":["ktx2"],"image/png":["png"],"image/sgi":["sgi"],"image/svg+xml":["svg","svgz"],"image/t38":["t38"],"image/tiff":["tif","tiff"],"image/tiff-fx":["tfx"],"image/webp":["webp"],"image/wmf":["wmf"],"message/disposition-notification":["disposition-notification"],"message/global":["u8msg"],"message/global-delivery-status":["u8dsn"],"message/global-disposition-notification":["u8mdn"],"message/global-headers":["u8hdr"],"message/rfc822":["eml","mime"],"model/3mf":["3mf"],"model/gltf+json":["gltf"],"model/gltf-binary":["glb"],"model/iges":["igs","iges"],"model/mesh":["msh","mesh","silo"],"model/mtl":["mtl"],"model/obj":["obj"],"model/step+xml":["stpx"],"model/step+zip":["stpz"],"model/step-xml+zip":["stpxz"],"model/stl":["stl"],"model/vrml":["wrl","vrml"],"model/x3d+binary":["*x3db","x3dbz"],"model/x3d+fastinfoset":["x3db"],"model/x3d+vrml":["*x3dv","x3dvz"],"model/x3d+xml":["x3d","x3dz"],"model/x3d-vrml":["x3dv"],"text/cache-manifest":["appcache","manifest"],"text/calendar":["ics","ifb"],"text/coffeescript":["coffee","litcoffee"],"text/css":["css"],"text/csv":["csv"],"text/html":["html","htm","shtml"],"text/jade":["jade"],"text/jsx":["jsx"],"text/less":["less"],"text/markdown":["markdown","md"],"text/mathml":["mml"],"text/mdx":["mdx"],"text/n3":["n3"],"text/plain":["txt","text","conf","def","list","log","in","ini"],"text/richtext":["rtx"],"text/rtf":["*rtf"],"text/sgml":["sgml","sgm"],"text/shex":["shex"],"text/slim":["slim","slm"],"text/spdx":["spdx"],"text/stylus":["stylus","styl"],"text/tab-separated-values":["tsv"],"text/troff":["t","tr","roff","man","me","ms"],"text/turtle":["ttl"],"text/uri-list":["uri","uris","urls"],"text/vcard":["vcard"],"text/vtt":["vtt"],"text/xml":["*xml"],"text/yaml":["yaml","yml"],"video/3gpp":["3gp","3gpp"],"video/3gpp2":["3g2"],"video/h261":["h261"],"video/h263":["h263"],"video/h264":["h264"],"video/iso.segment":["m4s"],"video/jpeg":["jpgv"],"video/jpm":["*jpm","jpgm"],"video/mj2":["mj2","mjp2"],"video/mp2t":["ts"],"video/mp4":["mp4","mp4v","mpg4"],"video/mpeg":["mpeg","mpg","mpe","m1v","m2v"],"video/ogg":["ogv"],"video/quicktime":["qt","mov"],"video/webm":["webm"]}}),Kn=u((e,t)=>{t.exports={"application/prs.cww":["cww"],"application/vnd.1000minds.decision-model+xml":["1km"],"application/vnd.3gpp.pic-bw-large":["plb"],"application/vnd.3gpp.pic-bw-small":["psb"],"application/vnd.3gpp.pic-bw-var":["pvb"],"application/vnd.3gpp2.tcap":["tcap"],"application/vnd.3m.post-it-notes":["pwn"],"application/vnd.accpac.simply.aso":["aso"],"application/vnd.accpac.simply.imp":["imp"],"application/vnd.acucobol":["acu"],"application/vnd.acucorp":["atc","acutc"],"application/vnd.adobe.air-application-installer-package+zip":["air"],"application/vnd.adobe.formscentral.fcdt":["fcdt"],"application/vnd.adobe.fxp":["fxp","fxpl"],"application/vnd.adobe.xdp+xml":["xdp"],"application/vnd.adobe.xfdf":["xfdf"],"application/vnd.ahead.space":["ahead"],"application/vnd.airzip.filesecure.azf":["azf"],"application/vnd.airzip.filesecure.azs":["azs"],"application/vnd.amazon.ebook":["azw"],"application/vnd.americandynamics.acc":["acc"],"application/vnd.amiga.ami":["ami"],"application/vnd.android.package-archive":["apk"],"application/vnd.anser-web-certificate-issue-initiation":["cii"],"application/vnd.anser-web-funds-transfer-initiation":["fti"],"application/vnd.antix.game-component":["atx"],"application/vnd.apple.installer+xml":["mpkg"],"application/vnd.apple.keynote":["key"],"application/vnd.apple.mpegurl":["m3u8"],"application/vnd.apple.numbers":["numbers"],"application/vnd.apple.pages":["pages"],"application/vnd.apple.pkpass":["pkpass"],"application/vnd.aristanetworks.swi":["swi"],"application/vnd.astraea-software.iota":["iota"],"application/vnd.audiograph":["aep"],"application/vnd.balsamiq.bmml+xml":["bmml"],"application/vnd.blueice.multipass":["mpm"],"application/vnd.bmi":["bmi"],"application/vnd.businessobjects":["rep"],"application/vnd.chemdraw+xml":["cdxml"],"application/vnd.chipnuts.karaoke-mmd":["mmd"],"application/vnd.cinderella":["cdy"],"application/vnd.citationstyles.style+xml":["csl"],"application/vnd.claymore":["cla"],"application/vnd.cloanto.rp9":["rp9"],"application/vnd.clonk.c4group":["c4g","c4d","c4f","c4p","c4u"],"application/vnd.cluetrust.cartomobile-config":["c11amc"],"application/vnd.cluetrust.cartomobile-config-pkg":["c11amz"],"application/vnd.commonspace":["csp"],"application/vnd.contact.cmsg":["cdbcmsg"],"application/vnd.cosmocaller":["cmc"],"application/vnd.crick.clicker":["clkx"],"application/vnd.crick.clicker.keyboard":["clkk"],"application/vnd.crick.clicker.palette":["clkp"],"application/vnd.crick.clicker.template":["clkt"],"application/vnd.crick.clicker.wordbank":["clkw"],"application/vnd.criticaltools.wbs+xml":["wbs"],"application/vnd.ctc-posml":["pml"],"application/vnd.cups-ppd":["ppd"],"application/vnd.curl.car":["car"],"application/vnd.curl.pcurl":["pcurl"],"application/vnd.dart":["dart"],"application/vnd.data-vision.rdz":["rdz"],"application/vnd.dbf":["dbf"],"application/vnd.dece.data":["uvf","uvvf","uvd","uvvd"],"application/vnd.dece.ttml+xml":["uvt","uvvt"],"application/vnd.dece.unspecified":["uvx","uvvx"],"application/vnd.dece.zip":["uvz","uvvz"],"application/vnd.denovo.fcselayout-link":["fe_launch"],"application/vnd.dna":["dna"],"application/vnd.dolby.mlp":["mlp"],"application/vnd.dpgraph":["dpg"],"application/vnd.dreamfactory":["dfac"],"application/vnd.ds-keypoint":["kpxx"],"application/vnd.dvb.ait":["ait"],"application/vnd.dvb.service":["svc"],"application/vnd.dynageo":["geo"],"application/vnd.ecowin.chart":["mag"],"application/vnd.enliven":["nml"],"application/vnd.epson.esf":["esf"],"application/vnd.epson.msf":["msf"],"application/vnd.epson.quickanime":["qam"],"application/vnd.epson.salt":["slt"],"application/vnd.epson.ssf":["ssf"],"application/vnd.eszigno3+xml":["es3","et3"],"application/vnd.ezpix-album":["ez2"],"application/vnd.ezpix-package":["ez3"],"application/vnd.fdf":["fdf"],"application/vnd.fdsn.mseed":["mseed"],"application/vnd.fdsn.seed":["seed","dataless"],"application/vnd.flographit":["gph"],"application/vnd.fluxtime.clip":["ftc"],"application/vnd.framemaker":["fm","frame","maker","book"],"application/vnd.frogans.fnc":["fnc"],"application/vnd.frogans.ltf":["ltf"],"application/vnd.fsc.weblaunch":["fsc"],"application/vnd.fujitsu.oasys":["oas"],"application/vnd.fujitsu.oasys2":["oa2"],"application/vnd.fujitsu.oasys3":["oa3"],"application/vnd.fujitsu.oasysgp":["fg5"],"application/vnd.fujitsu.oasysprs":["bh2"],"application/vnd.fujixerox.ddd":["ddd"],"application/vnd.fujixerox.docuworks":["xdw"],"application/vnd.fujixerox.docuworks.binder":["xbd"],"application/vnd.fuzzysheet":["fzs"],"application/vnd.genomatix.tuxedo":["txd"],"application/vnd.geogebra.file":["ggb"],"application/vnd.geogebra.tool":["ggt"],"application/vnd.geometry-explorer":["gex","gre"],"application/vnd.geonext":["gxt"],"application/vnd.geoplan":["g2w"],"application/vnd.geospace":["g3w"],"application/vnd.gmx":["gmx"],"application/vnd.google-apps.document":["gdoc"],"application/vnd.google-apps.presentation":["gslides"],"application/vnd.google-apps.spreadsheet":["gsheet"],"application/vnd.google-earth.kml+xml":["kml"],"application/vnd.google-earth.kmz":["kmz"],"application/vnd.grafeq":["gqf","gqs"],"application/vnd.groove-account":["gac"],"application/vnd.groove-help":["ghf"],"application/vnd.groove-identity-message":["gim"],"application/vnd.groove-injector":["grv"],"application/vnd.groove-tool-message":["gtm"],"application/vnd.groove-tool-template":["tpl"],"application/vnd.groove-vcard":["vcg"],"application/vnd.hal+xml":["hal"],"application/vnd.handheld-entertainment+xml":["zmm"],"application/vnd.hbci":["hbci"],"application/vnd.hhe.lesson-player":["les"],"application/vnd.hp-hpgl":["hpgl"],"application/vnd.hp-hpid":["hpid"],"application/vnd.hp-hps":["hps"],"application/vnd.hp-jlyt":["jlt"],"application/vnd.hp-pcl":["pcl"],"application/vnd.hp-pclxl":["pclxl"],"application/vnd.hydrostatix.sof-data":["sfd-hdstx"],"application/vnd.ibm.minipay":["mpy"],"application/vnd.ibm.modcap":["afp","listafp","list3820"],"application/vnd.ibm.rights-management":["irm"],"application/vnd.ibm.secure-container":["sc"],"application/vnd.iccprofile":["icc","icm"],"application/vnd.igloader":["igl"],"application/vnd.immervision-ivp":["ivp"],"application/vnd.immervision-ivu":["ivu"],"application/vnd.insors.igm":["igm"],"application/vnd.intercon.formnet":["xpw","xpx"],"application/vnd.intergeo":["i2g"],"application/vnd.intu.qbo":["qbo"],"application/vnd.intu.qfx":["qfx"],"application/vnd.ipunplugged.rcprofile":["rcprofile"],"application/vnd.irepository.package+xml":["irp"],"application/vnd.is-xpr":["xpr"],"application/vnd.isac.fcs":["fcs"],"application/vnd.jam":["jam"],"application/vnd.jcp.javame.midlet-rms":["rms"],"application/vnd.jisp":["jisp"],"application/vnd.joost.joda-archive":["joda"],"application/vnd.kahootz":["ktz","ktr"],"application/vnd.kde.karbon":["karbon"],"application/vnd.kde.kchart":["chrt"],"application/vnd.kde.kformula":["kfo"],"application/vnd.kde.kivio":["flw"],"application/vnd.kde.kontour":["kon"],"application/vnd.kde.kpresenter":["kpr","kpt"],"application/vnd.kde.kspread":["ksp"],"application/vnd.kde.kword":["kwd","kwt"],"application/vnd.kenameaapp":["htke"],"application/vnd.kidspiration":["kia"],"application/vnd.kinar":["kne","knp"],"application/vnd.koan":["skp","skd","skt","skm"],"application/vnd.kodak-descriptor":["sse"],"application/vnd.las.las+xml":["lasxml"],"application/vnd.llamagraphics.life-balance.desktop":["lbd"],"application/vnd.llamagraphics.life-balance.exchange+xml":["lbe"],"application/vnd.lotus-1-2-3":["123"],"application/vnd.lotus-approach":["apr"],"application/vnd.lotus-freelance":["pre"],"application/vnd.lotus-notes":["nsf"],"application/vnd.lotus-organizer":["org"],"application/vnd.lotus-screencam":["scm"],"application/vnd.lotus-wordpro":["lwp"],"application/vnd.macports.portpkg":["portpkg"],"application/vnd.mapbox-vector-tile":["mvt"],"application/vnd.mcd":["mcd"],"application/vnd.medcalcdata":["mc1"],"application/vnd.mediastation.cdkey":["cdkey"],"application/vnd.mfer":["mwf"],"application/vnd.mfmp":["mfm"],"application/vnd.micrografx.flo":["flo"],"application/vnd.micrografx.igx":["igx"],"application/vnd.mif":["mif"],"application/vnd.mobius.daf":["daf"],"application/vnd.mobius.dis":["dis"],"application/vnd.mobius.mbk":["mbk"],"application/vnd.mobius.mqy":["mqy"],"application/vnd.mobius.msl":["msl"],"application/vnd.mobius.plc":["plc"],"application/vnd.mobius.txf":["txf"],"application/vnd.mophun.application":["mpn"],"application/vnd.mophun.certificate":["mpc"],"application/vnd.mozilla.xul+xml":["xul"],"application/vnd.ms-artgalry":["cil"],"application/vnd.ms-cab-compressed":["cab"],"application/vnd.ms-excel":["xls","xlm","xla","xlc","xlt","xlw"],"application/vnd.ms-excel.addin.macroenabled.12":["xlam"],"application/vnd.ms-excel.sheet.binary.macroenabled.12":["xlsb"],"application/vnd.ms-excel.sheet.macroenabled.12":["xlsm"],"application/vnd.ms-excel.template.macroenabled.12":["xltm"],"application/vnd.ms-fontobject":["eot"],"application/vnd.ms-htmlhelp":["chm"],"application/vnd.ms-ims":["ims"],"application/vnd.ms-lrm":["lrm"],"application/vnd.ms-officetheme":["thmx"],"application/vnd.ms-outlook":["msg"],"application/vnd.ms-pki.seccat":["cat"],"application/vnd.ms-pki.stl":["*stl"],"application/vnd.ms-powerpoint":["ppt","pps","pot"],"application/vnd.ms-powerpoint.addin.macroenabled.12":["ppam"],"application/vnd.ms-powerpoint.presentation.macroenabled.12":["pptm"],"application/vnd.ms-powerpoint.slide.macroenabled.12":["sldm"],"application/vnd.ms-powerpoint.slideshow.macroenabled.12":["ppsm"],"application/vnd.ms-powerpoint.template.macroenabled.12":["potm"],"application/vnd.ms-project":["mpp","mpt"],"application/vnd.ms-word.document.macroenabled.12":["docm"],"application/vnd.ms-word.template.macroenabled.12":["dotm"],"application/vnd.ms-works":["wps","wks","wcm","wdb"],"application/vnd.ms-wpl":["wpl"],"application/vnd.ms-xpsdocument":["xps"],"application/vnd.mseq":["mseq"],"application/vnd.musician":["mus"],"application/vnd.muvee.style":["msty"],"application/vnd.mynfc":["taglet"],"application/vnd.neurolanguage.nlu":["nlu"],"application/vnd.nitf":["ntf","nitf"],"application/vnd.noblenet-directory":["nnd"],"application/vnd.noblenet-sealer":["nns"],"application/vnd.noblenet-web":["nnw"],"application/vnd.nokia.n-gage.ac+xml":["*ac"],"application/vnd.nokia.n-gage.data":["ngdat"],"application/vnd.nokia.n-gage.symbian.install":["n-gage"],"application/vnd.nokia.radio-preset":["rpst"],"application/vnd.nokia.radio-presets":["rpss"],"application/vnd.novadigm.edm":["edm"],"application/vnd.novadigm.edx":["edx"],"application/vnd.novadigm.ext":["ext"],"application/vnd.oasis.opendocument.chart":["odc"],"application/vnd.oasis.opendocument.chart-template":["otc"],"application/vnd.oasis.opendocument.database":["odb"],"application/vnd.oasis.opendocument.formula":["odf"],"application/vnd.oasis.opendocument.formula-template":["odft"],"application/vnd.oasis.opendocument.graphics":["odg"],"application/vnd.oasis.opendocument.graphics-template":["otg"],"application/vnd.oasis.opendocument.image":["odi"],"application/vnd.oasis.opendocument.image-template":["oti"],"application/vnd.oasis.opendocument.presentation":["odp"],"application/vnd.oasis.opendocument.presentation-template":["otp"],"application/vnd.oasis.opendocument.spreadsheet":["ods"],"application/vnd.oasis.opendocument.spreadsheet-template":["ots"],"application/vnd.oasis.opendocument.text":["odt"],"application/vnd.oasis.opendocument.text-master":["odm"],"application/vnd.oasis.opendocument.text-template":["ott"],"application/vnd.oasis.opendocument.text-web":["oth"],"application/vnd.olpc-sugar":["xo"],"application/vnd.oma.dd2+xml":["dd2"],"application/vnd.openblox.game+xml":["obgx"],"application/vnd.openofficeorg.extension":["oxt"],"application/vnd.openstreetmap.data+xml":["osm"],"application/vnd.openxmlformats-officedocument.presentationml.presentation":["pptx"],"application/vnd.openxmlformats-officedocument.presentationml.slide":["sldx"],"application/vnd.openxmlformats-officedocument.presentationml.slideshow":["ppsx"],"application/vnd.openxmlformats-officedocument.presentationml.template":["potx"],"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":["xlsx"],"application/vnd.openxmlformats-officedocument.spreadsheetml.template":["xltx"],"application/vnd.openxmlformats-officedocument.wordprocessingml.document":["docx"],"application/vnd.openxmlformats-officedocument.wordprocessingml.template":["dotx"],"application/vnd.osgeo.mapguide.package":["mgp"],"application/vnd.osgi.dp":["dp"],"application/vnd.osgi.subsystem":["esa"],"application/vnd.palm":["pdb","pqa","oprc"],"application/vnd.pawaafile":["paw"],"application/vnd.pg.format":["str"],"application/vnd.pg.osasli":["ei6"],"application/vnd.picsel":["efif"],"application/vnd.pmi.widget":["wg"],"application/vnd.pocketlearn":["plf"],"application/vnd.powerbuilder6":["pbd"],"application/vnd.previewsystems.box":["box"],"application/vnd.proteus.magazine":["mgz"],"application/vnd.publishare-delta-tree":["qps"],"application/vnd.pvi.ptid1":["ptid"],"application/vnd.quark.quarkxpress":["qxd","qxt","qwd","qwt","qxl","qxb"],"application/vnd.rar":["rar"],"application/vnd.realvnc.bed":["bed"],"application/vnd.recordare.musicxml":["mxl"],"application/vnd.recordare.musicxml+xml":["musicxml"],"application/vnd.rig.cryptonote":["cryptonote"],"application/vnd.rim.cod":["cod"],"application/vnd.rn-realmedia":["rm"],"application/vnd.rn-realmedia-vbr":["rmvb"],"application/vnd.route66.link66+xml":["link66"],"application/vnd.sailingtracker.track":["st"],"application/vnd.seemail":["see"],"application/vnd.sema":["sema"],"application/vnd.semd":["semd"],"application/vnd.semf":["semf"],"application/vnd.shana.informed.formdata":["ifm"],"application/vnd.shana.informed.formtemplate":["itp"],"application/vnd.shana.informed.interchange":["iif"],"application/vnd.shana.informed.package":["ipk"],"application/vnd.simtech-mindmapper":["twd","twds"],"application/vnd.smaf":["mmf"],"application/vnd.smart.teacher":["teacher"],"application/vnd.software602.filler.form+xml":["fo"],"application/vnd.solent.sdkm+xml":["sdkm","sdkd"],"application/vnd.spotfire.dxp":["dxp"],"application/vnd.spotfire.sfs":["sfs"],"application/vnd.stardivision.calc":["sdc"],"application/vnd.stardivision.draw":["sda"],"application/vnd.stardivision.impress":["sdd"],"application/vnd.stardivision.math":["smf"],"application/vnd.stardivision.writer":["sdw","vor"],"application/vnd.stardivision.writer-global":["sgl"],"application/vnd.stepmania.package":["smzip"],"application/vnd.stepmania.stepchart":["sm"],"application/vnd.sun.wadl+xml":["wadl"],"application/vnd.sun.xml.calc":["sxc"],"application/vnd.sun.xml.calc.template":["stc"],"application/vnd.sun.xml.draw":["sxd"],"application/vnd.sun.xml.draw.template":["std"],"application/vnd.sun.xml.impress":["sxi"],"application/vnd.sun.xml.impress.template":["sti"],"application/vnd.sun.xml.math":["sxm"],"application/vnd.sun.xml.writer":["sxw"],"application/vnd.sun.xml.writer.global":["sxg"],"application/vnd.sun.xml.writer.template":["stw"],"application/vnd.sus-calendar":["sus","susp"],"application/vnd.svd":["svd"],"application/vnd.symbian.install":["sis","sisx"],"application/vnd.syncml+xml":["xsm"],"application/vnd.syncml.dm+wbxml":["bdm"],"application/vnd.syncml.dm+xml":["xdm"],"application/vnd.syncml.dmddf+xml":["ddf"],"application/vnd.tao.intent-module-archive":["tao"],"application/vnd.tcpdump.pcap":["pcap","cap","dmp"],"application/vnd.tmobile-livetv":["tmo"],"application/vnd.trid.tpt":["tpt"],"application/vnd.triscape.mxs":["mxs"],"application/vnd.trueapp":["tra"],"application/vnd.ufdl":["ufd","ufdl"],"application/vnd.uiq.theme":["utz"],"application/vnd.umajin":["umj"],"application/vnd.unity":["unityweb"],"application/vnd.uoml+xml":["uoml"],"application/vnd.vcx":["vcx"],"application/vnd.visio":["vsd","vst","vss","vsw"],"application/vnd.visionary":["vis"],"application/vnd.vsf":["vsf"],"application/vnd.wap.wbxml":["wbxml"],"application/vnd.wap.wmlc":["wmlc"],"application/vnd.wap.wmlscriptc":["wmlsc"],"application/vnd.webturbo":["wtb"],"application/vnd.wolfram.player":["nbp"],"application/vnd.wordperfect":["wpd"],"application/vnd.wqd":["wqd"],"application/vnd.wt.stf":["stf"],"application/vnd.xara":["xar"],"application/vnd.xfdl":["xfdl"],"application/vnd.yamaha.hv-dic":["hvd"],"application/vnd.yamaha.hv-script":["hvs"],"application/vnd.yamaha.hv-voice":["hvp"],"application/vnd.yamaha.openscoreformat":["osf"],"application/vnd.yamaha.openscoreformat.osfpvg+xml":["osfpvg"],"application/vnd.yamaha.smaf-audio":["saf"],"application/vnd.yamaha.smaf-phrase":["spf"],"application/vnd.yellowriver-custom-menu":["cmp"],"application/vnd.zul":["zir","zirz"],"application/vnd.zzazz.deck+xml":["zaz"],"application/x-7z-compressed":["7z"],"application/x-abiword":["abw"],"application/x-ace-compressed":["ace"],"application/x-apple-diskimage":["*dmg"],"application/x-arj":["arj"],"application/x-authorware-bin":["aab","x32","u32","vox"],"application/x-authorware-map":["aam"],"application/x-authorware-seg":["aas"],"application/x-bcpio":["bcpio"],"application/x-bdoc":["*bdoc"],"application/x-bittorrent":["torrent"],"application/x-blorb":["blb","blorb"],"application/x-bzip":["bz"],"application/x-bzip2":["bz2","boz"],"application/x-cbr":["cbr","cba","cbt","cbz","cb7"],"application/x-cdlink":["vcd"],"application/x-cfs-compressed":["cfs"],"application/x-chat":["chat"],"application/x-chess-pgn":["pgn"],"application/x-chrome-extension":["crx"],"application/x-cocoa":["cco"],"application/x-conference":["nsc"],"application/x-cpio":["cpio"],"application/x-csh":["csh"],"application/x-debian-package":["*deb","udeb"],"application/x-dgc-compressed":["dgc"],"application/x-director":["dir","dcr","dxr","cst","cct","cxt","w3d","fgd","swa"],"application/x-doom":["wad"],"application/x-dtbncx+xml":["ncx"],"application/x-dtbook+xml":["dtb"],"application/x-dtbresource+xml":["res"],"application/x-dvi":["dvi"],"application/x-envoy":["evy"],"application/x-eva":["eva"],"application/x-font-bdf":["bdf"],"application/x-font-ghostscript":["gsf"],"application/x-font-linux-psf":["psf"],"application/x-font-pcf":["pcf"],"application/x-font-snf":["snf"],"application/x-font-type1":["pfa","pfb","pfm","afm"],"application/x-freearc":["arc"],"application/x-futuresplash":["spl"],"application/x-gca-compressed":["gca"],"application/x-glulx":["ulx"],"application/x-gnumeric":["gnumeric"],"application/x-gramps-xml":["gramps"],"application/x-gtar":["gtar"],"application/x-hdf":["hdf"],"application/x-httpd-php":["php"],"application/x-install-instructions":["install"],"application/x-iso9660-image":["*iso"],"application/x-iwork-keynote-sffkey":["*key"],"application/x-iwork-numbers-sffnumbers":["*numbers"],"application/x-iwork-pages-sffpages":["*pages"],"application/x-java-archive-diff":["jardiff"],"application/x-java-jnlp-file":["jnlp"],"application/x-keepass2":["kdbx"],"application/x-latex":["latex"],"application/x-lua-bytecode":["luac"],"application/x-lzh-compressed":["lzh","lha"],"application/x-makeself":["run"],"application/x-mie":["mie"],"application/x-mobipocket-ebook":["prc","mobi"],"application/x-ms-application":["application"],"application/x-ms-shortcut":["lnk"],"application/x-ms-wmd":["wmd"],"application/x-ms-wmz":["wmz"],"application/x-ms-xbap":["xbap"],"application/x-msaccess":["mdb"],"application/x-msbinder":["obd"],"application/x-mscardfile":["crd"],"application/x-msclip":["clp"],"application/x-msdos-program":["*exe"],"application/x-msdownload":["*exe","*dll","com","bat","*msi"],"application/x-msmediaview":["mvb","m13","m14"],"application/x-msmetafile":["*wmf","*wmz","*emf","emz"],"application/x-msmoney":["mny"],"application/x-mspublisher":["pub"],"application/x-msschedule":["scd"],"application/x-msterminal":["trm"],"application/x-mswrite":["wri"],"application/x-netcdf":["nc","cdf"],"application/x-ns-proxy-autoconfig":["pac"],"application/x-nzb":["nzb"],"application/x-perl":["pl","pm"],"application/x-pilot":["*prc","*pdb"],"application/x-pkcs12":["p12","pfx"],"application/x-pkcs7-certificates":["p7b","spc"],"application/x-pkcs7-certreqresp":["p7r"],"application/x-rar-compressed":["*rar"],"application/x-redhat-package-manager":["rpm"],"application/x-research-info-systems":["ris"],"application/x-sea":["sea"],"application/x-sh":["sh"],"application/x-shar":["shar"],"application/x-shockwave-flash":["swf"],"application/x-silverlight-app":["xap"],"application/x-sql":["sql"],"application/x-stuffit":["sit"],"application/x-stuffitx":["sitx"],"application/x-subrip":["srt"],"application/x-sv4cpio":["sv4cpio"],"application/x-sv4crc":["sv4crc"],"application/x-t3vm-image":["t3"],"application/x-tads":["gam"],"application/x-tar":["tar"],"application/x-tcl":["tcl","tk"],"application/x-tex":["tex"],"application/x-tex-tfm":["tfm"],"application/x-texinfo":["texinfo","texi"],"application/x-tgif":["*obj"],"application/x-ustar":["ustar"],"application/x-virtualbox-hdd":["hdd"],"application/x-virtualbox-ova":["ova"],"application/x-virtualbox-ovf":["ovf"],"application/x-virtualbox-vbox":["vbox"],"application/x-virtualbox-vbox-extpack":["vbox-extpack"],"application/x-virtualbox-vdi":["vdi"],"application/x-virtualbox-vhd":["vhd"],"application/x-virtualbox-vmdk":["vmdk"],"application/x-wais-source":["src"],"application/x-web-app-manifest+json":["webapp"],"application/x-x509-ca-cert":["der","crt","pem"],"application/x-xfig":["fig"],"application/x-xliff+xml":["*xlf"],"application/x-xpinstall":["xpi"],"application/x-xz":["xz"],"application/x-zmachine":["z1","z2","z3","z4","z5","z6","z7","z8"],"audio/vnd.dece.audio":["uva","uvva"],"audio/vnd.digital-winds":["eol"],"audio/vnd.dra":["dra"],"audio/vnd.dts":["dts"],"audio/vnd.dts.hd":["dtshd"],"audio/vnd.lucent.voice":["lvp"],"audio/vnd.ms-playready.media.pya":["pya"],"audio/vnd.nuera.ecelp4800":["ecelp4800"],"audio/vnd.nuera.ecelp7470":["ecelp7470"],"audio/vnd.nuera.ecelp9600":["ecelp9600"],"audio/vnd.rip":["rip"],"audio/x-aac":["aac"],"audio/x-aiff":["aif","aiff","aifc"],"audio/x-caf":["caf"],"audio/x-flac":["flac"],"audio/x-m4a":["*m4a"],"audio/x-matroska":["mka"],"audio/x-mpegurl":["m3u"],"audio/x-ms-wax":["wax"],"audio/x-ms-wma":["wma"],"audio/x-pn-realaudio":["ram","ra"],"audio/x-pn-realaudio-plugin":["rmp"],"audio/x-realaudio":["*ra"],"audio/x-wav":["*wav"],"chemical/x-cdx":["cdx"],"chemical/x-cif":["cif"],"chemical/x-cmdf":["cmdf"],"chemical/x-cml":["cml"],"chemical/x-csml":["csml"],"chemical/x-xyz":["xyz"],"image/prs.btif":["btif"],"image/prs.pti":["pti"],"image/vnd.adobe.photoshop":["psd"],"image/vnd.airzip.accelerator.azv":["azv"],"image/vnd.dece.graphic":["uvi","uvvi","uvg","uvvg"],"image/vnd.djvu":["djvu","djv"],"image/vnd.dvb.subtitle":["*sub"],"image/vnd.dwg":["dwg"],"image/vnd.dxf":["dxf"],"image/vnd.fastbidsheet":["fbs"],"image/vnd.fpx":["fpx"],"image/vnd.fst":["fst"],"image/vnd.fujixerox.edmics-mmr":["mmr"],"image/vnd.fujixerox.edmics-rlc":["rlc"],"image/vnd.microsoft.icon":["ico"],"image/vnd.ms-dds":["dds"],"image/vnd.ms-modi":["mdi"],"image/vnd.ms-photo":["wdp"],"image/vnd.net-fpx":["npx"],"image/vnd.pco.b16":["b16"],"image/vnd.tencent.tap":["tap"],"image/vnd.valve.source.texture":["vtf"],"image/vnd.wap.wbmp":["wbmp"],"image/vnd.xiff":["xif"],"image/vnd.zbrush.pcx":["pcx"],"image/x-3ds":["3ds"],"image/x-cmu-raster":["ras"],"image/x-cmx":["cmx"],"image/x-freehand":["fh","fhc","fh4","fh5","fh7"],"image/x-icon":["*ico"],"image/x-jng":["jng"],"image/x-mrsid-image":["sid"],"image/x-ms-bmp":["*bmp"],"image/x-pcx":["*pcx"],"image/x-pict":["pic","pct"],"image/x-portable-anymap":["pnm"],"image/x-portable-bitmap":["pbm"],"image/x-portable-graymap":["pgm"],"image/x-portable-pixmap":["ppm"],"image/x-rgb":["rgb"],"image/x-tga":["tga"],"image/x-xbitmap":["xbm"],"image/x-xpixmap":["xpm"],"image/x-xwindowdump":["xwd"],"message/vnd.wfa.wsc":["wsc"],"model/vnd.collada+xml":["dae"],"model/vnd.dwf":["dwf"],"model/vnd.gdl":["gdl"],"model/vnd.gtw":["gtw"],"model/vnd.mts":["mts"],"model/vnd.opengex":["ogex"],"model/vnd.parasolid.transmit.binary":["x_b"],"model/vnd.parasolid.transmit.text":["x_t"],"model/vnd.sap.vds":["vds"],"model/vnd.usdz+zip":["usdz"],"model/vnd.valve.source.compiled-map":["bsp"],"model/vnd.vtu":["vtu"],"text/prs.lines.tag":["dsc"],"text/vnd.curl":["curl"],"text/vnd.curl.dcurl":["dcurl"],"text/vnd.curl.mcurl":["mcurl"],"text/vnd.curl.scurl":["scurl"],"text/vnd.dvb.subtitle":["sub"],"text/vnd.fly":["fly"],"text/vnd.fmi.flexstor":["flx"],"text/vnd.graphviz":["gv"],"text/vnd.in3d.3dml":["3dml"],"text/vnd.in3d.spot":["spot"],"text/vnd.sun.j2me.app-descriptor":["jad"],"text/vnd.wap.wml":["wml"],"text/vnd.wap.wmlscript":["wmls"],"text/x-asm":["s","asm"],"text/x-c":["c","cc","cxx","cpp","h","hh","dic"],"text/x-component":["htc"],"text/x-fortran":["f","for","f77","f90"],"text/x-handlebars-template":["hbs"],"text/x-java-source":["java"],"text/x-lua":["lua"],"text/x-markdown":["mkd"],"text/x-nfo":["nfo"],"text/x-opml":["opml"],"text/x-org":["*org"],"text/x-pascal":["p","pas"],"text/x-processing":["pde"],"text/x-sass":["sass"],"text/x-scss":["scss"],"text/x-setext":["etx"],"text/x-sfv":["sfv"],"text/x-suse-ymp":["ymp"],"text/x-uuencode":["uu"],"text/x-vcalendar":["vcs"],"text/x-vcard":["vcf"],"video/vnd.dece.hd":["uvh","uvvh"],"video/vnd.dece.mobile":["uvm","uvvm"],"video/vnd.dece.pd":["uvp","uvvp"],"video/vnd.dece.sd":["uvs","uvvs"],"video/vnd.dece.video":["uvv","uvvv"],"video/vnd.dvb.file":["dvb"],"video/vnd.fvt":["fvt"],"video/vnd.mpegurl":["mxu","m4u"],"video/vnd.ms-playready.media.pyv":["pyv"],"video/vnd.uvvu.mp4":["uvu","uvvu"],"video/vnd.vivo":["viv"],"video/x-f4v":["f4v"],"video/x-fli":["fli"],"video/x-flv":["flv"],"video/x-m4v":["m4v"],"video/x-matroska":["mkv","mk3d","mks"],"video/x-mng":["mng"],"video/x-ms-asf":["asf","asx"],"video/x-ms-vob":["vob"],"video/x-ms-wm":["wm"],"video/x-ms-wmv":["wmv"],"video/x-ms-wmx":["wmx"],"video/x-ms-wvx":["wvx"],"video/x-msvideo":["avi"],"video/x-sgi-movie":["movie"],"video/x-smv":["smv"],"x-conference/x-cooltalk":["ice"]}}),Jn=u((e,t)=>{var r=Gn();t.exports=new r(Wn(),Kn())}),Zn=u((e,t)=>{var r=/["'&<>]/;t.exports=function(e){var t=""+e,i=r.exec(t);if(!i)return t;var n,s="",a=0,o=0;for(a=i.index;a<t.length;a++){switch(t.charCodeAt(a)){case 34:n="&quot;";break;case 38:n="&amp;";break;case 39:n="&#39;";break;case 60:n="&lt;";break;case 62:n="&gt;";break;default:continue}o!==a&&(s+=t.substring(o,a)),o=a+1,s+=n}return o!==a?s+t.substring(o,a):s}}),Yn=u(e=>{var t=/^(-?(?:\d+)?\.?\d+) *(m(?:illiseconds?|s(?:ecs?)?))?(s(?:ec(?:onds?|s)?)?)?(m(?:in(?:utes?|s)?)?)?(h(?:ours?|rs?)?)?(d(?:ays?)?)?(w(?:eeks?|ks?)?)?(y(?:ears?|rs?)?)?$/,r=1e3,i=6e4,n=60*i,s=24*n,a=365.25*s;function o(e,t,r,i){var n=(0|e)===e?e:~~(e+.5);return t+n+(i?" "+r+(1!=n?"s":""):r[0])}e.format=function(e,t){var l=e<0?"-":"",c=e<0?-e:e;return c<r?e+(t?" ms":"ms"):c<i?o(c/r,l,"second",t):c<n?o(c/i,l,"minute",t):c<s?o(c/n,l,"hour",t):c<a?o(c/s,l,"day",t):o(c/a,l,"year",t)},e.parse=function(e){var o,l=e.toLowerCase().match(t);if(null!=l&&(o=parseFloat(l[1])))return null!=l[3]?o*r:null!=l[4]?o*i:null!=l[5]?o*n:null!=l[6]?o*s:null!=l[7]?o*s*7:null!=l[8]?o*a:o}}),Xn=u(e=>{e.clearHeaders=function(e){let t=e.getHeaderNames();for(let r=0;r<t.length;r++)e.removeHeader(t[r])}}),Qn=u((e,t)=>{t.exports.collapseLeadingSlashes=function(e){if("/"!==e[0]||"/"!==e[1])return e;for(let t=2,r=e.length;t<r;++t)if("/"!==e[t])return e.slice(t-1)}}),es=u((e,t)=>{t.exports.containsDotFile=function(e){for(let t=0,r=e.length;t<r;++t)if(1!==e[t].length&&"."===e[t][0])return!0;return!1}}),ts=u(e=>{e.contentRange=function(e,t,r){return e+" "+(r?r.start+"-"+r.end:"*")+"/"+t}}),rs=u(e=>{e.createHtmlDocument=function(e,t){let r='<!DOCTYPE html>\n<html lang="en">\n<head>\n<meta charset="utf-8">\n<title>'+e+"</title>\n</head>\n<body>\n<pre>"+t+"</pre>\n</body>\n</html>\n";return[r,Buffer.byteLength(r)]}}),is=u((e,t)=>{var r=c("path").relative;t.exports=function(e){if(!e)throw new TypeError("argument namespace is required");var t=o(p()[1]);function r(e){a.call(r,e)}return r._file=t[0],r._ignored=function(e){return!!process.noDeprecation||n(process.env.NO_DEPRECATION||"",e)}(e),r._namespace=e,r._traced=function(e){return!!process.traceDeprecation||n(process.env.TRACE_DEPRECATION||"",e)}(e),r._warned=Object.create(null),r.function=f,r.property=m,r};var i=process.cwd();function n(e,t){for(var r=e.split(/[ ,]+/),i=String(t).toLowerCase(),n=0;n<r.length;n++){var s=r[n];if(s&&("*"===s||s.toLowerCase()===i))return!0}return!1}function s(e){var t=this.name+": "+this.namespace;this.message&&(t+=" deprecated "+this.message);for(var r=0;r<e.length;r++)t+="\n    at "+e[r].toString();return t}function a(e,t){var r=function(e,t){return("function"!=typeof e.listenerCount?e.listeners(t).length:e.listenerCount(t))>0}(process,"deprecation");if(r||!this._ignored){var i,n,s,a,c=0,h=!1,f=p(),m=this._file;for(t?(a=t,(s=o(f[1])).name=a.name,m=s[0]):s=a=o(f[c=2]);c<f.length;c++)if((n=(i=o(f[c]))[0])===m)h=!0;else if(n===this._file)m=this._file;else if(h)break;var y=i?a.join(":")+"__"+i.join(":"):void 0;if(void 0===y||!(y in this._warned)){this._warned[y]=!0;var v=e;if(v||(v=function(e){var t=e.callSite,r=e.name;r||(r="<anonymous@"+d(e)+">");var i=t.getThis(),n=i&&t.getTypeName();return"Object"===n&&(n=void 0),"Function"===n&&(n=i.name||n),n&&t.getMethodName()?n+"."+r:r}(s!==a&&s.name?s:a)),r){var b=g(this._namespace,v,f.slice(c));return void process.emit("deprecation",b)}var w=(process.stderr.isTTY?u:l).call(this,v,i,f.slice(c));process.stderr.write(w+"\n","utf8")}}}function o(e){var t=e.getFileName()||"<anonymous>",r=e.getLineNumber(),i=e.getColumnNumber();e.isEval()&&(t=e.getEvalOrigin()+", "+t);var n=[t,r,i];return n.callSite=e,n.name=e.getFunctionName(),n}function l(e,t,r){var i=(new Date).toUTCString()+" "+this._namespace+" deprecated "+e;if(this._traced){for(var n=0;n<r.length;n++)i+="\n    at "+r[n].toString();return i}return t&&(i+=" at "+d(t)),i}function u(e,t,r){var i="[36;1m"+this._namespace+"[22;39m [33;1mdeprecated[22;39m [0m"+e+"[39m";if(this._traced){for(var n=0;n<r.length;n++)i+="\n    [36mat "+r[n].toString()+"[39m";return i}return t&&(i+=" [36m"+d(t)+"[39m"),i}function d(e){return r(i,e[0])+":"+e[1]+":"+e[2]}function p(){var e=Error.stackTraceLimit,t={},r=Error.prepareStackTrace;Error.prepareStackTrace=h,Error.stackTraceLimit=Math.max(10,e),Error.captureStackTrace(t);var i=t.stack.slice(1);return Error.prepareStackTrace=r,Error.stackTraceLimit=e,i}function h(e,t){return t}function f(e,t){if("function"!=typeof e)throw new TypeError("argument fn must be a function");var r=function(e){for(var t="",r=0;r<e;r++)t+=", arg"+r;return t.substr(2)}(e.length),i=o(p()[1]);return i.name=e.name,new Function("fn","log","deprecate","message","site",'"use strict"\nreturn function ('+r+") {log.call(deprecate, message, site)\nreturn fn.apply(this, arguments)\n}")(e,a,this,t,i)}function m(e,t,r){if(!e||"object"!=typeof e&&"function"!=typeof e)throw new TypeError("argument obj must be object");var i=Object.getOwnPropertyDescriptor(e,t);if(!i)throw new TypeError("must call property on owner object");if(!i.configurable)throw new TypeError("property must be configurable");var n=this,s=o(p()[1]);s.name=t,"value"in i&&(i=function(e,t){var r=Object.getOwnPropertyDescriptor(e,t),i=r.value;return r.get=function(){return i},r.writable&&(r.set=function(e){return i=e}),delete r.value,delete r.writable,Object.defineProperty(e,t,r),r}(e,t));var l=i.get,c=i.set;"function"==typeof l&&(i.get=function(){return a.call(n,r,s),l.apply(this,arguments)}),"function"==typeof c&&(i.set=function(){return a.call(n,r,s),c.apply(this,arguments)}),Object.defineProperty(e,t,i)}function g(e,t,r){var i,n=new Error;return Object.defineProperty(n,"constructor",{value:g}),Object.defineProperty(n,"message",{configurable:!0,enumerable:!1,value:t,writable:!0}),Object.defineProperty(n,"name",{enumerable:!1,configurable:!0,value:"DeprecationError",writable:!0}),Object.defineProperty(n,"namespace",{configurable:!0,enumerable:!1,value:e,writable:!0}),Object.defineProperty(n,"stack",{configurable:!0,enumerable:!1,get:function(){return void 0!==i?i:i=s.call(this,r)},set:function(e){i=e}}),n}}),ns=u((e,t)=>{t.exports=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){return e.__proto__=t,e}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(e,r)||(e[r]=t[r]);return e})}),ss=u((e,t)=>{t.exports={100:"Continue",101:"Switching Protocols",102:"Processing",103:"Early Hints",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",208:"Already Reported",226:"IM Used",300:"Multiple Choices",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",307:"Temporary Redirect",308:"Permanent Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Payload Too Large",414:"URI Too Long",415:"Unsupported Media Type",416:"Range Not Satisfiable",417:"Expectation Failed",418:"I'm a Teapot",421:"Misdirected Request",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",425:"Too Early",426:"Upgrade Required",428:"Precondition Required",429:"Too Many Requests",431:"Request Header Fields Too Large",451:"Unavailable For Legal Reasons",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",508:"Loop Detected",509:"Bandwidth Limit Exceeded",510:"Not Extended",511:"Network Authentication Required"}}),as=u((e,t)=>{var r=ss();function i(e){if(!Object.prototype.hasOwnProperty.call(n.message,e))throw new Error("invalid status code: "+e);return n.message[e]}function n(e){if("number"==typeof e)return i(e);if("string"!=typeof e)throw new TypeError("code must be a number or string");var t=parseInt(e,10);return isNaN(t)?function(e){var t=e.toLowerCase();if(!Object.prototype.hasOwnProperty.call(n.code,t))throw new Error('invalid status message: "'+e+'"');return n.code[t]}(e):i(t)}t.exports=n,n.message=r,n.code=function(e){var t={};return Object.keys(e).forEach(function(r){var i=e[r],n=Number(r);t[i.toLowerCase()]=n}),t}(r),n.codes=function(e){return Object.keys(e).map(function(e){return Number(e)})}(r),n.redirect={300:!0,301:!0,302:!0,303:!0,305:!0,307:!0,308:!0},n.empty={204:!0,205:!0,304:!0},n.retry={502:!0,503:!0,504:!0}}),os=u((e,t)=>{t.exports="function"==typeof Object.create?function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:function(e,t){if(t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}}}),ls=u((e,t)=>{try{if("function"!=typeof(r=c("util")).inherits)throw"";t.exports=r.inherits}catch{t.exports=os()}var r}),cs=u((e,t)=>{t.exports=function(e){return e.split(" ").map(function(e){return e.slice(0,1).toUpperCase()+e.slice(1)}).join("").replace(/[^ _0-9a-z]/gi,"")}}),us=u((e,t)=>{var r=is()("http-errors"),i=ns(),n=as(),s=ls(),a=cs();function o(e){return+(String(e).charAt(0)+"00")}function l(e,t){var r=Object.getOwnPropertyDescriptor(e,"name");r&&r.configurable&&(r.value=t,Object.defineProperty(e,"name",r))}function c(e){return"Error"!==e.substr(-5)?e+"Error":e}t.exports=function e(){for(var t,i,s=500,a={},l=0;l<arguments.length;l++){var c=arguments[l],u=typeof c;if("object"===u&&c instanceof Error)s=(t=c).status||t.statusCode||s;else if("number"===u&&0===l)s=c;else if("string"===u)i=c;else{if("object"!==u)throw new TypeError("argument #"+(l+1)+" unsupported type "+u);a=c}}"number"==typeof s&&(s<400||s>=600)&&r("non-error status code; use only 4xx or 5xx status codes"),("number"!=typeof s||!n.message[s]&&(s<400||s>=600))&&(s=500);var d=e[s]||e[o(s)];for(var p in t||(t=d?new d(i):new Error(i||n.message[s]),Error.captureStackTrace(t,e)),(!d||!(t instanceof d)||t.status!==s)&&(t.expose=s<500,t.status=t.statusCode=s),a)"status"!==p&&"statusCode"!==p&&(t[p]=a[p]);return t},t.exports.HttpError=function(){function e(){throw new TypeError("cannot construct abstract class")}return s(e,Error),e}(),t.exports.isHttpError=function(e){return function(t){return!(!t||"object"!=typeof t)&&(t instanceof e||t instanceof Error&&"boolean"==typeof t.expose&&"number"==typeof t.statusCode&&t.status===t.statusCode)}}(t.exports.HttpError),function(e,t,r){t.forEach(function(t){var u,d=a(n.message[t]);switch(o(t)){case 400:u=function(e,t,r){var a=c(t);function o(e){var t=e??n.message[r],s=new Error(t);return Error.captureStackTrace(s,o),i(s,o.prototype),Object.defineProperty(s,"message",{enumerable:!0,configurable:!0,value:t,writable:!0}),Object.defineProperty(s,"name",{enumerable:!1,configurable:!0,value:a,writable:!0}),s}return s(o,e),l(o,a),o.prototype.status=r,o.prototype.statusCode=r,o.prototype.expose=!0,o}(r,d,t);break;case 500:u=function(e,t,r){var a=c(t);function o(e){var t=e??n.message[r],s=new Error(t);return Error.captureStackTrace(s,o),i(s,o.prototype),Object.defineProperty(s,"message",{enumerable:!0,configurable:!0,value:t,writable:!0}),Object.defineProperty(s,"name",{enumerable:!1,configurable:!0,value:a,writable:!0}),s}return s(o,e),l(o,a),o.prototype.status=r,o.prototype.statusCode=r,o.prototype.expose=!1,o}(r,d,t)}u&&(e[t]=u,e[d]=u)})}(t.exports,n.codes,t.exports.HttpError)}),ds=u((e,t)=>{var r=us();t.exports.createHttpError=function(e,t){return t?t instanceof Error?r(e,t,{expose:!1}):r(e,t):r(e)}}),ps=u((e,t)=>{t.exports.normalizeList=function(e,t){if("string"==typeof e)return[e];if(!1===e)return[];if(Array.isArray(e)){for(let r=0,i=e.length;r<i;++r)if("string"!=typeof e[r])throw new TypeError(t+" must be array of strings or false");return e}throw new TypeError(t+" must be array of strings or false")}}),hs=u((e,t)=>{function r(e,t){return e.index-t.index}function i(e,t){return e.start-t.start}t.exports.parseBytesRange=function(e,t){let n,s,a=t.slice(t.indexOf("=")+1),o=[],l=a.length,c=0,u=0,d=0,p=a.indexOf(","),h=a.indexOf("-"),f=-1;for(;-1===p&&(p=l),n=parseInt(a.slice(f+1,h),10),s=parseInt(a.slice(h+1,p),10),n!=n?(n=e-s,s=e-1):(s!=s||s>e-1)&&(s=e-1),n==n&&s==s&&n>-1&&n<=s&&o.push({start:n,end:s,index:d++}),p!==l;)f=p++,h=a.indexOf("-",p),p=a.indexOf(",",p);if(d<2)return o;for(o.sort(i),u=d,d=0,c=1;c<u;){let e=o[c++],t=o[d];e.start>t.end+1?o[++d]=e:e.end>t.end&&(t.end=e.end,t.index>e.index&&(t.index=e.index))}return o.length=d+1,o.sort(r),o}}),fs=u((e,t)=>{var r=String.prototype.slice;t.exports.parseTokenList=function(e,t){let i,n=0,s=0;for(let a=0,o=e.length;a<o;a++)switch(e.charCodeAt(a)){case 32:s===n&&(s=n=a+1);break;case 44:if(s!==n&&(i=t(r.call(e,s,n)),void 0!==i))return i;s=n=a+1;break;default:n=a+1}if(s!==n)return t(r.call(e,s,n))}}),ms=u((e,t)=>{t.exports.setHeaders=function(e,t){let r=Object.keys(t);for(let i=0;i<r.length;i++){let n=r[i];e.setHeader(n,t[n])}}}),gs=u((e,t)=>{var r=c("node:fs"),i=c("node:path"),n=c("node:stream"),s=c("node:util"),a=c("node:util").debuglog("send"),o=Ii(),l=Zn(),u=Jn(),d=Yn(),{clearHeaders:p}=Xn(),{collapseLeadingSlashes:h}=Qn(),{containsDotFile:f}=es(),{contentRange:m}=ts(),{createHtmlDocument:g}=rs(),{createHttpError:y}=ds(),{isUtf8MimeType:v}=Vn(),{normalizeList:b}=ps(),{parseBytesRange:w}=hs(),{parseTokenList:_}=fs(),{setHeaders:S}=ms(),E=i.extname,k=i.join,x=i.normalize,T=i.resolve,P=i.sep,R=/^ *bytes=/,O=/(?:^|[\\/])\.\.(?:[\\/]|$)/,$={400:g("Error","Bad Request"),403:g("Error","Forbidden"),404:g("Error","Not Found"),412:g("Error","Precondition Failed"),416:g("Error","Range Not Satisfiable"),500:g("Error","Internal Server Error")},C=["allow","ignore","deny"];function A(e,t,r){if(!new.target)return new A(e,t,r);n.call(this);let i=r||{};if(this.options=i,this.path=t,this.req=e,this._acceptRanges=void 0===i.acceptRanges||!!i.acceptRanges,this._cacheControl=void 0===i.cacheControl||!!i.cacheControl,this._etag=void 0===i.etag||!!i.etag,this._dotfiles=void 0!==i.dotfiles?C.indexOf(i.dotfiles):1,-1===this._dotfiles)throw new TypeError('dotfiles option must be "allow", "deny", or "ignore"');this._extensions=void 0!==i.extensions?b(i.extensions,"extensions option"):[],this._immutable=void 0!==i.immutable&&!!i.immutable,this._index=void 0!==i.index?b(i.index,"index option"):["index.html"],this._lastModified=void 0===i.lastModified||!!i.lastModified,this._maxage=i.maxAge||i.maxage,this._maxage="string"==typeof this._maxage?d.parse(this._maxage):Number(this._maxage),this._maxage=this._maxage==this._maxage?Math.min(Math.max(0,this._maxage),31536e6):0,this._root=i.root?T(i.root):null}s.inherits(A,n),A.prototype.root=function(e){return this._root=T(String(e)),a("root %s",this._root),this},A.prototype.error=function(e,t){if(this.listenerCount("error")>0)return this.emit("error",y(e,t));let r=this.res;p(r),t&&t.headers&&S(r,t.headers);let i=$[e];r.statusCode=e,r.setHeader("Content-Type","text/html; charset=UTF-8"),r.setHeader("Content-Length",i[1]),r.setHeader("Content-Security-Policy","default-src 'none'"),r.setHeader("X-Content-Type-Options","nosniff"),r.end(i[0])},A.prototype.hasTrailingSlash=function(){return"/"===this.path[this.path.length-1]},A.prototype.isConditionalGET=function(){return this.req.headers["if-match"]||this.req.headers["if-unmodified-since"]||this.req.headers["if-none-match"]||this.req.headers["if-modified-since"]},A.prototype.isNotModifiedFailure=function(){let e=this.req,t=this.res;if("cache-control"in e.headers&&-1!==e.headers["cache-control"].indexOf("no-cache"))return!1;if("if-none-match"in e.headers){let r=e.headers["if-none-match"];if("*"===r)return!0;let i=t.getHeader("etag");if("string"!=typeof i)return!1;let n=i.length;return!!_(r,function(e){let t=e.length;if(n===t&&e===i||n>t&&"W/"+e===i)return!0})}if("if-modified-since"in e.headers){let r=e.headers["if-modified-since"],i=t.getHeader("last-modified");if(!i||Date.parse(i)<=Date.parse(r))return!0}return!1},A.prototype.isPreconditionFailure=function(){let e=this.req,t=this.res,r=e.headers["if-match"];if(r){let e=t.getHeader("ETag");if("*"!==r&&!0!==(_(r,function(t){if(t===e||"W/"+t===e)return!0})||!1))return!0}if("if-unmodified-since"in e.headers){let r=Date.parse(e.headers["if-unmodified-since"]);if(r==r){let e=Date.parse(t.getHeader("Last-Modified"));if(e!=e||e>r)return!0}}return!1},A.prototype.removeContentHeaderFields=function(){let e=this.res;e.removeHeader("Content-Encoding"),e.removeHeader("Content-Language"),e.removeHeader("Content-Length"),e.removeHeader("Content-Range"),e.removeHeader("Content-Type")},A.prototype.notModified=function(){let e=this.res;a("not modified"),this.removeContentHeaderFields(),e.statusCode=304,e.end()},A.prototype.headersAlreadySent=function(){let e=new Error("Can't set headers after they are sent.");a("headers already sent"),this.error(500,e)},A.prototype.isCachable=function(){let e=this.res.statusCode;return e>=200&&e<300||304===e},A.prototype.onStatError=function(e){switch(e.code){case"ENAMETOOLONG":case"ENOTDIR":case"ENOENT":this.error(404,e);break;default:this.error(500,e)}},A.prototype.isRangeFresh=function(){if(!("if-range"in this.req.headers))return!0;let e=this.req.headers["if-range"];if(-1!==e.indexOf('"')){let t=this.res.getHeader("ETag");return t&&-1!==e.indexOf(t)||!1}let t=Date.parse(e);if(t!=t)return!1;let r=Date.parse(this.res.getHeader("Last-Modified"));return r!=r||r<=t},A.prototype.redirect=function(e){let t=this.res;if(this.listenerCount("directory")>0)return void this.emit("directory",t,e);if(this.hasTrailingSlash())return void this.error(403);let r=encodeURI(h(this.path+"/")),i=g("Redirecting",'Redirecting to <a href="'+l(r)+'">'+l(r)+"</a>");t.statusCode=301,t.setHeader("Content-Type","text/html; charset=UTF-8"),t.setHeader("Content-Length",i[1]),t.setHeader("Content-Security-Policy","default-src 'none'"),t.setHeader("X-Content-Type-Options","nosniff"),t.setHeader("Location",r),t.end(i[0])},A.prototype.pipe=function(e){let t=this._root;this.res=e;let r,i=o(this.path);if(null===i)return this.error(400),e;if(~i.indexOf("\0"))return this.error(400),e;if(null!==t){if(i&&(i=x("."+P+i)),O.test(i))return a('malicious path "%s"',i),this.error(403),e;r=i.split(P),i=x(k(t,i))}else{if(O.test(i))return a('malicious path "%s"',i),this.error(403),e;r=x(i).split(P),i=T(i)}if((a.enabled||0!==this._dotfiles)&&f(r))switch(this._dotfiles){case 0:a('allow dotfile "%s"',i);break;case 2:return a('deny dotfile "%s"',i),this.error(403),e;default:return a('ignore dotfile "%s"',i),this.error(404),e}return this._index.length&&this.hasTrailingSlash()?(this.sendIndex(i),e):(this.sendFile(i),e)},A.prototype.send=function(e,t){let r=t.size,i=this.options,n={},s=this.res,o=this.req,l=i.start||0;if(s.headersSent)this.headersAlreadySent();else{if(a('pipe "%s"',e),this.setHeader(e,t),this.type(e),this.isConditionalGET()){if(this.isPreconditionFailure())return void this.error(412);if(this.isCachable()&&this.isNotModifiedFailure())return void this.notModified()}if(r=Math.max(0,r-l),void 0!==i.end){let e=i.end-l+1;r>e&&(r=e)}if(this._acceptRanges){let e=o.headers.range;if(void 0!==e&&R.test(e))if(this.isRangeFresh()){let t=w(r,e);if(0===t.length)return a("range unsatisfiable"),s.setHeader("Content-Range",m("bytes",r)),this.error(416,{headers:{"Content-Range":s.getHeader("Content-Range")}});1===t.length&&(a("range %j",t),s.statusCode=206,s.setHeader("Content-Range",m("bytes",r,t[0])),l+=t[0].start,r=t[0].end-t[0].start+1)}else a("range stale")}for(let e in i)n[e]=i[e];n.start=l,n.end=Math.max(l,l+r-1),s.setHeader("Content-Length",r),"HEAD"!==o.method?this.stream(e,n):s.end()}},A.prototype.sendFile=function(e){let t=0,i=this;function n(s){if(i._extensions.length<=t)return s?i.onStatError(s):i.error(404);let o=e+"."+i._extensions[t++];a('stat "%s"',o),r.stat(o,function(e,t){return e?n(e):t.isDirectory()?n():(i.emit("file",o,t),void i.send(o,t))})}a('stat "%s"',e),r.stat(e,function(t,r){return t&&"ENOENT"===t.code&&!E(e)&&e[e.length-1]!==P?n(t):t?i.onStatError(t):r.isDirectory()?i.redirect(e):(i.emit("file",e,r),void i.send(e,r))})},A.prototype.sendIndex=function(e){let t=-1,i=this;!function n(s){if(++t>=i._index.length)return s?i.onStatError(s):i.error(404);let o=k(e,i._index[t]);a('stat "%s"',o),r.stat(o,function(e,t){return e?n(e):t.isDirectory()?n():(i.emit("file",o,t),void i.send(o,t))})}()},A.prototype.stream=function(e,t){let i=this,n=this.res,s=r.createReadStream(e,t);this.emit("stream",s),s.pipe(n);let a=!1;function o(){a||(a=!0,s.destroy())}n.once("finish",o),s.on("error",function(e){o(),i.onStatError(e)}),s.on("end",function(){i.emit("end")})},A.prototype.type=function(e){let t=this.res;if(t.getHeader("Content-Type"))return;let r=u.getType(e)||u.default_type;r?(a("content-type %s",r),v(r)?t.setHeader("Content-Type",r+"; charset=UTF-8"):t.setHeader("Content-Type",r)):a("no content-type")},A.prototype.setHeader=function(e,t){let r=this.res;if(this.emit("headers",r,e,t),this._acceptRanges&&!r.getHeader("Accept-Ranges")&&(a("accept ranges"),r.setHeader("Accept-Ranges","bytes")),this._cacheControl&&!r.getHeader("Cache-Control")){let e="public, max-age="+Math.floor(this._maxage/1e3);this._immutable&&(e+=", immutable"),a("cache-control %s",e),r.setHeader("Cache-Control",e)}if(this._lastModified&&!r.getHeader("Last-Modified")){let e=t.mtime.toUTCString();a("modified %s",e),r.setHeader("Last-Modified",e)}if(this._etag&&!r.getHeader("ETag")){let e='W/"'+t.size.toString(16)+"-"+t.mtime.getTime().toString(16)+'"';a("etag %s",e),r.setHeader("ETag",e)}},t.exports=A}),ys=u((e,t)=>{var r=Vn().isUtf8MimeType,i=Jn(),n=gs();function s(e,t,r){return new n(e,t,r)}t.exports=s,t.exports.default=s,t.exports.send=s,t.exports.SendStream=n,t.exports.isUtf8MimeType=r,t.exports.mime=i}),vs=u((e,t)=>{function r(e){if(!new.target)return new r(e);let{supportedValues:t=[],cache:i}=e&&"object"==typeof e&&e||{};this.supportedValues=t,this.cache=i}function i(e,t){if(!e||!Array.isArray(t)||0===t.length)return null;if("*"===e)return t[0];let r=null,i=1/0,l=0;return function(e,t){let r,i="",l=n;for(let c=0,u=e.length;c<u;++c){let u=e[c];if(" "!==u&&"\t"!==u){if(";"===u){l===s&&(l=a,r="");continue}if(","===u){if(l===s){if(t(i,1)){l=o;break}l=n,i=""}else if(l===a){if(t(i,parseFloat(r)||0)){l=o;break}l=n,i="",r=""}continue}if(l===a){if("q"===u||"="===u)continue;if("."===u||"1"===u||"0"===u||"2"===u||"3"===u||"4"===u||"5"===u||"6"===u||"7"===u||"8"===u||"9"===u){r+=u;continue}}else if(l===n){l=s,i+=u;continue}if(l===s){let t=e[c-1];(" "===t||"\t"===t)&&(i=""),i+=u;continue}if(t(i,parseFloat(r)||0)){l=o;break}l=n,i=u,r=""}}l===s?t(i,1):l===a&&t(i,parseFloat(r)||0)}(e,function(e,n){if(0===n||l>n)return!1;let s="*"===e&&t[0]||e,a=t.indexOf(s);return-1!==a&&(0===a&&1===n?(r=s,!0):((l<n||i>a)&&(r=s,i=a,l=n),!1))}),r}r.prototype.negotiate=function(e){return"string"!=typeof e?null:this.cache?(this.cache.has(e)||this.cache.set(e,i(e,this.supportedValues)),this.cache.get(e)):i(e,this.supportedValues)};var n=0,s=1,a=2,o=3;t.exports=i,t.exports.default=i,t.exports.negotiate=i,t.exports.Negotiator=r}),bs=u((e,t)=>{var r=c("buffer"),i=r.Buffer;function n(e,t){for(var r in e)t[r]=e[r]}function s(e,t,r){return i(e,t,r)}i.from&&i.alloc&&i.allocUnsafe&&i.allocUnsafeSlow?t.exports=r:(n(r,e),e.Buffer=s),s.prototype=Object.create(i.prototype),n(i,s),s.from=function(e,t,r){if("number"==typeof e)throw new TypeError("Argument must not be a number");return i(e,t,r)},s.alloc=function(e,t,r){if("number"!=typeof e)throw new TypeError("Argument must be a number");var n=i(e);return void 0!==t?"string"==typeof r?n.fill(t,r):n.fill(t):n.fill(0),n},s.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return i(e)},s.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return r.SlowBuffer(e)}}),ws=u((e,t)=>{t.exports=function(e,t){var i=t||{},n=i.type||"attachment",a=function(e,t){if(void 0!==e){var i={};if("string"!=typeof e)throw new TypeError("filename must be a string");if(void 0===t&&(t=!0),"string"!=typeof t&&"boolean"!=typeof t)throw new TypeError("fallback must be a string or boolean");if("string"==typeof t&&o.test(t))throw new TypeError("fallback must be ISO-8859-1 string");var n=r(e),a=p.test(n),l="string"!=typeof t?t&&y(n):r(t),c="string"==typeof l&&l!==n;return(c||!a||s.test(n))&&(i["filename*"]=n),(a||c)&&(i.filename=c?l:n),i}}(e,i.fallback);return function(e){var t=e.parameters,r=e.type;if(!r||"string"!=typeof r||!h.test(r))throw new TypeError("invalid type");var i=String(r).toLowerCase();if(t&&"object"==typeof t)for(var n,s=Object.keys(t).sort(),a=0;a<s.length;a++){var o="*"===(n=s[a]).substr(-1)?_(t[n]):w(t[n]);i+="; "+n+"="+o}return i}(new S(n,a))},t.exports.parse=function(e){if(!e||"string"!=typeof e)throw new TypeError("argument string is required");var t=m.exec(e);if(!t)throw new TypeError("invalid type format");var r,i,n=t[0].length,s=t[1].toLowerCase(),a=[],o={};for(n=d.lastIndex=";"===t[0].substr(-1)?n-1:n;t=d.exec(e);){if(t.index!==n)throw new TypeError("invalid parameter format");if(n+=t[0].length,r=t[1].toLowerCase(),i=t[2],-1!==a.indexOf(r))throw new TypeError("invalid duplicate parameter");a.push(r),r.indexOf("*")+1!==r.length?"string"!=typeof o[r]&&('"'===i[0]&&(i=i.substr(1,i.length-2).replace(l,"$1")),o[r]=i):(r=r.slice(0,-1),i=g(i),o[r]=i)}if(-1!==n&&n!==e.length)throw new TypeError("invalid parameter format");return new S(s,o)};var r=c("path").basename,i=bs().Buffer,n=/[\x00-\x20"'()*,/:;<=>?@[\\\]{}\x7f]/g,s=/%[0-9A-Fa-f]{2}/,a=/%([0-9A-Fa-f]{2})/g,o=/[^\x20-\x7e\xa0-\xff]/g,l=/\\([\u0000-\u007f])/g,u=/([\\"])/g,d=/;[\x09\x20]*([!#$%&'*+.0-9A-Z^_`a-z|~-]+)[\x09\x20]*=[\x09\x20]*("(?:[\x20!\x23-\x5b\x5d-\x7e\x80-\xff]|\\[\x20-\x7e])*"|[!#$%&'*+.0-9A-Z^_`a-z|~-]+)[\x09\x20]*/g,p=/^[\x20-\x7e\x80-\xff]+$/,h=/^[!#$%&'*+.0-9A-Z^_`a-z|~-]+$/,f=/^([A-Za-z0-9!#$%&+\-^_`{}~]+)'(?:[A-Za-z]{2,3}(?:-[A-Za-z]{3}){0,3}|[A-Za-z]{4,8}|)'((?:%[0-9A-Fa-f]{2}|[A-Za-z0-9!#$&+.^_`|~-])+)$/,m=/^([!#$%&'*+.0-9A-Z^_`a-z|~-]+)[\x09\x20]*(?:$|;)/;function g(e){var t=f.exec(e);if(!t)throw new TypeError("invalid extended field value");var r,n=t[1].toLowerCase(),s=t[2].replace(a,v);switch(n){case"iso-8859-1":r=y(s);break;case"utf-8":r=i.from(s,"binary").toString("utf8");break;default:throw new TypeError("unsupported charset in extended field")}return r}function y(e){return String(e).replace(o,"?")}function v(e,t){return String.fromCharCode(parseInt(t,16))}function b(e){return"%"+String(e).charCodeAt(0).toString(16).toUpperCase()}function w(e){return'"'+String(e).replace(u,"\\$1")+'"'}function _(e){var t=String(e);return"UTF-8''"+encodeURIComponent(t).replace(n,b)}function S(e,t){this.type=e,this.parameters=t}}),_s=u((e,t)=>{var r=c("node:os"),i=c("node:path"),n=c("node:fs/promises"),s=h(),a=Math.max(1,r.cpus().length-1),o={_getExtendedInfo:async function(e,t){let r=e.split(i.sep).length,l=await n.readdir(e),c=s.promise(async s=>{let a,l=i.join(e,s);try{a=await n.stat(l)}catch{return}a.isDirectory()?(t.totalFolderCount++,l.split(i.sep).length===r+1&&t.folderCount++,await o._getExtendedInfo(l,t)):(t.totalSize+=a.size,t.totalFileCount++,l.split(i.sep).length===r+1&&t.fileCount++,t.lastModified=Math.max(t.lastModified,a.mtimeMs))},a);await Promise.all(l.map(e=>c.push(e)))},getExtendedInfo:async function(e){let t={totalSize:0,fileCount:0,totalFileCount:0,folderCount:0,totalFolderCount:0,lastModified:0};return await o._getExtendedInfo(e,t),t},list:async function(e,t,r){let l={dirs:[],files:[]},c=await n.readdir(e);if(("deny"===r||"ignore"===r)&&(c=c.filter(e=>"."!==e.charAt(0))),c.length<1)return l;let u=s.promise(async r=>{let s;try{s=await n.stat(i.join(e,r))}catch{return}let a={name:r,stats:s};s.isDirectory()?(t.extendedFolderInfo&&(a.extendedInfo=await o.getExtendedInfo(i.join(e,r))),l.dirs.push(a)):l.files.push(a)},a);return await Promise.all(c.map(e=>u.push(e))),l.dirs.sort((e,t)=>e.name.localeCompare(t.name)),l.files.sort((e,t)=>e.name.localeCompare(t.name)),l},send:async function({reply:e,dir:t,options:r,route:i,prefix:n,dotfiles:s}){if("html"===e.request.query.format&&"function"!=typeof r.render)throw new Error("The `list.render` option must be a function and is required with the URL parameter `format=html`");let a;try{a=await o.list(t,r,s)}catch{return e.callNotFound()}if("html"!==(e.request.query.format||r.format)){if("extended"!==r.jsonFormat){let t={dirs:[],files:[]};a.dirs.forEach(e=>t.dirs.push(e.name)),a.files.forEach(e=>t.files.push(e.name)),e.send(t)}else e.send(a);return}let l=r.render(a.dirs.map(e=>o.htmlInfo(e,i,n,r)),a.files.map(e=>o.htmlInfo(e,i,n,r)));e.type("text/html").send(l)},htmlInfo:function(e,t,r,n){return n.names?.includes(i.basename(t))&&(t=i.normalize(i.join(t,".."))),{href:encodeURI(i.join(r,t,e.name).replace(/\\/gu,"/")),name:e.name,stats:e.stats,extendedInfo:e.extendedInfo}},handle:function(e,t){return t.names?.includes(i.basename(e))||((t.names?.includes("/")&&"/"===e[e.length-1])??!1)},path:function(e,t){return i.dirname(i.join(e,"/"===t[t.length-1]?t+"none":t))},validateOptions:function(e){if(e.list){if(Array.isArray(e.root))return new TypeError("multi-root with list option is not supported");if(e.list.format&&"json"!==e.list.format&&"html"!==e.list.format)return new TypeError("The `list.format` option must be json or html");if(e.list.names&&!Array.isArray(e.list.names))return new TypeError("The `list.names` option must be an array");if(null!=e.list.jsonFormat&&"names"!==e.list.jsonFormat&&"extended"!==e.list.jsonFormat)return new TypeError("The `list.jsonFormat` option must be name or extended");if("html"===e.list.format&&"function"!=typeof e.list.render)return new TypeError("The `list.render` option must be a function and is required with html format")}}};t.exports=o}),Ss=u((e,t)=>{var{PassThrough:r}=c("node:stream"),i=c("node:path"),{fileURLToPath:n}=c("node:url"),{statSync:s}=c("node:fs"),{glob:a}=qn(),o=Hn(),l=ys(),u=vs(),d=ws(),p=_s(),h=/\/$/u,f=/\*/gu,m=["br","gzip","deflate"];async function g(e,t){t.root=function(e){if(void 0===e)return e;if(e instanceof URL&&"file:"===e.protocol)return n(e);if(Array.isArray(e)){let t=[];for(let r=0,i=e.length;r<i;++r)e[r]instanceof URL&&"file:"===e[r].protocol?t.push(n(e[r])):t.push(e[r]);return t}return e}(t.root),function(e,t){if(void 0===t)throw new Error('"root" option is required');if(!Array.isArray(t)){if("string"==typeof t)return y(e,t);throw new Error('"root" option must be a string or array of strings')}if(!t.length)throw new Error('"root" option array requires one or more paths');if(new Set(t).size!==t.length)throw new Error('"root" option array contains one or more duplicate paths');t.map(t=>y(e,t))}(e,t.root);let s=t.setHeaders;if(void 0!==s&&"function"!=typeof s)throw new TypeError("The `setHeaders` option must be a function");let o=p.validateOptions(t);if(o)throw o;void 0===t.dotfiles&&(t.dotfiles="allow");let c={root:t.root,acceptRanges:t.acceptRanges,cacheControl:t.cacheControl,dotfiles:t.dotfiles,etag:t.etag,extensions:t.extensions,immutable:t.immutable,index:t.index,lastModified:t.lastModified,maxAge:t.maxAge},g=t.prefix??(t.prefix="/");t.prefixAvoidTrailingSlash||(g="/"===g[g.length-1]?g:g+"/");let _={constraints:t.constraints,schema:{hide:void 0===t.schemaHide||t.schemaHide},errorHandler(t,r,i){"ERR_STREAM_PREMATURE_CLOSE"!==t?.code?e.errorHandler(t,r,i):i.request.raw.destroy()}};if(!1!==t.decorateReply&&(e.decorateReply("sendFile",function(e,t,r){let i="object"==typeof t?t:r;return E(this.request,this,e,("string"==typeof t?t:i&&i.root)||c.root,0,i),this}),e.decorateReply("download",function(e,t,r={}){let{root:i,...n}="object"==typeof t?t:r;return this.header("content-disposition",d(t="string"==typeof t?t:e)),E(this.request,this,e,i,0,n),this})),!1!==t.serve){if(t.wildcard&&"boolean"!=typeof t.wildcard)throw new Error('"wildcard" option must be a boolean');if(void 0===t.wildcard||!0===t.wildcard)e.route({..._,method:["HEAD","GET"],path:g+"*",handler(e,t){E(e,t,"/"+e.params["*"],c.root)}}),!0===t.redirect&&g!==t.prefix&&e.get(t.prefix,_,(e,t)=>{t.redirect(301,w(e.raw.url))});else{let e=void 0===t.index?["index.html"]:[].concat(t.index),r=new Map,n=new Set,s=Array.isArray(c.root)?c.root:[c.root];for(let o of s){o=o.split(i.win32.sep).join(i.posix.sep),!o.endsWith("/")&&(o+="/");let s=await a("**/**",{cwd:o,absolute:!1,follow:!0,nodir:!0,dot:t.serveDotFiles});for(let t of s){t=t.split(i.win32.sep).join(i.posix.sep);let s=g+t;if(n.has(s))continue;n.add(s),k(_,s,`/${t}`,o);let a=i.posix.basename(s);e.includes(a)&&!r.has(a)&&r.set(i.posix.dirname(s),o)}}for(let[e,i]of r.entries()){let r=e+(e.endsWith("/")?"":"/"),n="/"+r.replace(g,"");k(_,r,n,i),!0===t.redirect&&k(_,r.replace(h,""),n.replace(h,""),i)}}}let S=t.allowedPath;function E(e,i,n,a,o=0,d,h){let y=n,_=Object.assign({},c,d);if(a&&(_.root=Array.isArray(a)?a[o]:a),S&&!S(n,_.root,e))return i.callNotFound();let k,x=n;if(t.preCompressed&&(h||(h=new Set),k=function(e,t){if(!("accept-encoding"in e))return;let r=e["accept-encoding"].toLowerCase().replace(f,"gzip");return u.negotiate(r,m.filter(e=>!t.has(e)))}(e.headers,h),k))if(n.endsWith("/")){if(!(n=v(n,_.root,_.index)))return i.callNotFound();x=x+n+"."+b(k)}else x=n+"."+b(k);let T,P=l(e.raw,encodeURI(x),_);P.on("file",function(e){T=e});let R=new r({flush(e){this.finished=!0,304===i.raw.statusCode&&i.send(""),e()}});R.getHeader=i.getHeader.bind(i),R.setHeader=i.header.bind(i),R.removeHeader=()=>{},R.finished=!1,Object.defineProperty(R,"filename",{get:()=>T}),Object.defineProperty(R,"statusCode",{get:()=>i.raw.statusCode,set(e){i.code(e)}}),"HEAD"===e.method?R.on("finish",i.send.bind(i)):R.on("pipe",function(){k&&(i.header("content-type",function(e){let t=l.mime.getType(e)||l.mime.default_type;return l.isUtf8MimeType(t)?`${t}; charset=UTF-8`:t}(n)),i.header("content-encoding",k)),i.send(R)}),void 0!==s&&P.on("headers",s),P.on("directory",function(r,s){if(t.list)p.send({reply:i,dir:s,options:t.list,route:n,prefix:g,dotfiles:t.dotfiles}).catch(e=>i.send(e));else if(!0===t.redirect)try{i.redirect(301,w(e.raw.url))}catch(e){i.send(e)}else{if(!n.endsWith("/")&&v(n,_.root,_.index))return E(e,i,n+"/",a,void 0,void 0,h);i.callNotFound()}}),P.on("error",function(r){return"ENOENT"===r.code?t.preCompressed&&k&&v(n,_.root,_.index)?E(e,i,n+"/",a,void 0,void 0,h):t.list&&p.handle(n,t.list)?void p.send({reply:i,dir:p.path(t.root,n),options:t.list,route:n,prefix:g,dotfiles:t.dotfiles}).catch(e=>i.send(e)):Array.isArray(a)&&o<a.length-1?E(e,i,n,a,o+1):t.preCompressed&&!h.has(k)?(h.add(k),E(e,i,y,a,o,void 0,h)):i.callNotFound():404===r.status?i.callNotFound():void i.send(r)}),P.pipe(R)}function k(t,r,i,n){let s=Object.assign({},t,{method:["HEAD","GET"],url:r,handler:x});s.config=s.config||{},s.config.file=i,s.config.rootPath=n,e.route(s)}function x(e,t){let r=e.routeOptions?.config||e.routeConfig;E(e,t,r.file,r.rootPath)}}function y(e,t){if("string"!=typeof t)throw new Error('"root" option must be a string');if(!1===i.isAbsolute(t))throw new Error('"root" option must be an absolute path');let r;try{r=s(t)}catch(r){if("ENOENT"===r.code)return void e.log.warn(`"root" path "${t}" must exist`);throw r}if(!1===r.isDirectory())throw new Error('"root" option must point to a directory')}function v(e,t,r=["index.html"]){return!!Array.isArray(r)&&r.find(r=>{let n=i.join(t,e,r);try{return!s(n).isDirectory()}catch{return!1}})}function b(e){switch(e){case"br":return"br";case"gzip":return"gz"}}function w(e){let t=0;for(;t<e.length&&("/"===e[t]||"\\"===e[t]);++t);e="/"+e.substr(t);try{let t=new URL(e,"http://localhost.com/"),r=t.pathname;return r+("/"!==r[r.length-1]?"/":"")+(t.search||"")}catch{let t=new Error(`Invalid redirect URL: ${e}`);throw t.statusCode=400,t}}l.mime.default_type="application/octet-stream",t.exports=o(g,{fastify:"4.x",name:"@fastify/static"}),t.exports.default=g,t.exports.fastifyStatic=g}),Es=u((e,t)=>{var r=["nodebuffer","arraybuffer","fragments"],i=typeof Blob<"u";i&&r.push("blob"),t.exports={BINARY_TYPES:r,CLOSE_TIMEOUT:3e4,EMPTY_BUFFER:Buffer.alloc(0),GUID:"258EAFA5-E914-47DA-95CA-C5AB0DC85B11",hasBlob:i,kForOnEventAttribute:Symbol("kIsForOnEventAttribute"),kListener:Symbol("kListener"),kStatusCode:Symbol("status-code"),kWebSocket:Symbol("websocket"),NOOP:()=>{}}}),ks=u((e,t)=>{var{EMPTY_BUFFER:r}=Es(),i=Buffer[Symbol.species];function n(e,t,r,i,n){for(let s=0;s<n;s++)r[i+s]=e[s]^t[3&s]}function s(e,t){for(let r=0;r<e.length;r++)e[r]^=t[3&r]}if(t.exports={concat:function(e,t){if(0===e.length)return r;if(1===e.length)return e[0];let n=Buffer.allocUnsafe(t),s=0;for(let t=0;t<e.length;t++){let r=e[t];n.set(r,s),s+=r.length}return s<t?new i(n.buffer,n.byteOffset,s):n},mask:n,toArrayBuffer:function(e){return e.length===e.buffer.byteLength?e.buffer:e.buffer.slice(e.byteOffset,e.byteOffset+e.length)},toBuffer:function e(t){if(e.readOnly=!0,Buffer.isBuffer(t))return t;let r;return t instanceof ArrayBuffer?r=new i(t):ArrayBuffer.isView(t)?r=new i(t.buffer,t.byteOffset,t.byteLength):(r=Buffer.from(t),e.readOnly=!1),r},unmask:s},!process.env.WS_NO_BUFFER_UTIL)try{let e=c("bufferutil");t.exports.mask=function(t,r,i,s,a){a<48?n(t,r,i,s,a):e.mask(t,r,i,s,a)},t.exports.unmask=function(t,r){t.length<32?s(t,r):e.unmask(t,r)}}catch{}}),xs=u((e,t)=>{var r=Symbol("kDone"),i=Symbol("kRun");t.exports=class{constructor(e){this[r]=()=>{this.pending--,this[i]()},this.concurrency=e||1/0,this.jobs=[],this.pending=0}add(e){this.jobs.push(e),this[i]()}[i](){if(this.pending!==this.concurrency&&this.jobs.length){let e=this.jobs.shift();this.pending++,e(this[r])}}}}),Ts=u((e,t)=>{var r,i=c("zlib"),n=ks(),s=xs(),{kStatusCode:a}=Es(),o=Buffer[Symbol.species],l=Buffer.from([0,0,255,255]),u=Symbol("permessage-deflate"),d=Symbol("total-length"),p=Symbol("callback"),h=Symbol("buffers"),f=Symbol("error");function m(e){this[h].push(e),this[d]+=e.length}function g(e){this[d]+=e.length,this[u]._maxPayload<1||this[d]<=this[u]._maxPayload?this[h].push(e):(this[f]=new RangeError("Max payload size exceeded"),this[f].code="WS_ERR_UNSUPPORTED_MESSAGE_LENGTH",this[f][a]=1009,this.removeListener("data",g),this.reset())}function y(e){this[u]._inflate=null,this[f]?this[p](this[f]):(e[a]=1007,this[p](e))}t.exports=class{constructor(e,t,i){this._maxPayload=0|i,this._options=e||{},this._threshold=void 0!==this._options.threshold?this._options.threshold:1024,this._isServer=!!t,this._deflate=null,this._inflate=null,this.params=null,r||(r=new s(void 0!==this._options.concurrencyLimit?this._options.concurrencyLimit:10))}static get extensionName(){return"permessage-deflate"}offer(){let e={};return this._options.serverNoContextTakeover&&(e.server_no_context_takeover=!0),this._options.clientNoContextTakeover&&(e.client_no_context_takeover=!0),this._options.serverMaxWindowBits&&(e.server_max_window_bits=this._options.serverMaxWindowBits),this._options.clientMaxWindowBits?e.client_max_window_bits=this._options.clientMaxWindowBits:null==this._options.clientMaxWindowBits&&(e.client_max_window_bits=!0),e}accept(e){return e=this.normalizeParams(e),this.params=this._isServer?this.acceptAsServer(e):this.acceptAsClient(e),this.params}cleanup(){if(this._inflate&&(this._inflate.close(),this._inflate=null),this._deflate){let e=this._deflate[p];this._deflate.close(),this._deflate=null,e&&e(new Error("The deflate stream was closed while data was being processed"))}}acceptAsServer(e){let t=this._options,r=e.find(e=>!(!1===t.serverNoContextTakeover&&e.server_no_context_takeover||e.server_max_window_bits&&(!1===t.serverMaxWindowBits||"number"==typeof t.serverMaxWindowBits&&t.serverMaxWindowBits>e.server_max_window_bits)||"number"==typeof t.clientMaxWindowBits&&!e.client_max_window_bits));if(!r)throw new Error("None of the extension offers can be accepted");return t.serverNoContextTakeover&&(r.server_no_context_takeover=!0),t.clientNoContextTakeover&&(r.client_no_context_takeover=!0),"number"==typeof t.serverMaxWindowBits&&(r.server_max_window_bits=t.serverMaxWindowBits),"number"==typeof t.clientMaxWindowBits?r.client_max_window_bits=t.clientMaxWindowBits:(!0===r.client_max_window_bits||!1===t.clientMaxWindowBits)&&delete r.client_max_window_bits,r}acceptAsClient(e){let t=e[0];if(!1===this._options.clientNoContextTakeover&&t.client_no_context_takeover)throw new Error('Unexpected parameter "client_no_context_takeover"');if(t.client_max_window_bits){if(!1===this._options.clientMaxWindowBits||"number"==typeof this._options.clientMaxWindowBits&&t.client_max_window_bits>this._options.clientMaxWindowBits)throw new Error('Unexpected or invalid parameter "client_max_window_bits"')}else"number"==typeof this._options.clientMaxWindowBits&&(t.client_max_window_bits=this._options.clientMaxWindowBits);return t}normalizeParams(e){return e.forEach(e=>{Object.keys(e).forEach(t=>{let r=e[t];if(r.length>1)throw new Error(`Parameter "${t}" must have only a single value`);if(r=r[0],"client_max_window_bits"===t){if(!0!==r){let e=+r;if(!Number.isInteger(e)||e<8||e>15)throw new TypeError(`Invalid value for parameter "${t}": ${r}`);r=e}else if(!this._isServer)throw new TypeError(`Invalid value for parameter "${t}": ${r}`)}else if("server_max_window_bits"===t){let e=+r;if(!Number.isInteger(e)||e<8||e>15)throw new TypeError(`Invalid value for parameter "${t}": ${r}`);r=e}else{if("client_no_context_takeover"!==t&&"server_no_context_takeover"!==t)throw new Error(`Unknown parameter "${t}"`);if(!0!==r)throw new TypeError(`Invalid value for parameter "${t}": ${r}`)}e[t]=r})}),e}decompress(e,t,i){r.add(r=>{this._decompress(e,t,(e,t)=>{r(),i(e,t)})})}compress(e,t,i){r.add(r=>{this._compress(e,t,(e,t)=>{r(),i(e,t)})})}_decompress(e,t,r){let s=this._isServer?"client":"server";if(!this._inflate){let e=`${s}_max_window_bits`;this._inflate=i.createInflateRaw({...this._options.zlibInflateOptions,windowBits:"number"!=typeof this.params[e]?i.Z_DEFAULT_WINDOWBITS:this.params[e]}),this._inflate[u]=this,this._inflate[d]=0,this._inflate[h]=[],this._inflate.on("error",y),this._inflate.on("data",g)}this._inflate[p]=r,this._inflate.write(e),t&&this._inflate.write(l),this._inflate.flush(()=>{let e=this._inflate[f];if(e)return this._inflate.close(),this._inflate=null,void r(e);let i=n.concat(this._inflate[h],this._inflate[d]);this._inflate._readableState.endEmitted?(this._inflate.close(),this._inflate=null):(this._inflate[d]=0,this._inflate[h]=[],t&&this.params[`${s}_no_context_takeover`]&&this._inflate.reset()),r(null,i)})}_compress(e,t,r){let s=this._isServer?"server":"client";if(!this._deflate){let e=`${s}_max_window_bits`;this._deflate=i.createDeflateRaw({...this._options.zlibDeflateOptions,windowBits:"number"!=typeof this.params[e]?i.Z_DEFAULT_WINDOWBITS:this.params[e]}),this._deflate[d]=0,this._deflate[h]=[],this._deflate.on("data",m)}this._deflate[p]=r,this._deflate.write(e),this._deflate.flush(i.Z_SYNC_FLUSH,()=>{if(!this._deflate)return;let e=n.concat(this._deflate[h],this._deflate[d]);t&&(e=new o(e.buffer,e.byteOffset,e.length-4)),this._deflate[p]=null,this._deflate[d]=0,this._deflate[h]=[],t&&this.params[`${s}_no_context_takeover`]&&this._deflate.reset(),r(null,e)})}}}),Ps=u((e,t)=>{var{isUtf8:r}=c("buffer"),{hasBlob:i}=Es();function n(e){let t=e.length,r=0;for(;r<t;)if(128&e[r])if(192==(224&e[r])){if(r+1===t||128!=(192&e[r+1])||192==(254&e[r]))return!1;r+=2}else if(224==(240&e[r])){if(r+2>=t||128!=(192&e[r+1])||128!=(192&e[r+2])||224===e[r]&&128==(224&e[r+1])||237===e[r]&&160==(224&e[r+1]))return!1;r+=3}else{if(240!=(248&e[r]))return!1;if(r+3>=t||128!=(192&e[r+1])||128!=(192&e[r+2])||128!=(192&e[r+3])||240===e[r]&&128==(240&e[r+1])||244===e[r]&&e[r+1]>143||e[r]>244)return!1;r+=4}else r++;return!0}if(t.exports={isBlob:function(e){return i&&"object"==typeof e&&"function"==typeof e.arrayBuffer&&"string"==typeof e.type&&"function"==typeof e.stream&&("Blob"===e[Symbol.toStringTag]||"File"===e[Symbol.toStringTag])},isValidStatusCode:function(e){return e>=1e3&&e<=1014&&1004!==e&&1005!==e&&1006!==e||e>=3e3&&e<=4999},isValidUTF8:n,tokenChars:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,1,1,1,1,0,0,1,1,0,1,1,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,0,1,0]},r)t.exports.isValidUTF8=function(e){return e.length<24?n(e):r(e)};else if(!process.env.WS_NO_UTF_8_VALIDATE)try{let e=c("utf-8-validate");t.exports.isValidUTF8=function(t){return t.length<32?n(t):e(t)}}catch{}}),Rs=u((e,t)=>{var{Writable:r}=c("stream"),i=Ts(),{BINARY_TYPES:n,EMPTY_BUFFER:s,kStatusCode:a,kWebSocket:o}=Es(),{concat:l,toArrayBuffer:u,unmask:d}=ks(),{isValidStatusCode:p,isValidUTF8:h}=Ps(),f=Buffer[Symbol.species];t.exports=class extends r{constructor(e={}){super(),this._allowSynchronousEvents=void 0===e.allowSynchronousEvents||e.allowSynchronousEvents,this._binaryType=e.binaryType||n[0],this._extensions=e.extensions||{},this._isServer=!!e.isServer,this._maxPayload=0|e.maxPayload,this._skipUTF8Validation=!!e.skipUTF8Validation,this[o]=void 0,this._bufferedBytes=0,this._buffers=[],this._compressed=!1,this._payloadLength=0,this._mask=void 0,this._fragmented=0,this._masked=!1,this._fin=!1,this._opcode=0,this._totalPayloadLength=0,this._messageLength=0,this._fragments=[],this._errored=!1,this._loop=!1,this._state=0}_write(e,t,r){if(8===this._opcode&&0==this._state)return r();this._bufferedBytes+=e.length,this._buffers.push(e),this.startLoop(r)}consume(e){if(this._bufferedBytes-=e,e===this._buffers[0].length)return this._buffers.shift();if(e<this._buffers[0].length){let t=this._buffers[0];return this._buffers[0]=new f(t.buffer,t.byteOffset+e,t.length-e),new f(t.buffer,t.byteOffset,e)}let t=Buffer.allocUnsafe(e);do{let r=this._buffers[0],i=t.length-e;e>=r.length?t.set(this._buffers.shift(),i):(t.set(new Uint8Array(r.buffer,r.byteOffset,e),i),this._buffers[0]=new f(r.buffer,r.byteOffset+e,r.length-e)),e-=r.length}while(e>0);return t}startLoop(e){this._loop=!0;do{switch(this._state){case 0:this.getInfo(e);break;case 1:this.getPayloadLength16(e);break;case 2:this.getPayloadLength64(e);break;case 3:this.getMask();break;case 4:this.getData(e);break;case 5:case 6:return void(this._loop=!1)}}while(this._loop);this._errored||e()}getInfo(e){if(this._bufferedBytes<2)return void(this._loop=!1);let t=this.consume(2);if(48&t[0])return void e(this.createError(RangeError,"RSV2 and RSV3 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_2_3"));let r=!(64&~t[0]);if(!r||this._extensions[i.extensionName]){if(this._fin=!(128&~t[0]),this._opcode=15&t[0],this._payloadLength=127&t[1],0===this._opcode){if(r)return void e(this.createError(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1"));if(!this._fragmented)return void e(this.createError(RangeError,"invalid opcode 0",!0,1002,"WS_ERR_INVALID_OPCODE"));this._opcode=this._fragmented}else if(1===this._opcode||2===this._opcode){if(this._fragmented)return void e(this.createError(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE"));this._compressed=r}else{if(!(this._opcode>7&&this._opcode<11))return void e(this.createError(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE"));if(!this._fin)return void e(this.createError(RangeError,"FIN must be set",!0,1002,"WS_ERR_EXPECTED_FIN"));if(r)return void e(this.createError(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1"));if(this._payloadLength>125||8===this._opcode&&1===this._payloadLength)return void e(this.createError(RangeError,`invalid payload length ${this._payloadLength}`,!0,1002,"WS_ERR_INVALID_CONTROL_PAYLOAD_LENGTH"))}if(!this._fin&&!this._fragmented&&(this._fragmented=this._opcode),this._masked=!(128&~t[1]),this._isServer){if(!this._masked)return void e(this.createError(RangeError,"MASK must be set",!0,1002,"WS_ERR_EXPECTED_MASK"))}else if(this._masked)return void e(this.createError(RangeError,"MASK must be clear",!0,1002,"WS_ERR_UNEXPECTED_MASK"));126===this._payloadLength?this._state=1:127===this._payloadLength?this._state=2:this.haveLength(e)}else e(this.createError(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1"))}getPayloadLength16(e){this._bufferedBytes<2?this._loop=!1:(this._payloadLength=this.consume(2).readUInt16BE(0),this.haveLength(e))}getPayloadLength64(e){if(this._bufferedBytes<8)return void(this._loop=!1);let t=this.consume(8),r=t.readUInt32BE(0);r>Math.pow(2,21)-1?e(this.createError(RangeError,"Unsupported WebSocket frame: payload length > 2^53 - 1",!1,1009,"WS_ERR_UNSUPPORTED_DATA_PAYLOAD_LENGTH")):(this._payloadLength=r*Math.pow(2,32)+t.readUInt32BE(4),this.haveLength(e))}haveLength(e){this._payloadLength&&this._opcode<8&&(this._totalPayloadLength+=this._payloadLength,this._totalPayloadLength>this._maxPayload&&this._maxPayload>0)?e(this.createError(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH")):this._state=this._masked?3:4}getMask(){this._bufferedBytes<4?this._loop=!1:(this._mask=this.consume(4),this._state=4)}getData(e){let t=s;if(this._payloadLength){if(this._bufferedBytes<this._payloadLength)return void(this._loop=!1);t=this.consume(this._payloadLength),this._masked&&0!==(this._mask[0]|this._mask[1]|this._mask[2]|this._mask[3])&&d(t,this._mask)}if(!(this._opcode>7))return this._compressed?(this._state=5,void this.decompress(t,e)):(t.length&&(this._messageLength=this._totalPayloadLength,this._fragments.push(t)),void this.dataMessage(e));this.controlMessage(t,e)}decompress(e,t){this._extensions[i.extensionName].decompress(e,this._fin,(e,r)=>{if(e)return t(e);if(r.length){if(this._messageLength+=r.length,this._messageLength>this._maxPayload&&this._maxPayload>0){let e=this.createError(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH");return void t(e)}this._fragments.push(r)}this.dataMessage(t),0===this._state&&this.startLoop(t)})}dataMessage(e){if(!this._fin)return void(this._state=0);let t=this._messageLength,r=this._fragments;if(this._totalPayloadLength=0,this._messageLength=0,this._fragmented=0,this._fragments=[],2===this._opcode){let i;i="nodebuffer"===this._binaryType?l(r,t):"arraybuffer"===this._binaryType?u(l(r,t)):"blob"===this._binaryType?new Blob(r):r,this._allowSynchronousEvents?(this.emit("message",i,!0),this._state=0):(this._state=6,setImmediate(()=>{this.emit("message",i,!0),this._state=0,this.startLoop(e)}))}else{let i=l(r,t);if(!this._skipUTF8Validation&&!h(i)){let t=this.createError(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8");return void e(t)}5===this._state||this._allowSynchronousEvents?(this.emit("message",i,!1),this._state=0):(this._state=6,setImmediate(()=>{this.emit("message",i,!1),this._state=0,this.startLoop(e)}))}}controlMessage(e,t){if(8!==this._opcode)this._allowSynchronousEvents?(this.emit(9===this._opcode?"ping":"pong",e),this._state=0):(this._state=6,setImmediate(()=>{this.emit(9===this._opcode?"ping":"pong",e),this._state=0,this.startLoop(t)}));else{if(0===e.length)this._loop=!1,this.emit("conclude",1005,s),this.end();else{let r=e.readUInt16BE(0);if(!p(r)){let e=this.createError(RangeError,`invalid status code ${r}`,!0,1002,"WS_ERR_INVALID_CLOSE_CODE");return void t(e)}let i=new f(e.buffer,e.byteOffset+2,e.length-2);if(!this._skipUTF8Validation&&!h(i)){let e=this.createError(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8");return void t(e)}this._loop=!1,this.emit("conclude",r,i),this.end()}this._state=0}}createError(e,t,r,i,n){this._loop=!1,this._errored=!0;let s=new e(r?`Invalid WebSocket frame: ${t}`:t);return Error.captureStackTrace(s,this.createError),s.code=n,s[a]=i,s}}}),Os=u((e,t)=>{c("stream");var r,{randomFillSync:i}=c("crypto"),n=Ts(),{EMPTY_BUFFER:s,kWebSocket:a,NOOP:o}=Es(),{isBlob:l,isValidStatusCode:u}=Ps(),{mask:d,toBuffer:p}=ks(),h=Symbol("kByteLength"),f=Buffer.alloc(4),m=8192,g=m;function y(e,t,r){"function"==typeof r&&r(t);for(let r=0;r<e._queue.length;r++){let i=e._queue[r],n=i[i.length-1];"function"==typeof n&&n(t)}}function v(e,t,r){y(e,t,r),e.onerror(t)}t.exports=class e{constructor(e,t,r){this._extensions=t||{},r&&(this._generateMask=r,this._maskBuffer=Buffer.alloc(4)),this._socket=e,this._firstFragment=!0,this._compress=!1,this._bufferedBytes=0,this._queue=[],this._state=0,this.onerror=o,this[a]=void 0}static frame(e,t){let n,s,a=!1,o=2,l=!1;t.mask&&(n=t.maskBuffer||f,t.generateMask?t.generateMask(n):(g===m&&(void 0===r&&(r=Buffer.alloc(m)),i(r,0,m),g=0),n[0]=r[g++],n[1]=r[g++],n[2]=r[g++],n[3]=r[g++]),l=0===(n[0]|n[1]|n[2]|n[3]),o=6),"string"==typeof e?s=t.mask&&!l||void 0===t[h]?(e=Buffer.from(e)).length:t[h]:(s=e.length,a=t.mask&&t.readOnly&&!l);let c=s;s>=65536?(o+=8,c=127):s>125&&(o+=2,c=126);let u=Buffer.allocUnsafe(a?s+o:o);return u[0]=t.fin?128|t.opcode:t.opcode,t.rsv1&&(u[0]|=64),u[1]=c,126===c?u.writeUInt16BE(s,2):127===c&&(u[2]=u[3]=0,u.writeUIntBE(s,4,6)),t.mask?(u[1]|=128,u[o-4]=n[0],u[o-3]=n[1],u[o-2]=n[2],u[o-1]=n[3],l?[u,e]:a?(d(e,n,u,o,s),[u]):(d(e,n,e,0,s),[u,e])):[u,e]}close(t,r,i,n){let a;if(void 0===t)a=s;else{if("number"!=typeof t||!u(t))throw new TypeError("First argument must be a valid error code number");if(void 0!==r&&r.length){let e=Buffer.byteLength(r);if(e>123)throw new RangeError("The message must not be greater than 123 bytes");a=Buffer.allocUnsafe(2+e),a.writeUInt16BE(t,0),"string"==typeof r?a.write(r,2):a.set(r,2)}else a=Buffer.allocUnsafe(2),a.writeUInt16BE(t,0)}let o={[h]:a.length,fin:!0,generateMask:this._generateMask,mask:i,maskBuffer:this._maskBuffer,opcode:8,readOnly:!1,rsv1:!1};0!==this._state?this.enqueue([this.dispatch,a,!1,o,n]):this.sendFrame(e.frame(a,o),n)}ping(t,r,i){let n,s;if("string"==typeof t?(n=Buffer.byteLength(t),s=!1):l(t)?(n=t.size,s=!1):(n=(t=p(t)).length,s=p.readOnly),n>125)throw new RangeError("The data size must not be greater than 125 bytes");let a={[h]:n,fin:!0,generateMask:this._generateMask,mask:r,maskBuffer:this._maskBuffer,opcode:9,readOnly:s,rsv1:!1};l(t)?0!==this._state?this.enqueue([this.getBlobData,t,!1,a,i]):this.getBlobData(t,!1,a,i):0!==this._state?this.enqueue([this.dispatch,t,!1,a,i]):this.sendFrame(e.frame(t,a),i)}pong(t,r,i){let n,s;if("string"==typeof t?(n=Buffer.byteLength(t),s=!1):l(t)?(n=t.size,s=!1):(n=(t=p(t)).length,s=p.readOnly),n>125)throw new RangeError("The data size must not be greater than 125 bytes");let a={[h]:n,fin:!0,generateMask:this._generateMask,mask:r,maskBuffer:this._maskBuffer,opcode:10,readOnly:s,rsv1:!1};l(t)?0!==this._state?this.enqueue([this.getBlobData,t,!1,a,i]):this.getBlobData(t,!1,a,i):0!==this._state?this.enqueue([this.dispatch,t,!1,a,i]):this.sendFrame(e.frame(t,a),i)}send(e,t,r){let i,s,a=this._extensions[n.extensionName],o=t.binary?2:1,c=t.compress;"string"==typeof e?(i=Buffer.byteLength(e),s=!1):l(e)?(i=e.size,s=!1):(i=(e=p(e)).length,s=p.readOnly),this._firstFragment?(this._firstFragment=!1,c&&a&&a.params[a._isServer?"server_no_context_takeover":"client_no_context_takeover"]&&(c=i>=a._threshold),this._compress=c):(c=!1,o=0),t.fin&&(this._firstFragment=!0);let u={[h]:i,fin:t.fin,generateMask:this._generateMask,mask:t.mask,maskBuffer:this._maskBuffer,opcode:o,readOnly:s,rsv1:c};l(e)?0!==this._state?this.enqueue([this.getBlobData,e,this._compress,u,r]):this.getBlobData(e,this._compress,u,r):0!==this._state?this.enqueue([this.dispatch,e,this._compress,u,r]):this.dispatch(e,this._compress,u,r)}getBlobData(t,r,i,n){this._bufferedBytes+=i[h],this._state=2,t.arrayBuffer().then(t=>{if(this._socket.destroyed){let e=new Error("The socket was closed while the blob was being read");return void process.nextTick(y,this,e,n)}this._bufferedBytes-=i[h];let s=p(t);r?this.dispatch(s,r,i,n):(this._state=0,this.sendFrame(e.frame(s,i),n),this.dequeue())}).catch(e=>{process.nextTick(v,this,e,n)})}dispatch(t,r,i,s){if(!r)return void this.sendFrame(e.frame(t,i),s);let a=this._extensions[n.extensionName];this._bufferedBytes+=i[h],this._state=1,a.compress(t,i.fin,(t,r)=>{this._socket.destroyed?y(this,new Error("The socket was closed while data was being compressed"),s):(this._bufferedBytes-=i[h],this._state=0,i.readOnly=!1,this.sendFrame(e.frame(r,i),s),this.dequeue())})}dequeue(){for(;0===this._state&&this._queue.length;){let e=this._queue.shift();this._bufferedBytes-=e[3][h],Reflect.apply(e[0],this,e.slice(1))}}enqueue(e){this._bufferedBytes+=e[3][h],this._queue.push(e)}sendFrame(e,t){2===e.length?(this._socket.cork(),this._socket.write(e[0]),this._socket.write(e[1],t),this._socket.uncork()):this._socket.write(e[0],t)}}}),$s=u((e,t)=>{var{kForOnEventAttribute:r,kListener:i}=Es(),n=Symbol("kCode"),s=Symbol("kData"),a=Symbol("kError"),o=Symbol("kMessage"),l=Symbol("kReason"),c=Symbol("kTarget"),u=Symbol("kType"),d=Symbol("kWasClean"),p=class{constructor(e){this[c]=null,this[u]=e}get target(){return this[c]}get type(){return this[u]}};Object.defineProperty(p.prototype,"target",{enumerable:!0}),Object.defineProperty(p.prototype,"type",{enumerable:!0});var h=class extends p{constructor(e,t={}){super(e),this[n]=void 0===t.code?0:t.code,this[l]=void 0===t.reason?"":t.reason,this[d]=void 0!==t.wasClean&&t.wasClean}get code(){return this[n]}get reason(){return this[l]}get wasClean(){return this[d]}};Object.defineProperty(h.prototype,"code",{enumerable:!0}),Object.defineProperty(h.prototype,"reason",{enumerable:!0}),Object.defineProperty(h.prototype,"wasClean",{enumerable:!0});var f=class extends p{constructor(e,t={}){super(e),this[a]=void 0===t.error?null:t.error,this[o]=void 0===t.message?"":t.message}get error(){return this[a]}get message(){return this[o]}};Object.defineProperty(f.prototype,"error",{enumerable:!0}),Object.defineProperty(f.prototype,"message",{enumerable:!0});var m=class extends p{constructor(e,t={}){super(e),this[s]=void 0===t.data?null:t.data}get data(){return this[s]}};Object.defineProperty(m.prototype,"data",{enumerable:!0});var g={addEventListener(e,t,n={}){for(let s of this.listeners(e))if(!n[r]&&s[i]===t&&!s[r])return;let s;if("message"===e)s=function(e,r){let i=new m("message",{data:r?e:e.toString()});i[c]=this,y(t,this,i)};else if("close"===e)s=function(e,r){let i=new h("close",{code:e,reason:r.toString(),wasClean:this._closeFrameReceived&&this._closeFrameSent});i[c]=this,y(t,this,i)};else if("error"===e)s=function(e){let r=new f("error",{error:e,message:e.message});r[c]=this,y(t,this,r)};else{if("open"!==e)return;s=function(){let e=new p("open");e[c]=this,y(t,this,e)}}s[r]=!!n[r],s[i]=t,n.once?this.once(e,s):this.on(e,s)},removeEventListener(e,t){for(let n of this.listeners(e))if(n[i]===t&&!n[r]){this.removeListener(e,n);break}}};function y(e,t,r){"object"==typeof e&&e.handleEvent?e.handleEvent.call(e,r):e.call(t,r)}t.exports={CloseEvent:h,ErrorEvent:f,Event:p,EventTarget:g,MessageEvent:m}}),Cs=u((e,t)=>{var{tokenChars:r}=Ps();function i(e,t,r){void 0===e[t]?e[t]=[r]:e[t].push(r)}t.exports={format:function(e){return Object.keys(e).map(t=>{let r=e[t];return Array.isArray(r)||(r=[r]),r.map(e=>[t].concat(Object.keys(e).map(t=>{let r=e[t];return Array.isArray(r)||(r=[r]),r.map(e=>!0===e?t:`${t}=${e}`).join("; ")})).join("; ")).join(", ")}).join(", ")},parse:function(e){let t,n,s=Object.create(null),a=Object.create(null),o=!1,l=!1,c=!1,u=-1,d=-1,p=-1,h=0;for(;h<e.length;h++)if(d=e.charCodeAt(h),void 0===t)if(-1===p&&1===r[d])-1===u&&(u=h);else if(0===h||32!==d&&9!==d){if(59!==d&&44!==d)throw new SyntaxError(`Unexpected character at index ${h}`);{if(-1===u)throw new SyntaxError(`Unexpected character at index ${h}`);-1===p&&(p=h);let r=e.slice(u,p);44===d?(i(s,r,a),a=Object.create(null)):t=r,u=p=-1}}else-1===p&&-1!==u&&(p=h);else if(void 0===n)if(-1===p&&1===r[d])-1===u&&(u=h);else if(32===d||9===d)-1===p&&-1!==u&&(p=h);else if(59===d||44===d){if(-1===u)throw new SyntaxError(`Unexpected character at index ${h}`);-1===p&&(p=h),i(a,e.slice(u,p),!0),44===d&&(i(s,t,a),a=Object.create(null),t=void 0),u=p=-1}else{if(61!==d||-1===u||-1!==p)throw new SyntaxError(`Unexpected character at index ${h}`);n=e.slice(u,h),u=p=-1}else if(l){if(1!==r[d])throw new SyntaxError(`Unexpected character at index ${h}`);-1===u?u=h:o||(o=!0),l=!1}else if(c)if(1===r[d])-1===u&&(u=h);else if(34===d&&-1!==u)c=!1,p=h;else{if(92!==d)throw new SyntaxError(`Unexpected character at index ${h}`);l=!0}else if(34===d&&61===e.charCodeAt(h-1))c=!0;else if(-1===p&&1===r[d])-1===u&&(u=h);else if(-1===u||32!==d&&9!==d){if(59!==d&&44!==d)throw new SyntaxError(`Unexpected character at index ${h}`);{if(-1===u)throw new SyntaxError(`Unexpected character at index ${h}`);-1===p&&(p=h);let r=e.slice(u,p);o&&(r=r.replace(/\\/g,""),o=!1),i(a,n,r),44===d&&(i(s,t,a),a=Object.create(null),t=void 0),n=void 0,u=p=-1}}else-1===p&&(p=h);if(-1===u||c||32===d||9===d)throw new SyntaxError("Unexpected end of input");-1===p&&(p=h);let f=e.slice(u,p);return void 0===t?i(s,f,a):(void 0===n?i(a,f,!0):i(a,n,o?f.replace(/\\/g,""):f),i(s,t,a)),s}}}),As=u((e,t)=>{var r=c("events"),i=c("https"),n=c("http"),s=c("net"),a=c("tls"),{randomBytes:o,createHash:l}=c("crypto"),{URL:u}=(c("stream"),c("url")),d=Ts(),p=Rs(),h=Os(),{isBlob:f}=Ps(),{BINARY_TYPES:m,CLOSE_TIMEOUT:g,EMPTY_BUFFER:y,GUID:v,kForOnEventAttribute:b,kListener:w,kStatusCode:_,kWebSocket:S,NOOP:E}=Es(),{EventTarget:{addEventListener:k,removeEventListener:x}}=$s(),{format:T,parse:P}=Cs(),{toBuffer:R}=ks(),O=Symbol("kAborted"),$=[8,13],C=["CONNECTING","OPEN","CLOSING","CLOSED"],A=/^[!#$%&'*+\-.0-9A-Z^_`|a-z~]+$/,N=class e extends r{constructor(t,r,i){super(),this._binaryType=m[0],this._closeCode=1006,this._closeFrameReceived=!1,this._closeFrameSent=!1,this._closeMessage=y,this._closeTimer=null,this._errorEmitted=!1,this._extensions={},this._paused=!1,this._protocol="",this._readyState=e.CONNECTING,this._receiver=null,this._sender=null,this._socket=null,null!==t?(this._bufferedAmount=0,this._isServer=!1,this._redirects=0,void 0===r?r=[]:Array.isArray(r)||("object"==typeof r&&null!==r?(i=r,r=[]):r=[r]),I(this,t,r,i)):(this._autoPong=i.autoPong,this._closeTimeout=i.closeTimeout,this._isServer=!0)}get binaryType(){return this._binaryType}set binaryType(e){m.includes(e)&&(this._binaryType=e,this._receiver&&(this._receiver._binaryType=e))}get bufferedAmount(){return this._socket?this._socket._writableState.length+this._sender._bufferedBytes:this._bufferedAmount}get extensions(){return Object.keys(this._extensions).join()}get isPaused(){return this._paused}get onclose(){return null}get onerror(){return null}get onopen(){return null}get onmessage(){return null}get protocol(){return this._protocol}get readyState(){return this._readyState}get url(){return this._url}setSocket(t,r,i){let n=new p({allowSynchronousEvents:i.allowSynchronousEvents,binaryType:this.binaryType,extensions:this._extensions,isServer:this._isServer,maxPayload:i.maxPayload,skipUTF8Validation:i.skipUTF8Validation}),s=new h(t,this._extensions,i.generateMask);this._receiver=n,this._sender=s,this._socket=t,n[S]=this,s[S]=this,t[S]=this,n.on("conclude",z),n.on("drain",q),n.on("error",U),n.on("message",H),n.on("ping",V),n.on("pong",G),s.onerror=K,t.setTimeout&&t.setTimeout(0),t.setNoDelay&&t.setNoDelay(),r.length>0&&t.unshift(r),t.on("close",Z),t.on("data",Y),t.on("end",X),t.on("error",Q),this._readyState=e.OPEN,this.emit("open")}emitClose(){if(!this._socket)return this._readyState=e.CLOSED,void this.emit("close",this._closeCode,this._closeMessage);this._extensions[d.extensionName]&&this._extensions[d.extensionName].cleanup(),this._receiver.removeAllListeners(),this._readyState=e.CLOSED,this.emit("close",this._closeCode,this._closeMessage)}close(t,r){if(this.readyState!==e.CLOSED){if(this.readyState===e.CONNECTING)return void F(this,this._req,"WebSocket was closed before the connection was established");if(this.readyState===e.CLOSING)return void(this._closeFrameSent&&(this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end());this._readyState=e.CLOSING,this._sender.close(t,r,!this._isServer,e=>{e||(this._closeFrameSent=!0,(this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end())}),J(this)}}pause(){this.readyState===e.CONNECTING||this.readyState===e.CLOSED||(this._paused=!0,this._socket.pause())}ping(t,r,i){if(this.readyState===e.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");"function"==typeof t?(i=t,t=r=void 0):"function"==typeof r&&(i=r,r=void 0),"number"==typeof t&&(t=t.toString()),this.readyState===e.OPEN?(void 0===r&&(r=!this._isServer),this._sender.ping(t||y,r,i)):M(this,t,i)}pong(t,r,i){if(this.readyState===e.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");"function"==typeof t?(i=t,t=r=void 0):"function"==typeof r&&(i=r,r=void 0),"number"==typeof t&&(t=t.toString()),this.readyState===e.OPEN?(void 0===r&&(r=!this._isServer),this._sender.pong(t||y,r,i)):M(this,t,i)}resume(){this.readyState===e.CONNECTING||this.readyState===e.CLOSED||(this._paused=!1,this._receiver._writableState.needDrain||this._socket.resume())}send(t,r,i){if(this.readyState===e.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");if("function"==typeof r&&(i=r,r={}),"number"==typeof t&&(t=t.toString()),this.readyState!==e.OPEN)return void M(this,t,i);let n={binary:"string"!=typeof t,mask:!this._isServer,compress:!0,fin:!0,...r};this._extensions[d.extensionName]||(n.compress=!1),this._sender.send(t||y,n,i)}terminate(){if(this.readyState!==e.CLOSED){if(this.readyState===e.CONNECTING)return void F(this,this._req,"WebSocket was closed before the connection was established");this._socket&&(this._readyState=e.CLOSING,this._socket.destroy())}}};function I(e,t,r,s){let a,c={allowSynchronousEvents:!0,autoPong:!0,closeTimeout:g,protocolVersion:$[1],maxPayload:104857600,skipUTF8Validation:!1,perMessageDeflate:!0,followRedirects:!1,maxRedirects:10,...s,socketPath:void 0,hostname:void 0,protocol:void 0,timeout:void 0,method:"GET",host:void 0,path:void 0,port:void 0};if(e._autoPong=c.autoPong,e._closeTimeout=c.closeTimeout,!$.includes(c.protocolVersion))throw new RangeError(`Unsupported protocol version: ${c.protocolVersion} (supported versions: ${$.join(", ")})`);if(t instanceof u)a=t;else try{a=new u(t)}catch{throw new SyntaxError(`Invalid URL: ${t}`)}"http:"===a.protocol?a.protocol="ws:":"https:"===a.protocol&&(a.protocol="wss:"),e._url=a.href;let p,h="wss:"===a.protocol,f="ws+unix:"===a.protocol;if("ws:"===a.protocol||h||f?f&&!a.pathname?p="The URL's pathname is empty":a.hash&&(p="The URL contains a fragment identifier"):p='The URL\'s protocol must be one of "ws:", "wss:", "http:", "https:", or "ws+unix:"',p){let t=new SyntaxError(p);if(0===e._redirects)throw t;return void j(e,t)}let m,y,b=h?443:80,w=o(16).toString("base64"),_=h?i.request:n.request,S=new Set;if(c.createConnection=c.createConnection||(h?D:L),c.defaultPort=c.defaultPort||b,c.port=a.port||b,c.host=a.hostname.startsWith("[")?a.hostname.slice(1,-1):a.hostname,c.headers={...c.headers,"Sec-WebSocket-Version":c.protocolVersion,"Sec-WebSocket-Key":w,Connection:"Upgrade",Upgrade:"websocket"},c.path=a.pathname+a.search,c.timeout=c.handshakeTimeout,c.perMessageDeflate&&(m=new d(!0!==c.perMessageDeflate?c.perMessageDeflate:{},!1,c.maxPayload),c.headers["Sec-WebSocket-Extensions"]=T({[d.extensionName]:m.offer()})),r.length){for(let e of r){if("string"!=typeof e||!A.test(e)||S.has(e))throw new SyntaxError("An invalid or duplicated subprotocol was specified");S.add(e)}c.headers["Sec-WebSocket-Protocol"]=r.join(",")}if(c.origin&&(c.protocolVersion<13?c.headers["Sec-WebSocket-Origin"]=c.origin:c.headers.Origin=c.origin),(a.username||a.password)&&(c.auth=`${a.username}:${a.password}`),f){let e=c.path.split(":");c.socketPath=e[0],c.path=e[1]}if(c.followRedirects){if(0===e._redirects){e._originalIpc=f,e._originalSecure=h,e._originalHostOrSocketPath=f?c.socketPath:a.host;let t=s&&s.headers;if(s={...s,headers:{}},t)for(let[e,r]of Object.entries(t))s.headers[e.toLowerCase()]=r}else if(0===e.listenerCount("redirect")){let t=f?!!e._originalIpc&&c.socketPath===e._originalHostOrSocketPath:!e._originalIpc&&a.host===e._originalHostOrSocketPath;(!t||e._originalSecure&&!h)&&(delete c.headers.authorization,delete c.headers.cookie,t||delete c.headers.host,c.auth=void 0)}c.auth&&!s.headers.authorization&&(s.headers.authorization="Basic "+Buffer.from(c.auth).toString("base64")),y=e._req=_(c),e._redirects&&e.emit("redirect",e.url,y)}else y=e._req=_(c);c.timeout&&y.on("timeout",()=>{F(e,y,"Opening handshake has timed out")}),y.on("error",t=>{null===y||y[O]||(y=e._req=null,j(e,t))}),y.on("response",i=>{let n=i.headers.location,a=i.statusCode;if(n&&c.followRedirects&&a>=300&&a<400){if(++e._redirects>c.maxRedirects)return void F(e,y,"Maximum redirects exceeded");let i;y.abort();try{i=new u(n,t)}catch{let t=new SyntaxError(`Invalid URL: ${n}`);return void j(e,t)}I(e,i,r,s)}else e.emit("unexpected-response",y,i)||F(e,y,`Unexpected server response: ${i.statusCode}`)}),y.on("upgrade",(t,r,i)=>{if(e.emit("upgrade",t),e.readyState!==N.CONNECTING)return;y=e._req=null;let n=t.headers.upgrade;if(void 0===n||"websocket"!==n.toLowerCase())return void F(e,r,"Invalid Upgrade header");let s=l("sha1").update(w+v).digest("base64");if(t.headers["sec-websocket-accept"]!==s)return void F(e,r,"Invalid Sec-WebSocket-Accept header");let a,o=t.headers["sec-websocket-protocol"];if(void 0!==o?S.size?S.has(o)||(a="Server sent an invalid subprotocol"):a="Server sent a subprotocol but none was requested":S.size&&(a="Server sent no subprotocol"),a)return void F(e,r,a);o&&(e._protocol=o);let u=t.headers["sec-websocket-extensions"];if(void 0!==u){if(!m)return void F(e,r,"Server sent a Sec-WebSocket-Extensions header but no extension was requested");let t;try{t=P(u)}catch{return void F(e,r,"Invalid Sec-WebSocket-Extensions header")}let i=Object.keys(t);if(1!==i.length||i[0]!==d.extensionName)return void F(e,r,"Server indicated an extension that was not requested");try{m.accept(t[d.extensionName])}catch{return void F(e,r,"Invalid Sec-WebSocket-Extensions header")}e._extensions[d.extensionName]=m}e.setSocket(r,i,{allowSynchronousEvents:c.allowSynchronousEvents,generateMask:c.generateMask,maxPayload:c.maxPayload,skipUTF8Validation:c.skipUTF8Validation})}),c.finishRequest?c.finishRequest(y,e):y.end()}function j(e,t){e._readyState=N.CLOSING,e._errorEmitted=!0,e.emit("error",t),e.emitClose()}function L(e){return e.path=e.socketPath,s.connect(e)}function D(e){return e.path=void 0,!e.servername&&""!==e.servername&&(e.servername=s.isIP(e.host)?"":e.host),a.connect(e)}function F(e,t,r){e._readyState=N.CLOSING;let i=new Error(r);Error.captureStackTrace(i,F),t.setHeader?(t[O]=!0,t.abort(),t.socket&&!t.socket.destroyed&&t.socket.destroy(),process.nextTick(j,e,i)):(t.destroy(i),t.once("error",e.emit.bind(e,"error")),t.once("close",e.emitClose.bind(e)))}function M(e,t,r){if(t){let r=f(t)?t.size:R(t).length;e._socket?e._sender._bufferedBytes+=r:e._bufferedAmount+=r}if(r){let t=new Error(`WebSocket is not open: readyState ${e.readyState} (${C[e.readyState]})`);process.nextTick(r,t)}}function z(e,t){let r=this[S];r._closeFrameReceived=!0,r._closeMessage=t,r._closeCode=e,void 0!==r._socket[S]&&(r._socket.removeListener("data",Y),process.nextTick(W,r._socket),1005===e?r.close():r.close(e,t))}function q(){let e=this[S];e.isPaused||e._socket.resume()}function U(e){let t=this[S];void 0!==t._socket[S]&&(t._socket.removeListener("data",Y),process.nextTick(W,t._socket),t.close(e[_])),t._errorEmitted||(t._errorEmitted=!0,t.emit("error",e))}function B(){this[S].emitClose()}function H(e,t){this[S].emit("message",e,t)}function V(e){let t=this[S];t._autoPong&&t.pong(e,!this._isServer,E),t.emit("ping",e)}function G(e){this[S].emit("pong",e)}function W(e){e.resume()}function K(e){let t=this[S];t.readyState!==N.CLOSED&&(t.readyState===N.OPEN&&(t._readyState=N.CLOSING,J(t)),this._socket.end(),t._errorEmitted||(t._errorEmitted=!0,t.emit("error",e)))}function J(e){e._closeTimer=setTimeout(e._socket.destroy.bind(e._socket),e._closeTimeout)}function Z(){let e=this[S];if(this.removeListener("close",Z),this.removeListener("data",Y),this.removeListener("end",X),e._readyState=N.CLOSING,!this._readableState.endEmitted&&!e._closeFrameReceived&&!e._receiver._writableState.errorEmitted&&0!==this._readableState.length){let t=this.read(this._readableState.length);e._receiver.write(t)}e._receiver.end(),this[S]=void 0,clearTimeout(e._closeTimer),e._receiver._writableState.finished||e._receiver._writableState.errorEmitted?e.emitClose():(e._receiver.on("error",B),e._receiver.on("finish",B))}function Y(e){this[S]._receiver.write(e)||this.pause()}function X(){let e=this[S];e._readyState=N.CLOSING,e._receiver.end(),this.end()}function Q(){let e=this[S];this.removeListener("error",Q),this.on("error",E),e&&(e._readyState=N.CLOSING,this.destroy())}Object.defineProperty(N,"CONNECTING",{enumerable:!0,value:C.indexOf("CONNECTING")}),Object.defineProperty(N.prototype,"CONNECTING",{enumerable:!0,value:C.indexOf("CONNECTING")}),Object.defineProperty(N,"OPEN",{enumerable:!0,value:C.indexOf("OPEN")}),Object.defineProperty(N.prototype,"OPEN",{enumerable:!0,value:C.indexOf("OPEN")}),Object.defineProperty(N,"CLOSING",{enumerable:!0,value:C.indexOf("CLOSING")}),Object.defineProperty(N.prototype,"CLOSING",{enumerable:!0,value:C.indexOf("CLOSING")}),Object.defineProperty(N,"CLOSED",{enumerable:!0,value:C.indexOf("CLOSED")}),Object.defineProperty(N.prototype,"CLOSED",{enumerable:!0,value:C.indexOf("CLOSED")}),["binaryType","bufferedAmount","extensions","isPaused","protocol","readyState","url"].forEach(e=>{Object.defineProperty(N.prototype,e,{enumerable:!0})}),["open","error","close","message"].forEach(e=>{Object.defineProperty(N.prototype,`on${e}`,{enumerable:!0,get(){for(let t of this.listeners(e))if(t[b])return t[w];return null},set(t){for(let t of this.listeners(e))if(t[b]){this.removeListener(e,t);break}"function"==typeof t&&this.addEventListener(e,t,{[b]:!0})}})}),N.prototype.addEventListener=k,N.prototype.removeEventListener=x,t.exports=N}),Ns=u((e,t)=>{As();var{Duplex:r}=c("stream");function i(e){e.emit("close")}function n(){!this.destroyed&&this._writableState.finished&&this.destroy()}function s(e){this.removeListener("error",s),this.destroy(),0===this.listenerCount("error")&&this.emit("error",e)}t.exports=function(e,t){let a=!0,o=new r({...t,autoDestroy:!1,emitClose:!1,objectMode:!1,writableObjectMode:!1});return e.on("message",function(t,r){let i=!r&&o._readableState.objectMode?t.toString():t;o.push(i)||e.pause()}),e.once("error",function(e){o.destroyed||(a=!1,o.destroy(e))}),e.once("close",function(){o.destroyed||o.push(null)}),o._destroy=function(t,r){if(e.readyState===e.CLOSED)return r(t),void process.nextTick(i,o);let n=!1;e.once("error",function(e){n=!0,r(e)}),e.once("close",function(){n||r(t),process.nextTick(i,o)}),a&&e.terminate()},o._final=function(t){e.readyState!==e.CONNECTING?null!==e._socket&&(e._socket._writableState.finished?(t(),o._readableState.endEmitted&&o.destroy()):(e._socket.once("finish",function(){t()}),e.close())):e.once("open",function(){o._final(t)})},o._read=function(){e.isPaused&&e.resume()},o._write=function(t,r,i){e.readyState!==e.CONNECTING?e.send(t,i):e.once("open",function(){o._write(t,r,i)})},o.on("end",n),o.on("error",s),o}}),Is=u((e,t)=>{var{tokenChars:r}=Ps();t.exports={parse:function(e){let t=new Set,i=-1,n=-1,s=0;for(;s<e.length;s++){let a=e.charCodeAt(s);if(-1===n&&1===r[a])-1===i&&(i=s);else if(0===s||32!==a&&9!==a){if(44!==a)throw new SyntaxError(`Unexpected character at index ${s}`);{if(-1===i)throw new SyntaxError(`Unexpected character at index ${s}`);-1===n&&(n=s);let r=e.slice(i,n);if(t.has(r))throw new SyntaxError(`The "${r}" subprotocol is duplicated`);t.add(r),i=n=-1}}else-1===n&&-1!==i&&(n=s)}if(-1===i||-1!==n)throw new SyntaxError("Unexpected end of input");let a=e.slice(i,s);if(t.has(a))throw new SyntaxError(`The "${a}" subprotocol is duplicated`);return t.add(a),t}}}),js=u((e,t)=>{var r=c("events"),i=c("http"),{createHash:n}=(c("stream"),c("crypto")),s=Cs(),a=Ts(),o=Is(),l=As(),{CLOSE_TIMEOUT:u,GUID:d,kWebSocket:p}=Es(),h=/^[+/0-9A-Za-z]{22}==$/;function f(e){e._state=2,e.emit("close")}function m(){this.destroy()}function g(e,t,r,n){r=r||i.STATUS_CODES[t],n={Connection:"close","Content-Type":"text/html","Content-Length":Buffer.byteLength(r),...n},e.once("finish",e.destroy),e.end(`HTTP/1.1 ${t} ${i.STATUS_CODES[t]}\r\n`+Object.keys(n).map(e=>`${e}: ${n[e]}`).join("\r\n")+"\r\n\r\n"+r)}function y(e,t,r,i,n,s){if(e.listenerCount("wsClientError")){let i=new Error(n);Error.captureStackTrace(i,y),e.emit("wsClientError",i,r,t)}else g(r,i,n,s)}t.exports=class extends r{constructor(e,t){if(super(),null==(e={allowSynchronousEvents:!0,autoPong:!0,maxPayload:104857600,skipUTF8Validation:!1,perMessageDeflate:!1,handleProtocols:null,clientTracking:!0,closeTimeout:u,verifyClient:null,noServer:!1,backlog:null,server:null,host:null,path:null,port:null,WebSocket:l,...e}).port&&!e.server&&!e.noServer||null!=e.port&&(e.server||e.noServer)||e.server&&e.noServer)throw new TypeError('One and only one of the "port", "server", or "noServer" options must be specified');if(null!=e.port?(this._server=i.createServer((e,t)=>{let r=i.STATUS_CODES[426];t.writeHead(426,{"Content-Length":r.length,"Content-Type":"text/plain"}),t.end(r)}),this._server.listen(e.port,e.host,e.backlog,t)):e.server&&(this._server=e.server),this._server){let e=this.emit.bind(this,"connection");this._removeListeners=function(e,t){for(let r of Object.keys(t))e.on(r,t[r]);return function(){for(let r of Object.keys(t))e.removeListener(r,t[r])}}(this._server,{listening:this.emit.bind(this,"listening"),error:this.emit.bind(this,"error"),upgrade:(t,r,i)=>{this.handleUpgrade(t,r,i,e)}})}!0===e.perMessageDeflate&&(e.perMessageDeflate={}),e.clientTracking&&(this.clients=new Set,this._shouldEmitClose=!1),this.options=e,this._state=0}address(){if(this.options.noServer)throw new Error('The server is operating in "noServer" mode');return this._server?this._server.address():null}close(e){if(2===this._state)return e&&this.once("close",()=>{e(new Error("The server is not running"))}),void process.nextTick(f,this);if(e&&this.once("close",e),1!==this._state)if(this._state=1,this.options.noServer||this.options.server)this._server&&(this._removeListeners(),this._removeListeners=this._server=null),this.clients&&this.clients.size?this._shouldEmitClose=!0:process.nextTick(f,this);else{let e=this._server;this._removeListeners(),this._removeListeners=this._server=null,e.close(()=>{f(this)})}}shouldHandle(e){if(this.options.path){let t=e.url.indexOf("?");if((-1!==t?e.url.slice(0,t):e.url)!==this.options.path)return!1}return!0}handleUpgrade(e,t,r,i){t.on("error",m);let n=e.headers["sec-websocket-key"],l=e.headers.upgrade,c=+e.headers["sec-websocket-version"];if("GET"!==e.method)return void y(this,e,t,405,"Invalid HTTP method");if(void 0===l||"websocket"!==l.toLowerCase())return void y(this,e,t,400,"Invalid Upgrade header");if(void 0===n||!h.test(n))return void y(this,e,t,400,"Missing or invalid Sec-WebSocket-Key header");if(13!==c&&8!==c)return void y(this,e,t,400,"Missing or invalid Sec-WebSocket-Version header",{"Sec-WebSocket-Version":"13, 8"});if(!this.shouldHandle(e))return void g(t,400);let u=e.headers["sec-websocket-protocol"],d=new Set;if(void 0!==u)try{d=o.parse(u)}catch{return void y(this,e,t,400,"Invalid Sec-WebSocket-Protocol header")}let p=e.headers["sec-websocket-extensions"],f={};if(this.options.perMessageDeflate&&void 0!==p){let r=new a(this.options.perMessageDeflate,!0,this.options.maxPayload);try{let e=s.parse(p);e[a.extensionName]&&(r.accept(e[a.extensionName]),f[a.extensionName]=r)}catch{return void y(this,e,t,400,"Invalid or unacceptable Sec-WebSocket-Extensions header")}}if(this.options.verifyClient){let s={origin:e.headers[8===c?"sec-websocket-origin":"origin"],secure:!(!e.socket.authorized&&!e.socket.encrypted),req:e};if(2===this.options.verifyClient.length)return void this.options.verifyClient(s,(s,a,o,l)=>{if(!s)return g(t,a||401,o,l);this.completeUpgrade(f,n,d,e,t,r,i)});if(!this.options.verifyClient(s))return g(t,401)}this.completeUpgrade(f,n,d,e,t,r,i)}completeUpgrade(e,t,r,i,o,l,c){if(!o.readable||!o.writable)return o.destroy();if(o[p])throw new Error("server.handleUpgrade() was called more than once with the same socket, possibly due to a misconfiguration");if(this._state>0)return g(o,503);let u=["HTTP/1.1 101 Switching Protocols","Upgrade: websocket","Connection: Upgrade",`Sec-WebSocket-Accept: ${n("sha1").update(t+d).digest("base64")}`],h=new this.options.WebSocket(null,void 0,this.options);if(r.size){let e=this.options.handleProtocols?this.options.handleProtocols(r,i):r.values().next().value;e&&(u.push(`Sec-WebSocket-Protocol: ${e}`),h._protocol=e)}if(e[a.extensionName]){let t=e[a.extensionName].params,r=s.format({[a.extensionName]:[t]});u.push(`Sec-WebSocket-Extensions: ${r}`),h._extensions=e}this.emit("headers",u,i),o.write(u.concat("\r\n").join("\r\n")),o.removeListener("error",m),h.setSocket(o,l,{allowSynchronousEvents:this.options.allowSynchronousEvents,maxPayload:this.options.maxPayload,skipUTF8Validation:this.options.skipUTF8Validation}),this.clients&&(this.clients.add(h),h.on("close",()=>{this.clients.delete(h),this._shouldEmitClose&&!this.clients.size&&process.nextTick(f,this)})),c(h,i)}}}),Ls=d(En(),1),Ds=d(Ss(),1);import Fs from"node:path";import Ms from"node:fs/promises";import{execFile as zs}from"node:child_process";import{fileURLToPath as qs}from"node:url";var Us,Bs,Hs={};((e,t)=>{for(var r in t)n(e,r,{get:t[r],enumerable:!0})})(Hs,{BRAND:()=>ko,DIRTY:()=>aa,EMPTY_PATH:()=>ta,INVALID:()=>sa,NEVER:()=>yl,OK:()=>oa,ParseStatus:()=>na,Schema:()=>ga,ZodAny:()=>Ka,ZodArray:()=>Xa,ZodBigInt:()=>Ua,ZodBoolean:()=>Ba,ZodBranded:()=>xo,ZodCatch:()=>So,ZodDate:()=>Ha,ZodDefault:()=>_o,ZodDiscriminatedUnion:()=>io,ZodEffects:()=>vo,ZodEnum:()=>mo,ZodError:()=>Js,ZodFirstPartyTypeKind:()=>$o,ZodFunction:()=>uo,ZodIntersection:()=>so,ZodIssueCode:()=>Ws,ZodLazy:()=>po,ZodLiteral:()=>ho,ZodMap:()=>lo,ZodNaN:()=>Eo,ZodNativeEnum:()=>go,ZodNever:()=>Za,ZodNull:()=>Wa,ZodNullable:()=>wo,ZodNumber:()=>qa,ZodObject:()=>eo,ZodOptional:()=>bo,ZodParsedType:()=>Vs,ZodPipeline:()=>To,ZodPromise:()=>yo,ZodReadonly:()=>Po,ZodRecord:()=>oo,ZodSchema:()=>ga,ZodSet:()=>co,ZodString:()=>Ma,ZodSymbol:()=>Va,ZodTransformer:()=>vo,ZodTuple:()=>ao,ZodType:()=>ga,ZodUndefined:()=>Ga,ZodUnion:()=>to,ZodUnknown:()=>Ja,ZodVoid:()=>Ya,addIssueToContext:()=>ra,any:()=>Uo,array:()=>Go,bigint:()=>Lo,boolean:()=>Do,coerce:()=>gl,custom:()=>Oo,date:()=>Fo,datetimeRegex:()=>ja,defaultErrorMap:()=>Zs,discriminatedUnion:()=>Zo,effect:()=>ll,enum:()=>sl,function:()=>rl,getErrorMap:()=>Qs,getParsedType:()=>Gs,instanceof:()=>Ao,intersection:()=>Yo,isAborted:()=>la,isAsync:()=>da,isDirty:()=>ca,isValid:()=>ua,late:()=>Co,lazy:()=>il,literal:()=>nl,makeIssue:()=>ea,map:()=>el,nan:()=>jo,nativeEnum:()=>al,never:()=>Ho,null:()=>qo,nullable:()=>ul,number:()=>Io,object:()=>Wo,objectUtil:()=>Bs,oboolean:()=>ml,onumber:()=>fl,optional:()=>cl,ostring:()=>hl,pipeline:()=>pl,preprocess:()=>dl,promise:()=>ol,quotelessJson:()=>Ks,record:()=>Qo,set:()=>tl,setErrorMap:()=>Xs,strictObject:()=>Ko,string:()=>No,symbol:()=>Mo,transformer:()=>ll,tuple:()=>Xo,undefined:()=>zo,union:()=>Jo,unknown:()=>Bo,util:()=>Us,void:()=>Vo}),function(e){e.assertEqual=e=>{},e.assertIs=function(e){},e.assertNever=function(e){throw new Error},e.arrayToEnum=e=>{let t={};for(let r of e)t[r]=r;return t},e.getValidEnumValues=t=>{let r=e.objectKeys(t).filter(e=>"number"!=typeof t[t[e]]),i={};for(let e of r)i[e]=t[e];return e.objectValues(i)},e.objectValues=t=>e.objectKeys(t).map(function(e){return t[e]}),e.objectKeys="function"==typeof Object.keys?e=>Object.keys(e):e=>{let t=[];for(let r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.push(r);return t},e.find=(e,t)=>{for(let r of e)if(t(r))return r},e.isInteger="function"==typeof Number.isInteger?e=>Number.isInteger(e):e=>"number"==typeof e&&Number.isFinite(e)&&Math.floor(e)===e,e.joinValues=function(e,t=" | "){return e.map(e=>"string"==typeof e?`'${e}'`:e).join(t)},e.jsonStringifyReplacer=(e,t)=>"bigint"==typeof t?t.toString():t}(Us||(Us={})),(Bs||(Bs={})).mergeShapes=(e,t)=>({...e,...t});var Vs=Us.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Gs=e=>{switch(typeof e){case"undefined":return Vs.undefined;case"string":return Vs.string;case"number":return Number.isNaN(e)?Vs.nan:Vs.number;case"boolean":return Vs.boolean;case"function":return Vs.function;case"bigint":return Vs.bigint;case"symbol":return Vs.symbol;case"object":return Array.isArray(e)?Vs.array:null===e?Vs.null:e.then&&"function"==typeof e.then&&e.catch&&"function"==typeof e.catch?Vs.promise:typeof Map<"u"&&e instanceof Map?Vs.map:typeof Set<"u"&&e instanceof Set?Vs.set:typeof Date<"u"&&e instanceof Date?Vs.date:Vs.object;default:return Vs.unknown}},Ws=Us.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),Ks=e=>JSON.stringify(e,null,2).replace(/"([^"]+)":/g,"$1:"),Js=class e extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=e=>{this.issues=[...this.issues,e]},this.addIssues=(e=[])=>{this.issues=[...this.issues,...e]};let t=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,this.name="ZodError",this.issues=e}format(e){let t=e||function(e){return e.message},r={_errors:[]},i=e=>{for(let n of e.issues)if("invalid_union"===n.code)n.unionErrors.map(i);else if("invalid_return_type"===n.code)i(n.returnTypeError);else if("invalid_arguments"===n.code)i(n.argumentsError);else if(0===n.path.length)r._errors.push(t(n));else{let e=r,i=0;for(;i<n.path.length;){let r=n.path[i];i===n.path.length-1?(e[r]=e[r]||{_errors:[]},e[r]._errors.push(t(n))):e[r]=e[r]||{_errors:[]},e=e[r],i++}}};return i(this),r}static assert(t){if(!(t instanceof e))throw new Error(`Not a ZodError: ${t}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,Us.jsonStringifyReplacer,2)}get isEmpty(){return 0===this.issues.length}flatten(e=e=>e.message){let t={},r=[];for(let i of this.issues)if(i.path.length>0){let r=i.path[0];t[r]=t[r]||[],t[r].push(e(i))}else r.push(e(i));return{formErrors:r,fieldErrors:t}}get formErrors(){return this.flatten()}};Js.create=e=>new Js(e);var Zs=(e,t)=>{let r;switch(e.code){case Ws.invalid_type:r=e.received===Vs.undefined?"Required":`Expected ${e.expected}, received ${e.received}`;break;case Ws.invalid_literal:r=`Invalid literal value, expected ${JSON.stringify(e.expected,Us.jsonStringifyReplacer)}`;break;case Ws.unrecognized_keys:r=`Unrecognized key(s) in object: ${Us.joinValues(e.keys,", ")}`;break;case Ws.invalid_union:r="Invalid input";break;case Ws.invalid_union_discriminator:r=`Invalid discriminator value. Expected ${Us.joinValues(e.options)}`;break;case Ws.invalid_enum_value:r=`Invalid enum value. Expected ${Us.joinValues(e.options)}, received '${e.received}'`;break;case Ws.invalid_arguments:r="Invalid function arguments";break;case Ws.invalid_return_type:r="Invalid function return type";break;case Ws.invalid_date:r="Invalid date";break;case Ws.invalid_string:"object"==typeof e.validation?"includes"in e.validation?(r=`Invalid input: must include "${e.validation.includes}"`,"number"==typeof e.validation.position&&(r=`${r} at one or more positions greater than or equal to ${e.validation.position}`)):"startsWith"in e.validation?r=`Invalid input: must start with "${e.validation.startsWith}"`:"endsWith"in e.validation?r=`Invalid input: must end with "${e.validation.endsWith}"`:Us.assertNever(e.validation):r="regex"!==e.validation?`Invalid ${e.validation}`:"Invalid";break;case Ws.too_small:r="array"===e.type?`Array must contain ${e.exact?"exactly":e.inclusive?"at least":"more than"} ${e.minimum} element(s)`:"string"===e.type?`String must contain ${e.exact?"exactly":e.inclusive?"at least":"over"} ${e.minimum} character(s)`:"number"===e.type||"bigint"===e.type?`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:"date"===e.type?`Date must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(e.minimum))}`:"Invalid input";break;case Ws.too_big:r="array"===e.type?`Array must contain ${e.exact?"exactly":e.inclusive?"at most":"less than"} ${e.maximum} element(s)`:"string"===e.type?`String must contain ${e.exact?"exactly":e.inclusive?"at most":"under"} ${e.maximum} character(s)`:"number"===e.type?`Number must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:"bigint"===e.type?`BigInt must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:"date"===e.type?`Date must be ${e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(e.maximum))}`:"Invalid input";break;case Ws.custom:r="Invalid input";break;case Ws.invalid_intersection_types:r="Intersection results could not be merged";break;case Ws.not_multiple_of:r=`Number must be a multiple of ${e.multipleOf}`;break;case Ws.not_finite:r="Number must be finite";break;default:r=t.defaultError,Us.assertNever(e)}return{message:r}},Ys=Zs;function Xs(e){Ys=e}function Qs(){return Ys}var ea=e=>{let{data:t,path:r,errorMaps:i,issueData:n}=e,s=[...r,...n.path||[]],a={...n,path:s};if(void 0!==n.message)return{...n,path:s,message:n.message};let o="",l=i.filter(e=>!!e).slice().reverse();for(let e of l)o=e(a,{data:t,defaultError:o}).message;return{...n,path:s,message:o}},ta=[];function ra(e,t){let r=Qs(),i=ea({issueData:t,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,r,r===Zs?void 0:Zs].filter(e=>!!e)});e.common.issues.push(i)}var ia,na=class e{constructor(){this.value="valid"}dirty(){"valid"===this.value&&(this.value="dirty")}abort(){"aborted"!==this.value&&(this.value="aborted")}static mergeArray(e,t){let r=[];for(let i of t){if("aborted"===i.status)return sa;"dirty"===i.status&&e.dirty(),r.push(i.value)}return{status:e.value,value:r}}static async mergeObjectAsync(t,r){let i=[];for(let e of r){let t=await e.key,r=await e.value;i.push({key:t,value:r})}return e.mergeObjectSync(t,i)}static mergeObjectSync(e,t){let r={};for(let i of t){let{key:t,value:n}=i;if("aborted"===t.status||"aborted"===n.status)return sa;"dirty"===t.status&&e.dirty(),"dirty"===n.status&&e.dirty(),"__proto__"!==t.value&&(typeof n.value<"u"||i.alwaysSet)&&(r[t.value]=n.value)}return{status:e.value,value:r}}},sa=Object.freeze({status:"aborted"}),aa=e=>({status:"dirty",value:e}),oa=e=>({status:"valid",value:e}),la=e=>"aborted"===e.status,ca=e=>"dirty"===e.status,ua=e=>"valid"===e.status,da=e=>typeof Promise<"u"&&e instanceof Promise;!function(e){e.errToObj=e=>"string"==typeof e?{message:e}:e||{},e.toString=e=>"string"==typeof e?e:e?.message}(ia||(ia={}));var pa=class{constructor(e,t,r,i){this._cachedPath=[],this.parent=e,this.data=t,this._path=r,this._key=i}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}},ha=(e,t)=>{if(ua(t))return{success:!0,data:t.value};if(!e.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;let t=new Js(e.common.issues);return this._error=t,this._error}}};function fa(e){if(!e)return{};let{errorMap:t,invalid_type_error:r,required_error:i,description:n}=e;if(t&&(r||i))throw new Error('Can\'t use "invalid_type_error" or "required_error" in conjunction with custom error map.');return t?{errorMap:t,description:n}:{errorMap:(t,n)=>{let{message:s}=e;return"invalid_enum_value"===t.code?{message:s??n.defaultError}:typeof n.data>"u"?{message:s??i??n.defaultError}:"invalid_type"!==t.code?{message:n.defaultError}:{message:s??r??n.defaultError}},description:n}}var ma,ga=class{get description(){return this._def.description}_getType(e){return Gs(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:Gs(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new na,ctx:{common:e.parent.common,data:e.data,parsedType:Gs(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){let t=this._parse(e);if(da(t))throw new Error("Synchronous parse encountered promise.");return t}_parseAsync(e){let t=this._parse(e);return Promise.resolve(t)}parse(e,t){let r=this.safeParse(e,t);if(r.success)return r.data;throw r.error}safeParse(e,t){let r={common:{issues:[],async:t?.async??!1,contextualErrorMap:t?.errorMap},path:t?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Gs(e)},i=this._parseSync({data:e,path:r.path,parent:r});return ha(r,i)}"~validate"(e){let t={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Gs(e)};if(!this["~standard"].async)try{let r=this._parseSync({data:e,path:[],parent:t});return ua(r)?{value:r.value}:{issues:t.common.issues}}catch(e){e?.message?.toLowerCase()?.includes("encountered")&&(this["~standard"].async=!0),t.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:t}).then(e=>ua(e)?{value:e.value}:{issues:t.common.issues})}async parseAsync(e,t){let r=await this.safeParseAsync(e,t);if(r.success)return r.data;throw r.error}async safeParseAsync(e,t){let r={common:{issues:[],contextualErrorMap:t?.errorMap,async:!0},path:t?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Gs(e)},i=this._parse({data:e,path:r.path,parent:r}),n=await(da(i)?i:Promise.resolve(i));return ha(r,n)}refine(e,t){let r=e=>"string"==typeof t||typeof t>"u"?{message:t}:"function"==typeof t?t(e):t;return this._refinement((t,i)=>{let n=e(t),s=()=>i.addIssue({code:Ws.custom,...r(t)});return typeof Promise<"u"&&n instanceof Promise?n.then(e=>!!e||(s(),!1)):!!n||(s(),!1)})}refinement(e,t){return this._refinement((r,i)=>!!e(r)||(i.addIssue("function"==typeof t?t(r,i):t),!1))}_refinement(e){return new vo({schema:this,typeName:$o.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:e=>this["~validate"](e)}}optional(){return bo.create(this,this._def)}nullable(){return wo.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Xa.create(this)}promise(){return yo.create(this,this._def)}or(e){return to.create([this,e],this._def)}and(e){return so.create(this,e,this._def)}transform(e){return new vo({...fa(this._def),schema:this,typeName:$o.ZodEffects,effect:{type:"transform",transform:e}})}default(e){let t="function"==typeof e?e:()=>e;return new _o({...fa(this._def),innerType:this,defaultValue:t,typeName:$o.ZodDefault})}brand(){return new xo({typeName:$o.ZodBranded,type:this,...fa(this._def)})}catch(e){let t="function"==typeof e?e:()=>e;return new So({...fa(this._def),innerType:this,catchValue:t,typeName:$o.ZodCatch})}describe(e){return new(0,this.constructor)({...this._def,description:e})}pipe(e){return To.create(this,e)}readonly(){return Po.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}},ya=/^c[^\s-]{8,}$/i,va=/^[0-9a-z]+$/,ba=/^[0-9A-HJKMNP-TV-Z]{26}$/i,wa=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,_a=/^[a-z0-9_-]{21}$/i,Sa=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,Ea=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,ka=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,xa=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,Ta=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,Pa=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,Ra=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,Oa=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,$a=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,Ca="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",Aa=new RegExp(`^${Ca}$`);function Na(e){let t="[0-5]\\d";return e.precision?t=`${t}\\.\\d{${e.precision}}`:null==e.precision&&(t=`${t}(\\.\\d+)?`),`([01]\\d|2[0-3]):[0-5]\\d(:${t})${e.precision?"+":"?"}`}function Ia(e){return new RegExp(`^${Na(e)}$`)}function ja(e){let t=`${Ca}T${Na(e)}`,r=[];return r.push(e.local?"Z?":"Z"),e.offset&&r.push("([+-]\\d{2}:?\\d{2})"),t=`${t}(${r.join("|")})`,new RegExp(`^${t}$`)}function La(e,t){return!(("v4"!==t&&t||!xa.test(e))&&("v6"!==t&&t||!Pa.test(e)))}function Da(e,t){if(!Sa.test(e))return!1;try{let[r]=e.split(".");if(!r)return!1;let i=r.replace(/-/g,"+").replace(/_/g,"/").padEnd(r.length+(4-r.length%4)%4,"="),n=JSON.parse(atob(i));return!("object"!=typeof n||null===n||"typ"in n&&"JWT"!==n?.typ||!n.alg||t&&n.alg!==t)}catch{return!1}}function Fa(e,t){return!(("v4"!==t&&t||!Ta.test(e))&&("v6"!==t&&t||!Ra.test(e)))}var Ma=class e extends ga{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==Vs.string){let t=this._getOrReturnCtx(e);return ra(t,{code:Ws.invalid_type,expected:Vs.string,received:t.parsedType}),sa}let t,r=new na;for(let i of this._def.checks)if("min"===i.kind)e.data.length<i.value&&(t=this._getOrReturnCtx(e,t),ra(t,{code:Ws.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),r.dirty());else if("max"===i.kind)e.data.length>i.value&&(t=this._getOrReturnCtx(e,t),ra(t,{code:Ws.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),r.dirty());else if("length"===i.kind){let n=e.data.length>i.value,s=e.data.length<i.value;(n||s)&&(t=this._getOrReturnCtx(e,t),n?ra(t,{code:Ws.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):s&&ra(t,{code:Ws.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),r.dirty())}else if("email"===i.kind)ka.test(e.data)||(t=this._getOrReturnCtx(e,t),ra(t,{validation:"email",code:Ws.invalid_string,message:i.message}),r.dirty());else if("emoji"===i.kind)ma||(ma=new RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),ma.test(e.data)||(t=this._getOrReturnCtx(e,t),ra(t,{validation:"emoji",code:Ws.invalid_string,message:i.message}),r.dirty());else if("uuid"===i.kind)wa.test(e.data)||(t=this._getOrReturnCtx(e,t),ra(t,{validation:"uuid",code:Ws.invalid_string,message:i.message}),r.dirty());else if("nanoid"===i.kind)_a.test(e.data)||(t=this._getOrReturnCtx(e,t),ra(t,{validation:"nanoid",code:Ws.invalid_string,message:i.message}),r.dirty());else if("cuid"===i.kind)ya.test(e.data)||(t=this._getOrReturnCtx(e,t),ra(t,{validation:"cuid",code:Ws.invalid_string,message:i.message}),r.dirty());else if("cuid2"===i.kind)va.test(e.data)||(t=this._getOrReturnCtx(e,t),ra(t,{validation:"cuid2",code:Ws.invalid_string,message:i.message}),r.dirty());else if("ulid"===i.kind)ba.test(e.data)||(t=this._getOrReturnCtx(e,t),ra(t,{validation:"ulid",code:Ws.invalid_string,message:i.message}),r.dirty());else if("url"===i.kind)try{new URL(e.data)}catch{t=this._getOrReturnCtx(e,t),ra(t,{validation:"url",code:Ws.invalid_string,message:i.message}),r.dirty()}else"regex"===i.kind?(i.regex.lastIndex=0,i.regex.test(e.data)||(t=this._getOrReturnCtx(e,t),ra(t,{validation:"regex",code:Ws.invalid_string,message:i.message}),r.dirty())):"trim"===i.kind?e.data=e.data.trim():"includes"===i.kind?e.data.includes(i.value,i.position)||(t=this._getOrReturnCtx(e,t),ra(t,{code:Ws.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),r.dirty()):"toLowerCase"===i.kind?e.data=e.data.toLowerCase():"toUpperCase"===i.kind?e.data=e.data.toUpperCase():"startsWith"===i.kind?e.data.startsWith(i.value)||(t=this._getOrReturnCtx(e,t),ra(t,{code:Ws.invalid_string,validation:{startsWith:i.value},message:i.message}),r.dirty()):"endsWith"===i.kind?e.data.endsWith(i.value)||(t=this._getOrReturnCtx(e,t),ra(t,{code:Ws.invalid_string,validation:{endsWith:i.value},message:i.message}),r.dirty()):"datetime"===i.kind?ja(i).test(e.data)||(t=this._getOrReturnCtx(e,t),ra(t,{code:Ws.invalid_string,validation:"datetime",message:i.message}),r.dirty()):"date"===i.kind?Aa.test(e.data)||(t=this._getOrReturnCtx(e,t),ra(t,{code:Ws.invalid_string,validation:"date",message:i.message}),r.dirty()):"time"===i.kind?Ia(i).test(e.data)||(t=this._getOrReturnCtx(e,t),ra(t,{code:Ws.invalid_string,validation:"time",message:i.message}),r.dirty()):"duration"===i.kind?Ea.test(e.data)||(t=this._getOrReturnCtx(e,t),ra(t,{validation:"duration",code:Ws.invalid_string,message:i.message}),r.dirty()):"ip"===i.kind?La(e.data,i.version)||(t=this._getOrReturnCtx(e,t),ra(t,{validation:"ip",code:Ws.invalid_string,message:i.message}),r.dirty()):"jwt"===i.kind?Da(e.data,i.alg)||(t=this._getOrReturnCtx(e,t),ra(t,{validation:"jwt",code:Ws.invalid_string,message:i.message}),r.dirty()):"cidr"===i.kind?Fa(e.data,i.version)||(t=this._getOrReturnCtx(e,t),ra(t,{validation:"cidr",code:Ws.invalid_string,message:i.message}),r.dirty()):"base64"===i.kind?Oa.test(e.data)||(t=this._getOrReturnCtx(e,t),ra(t,{validation:"base64",code:Ws.invalid_string,message:i.message}),r.dirty()):"base64url"===i.kind?$a.test(e.data)||(t=this._getOrReturnCtx(e,t),ra(t,{validation:"base64url",code:Ws.invalid_string,message:i.message}),r.dirty()):Us.assertNever(i);return{status:r.value,value:e.data}}_regex(e,t,r){return this.refinement(t=>e.test(t),{validation:t,code:Ws.invalid_string,...ia.errToObj(r)})}_addCheck(t){return new e({...this._def,checks:[...this._def.checks,t]})}email(e){return this._addCheck({kind:"email",...ia.errToObj(e)})}url(e){return this._addCheck({kind:"url",...ia.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...ia.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...ia.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...ia.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...ia.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...ia.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...ia.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...ia.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...ia.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...ia.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...ia.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...ia.errToObj(e)})}datetime(e){return this._addCheck("string"==typeof e?{kind:"datetime",precision:null,offset:!1,local:!1,message:e}:{kind:"datetime",precision:typeof e?.precision>"u"?null:e?.precision,offset:e?.offset??!1,local:e?.local??!1,...ia.errToObj(e?.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return this._addCheck("string"==typeof e?{kind:"time",precision:null,message:e}:{kind:"time",precision:typeof e?.precision>"u"?null:e?.precision,...ia.errToObj(e?.message)})}duration(e){return this._addCheck({kind:"duration",...ia.errToObj(e)})}regex(e,t){return this._addCheck({kind:"regex",regex:e,...ia.errToObj(t)})}includes(e,t){return this._addCheck({kind:"includes",value:e,position:t?.position,...ia.errToObj(t?.message)})}startsWith(e,t){return this._addCheck({kind:"startsWith",value:e,...ia.errToObj(t)})}endsWith(e,t){return this._addCheck({kind:"endsWith",value:e,...ia.errToObj(t)})}min(e,t){return this._addCheck({kind:"min",value:e,...ia.errToObj(t)})}max(e,t){return this._addCheck({kind:"max",value:e,...ia.errToObj(t)})}length(e,t){return this._addCheck({kind:"length",value:e,...ia.errToObj(t)})}nonempty(e){return this.min(1,ia.errToObj(e))}trim(){return new e({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new e({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new e({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>"datetime"===e.kind)}get isDate(){return!!this._def.checks.find(e=>"date"===e.kind)}get isTime(){return!!this._def.checks.find(e=>"time"===e.kind)}get isDuration(){return!!this._def.checks.find(e=>"duration"===e.kind)}get isEmail(){return!!this._def.checks.find(e=>"email"===e.kind)}get isURL(){return!!this._def.checks.find(e=>"url"===e.kind)}get isEmoji(){return!!this._def.checks.find(e=>"emoji"===e.kind)}get isUUID(){return!!this._def.checks.find(e=>"uuid"===e.kind)}get isNANOID(){return!!this._def.checks.find(e=>"nanoid"===e.kind)}get isCUID(){return!!this._def.checks.find(e=>"cuid"===e.kind)}get isCUID2(){return!!this._def.checks.find(e=>"cuid2"===e.kind)}get isULID(){return!!this._def.checks.find(e=>"ulid"===e.kind)}get isIP(){return!!this._def.checks.find(e=>"ip"===e.kind)}get isCIDR(){return!!this._def.checks.find(e=>"cidr"===e.kind)}get isBase64(){return!!this._def.checks.find(e=>"base64"===e.kind)}get isBase64url(){return!!this._def.checks.find(e=>"base64url"===e.kind)}get minLength(){let e=null;for(let t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxLength(){let e=null;for(let t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}};function za(e,t){let r=(e.toString().split(".")[1]||"").length,i=(t.toString().split(".")[1]||"").length,n=r>i?r:i;return Number.parseInt(e.toFixed(n).replace(".",""))%Number.parseInt(t.toFixed(n).replace(".",""))/10**n}Ma.create=e=>new Ma({checks:[],typeName:$o.ZodString,coerce:e?.coerce??!1,...fa(e)});var qa=class e extends ga{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==Vs.number){let t=this._getOrReturnCtx(e);return ra(t,{code:Ws.invalid_type,expected:Vs.number,received:t.parsedType}),sa}let t,r=new na;for(let i of this._def.checks)"int"===i.kind?Us.isInteger(e.data)||(t=this._getOrReturnCtx(e,t),ra(t,{code:Ws.invalid_type,expected:"integer",received:"float",message:i.message}),r.dirty()):"min"===i.kind?(i.inclusive?e.data<i.value:e.data<=i.value)&&(t=this._getOrReturnCtx(e,t),ra(t,{code:Ws.too_small,minimum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),r.dirty()):"max"===i.kind?(i.inclusive?e.data>i.value:e.data>=i.value)&&(t=this._getOrReturnCtx(e,t),ra(t,{code:Ws.too_big,maximum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),r.dirty()):"multipleOf"===i.kind?0!==za(e.data,i.value)&&(t=this._getOrReturnCtx(e,t),ra(t,{code:Ws.not_multiple_of,multipleOf:i.value,message:i.message}),r.dirty()):"finite"===i.kind?Number.isFinite(e.data)||(t=this._getOrReturnCtx(e,t),ra(t,{code:Ws.not_finite,message:i.message}),r.dirty()):Us.assertNever(i);return{status:r.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,ia.toString(t))}gt(e,t){return this.setLimit("min",e,!1,ia.toString(t))}lte(e,t){return this.setLimit("max",e,!0,ia.toString(t))}lt(e,t){return this.setLimit("max",e,!1,ia.toString(t))}setLimit(t,r,i,n){return new e({...this._def,checks:[...this._def.checks,{kind:t,value:r,inclusive:i,message:ia.toString(n)}]})}_addCheck(t){return new e({...this._def,checks:[...this._def.checks,t]})}int(e){return this._addCheck({kind:"int",message:ia.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:ia.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:ia.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:ia.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:ia.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:ia.toString(t)})}finite(e){return this._addCheck({kind:"finite",message:ia.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:ia.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:ia.toString(e)})}get minValue(){let e=null;for(let t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(let t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}get isInt(){return!!this._def.checks.find(e=>"int"===e.kind||"multipleOf"===e.kind&&Us.isInteger(e.value))}get isFinite(){let e=null,t=null;for(let r of this._def.checks){if("finite"===r.kind||"int"===r.kind||"multipleOf"===r.kind)return!0;"min"===r.kind?(null===t||r.value>t)&&(t=r.value):"max"===r.kind&&(null===e||r.value<e)&&(e=r.value)}return Number.isFinite(t)&&Number.isFinite(e)}};qa.create=e=>new qa({checks:[],typeName:$o.ZodNumber,coerce:e?.coerce||!1,...fa(e)});var Ua=class e extends ga{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==Vs.bigint)return this._getInvalidInput(e);let t,r=new na;for(let i of this._def.checks)"min"===i.kind?(i.inclusive?e.data<i.value:e.data<=i.value)&&(t=this._getOrReturnCtx(e,t),ra(t,{code:Ws.too_small,type:"bigint",minimum:i.value,inclusive:i.inclusive,message:i.message}),r.dirty()):"max"===i.kind?(i.inclusive?e.data>i.value:e.data>=i.value)&&(t=this._getOrReturnCtx(e,t),ra(t,{code:Ws.too_big,type:"bigint",maximum:i.value,inclusive:i.inclusive,message:i.message}),r.dirty()):"multipleOf"===i.kind?e.data%i.value!==BigInt(0)&&(t=this._getOrReturnCtx(e,t),ra(t,{code:Ws.not_multiple_of,multipleOf:i.value,message:i.message}),r.dirty()):Us.assertNever(i);return{status:r.value,value:e.data}}_getInvalidInput(e){let t=this._getOrReturnCtx(e);return ra(t,{code:Ws.invalid_type,expected:Vs.bigint,received:t.parsedType}),sa}gte(e,t){return this.setLimit("min",e,!0,ia.toString(t))}gt(e,t){return this.setLimit("min",e,!1,ia.toString(t))}lte(e,t){return this.setLimit("max",e,!0,ia.toString(t))}lt(e,t){return this.setLimit("max",e,!1,ia.toString(t))}setLimit(t,r,i,n){return new e({...this._def,checks:[...this._def.checks,{kind:t,value:r,inclusive:i,message:ia.toString(n)}]})}_addCheck(t){return new e({...this._def,checks:[...this._def.checks,t]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:ia.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:ia.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:ia.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:ia.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:ia.toString(t)})}get minValue(){let e=null;for(let t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(let t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}};Ua.create=e=>new Ua({checks:[],typeName:$o.ZodBigInt,coerce:e?.coerce??!1,...fa(e)});var Ba=class extends ga{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==Vs.boolean){let t=this._getOrReturnCtx(e);return ra(t,{code:Ws.invalid_type,expected:Vs.boolean,received:t.parsedType}),sa}return oa(e.data)}};Ba.create=e=>new Ba({typeName:$o.ZodBoolean,coerce:e?.coerce||!1,...fa(e)});var Ha=class e extends ga{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==Vs.date){let t=this._getOrReturnCtx(e);return ra(t,{code:Ws.invalid_type,expected:Vs.date,received:t.parsedType}),sa}if(Number.isNaN(e.data.getTime()))return ra(this._getOrReturnCtx(e),{code:Ws.invalid_date}),sa;let t,r=new na;for(let i of this._def.checks)"min"===i.kind?e.data.getTime()<i.value&&(t=this._getOrReturnCtx(e,t),ra(t,{code:Ws.too_small,message:i.message,inclusive:!0,exact:!1,minimum:i.value,type:"date"}),r.dirty()):"max"===i.kind?e.data.getTime()>i.value&&(t=this._getOrReturnCtx(e,t),ra(t,{code:Ws.too_big,message:i.message,inclusive:!0,exact:!1,maximum:i.value,type:"date"}),r.dirty()):Us.assertNever(i);return{status:r.value,value:new Date(e.data.getTime())}}_addCheck(t){return new e({...this._def,checks:[...this._def.checks,t]})}min(e,t){return this._addCheck({kind:"min",value:e.getTime(),message:ia.toString(t)})}max(e,t){return this._addCheck({kind:"max",value:e.getTime(),message:ia.toString(t)})}get minDate(){let e=null;for(let t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return null!=e?new Date(e):null}get maxDate(){let e=null;for(let t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return null!=e?new Date(e):null}};Ha.create=e=>new Ha({checks:[],coerce:e?.coerce||!1,typeName:$o.ZodDate,...fa(e)});var Va=class extends ga{_parse(e){if(this._getType(e)!==Vs.symbol){let t=this._getOrReturnCtx(e);return ra(t,{code:Ws.invalid_type,expected:Vs.symbol,received:t.parsedType}),sa}return oa(e.data)}};Va.create=e=>new Va({typeName:$o.ZodSymbol,...fa(e)});var Ga=class extends ga{_parse(e){if(this._getType(e)!==Vs.undefined){let t=this._getOrReturnCtx(e);return ra(t,{code:Ws.invalid_type,expected:Vs.undefined,received:t.parsedType}),sa}return oa(e.data)}};Ga.create=e=>new Ga({typeName:$o.ZodUndefined,...fa(e)});var Wa=class extends ga{_parse(e){if(this._getType(e)!==Vs.null){let t=this._getOrReturnCtx(e);return ra(t,{code:Ws.invalid_type,expected:Vs.null,received:t.parsedType}),sa}return oa(e.data)}};Wa.create=e=>new Wa({typeName:$o.ZodNull,...fa(e)});var Ka=class extends ga{constructor(){super(...arguments),this._any=!0}_parse(e){return oa(e.data)}};Ka.create=e=>new Ka({typeName:$o.ZodAny,...fa(e)});var Ja=class extends ga{constructor(){super(...arguments),this._unknown=!0}_parse(e){return oa(e.data)}};Ja.create=e=>new Ja({typeName:$o.ZodUnknown,...fa(e)});var Za=class extends ga{_parse(e){let t=this._getOrReturnCtx(e);return ra(t,{code:Ws.invalid_type,expected:Vs.never,received:t.parsedType}),sa}};Za.create=e=>new Za({typeName:$o.ZodNever,...fa(e)});var Ya=class extends ga{_parse(e){if(this._getType(e)!==Vs.undefined){let t=this._getOrReturnCtx(e);return ra(t,{code:Ws.invalid_type,expected:Vs.void,received:t.parsedType}),sa}return oa(e.data)}};Ya.create=e=>new Ya({typeName:$o.ZodVoid,...fa(e)});var Xa=class e extends ga{_parse(e){let{ctx:t,status:r}=this._processInputParams(e),i=this._def;if(t.parsedType!==Vs.array)return ra(t,{code:Ws.invalid_type,expected:Vs.array,received:t.parsedType}),sa;if(null!==i.exactLength){let e=t.data.length>i.exactLength.value,n=t.data.length<i.exactLength.value;(e||n)&&(ra(t,{code:e?Ws.too_big:Ws.too_small,minimum:n?i.exactLength.value:void 0,maximum:e?i.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:i.exactLength.message}),r.dirty())}if(null!==i.minLength&&t.data.length<i.minLength.value&&(ra(t,{code:Ws.too_small,minimum:i.minLength.value,type:"array",inclusive:!0,exact:!1,message:i.minLength.message}),r.dirty()),null!==i.maxLength&&t.data.length>i.maxLength.value&&(ra(t,{code:Ws.too_big,maximum:i.maxLength.value,type:"array",inclusive:!0,exact:!1,message:i.maxLength.message}),r.dirty()),t.common.async)return Promise.all([...t.data].map((e,r)=>i.type._parseAsync(new pa(t,e,t.path,r)))).then(e=>na.mergeArray(r,e));let n=[...t.data].map((e,r)=>i.type._parseSync(new pa(t,e,t.path,r)));return na.mergeArray(r,n)}get element(){return this._def.type}min(t,r){return new e({...this._def,minLength:{value:t,message:ia.toString(r)}})}max(t,r){return new e({...this._def,maxLength:{value:t,message:ia.toString(r)}})}length(t,r){return new e({...this._def,exactLength:{value:t,message:ia.toString(r)}})}nonempty(e){return this.min(1,e)}};function Qa(e){if(e instanceof eo){let t={};for(let r in e.shape)t[r]=bo.create(Qa(e.shape[r]));return new eo({...e._def,shape:()=>t})}return e instanceof Xa?new Xa({...e._def,type:Qa(e.element)}):e instanceof bo?bo.create(Qa(e.unwrap())):e instanceof wo?wo.create(Qa(e.unwrap())):e instanceof ao?ao.create(e.items.map(e=>Qa(e))):e}Xa.create=(e,t)=>new Xa({type:e,minLength:null,maxLength:null,exactLength:null,typeName:$o.ZodArray,...fa(t)});var eo=class e extends ga{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(null!==this._cached)return this._cached;let e=this._def.shape(),t=Us.objectKeys(e);return this._cached={shape:e,keys:t},this._cached}_parse(e){if(this._getType(e)!==Vs.object){let t=this._getOrReturnCtx(e);return ra(t,{code:Ws.invalid_type,expected:Vs.object,received:t.parsedType}),sa}let{status:t,ctx:r}=this._processInputParams(e),{shape:i,keys:n}=this._getCached(),s=[];if(!(this._def.catchall instanceof Za&&"strip"===this._def.unknownKeys))for(let e in r.data)n.includes(e)||s.push(e);let a=[];for(let e of n)a.push({key:{status:"valid",value:e},value:i[e]._parse(new pa(r,r.data[e],r.path,e)),alwaysSet:e in r.data});if(this._def.catchall instanceof Za){let e=this._def.unknownKeys;if("passthrough"===e)for(let e of s)a.push({key:{status:"valid",value:e},value:{status:"valid",value:r.data[e]}});else if("strict"===e)s.length>0&&(ra(r,{code:Ws.unrecognized_keys,keys:s}),t.dirty());else if("strip"!==e)throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{let e=this._def.catchall;for(let t of s)a.push({key:{status:"valid",value:t},value:e._parse(new pa(r,r.data[t],r.path,t)),alwaysSet:t in r.data})}return r.common.async?Promise.resolve().then(async()=>{let e=[];for(let t of a){let r=await t.key,i=await t.value;e.push({key:r,value:i,alwaysSet:t.alwaysSet})}return e}).then(e=>na.mergeObjectSync(t,e)):na.mergeObjectSync(t,a)}get shape(){return this._def.shape()}strict(t){return new e({...this._def,unknownKeys:"strict",...void 0!==t?{errorMap:(e,r)=>{let i=this._def.errorMap?.(e,r).message??r.defaultError;return"unrecognized_keys"===e.code?{message:ia.errToObj(t).message??i}:{message:i}}}:{}})}strip(){return new e({...this._def,unknownKeys:"strip"})}passthrough(){return new e({...this._def,unknownKeys:"passthrough"})}extend(t){return new e({...this._def,shape:()=>({...this._def.shape(),...t})})}merge(t){return new e({unknownKeys:t._def.unknownKeys,catchall:t._def.catchall,shape:()=>({...this._def.shape(),...t._def.shape()}),typeName:$o.ZodObject})}setKey(e,t){return this.augment({[e]:t})}catchall(t){return new e({...this._def,catchall:t})}pick(t){let r={};for(let e of Us.objectKeys(t))t[e]&&this.shape[e]&&(r[e]=this.shape[e]);return new e({...this._def,shape:()=>r})}omit(t){let r={};for(let e of Us.objectKeys(this.shape))t[e]||(r[e]=this.shape[e]);return new e({...this._def,shape:()=>r})}deepPartial(){return Qa(this)}partial(t){let r={};for(let e of Us.objectKeys(this.shape)){let i=this.shape[e];r[e]=t&&!t[e]?i:i.optional()}return new e({...this._def,shape:()=>r})}required(t){let r={};for(let e of Us.objectKeys(this.shape))if(t&&!t[e])r[e]=this.shape[e];else{let t=this.shape[e];for(;t instanceof bo;)t=t._def.innerType;r[e]=t}return new e({...this._def,shape:()=>r})}keyof(){return fo(Us.objectKeys(this.shape))}};eo.create=(e,t)=>new eo({shape:()=>e,unknownKeys:"strip",catchall:Za.create(),typeName:$o.ZodObject,...fa(t)}),eo.strictCreate=(e,t)=>new eo({shape:()=>e,unknownKeys:"strict",catchall:Za.create(),typeName:$o.ZodObject,...fa(t)}),eo.lazycreate=(e,t)=>new eo({shape:e,unknownKeys:"strip",catchall:Za.create(),typeName:$o.ZodObject,...fa(t)});var to=class extends ga{_parse(e){let{ctx:t}=this._processInputParams(e),r=this._def.options;if(t.common.async)return Promise.all(r.map(async e=>{let r={...t,common:{...t.common,issues:[]},parent:null};return{result:await e._parseAsync({data:t.data,path:t.path,parent:r}),ctx:r}})).then(function(e){for(let t of e)if("valid"===t.result.status)return t.result;for(let r of e)if("dirty"===r.result.status)return t.common.issues.push(...r.ctx.common.issues),r.result;let r=e.map(e=>new Js(e.ctx.common.issues));return ra(t,{code:Ws.invalid_union,unionErrors:r}),sa});{let e,i=[];for(let n of r){let r={...t,common:{...t.common,issues:[]},parent:null},s=n._parseSync({data:t.data,path:t.path,parent:r});if("valid"===s.status)return s;"dirty"===s.status&&!e&&(e={result:s,ctx:r}),r.common.issues.length&&i.push(r.common.issues)}if(e)return t.common.issues.push(...e.ctx.common.issues),e.result;let n=i.map(e=>new Js(e));return ra(t,{code:Ws.invalid_union,unionErrors:n}),sa}}get options(){return this._def.options}};to.create=(e,t)=>new to({options:e,typeName:$o.ZodUnion,...fa(t)});var ro=e=>e instanceof po?ro(e.schema):e instanceof vo?ro(e.innerType()):e instanceof ho?[e.value]:e instanceof mo?e.options:e instanceof go?Us.objectValues(e.enum):e instanceof _o?ro(e._def.innerType):e instanceof Ga?[void 0]:e instanceof Wa?[null]:e instanceof bo?[void 0,...ro(e.unwrap())]:e instanceof wo?[null,...ro(e.unwrap())]:e instanceof xo||e instanceof Po?ro(e.unwrap()):e instanceof So?ro(e._def.innerType):[],io=class e extends ga{_parse(e){let{ctx:t}=this._processInputParams(e);if(t.parsedType!==Vs.object)return ra(t,{code:Ws.invalid_type,expected:Vs.object,received:t.parsedType}),sa;let r=this.discriminator,i=this.optionsMap.get(t.data[r]);return i?t.common.async?i._parseAsync({data:t.data,path:t.path,parent:t}):i._parseSync({data:t.data,path:t.path,parent:t}):(ra(t,{code:Ws.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[r]}),sa)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(t,r,i){let n=new Map;for(let e of r){let r=ro(e.shape[t]);if(!r.length)throw new Error(`A discriminator value for key \`${t}\` could not be extracted from all schema options`);for(let i of r){if(n.has(i))throw new Error(`Discriminator property ${String(t)} has duplicate value ${String(i)}`);n.set(i,e)}}return new e({typeName:$o.ZodDiscriminatedUnion,discriminator:t,options:r,optionsMap:n,...fa(i)})}};function no(e,t){let r=Gs(e),i=Gs(t);if(e===t)return{valid:!0,data:e};if(r===Vs.object&&i===Vs.object){let r=Us.objectKeys(t),i=Us.objectKeys(e).filter(e=>-1!==r.indexOf(e)),n={...e,...t};for(let r of i){let i=no(e[r],t[r]);if(!i.valid)return{valid:!1};n[r]=i.data}return{valid:!0,data:n}}if(r===Vs.array&&i===Vs.array){if(e.length!==t.length)return{valid:!1};let r=[];for(let i=0;i<e.length;i++){let n=no(e[i],t[i]);if(!n.valid)return{valid:!1};r.push(n.data)}return{valid:!0,data:r}}return r===Vs.date&&i===Vs.date&&+e==+t?{valid:!0,data:e}:{valid:!1}}var so=class extends ga{_parse(e){let{status:t,ctx:r}=this._processInputParams(e),i=(e,i)=>{if(la(e)||la(i))return sa;let n=no(e.value,i.value);return n.valid?((ca(e)||ca(i))&&t.dirty(),{status:t.value,value:n.data}):(ra(r,{code:Ws.invalid_intersection_types}),sa)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then(([e,t])=>i(e,t)):i(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}};so.create=(e,t,r)=>new so({left:e,right:t,typeName:$o.ZodIntersection,...fa(r)});var ao=class e extends ga{_parse(e){let{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==Vs.array)return ra(r,{code:Ws.invalid_type,expected:Vs.array,received:r.parsedType}),sa;if(r.data.length<this._def.items.length)return ra(r,{code:Ws.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),sa;!this._def.rest&&r.data.length>this._def.items.length&&(ra(r,{code:Ws.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),t.dirty());let i=[...r.data].map((e,t)=>{let i=this._def.items[t]||this._def.rest;return i?i._parse(new pa(r,e,r.path,t)):null}).filter(e=>!!e);return r.common.async?Promise.all(i).then(e=>na.mergeArray(t,e)):na.mergeArray(t,i)}get items(){return this._def.items}rest(t){return new e({...this._def,rest:t})}};ao.create=(e,t)=>{if(!Array.isArray(e))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new ao({items:e,typeName:$o.ZodTuple,rest:null,...fa(t)})};var oo=class e extends ga{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==Vs.object)return ra(r,{code:Ws.invalid_type,expected:Vs.object,received:r.parsedType}),sa;let i=[],n=this._def.keyType,s=this._def.valueType;for(let e in r.data)i.push({key:n._parse(new pa(r,e,r.path,e)),value:s._parse(new pa(r,r.data[e],r.path,e)),alwaysSet:e in r.data});return r.common.async?na.mergeObjectAsync(t,i):na.mergeObjectSync(t,i)}get element(){return this._def.valueType}static create(t,r,i){return new e(r instanceof ga?{keyType:t,valueType:r,typeName:$o.ZodRecord,...fa(i)}:{keyType:Ma.create(),valueType:t,typeName:$o.ZodRecord,...fa(r)})}},lo=class extends ga{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==Vs.map)return ra(r,{code:Ws.invalid_type,expected:Vs.map,received:r.parsedType}),sa;let i=this._def.keyType,n=this._def.valueType,s=[...r.data.entries()].map(([e,t],s)=>({key:i._parse(new pa(r,e,r.path,[s,"key"])),value:n._parse(new pa(r,t,r.path,[s,"value"]))}));if(r.common.async){let e=new Map;return Promise.resolve().then(async()=>{for(let r of s){let i=await r.key,n=await r.value;if("aborted"===i.status||"aborted"===n.status)return sa;("dirty"===i.status||"dirty"===n.status)&&t.dirty(),e.set(i.value,n.value)}return{status:t.value,value:e}})}{let e=new Map;for(let r of s){let i=r.key,n=r.value;if("aborted"===i.status||"aborted"===n.status)return sa;("dirty"===i.status||"dirty"===n.status)&&t.dirty(),e.set(i.value,n.value)}return{status:t.value,value:e}}}};lo.create=(e,t,r)=>new lo({valueType:t,keyType:e,typeName:$o.ZodMap,...fa(r)});var co=class e extends ga{_parse(e){let{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==Vs.set)return ra(r,{code:Ws.invalid_type,expected:Vs.set,received:r.parsedType}),sa;let i=this._def;null!==i.minSize&&r.data.size<i.minSize.value&&(ra(r,{code:Ws.too_small,minimum:i.minSize.value,type:"set",inclusive:!0,exact:!1,message:i.minSize.message}),t.dirty()),null!==i.maxSize&&r.data.size>i.maxSize.value&&(ra(r,{code:Ws.too_big,maximum:i.maxSize.value,type:"set",inclusive:!0,exact:!1,message:i.maxSize.message}),t.dirty());let n=this._def.valueType;function s(e){let r=new Set;for(let i of e){if("aborted"===i.status)return sa;"dirty"===i.status&&t.dirty(),r.add(i.value)}return{status:t.value,value:r}}let a=[...r.data.values()].map((e,t)=>n._parse(new pa(r,e,r.path,t)));return r.common.async?Promise.all(a).then(e=>s(e)):s(a)}min(t,r){return new e({...this._def,minSize:{value:t,message:ia.toString(r)}})}max(t,r){return new e({...this._def,maxSize:{value:t,message:ia.toString(r)}})}size(e,t){return this.min(e,t).max(e,t)}nonempty(e){return this.min(1,e)}};co.create=(e,t)=>new co({valueType:e,minSize:null,maxSize:null,typeName:$o.ZodSet,...fa(t)});var uo=class e extends ga{constructor(){super(...arguments),this.validate=this.implement}_parse(e){let{ctx:t}=this._processInputParams(e);if(t.parsedType!==Vs.function)return ra(t,{code:Ws.invalid_type,expected:Vs.function,received:t.parsedType}),sa;function r(e,r){return ea({data:e,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,Qs(),Zs].filter(e=>!!e),issueData:{code:Ws.invalid_arguments,argumentsError:r}})}function i(e,r){return ea({data:e,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,Qs(),Zs].filter(e=>!!e),issueData:{code:Ws.invalid_return_type,returnTypeError:r}})}let n={errorMap:t.common.contextualErrorMap},s=t.data;if(this._def.returns instanceof yo){let e=this;return oa(async function(...t){let a=new Js([]),o=await e._def.args.parseAsync(t,n).catch(e=>{throw a.addIssue(r(t,e)),a}),l=await Reflect.apply(s,this,o);return await e._def.returns._def.type.parseAsync(l,n).catch(e=>{throw a.addIssue(i(l,e)),a})})}{let e=this;return oa(function(...t){let a=e._def.args.safeParse(t,n);if(!a.success)throw new Js([r(t,a.error)]);let o=Reflect.apply(s,this,a.data),l=e._def.returns.safeParse(o,n);if(!l.success)throw new Js([i(o,l.error)]);return l.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...t){return new e({...this._def,args:ao.create(t).rest(Ja.create())})}returns(t){return new e({...this._def,returns:t})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(t,r,i){return new e({args:t||ao.create([]).rest(Ja.create()),returns:r||Ja.create(),typeName:$o.ZodFunction,...fa(i)})}},po=class extends ga{get schema(){return this._def.getter()}_parse(e){let{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}};po.create=(e,t)=>new po({getter:e,typeName:$o.ZodLazy,...fa(t)});var ho=class extends ga{_parse(e){if(e.data!==this._def.value){let t=this._getOrReturnCtx(e);return ra(t,{received:t.data,code:Ws.invalid_literal,expected:this._def.value}),sa}return{status:"valid",value:e.data}}get value(){return this._def.value}};function fo(e,t){return new mo({values:e,typeName:$o.ZodEnum,...fa(t)})}ho.create=(e,t)=>new ho({value:e,typeName:$o.ZodLiteral,...fa(t)});var mo=class e extends ga{_parse(e){if("string"!=typeof e.data){let t=this._getOrReturnCtx(e);return ra(t,{expected:Us.joinValues(this._def.values),received:t.parsedType,code:Ws.invalid_type}),sa}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(e.data)){let t=this._getOrReturnCtx(e);return ra(t,{received:t.data,code:Ws.invalid_enum_value,options:this._def.values}),sa}return oa(e.data)}get options(){return this._def.values}get enum(){let e={};for(let t of this._def.values)e[t]=t;return e}get Values(){let e={};for(let t of this._def.values)e[t]=t;return e}get Enum(){let e={};for(let t of this._def.values)e[t]=t;return e}extract(t,r=this._def){return e.create(t,{...this._def,...r})}exclude(t,r=this._def){return e.create(this.options.filter(e=>!t.includes(e)),{...this._def,...r})}};mo.create=fo;var go=class extends ga{_parse(e){let t=Us.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(e);if(r.parsedType!==Vs.string&&r.parsedType!==Vs.number){let e=Us.objectValues(t);return ra(r,{expected:Us.joinValues(e),received:r.parsedType,code:Ws.invalid_type}),sa}if(this._cache||(this._cache=new Set(Us.getValidEnumValues(this._def.values))),!this._cache.has(e.data)){let e=Us.objectValues(t);return ra(r,{received:r.data,code:Ws.invalid_enum_value,options:e}),sa}return oa(e.data)}get enum(){return this._def.values}};go.create=(e,t)=>new go({values:e,typeName:$o.ZodNativeEnum,...fa(t)});var yo=class extends ga{unwrap(){return this._def.type}_parse(e){let{ctx:t}=this._processInputParams(e);if(t.parsedType!==Vs.promise&&!1===t.common.async)return ra(t,{code:Ws.invalid_type,expected:Vs.promise,received:t.parsedType}),sa;let r=t.parsedType===Vs.promise?t.data:Promise.resolve(t.data);return oa(r.then(e=>this._def.type.parseAsync(e,{path:t.path,errorMap:t.common.contextualErrorMap})))}};yo.create=(e,t)=>new yo({type:e,typeName:$o.ZodPromise,...fa(t)});var vo=class extends ga{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===$o.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){let{status:t,ctx:r}=this._processInputParams(e),i=this._def.effect||null,n={addIssue:e=>{ra(r,e),e.fatal?t.abort():t.dirty()},get path(){return r.path}};if(n.addIssue=n.addIssue.bind(n),"preprocess"===i.type){let e=i.transform(r.data,n);if(r.common.async)return Promise.resolve(e).then(async e=>{if("aborted"===t.value)return sa;let i=await this._def.schema._parseAsync({data:e,path:r.path,parent:r});return"aborted"===i.status?sa:"dirty"===i.status||"dirty"===t.value?aa(i.value):i});{if("aborted"===t.value)return sa;let i=this._def.schema._parseSync({data:e,path:r.path,parent:r});return"aborted"===i.status?sa:"dirty"===i.status||"dirty"===t.value?aa(i.value):i}}if("refinement"===i.type){let e=e=>{let t=i.refinement(e,n);if(r.common.async)return Promise.resolve(t);if(t instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return e};if(!1===r.common.async){let i=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});return"aborted"===i.status?sa:("dirty"===i.status&&t.dirty(),e(i.value),{status:t.value,value:i.value})}return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(r=>"aborted"===r.status?sa:("dirty"===r.status&&t.dirty(),e(r.value).then(()=>({status:t.value,value:r.value}))))}if("transform"===i.type){if(!1===r.common.async){let e=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!ua(e))return sa;let s=i.transform(e.value,n);if(s instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:s}}return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(e=>ua(e)?Promise.resolve(i.transform(e.value,n)).then(e=>({status:t.value,value:e})):sa)}Us.assertNever(i)}};vo.create=(e,t,r)=>new vo({schema:e,typeName:$o.ZodEffects,effect:t,...fa(r)}),vo.createWithPreprocess=(e,t,r)=>new vo({schema:t,effect:{type:"preprocess",transform:e},typeName:$o.ZodEffects,...fa(r)});var bo=class extends ga{_parse(e){return this._getType(e)===Vs.undefined?oa(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}};bo.create=(e,t)=>new bo({innerType:e,typeName:$o.ZodOptional,...fa(t)});var wo=class extends ga{_parse(e){return this._getType(e)===Vs.null?oa(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}};wo.create=(e,t)=>new wo({innerType:e,typeName:$o.ZodNullable,...fa(t)});var _o=class extends ga{_parse(e){let{ctx:t}=this._processInputParams(e),r=t.data;return t.parsedType===Vs.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:t.path,parent:t})}removeDefault(){return this._def.innerType}};_o.create=(e,t)=>new _o({innerType:e,typeName:$o.ZodDefault,defaultValue:"function"==typeof t.default?t.default:()=>t.default,...fa(t)});var So=class extends ga{_parse(e){let{ctx:t}=this._processInputParams(e),r={...t,common:{...t.common,issues:[]}},i=this._def.innerType._parse({data:r.data,path:r.path,parent:{...r}});return da(i)?i.then(e=>({status:"valid",value:"valid"===e.status?e.value:this._def.catchValue({get error(){return new Js(r.common.issues)},input:r.data})})):{status:"valid",value:"valid"===i.status?i.value:this._def.catchValue({get error(){return new Js(r.common.issues)},input:r.data})}}removeCatch(){return this._def.innerType}};So.create=(e,t)=>new So({innerType:e,typeName:$o.ZodCatch,catchValue:"function"==typeof t.catch?t.catch:()=>t.catch,...fa(t)});var Eo=class extends ga{_parse(e){if(this._getType(e)!==Vs.nan){let t=this._getOrReturnCtx(e);return ra(t,{code:Ws.invalid_type,expected:Vs.nan,received:t.parsedType}),sa}return{status:"valid",value:e.data}}};Eo.create=e=>new Eo({typeName:$o.ZodNaN,...fa(e)});var ko=Symbol("zod_brand"),xo=class extends ga{_parse(e){let{ctx:t}=this._processInputParams(e);return this._def.type._parse({data:t.data,path:t.path,parent:t})}unwrap(){return this._def.type}},To=class e extends ga{_parse(e){let{status:t,ctx:r}=this._processInputParams(e);if(r.common.async)return(async()=>{let e=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return"aborted"===e.status?sa:"dirty"===e.status?(t.dirty(),aa(e.value)):this._def.out._parseAsync({data:e.value,path:r.path,parent:r})})();{let e=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return"aborted"===e.status?sa:"dirty"===e.status?(t.dirty(),{status:"dirty",value:e.value}):this._def.out._parseSync({data:e.value,path:r.path,parent:r})}}static create(t,r){return new e({in:t,out:r,typeName:$o.ZodPipeline})}},Po=class extends ga{_parse(e){let t=this._def.innerType._parse(e),r=e=>(ua(e)&&(e.value=Object.freeze(e.value)),e);return da(t)?t.then(e=>r(e)):r(t)}unwrap(){return this._def.innerType}};function Ro(e,t){let r="function"==typeof e?e(t):"string"==typeof e?{message:e}:e;return"string"==typeof r?{message:r}:r}function Oo(e,t={},r){return e?Ka.create().superRefine((i,n)=>{let s=e(i);if(s instanceof Promise)return s.then(e=>{if(!e){let e=Ro(t,i),s=e.fatal??r??!0;n.addIssue({code:"custom",...e,fatal:s})}});if(!s){let e=Ro(t,i),s=e.fatal??r??!0;n.addIssue({code:"custom",...e,fatal:s})}}):Ka.create()}Po.create=(e,t)=>new Po({innerType:e,typeName:$o.ZodReadonly,...fa(t)});var $o,Co={object:eo.lazycreate};!function(e){e.ZodString="ZodString",e.ZodNumber="ZodNumber",e.ZodNaN="ZodNaN",e.ZodBigInt="ZodBigInt",e.ZodBoolean="ZodBoolean",e.ZodDate="ZodDate",e.ZodSymbol="ZodSymbol",e.ZodUndefined="ZodUndefined",e.ZodNull="ZodNull",e.ZodAny="ZodAny",e.ZodUnknown="ZodUnknown",e.ZodNever="ZodNever",e.ZodVoid="ZodVoid",e.ZodArray="ZodArray",e.ZodObject="ZodObject",e.ZodUnion="ZodUnion",e.ZodDiscriminatedUnion="ZodDiscriminatedUnion",e.ZodIntersection="ZodIntersection",e.ZodTuple="ZodTuple",e.ZodRecord="ZodRecord",e.ZodMap="ZodMap",e.ZodSet="ZodSet",e.ZodFunction="ZodFunction",e.ZodLazy="ZodLazy",e.ZodLiteral="ZodLiteral",e.ZodEnum="ZodEnum",e.ZodEffects="ZodEffects",e.ZodNativeEnum="ZodNativeEnum",e.ZodOptional="ZodOptional",e.ZodNullable="ZodNullable",e.ZodDefault="ZodDefault",e.ZodCatch="ZodCatch",e.ZodPromise="ZodPromise",e.ZodBranded="ZodBranded",e.ZodPipeline="ZodPipeline",e.ZodReadonly="ZodReadonly"}($o||($o={}));var Ao=(e,t={message:`Input not instance of ${e.name}`})=>Oo(t=>t instanceof e,t),No=Ma.create,Io=qa.create,jo=Eo.create,Lo=Ua.create,Do=Ba.create,Fo=Ha.create,Mo=Va.create,zo=Ga.create,qo=Wa.create,Uo=Ka.create,Bo=Ja.create,Ho=Za.create,Vo=Ya.create,Go=Xa.create,Wo=eo.create,Ko=eo.strictCreate,Jo=to.create,Zo=io.create,Yo=so.create,Xo=ao.create,Qo=oo.create,el=lo.create,tl=co.create,rl=uo.create,il=po.create,nl=ho.create,sl=mo.create,al=go.create,ol=yo.create,ll=vo.create,cl=bo.create,ul=wo.create,dl=vo.createWithPreprocess,pl=To.create,hl=()=>No().optional(),fl=()=>Io().optional(),ml=()=>Do().optional(),gl={string:e=>Ma.create({...e,coerce:!0}),number:e=>qa.create({...e,coerce:!0}),boolean:e=>Ba.create({...e,coerce:!0}),bigint:e=>Ua.create({...e,coerce:!0}),date:e=>Ha.create({...e,coerce:!0})},yl=sa;import vl from"node:os";import bl from"node:path";import wl from"node:fs/promises";import _l from"node:os";import Sl from"node:path";function El(e){return e&&"string"==typeof e?"~"===e?_l.homedir():e.startsWith("~/")?Sl.join(_l.homedir(),e.slice(2)):e:e}async function kl(e,t={}){try{let t=await wl.readFile(e,"utf8");return JSON.parse(t)}catch(e){if("ENOENT"===e.code)return t;throw e}}async function xl(e,t,r=384){await async function(e){let t=Sl.dirname(e);await wl.mkdir(t,{recursive:!0})}(e);let i=`${e}.tmp`,n=`${JSON.stringify(t,null,2)}\n`;await wl.writeFile(i,n,{encoding:"utf8",mode:r}),await wl.rename(i,e);try{await wl.chmod(e,r)}catch{}}function Tl(e){if(!e||"string"!=typeof e)return"";let t=e.trim();if(!t)return"";if(t.length<=6)return"*".repeat(t.length);let r=t.slice(-4);return`${"*".repeat(Math.max(0,t.length-4))}${r}`}function Pl(e,t){let r=Number.parseInt(String(e),10);return Number.isNaN(r)||r<=0?t:r}function Rl(e){return String(e||"").trim()}var Ol=Hs.object({panel:Hs.object({listen_host:Hs.string().default("127.0.0.1"),listen_port:Hs.number().int().positive().default(18080),container_name:Hs.string().default("openclaw-panel"),image_repo:Hs.string().default("ghcr.io/bianshumeng/openclaw-panel")}).default({}),runtime:Hs.object({mode:Hs.enum(["systemd","docker"]).default("systemd")}).default({}),reverse_proxy:Hs.object({enabled:Hs.boolean().default(!1),public_scheme:Hs.enum(["http","https"]).default("http"),public_host:Hs.string().default(""),panel_public_port:Hs.number().int().positive().default(18080),gateway_public_port:Hs.number().int().positive().default(18789),panel_public_base_url:Hs.string().default(""),webhook_public_base_url:Hs.string().default("")}).default({}),openclaw:Hs.object({config_path:Hs.string().default("~/.openclaw/openclaw.json"),service_name:Hs.string().default("openclaw-gateway"),container_name:Hs.string().default("openclaw-gateway"),image_repo:Hs.string().default("ghcr.io/bianshumeng/openclaw-mymy"),gateway_port:Hs.number().int().positive().default(18789),gateway_ws_url:Hs.string().default(""),gateway_media_root:Hs.string().default("")}).default({}),docker:Hs.object({enabled:Hs.boolean().default(!1)}).default({}),update:Hs.object({github_token:Hs.string().default(""),bot_release_repo:Hs.string().default("openclaw/openclaw"),panel_release_repo:Hs.string().default("Bianshumeng/openclaw-panel-public"),panel_service_name:Hs.string().default("openclaw-panel"),panel_app_dir:Hs.string().default("/opt/openclaw-panel")}).default({}),log:Hs.object({source:Hs.enum(["journal","file","docker"]).default("journal"),file_path:Hs.string().default("~/.openclaw/logs/gateway.log")}).default({})}),$l=Ol.parse({});function Cl(){return process.env.PANEL_CONFIG_PATH?El(process.env.PANEL_CONFIG_PATH):bl.join(vl.homedir(),".openclaw-panel","panel.config.json")}async function Al(){let e=Cl(),t=await kl(e,$l),r={...$l,...t,panel:{...$l.panel,...t.panel||{}},runtime:{...$l.runtime,...t.runtime||{}},reverse_proxy:{...$l.reverse_proxy,...t.reverse_proxy||{}},openclaw:{...$l.openclaw,...t.openclaw||{}},docker:{...$l.docker,...t.docker||{}},update:{...$l.update,...t.update||{}},log:{...$l.log,...t.log||{}}},i=Ol.parse(r),n=String(process.env.PANEL_LISTEN_HOST||"").trim(),s=Number.parseInt(String(process.env.PANEL_LISTEN_PORT||""),10),a=function(e,t={}){let r=t.env||process.env,i=t.homeDir||vl.homedir();return El(Rl(r.OPENCLAW_CONFIG_PATH))||El(Rl(e?.openclaw?.config_path))||bl.join(i,".openclaw","openclaw.json")}(i),o={...i.panel,...n?{listen_host:n}:{},...Number.isFinite(s)&&s>0?{listen_port:s}:{}},l={...i.runtime,mode:"systemd"},c={...i.docker,enabled:!1},u="docker"===i.log.source?{...i.log,source:"linux"===process.platform?"journal":"file"}:i.log,d=Rl(u.file_path)||$l.log.file_path;return{filePath:e,config:{...i,panel:o,runtime:l,docker:c,openclaw:{...i.openclaw,config_path:a,gateway_media_root:""},log:{...u,file_path:d}}}}import Nl from"node:fs/promises";function Il(e,t){let r=Number.parseInt(String(e??""),10);return!Number.isFinite(r)||r<0?t:r}async function jl(e){let t,r=El(e);try{t=await Nl.stat(r)}catch(e){if("ENOENT"===e.code)return{path:r,exists:!1,changed:!1,ownerFixed:!1,modeFixed:!1};throw e}let i=function(){let e=String(process.env.OPENCLAW_CONFIG_OWNER_UID??"").trim(),t=String(process.env.OPENCLAW_CONFIG_OWNER_GID??"").trim();if(!(e.length>0||t.length>0))return null;let r=Il(e,NaN),i=Il(t,NaN);if(!Number.isFinite(r)||!Number.isFinite(i))throw new Error("OPENCLAW_CONFIG_OWNER_UID / OPENCLAW_CONFIG_OWNER_GID 必须同时为非负整数");return{uid:r,gid:i}}(),n=!1;384!=(511&t.mode)&&(await Nl.chmod(r,384),n=!0);let s=!1;return"function"==typeof process.getuid&&0===process.getuid()&&i&&(t.uid!==i.uid||t.gid!==i.gid)&&(await Nl.chown(r,i.uid,i.gid),s=!0),{path:r,exists:!0,changed:n||s,ownerFixed:s,modeFixed:n}}async function Ll(e){return kl(El(e),{})}async function Dl(e,t){let r=El(e),i=`${r}.bak.${(new Date).toISOString().replaceAll(":","-")}`;try{await Nl.copyFile(r,i)}catch(e){if("ENOENT"!==e.code)throw e}return await xl(r,t,384),{path:r,backupPath:i,permissionSync:await jl(r)}}function Fl(e,t,r={}){return e?.channels?.[t]||r}function Ml(e){return Array.isArray(e)?e.map(e=>String(e).trim()).filter(Boolean).join("\n"):""}function zl(e){let t=String(e||"").split(/[\n,]/).map(e=>e.trim()).filter(Boolean);return[...new Set(t)]}function ql(e){let t=Number(e);return!Number.isFinite(t)||t<=0?null:Math.floor(t)}function Ul(e){let t=Number(e);return!Number.isFinite(t)||t<0?null:Math.floor(t)}function Bl(e){if(!e||"object"!=typeof e)return"";try{return Array.isArray(e)?e.length>0?JSON.stringify(e,null,2):"":Object.keys(e).length>0?JSON.stringify(e,null,2):""}catch{return""}}function Hl(e,t,r){let i,n={groupsJson:"Telegram 群组覆盖（groupsJson）",accountsJson:"Telegram 账号映射（accountsJson）",customCommandsJson:"Telegram 自定义命令（customCommandsJson）",draftChunkJson:"Telegram 草稿分块（draftChunkJson）"}[t]||t,s=String(e||"").trim();if(!s)return null;try{i=JSON.parse(s)}catch{throw new Error(`${n} 不是有效 JSON`)}if("array"===r){if(!Array.isArray(i))throw new Error(`${n} 必须是数组 JSON`);return i}if(!i||"object"!=typeof i||Array.isArray(i))throw new Error(`${n} 必须是对象 JSON`);return i}function Vl(e){let t=e?.accounts;if(!t||"object"!=typeof t)return{accountId:"main",account:{}};if(t.main&&"object"==typeof t.main)return{accountId:"main",account:t.main};let r=Object.entries(t).find(([,e])=>e&&"object"==typeof e);return r?{accountId:r[0],account:r[1]}:{accountId:"main",account:{}}}function Gl(e,t){return!e||function(e){return"string"==typeof e&&/^\*{4,}/.test(e)}(e)?t||"":e}function Wl(e,t){let r=Number(e);return!Number.isFinite(r)||r<=0?t:Math.floor(r)}function Kl(e,t={}){let r=String(t?.id||"").trim(),i=String(e?.id||r).trim(),n=String(e?.name||t?.name||i).trim()||i,s={...t,...e,id:i,name:n,contextWindow:Wl(e?.contextWindow,Wl(t?.contextWindow,2e5)),maxTokens:Wl(e?.maxTokens,Wl(t?.maxTokens,8192))},a=function(e,t){let r=Array.isArray(e)?e:Array.isArray(t)?t:[];return[...new Set(r.map(e=>String(e).trim()).filter(Boolean))]}(e?.input,t?.input);return a.length>0?s.input=a:delete s.input,void 0===e?.reasoning&&void 0!==t?.reasoning?s.reasoning=!!t.reasoning:void 0!==e?.reasoning&&(s.reasoning=!!e.reasoning),void 0===e?.cost&&void 0!==t?.cost&&(s.cost=t.cost),s}function Jl(e,t,r){let i=String(r||"").trim();i?e[t]=i:delete e[t]}function Zl(e,t,r,{allowZero:i=!1}={}){let n=Number(r);Number.isFinite(n)&&(i?n>=0:n>0)?e[t]=Math.floor(n):delete e[t]}function Yl(e){let t=e?.models?.providers||{},r=e?.agents?.defaults||{},i=r?.models&&"object"==typeof r.models?r.models:{},n=String(r?.thinkingDefault||"").trim(),s=String(e?.agents?.defaults?.model?.primary||"").trim(),[a,o]=s.includes("/")?s.split("/",2):["",""],l=Object.keys(t),c=a&&Object.prototype.hasOwnProperty.call(t,a)?a:l[0]||"",u=c&&t[c]||{},d=Array.isArray(u.models)?u.models:[],p=d.find(e=>String(e?.id||"")===String(o||""))||d[0]||{},h=Fl(e,"telegram",{}),f=Fl(e,"feishu",Fl(e,"feishu-china",{})),m=Vl(f),g={...f,...m.account||{}},y=Fl(e,"discord",{}),v=Vl(y),b={...y,...v.account||{}},w=Fl(e,"slack",{}),_=Vl(w),S={...w,..._.account||{}},E=h?.groups?.["*"]||{},k=h?.actions&&"object"==typeof h.actions?h.actions:{},x=h?.retry&&"object"==typeof h.retry?h.retry:{},T=function(e){return"number"==typeof e&&Number.isFinite(e)&&e>=0&&e<=1?e:null}(x.jitter),P=h?.network&&"object"==typeof h.network?h.network:{},R=function(e){if(Array.isArray(e))return e.map(e=>String(e||"").trim()).includes("inlineButtons")?"all":"allowlist";let t=String(e?.inlineButtons||"").trim();return["off","dm","group","all","allowlist"].includes(t)?t:"allowlist"}(h?.capabilities),O=h?.commands&&"object"==typeof h.commands?h.commands:{},$="boolean"==typeof O.native?String(O.native):"auto"===String(O.native||"").trim()?"auto":"default",C=b?.guilds?.["*"]||{},A=b.dmPolicy||b?.dm?.policy||"pairing",N=b.allowFrom??b?.dm?.allowFrom??[],I=S.dmPolicy||S?.dm?.policy||"pairing",j=S.allowFrom??S?.dm?.allowFrom??[],L=Object.entries(t).map(([e,t])=>{let r=Array.isArray(t?.models)?t.models:[];return{id:e,api:String(t?.api||""),baseUrl:String(t?.baseUrl||""),modelCount:r.length,models:r.map(t=>{let r=String(t?.id||""),s=`${e}/${r}`,a=i?.[s]||{},o=function(e){for(let t of e){let e=String(t??"").trim();if(e)return e}return""}([a?.thinkingStrength,a?.thinking,a?.thinkingLevel,a?.reasoningEffort,t?.thinkingStrength,t?.thinking,t?.thinkingLevel,t?.reasoningEffort,n])||"无";return{id:r,name:String(t?.name||t?.id||""),reasoning:!!t?.reasoning,input:Array.isArray(t?.input)?t.input.map(e=>String(e)):[],contextWindow:Number(t?.contextWindow||0)||void 0,maxTokens:Number(t?.maxTokens||0)||void 0,thinkingStrength:o}})}}),D=L.flatMap(e=>e.models.map(t=>({ref:`${e.id}/${t.id}`,providerId:e.id,providerApi:e.api,providerBaseUrl:e.baseUrl,modelId:t.id,modelName:t.name||t.id,contextWindow:t.contextWindow,maxTokens:t.maxTokens,thinkingStrength:t.thinkingStrength||"无"}))),F=s||(c&&p.id?`${c}/${p.id}`:""),M=D.find(e=>e.ref===F);return{model:{primary:F,providerId:c,providerApi:String(u.api||""),providerBaseUrl:String(u.baseUrl||""),providerApiKey:Tl(u.apiKey||""),modelId:String(p.id||""),modelName:String(p.name||p.id||""),contextWindow:Number(p.contextWindow||0)||void 0,maxTokens:Number(p.maxTokens||0)||void 0,thinkingStrength:M?.thinkingStrength||n||"无",catalog:{providers:L,modelRefs:D}},channels:{telegram:{enabled:!!h.enabled,botToken:Tl(h.botToken||h.token||""),tokenFile:h.tokenFile||"",dmPolicy:h.dmPolicy||"pairing",allowFrom:Ml(h.allowFrom||[]),groupPolicy:h.groupPolicy||"allowlist",groupAllowFrom:Ml(h.groupAllowFrom||[]),requireMention:!1!==E.requireMention,streamMode:h.streamMode||"partial",chunkMode:h.chunkMode||"length",textChunkLimit:ql(h.textChunkLimit),replyToMode:h.replyToMode||"off",linkPreview:!1!==h.linkPreview,blockStreaming:!0===h.blockStreaming,timeoutSeconds:ql(h.timeoutSeconds),mediaMaxMb:ql(h.mediaMaxMb),dmHistoryLimit:Ul(h.dmHistoryLimit),historyLimit:Ul(h.historyLimit),webhookUrl:h.webhookUrl||"",webhookSecret:Tl(h.webhookSecret||""),webhookPath:h.webhookPath||"/telegram-webhook",proxy:h.proxy||"",configWrites:!1!==h.configWrites,reactionLevel:h.reactionLevel||"minimal",reactionNotifications:h.reactionNotifications||"own",inlineButtons:R,actionSendMessage:!1!==k.sendMessage,actionReactions:!1!==k.reactions,actionDeleteMessage:!1!==k.deleteMessage,actionSticker:!0===k.sticker,networkAutoSelectFamily:"boolean"==typeof P.autoSelectFamily?P.autoSelectFamily:null,retryAttempts:ql(x.attempts),retryMinDelayMs:ql(x.minDelayMs),retryMaxDelayMs:ql(x.maxDelayMs),retryJitter:T,commandsNative:$,groupsJson:Bl(h.groups),accountsJson:Bl(h.accounts),customCommandsJson:Bl(h.customCommands),draftChunkJson:Bl(h.draftChunk)},feishu:{enabled:!!g.enabled,appId:g.appId||"",appSecret:Tl(g.appSecret||""),domain:g.domain||"feishu",connectionMode:g.connectionMode||"websocket",dmPolicy:g.dmPolicy||"pairing",allowFrom:Ml(g.allowFrom||[]),groupPolicy:g.groupPolicy||"allowlist",groupAllowFrom:Ml(g.groupAllowFrom||[]),requireMention:!1!==g.requireMention},discord:{enabled:!!b.enabled,token:Tl(b.token||""),dmPolicy:A,allowFrom:Ml(N),groupPolicy:b.groupPolicy||"allowlist",allowBots:!!b.allowBots,requireMention:!1!==C.requireMention},slack:{enabled:!!S.enabled,mode:S.mode||"socket",botToken:Tl(S.botToken||""),appToken:Tl(S.appToken||""),signingSecret:Tl(S.signingSecret||""),dmPolicy:I,allowFrom:Ml(j),groupPolicy:S.groupPolicy||"allowlist",allowBots:!!S.allowBots,requireMention:!1!==S.requireMention}}}}var Xl=Hs.object({id:Hs.string().min(1,"model.id 不能为空"),name:Hs.string().optional().default(""),api:Hs.string().optional(),reasoning:Hs.boolean().optional(),input:Hs.array(Hs.string()).optional(),cost:Hs.record(Hs.number()).optional(),contextWindow:Hs.number().int().positive().optional(),maxTokens:Hs.number().int().positive().optional()}),Ql=Hs.object({model:Hs.object({primary:Hs.string().min(1,"model.primary 不能为空"),providerId:Hs.string().min(1,"model.providerId 不能为空"),providerApi:Hs.string().min(1,"model.providerApi 不能为空"),providerBaseUrl:Hs.string().min(1,"model.providerBaseUrl 不能为空"),providerApiKey:Hs.string().optional().default(""),modelId:Hs.string().min(1,"model.modelId 不能为空"),modelName:Hs.string().min(1,"model.modelName 不能为空"),contextWindow:Hs.number().int().positive().default(2e5),maxTokens:Hs.number().int().positive().default(8192),providerModels:Hs.array(Xl).optional().default([])}),channels:Hs.object({telegram:Hs.object({enabled:Hs.boolean().default(!1),botToken:Hs.string().optional().default(""),tokenFile:Hs.string().optional().default(""),dmPolicy:Hs.enum(["open","pairing","allowlist","disabled"]).default("pairing"),allowFrom:Hs.string().optional().default(""),groupPolicy:Hs.enum(["open","allowlist","disabled"]).default("allowlist"),groupAllowFrom:Hs.string().optional().default(""),requireMention:Hs.boolean().default(!0),streamMode:Hs.enum(["off","partial","block"]).default("partial"),chunkMode:Hs.enum(["length","newline"]).default("length"),textChunkLimit:Hs.number().int().positive().nullable().optional().default(null),replyToMode:Hs.enum(["off","first","all"]).default("off"),linkPreview:Hs.boolean().default(!0),blockStreaming:Hs.boolean().default(!1),timeoutSeconds:Hs.number().int().positive().nullable().optional().default(null),mediaMaxMb:Hs.number().int().positive().nullable().optional().default(null),dmHistoryLimit:Hs.number().int().nonnegative().nullable().optional().default(null),historyLimit:Hs.number().int().nonnegative().nullable().optional().default(null),webhookUrl:Hs.string().optional().default(""),webhookSecret:Hs.string().optional().default(""),webhookPath:Hs.string().optional().default("/telegram-webhook"),proxy:Hs.string().optional().default(""),configWrites:Hs.boolean().default(!0),reactionLevel:Hs.enum(["off","ack","minimal","extensive"]).default("minimal"),reactionNotifications:Hs.enum(["off","own","all"]).default("own"),inlineButtons:Hs.enum(["off","dm","group","all","allowlist"]).default("allowlist"),actionSendMessage:Hs.boolean().default(!0),actionReactions:Hs.boolean().default(!0),actionDeleteMessage:Hs.boolean().default(!0),actionSticker:Hs.boolean().default(!1),networkAutoSelectFamily:Hs.boolean().nullable().optional().default(null),retryAttempts:Hs.number().int().positive().nullable().optional().default(null),retryMinDelayMs:Hs.number().int().positive().nullable().optional().default(null),retryMaxDelayMs:Hs.number().int().positive().nullable().optional().default(null),retryJitter:Hs.number().min(0).max(1).nullable().optional().default(null),commandsNative:Hs.enum(["default","auto","true","false"]).default("default"),groupsJson:Hs.string().optional().default(""),accountsJson:Hs.string().optional().default(""),customCommandsJson:Hs.string().optional().default(""),draftChunkJson:Hs.string().optional().default("")}),feishu:Hs.object({enabled:Hs.boolean().default(!1),appId:Hs.string().optional().default(""),appSecret:Hs.string().optional().default(""),domain:Hs.string().optional().default("feishu"),connectionMode:Hs.enum(["websocket","webhook"]).default("websocket"),dmPolicy:Hs.enum(["open","pairing","allowlist"]).default("pairing"),allowFrom:Hs.string().optional().default(""),groupPolicy:Hs.enum(["open","allowlist","disabled"]).default("allowlist"),groupAllowFrom:Hs.string().optional().default(""),requireMention:Hs.boolean().default(!0)}),discord:Hs.object({enabled:Hs.boolean().default(!1),token:Hs.string().optional().default(""),dmPolicy:Hs.enum(["open","pairing","allowlist","disabled"]).default("pairing"),allowFrom:Hs.string().optional().default(""),groupPolicy:Hs.enum(["open","allowlist","disabled"]).default("allowlist"),allowBots:Hs.boolean().default(!1),requireMention:Hs.boolean().default(!0)}),slack:Hs.object({enabled:Hs.boolean().default(!1),mode:Hs.enum(["socket","http"]).default("socket"),botToken:Hs.string().optional().default(""),appToken:Hs.string().optional().default(""),signingSecret:Hs.string().optional().default(""),dmPolicy:Hs.enum(["open","pairing","allowlist","disabled"]).default("pairing"),allowFrom:Hs.string().optional().default(""),groupPolicy:Hs.enum(["open","allowlist","disabled"]).default("allowlist"),allowBots:Hs.boolean().default(!1),requireMention:Hs.boolean().default(!0)})}).optional()}),ec=Ql;function tc(e){return null!==e&&"object"==typeof e&&!Array.isArray(e)}function rc(e,t){let r=String(e||"").trim(),i=String(t||"").trim();return r&&i?`${r}/${i}`:""}function ic(e){let t=structuredClone(e||{});return tc(t.models)||(t.models={}),tc(t.models.providers)||(t.models.providers={}),tc(t.agents)||(t.agents={}),tc(t.agents.defaults)||(t.agents.defaults={}),tc(t.agents.defaults.model)||(t.agents.defaults.model={}),tc(t.agents.defaults.models)||(t.agents.defaults.models={}),t}function nc(e,t){let r=tc(e?.agents?.defaults?.models)?e.agents.defaults.models:{},i={};Object.entries(r).forEach(([e,r])=>{let n=String(t(e)||"").trim();n&&(Object.prototype.hasOwnProperty.call(i,n)||(i[n]=r))}),e.agents.defaults.models=i}function sc(e){let t=tc(e?.models?.providers)?e.models.providers:{},r=new Set(function(e){let t=[];return Object.entries(e||{}).forEach(([e,r])=>{(Array.isArray(r?.models)?r.models:[]).forEach(r=>{let i=String(r?.id||"").trim(),n=rc(e,i);n&&t.push(n)})}),t}(t)),i=String(e?.agents?.defaults?.model?.primary||"").trim(),n=r.has(i)?i:function(e){for(let[t,r]of Object.entries(e||{})){let e=Array.isArray(r?.models)?r.models:[];for(let r of e){let e=rc(t,String(r?.id||"").trim());if(e)return e}}return""}(t);e.agents.defaults.model.primary=n;let s=tc(e?.agents?.defaults?.models)?e.agents.defaults.models:{},a={};return Object.entries(s).forEach(([e,t])=>{r.has(e)&&(a[e]=t)}),e.agents.defaults.models=a,{primary:n,availableModelRefs:[...r]}}function ac(e,t){if(null==e||""===e)return;let r=Number(e);if(!Number.isFinite(r)||r<=0)throw new Error(`${t} 必须是正整数`);return Math.floor(r)}import{execFile as oc}from"node:child_process";function lc(e,t,r=oc){return new Promise(i=>{r(e,t,{timeout:15e3},(e,t,r)=>{i({ok:!e,code:e?.code??0,stdout:(t||"").trim(),stderr:(r||"").trim(),message:e?.message||""})})})}function cc(e){return new Promise(t=>{setTimeout(t,e)})}function uc(e,t){let r=String(t||"").trim().toLowerCase();if(!r)return!1;if("ENOENT"===e?.code)return!0;let i=[e?.stdout,e?.stderr,e?.message].filter(Boolean).join("\n").toLowerCase();return!(!i||!i.includes(`exec: "${r}"`)&&!i.includes(`exec: ${r}`))&&(i.includes("not found")||i.includes("no such file")||i.includes("executable file not found"))}async function dc(e,t,r={}){let i=r.platform||process.platform,n=r.execFile||oc;if("linux"!==i)return{ok:!1,action:e,runtimeMode:"systemd",serviceName:t,output:"仅 Linux + systemd 环境支持服务控制。",message:"仅 Linux + systemd 环境支持服务控制。"};if("status"===e){let r=await lc("systemctl",["is-active",t],n),i=await lc("systemctl",["status",t,"--no-pager","-n","30"],n),s=[r.stdout,i.stdout,i.stderr].filter(Boolean).join("\n");return{ok:r.ok,action:e,runtimeMode:"systemd",serviceName:t,active:"active"===r.stdout,output:s,message:s}}let s=await lc("systemctl",[e,t],n),a=[s.stdout,s.stderr,s.message].filter(Boolean).join("\n");return{ok:s.ok,action:e,runtimeMode:"systemd",serviceName:t,output:a,message:a}}async function pc(e,t={}){let r=t.execFile||oc,i=await lc("docker",["inspect",e],r);if(!i.ok)return{ok:!1,message:[i.stdout,i.stderr,i.message].filter(Boolean).join("\n").trim()||"容器不存在或不可访问。"};let n=function(e){try{let t=JSON.parse(e||"[]");return Array.isArray(t)&&0!==t.length?t[0]:null}catch{return null}}(i.stdout);if(!n)return{ok:!1,message:"docker inspect 返回内容无法解析。"};let s=n?.State&&"object"==typeof n.State?n.State:{},a=String(s.Status||"unknown").trim()||"unknown",o=Number(n?.RestartCount??0),l=Number.isFinite(o)?o:0,c=Number(s?.ExitCode);return{ok:!0,status:a,active:"running"===a,restarting:!!s?.Restarting,running:!!s?.Running,restartCount:l,exitCode:Number.isFinite(c)?c:null,error:String(s?.Error||"").trim(),startedAt:String(s?.StartedAt||""),finishedAt:String(s?.FinishedAt||"")}}async function hc(e,{includeFailureLogs:t=!0,probeRestartLoop:r=!0}={},i={}){let n=i.execFile||oc,s=await lc("docker",["ps","-a","--filter",`name=^/${e}$`],n),a=await pc(e,{execFile:n});if(!a.ok){let t=[a.message];return s.stdout&&t.push(s.stdout),{ok:!1,action:"status",runtimeMode:"docker",containerName:e,active:!1,state:"not-found",output:t.filter(Boolean).join("\n").trim()||"容器不存在或不可访问。"}}let o=a,l="";if(r&&"running"===a.status){await cc(1100);let t=await pc(e,{execFile:n});t.ok&&(o=t,"restarting"===t.status?l="容器处于重启中状态。":t.restartCount>a.restartCount&&(l=`检测到容器在短时间内重启次数增长（${a.restartCount} -> ${t.restartCount}）。`))}let c="running"===o.status&&!l,u=[];if(u.push(...function(e){let t=[`state: ${e.status}`,"running: "+(e.running?"true":"false"),"restarting: "+(e.restarting?"true":"false"),`restartCount: ${e.restartCount}`];return null!==e.exitCode&&t.push(`exitCode: ${e.exitCode}`),e.error&&t.push(`error: ${e.error}`),e.startedAt&&t.push(`startedAt: ${e.startedAt}`),e.finishedAt&&t.push(`finishedAt: ${e.finishedAt}`),t}(o)),l&&u.push(`statusHint: ${l}`),s.stdout&&u.push(s.stdout),!c&&t){let t=await lc("docker",["logs","--tail","60",e],n),r=[t.stdout,t.stderr].filter(Boolean).join("\n").trim();r?(u.push("---- recent logs ----"),u.push(r)):!t.ok&&t.message&&u.push(`logs error: ${t.message}`)}return{ok:!0,action:"status",runtimeMode:"docker",containerName:e,active:c,state:o.status,restartCount:o.restartCount,exitCode:o.exitCode,instabilityReason:l,output:u.join("\n").trim()||"容器不存在或不可访问。"}}async function fc(e,t,r={}){if("docker"===(t?.runtime?.mode||"systemd")){let i=function(e){return e?.openclaw?.container_name||e?.openclaw?.service_name||"openclaw-gateway"}(t);return async function(e,t,r={}){let i=r.execFile||oc;if("status"===e)return hc(t,{},{execFile:i});let n=await lc("docker",[e,t],i);if(!n.ok)return{ok:!1,action:e,runtimeMode:"docker",containerName:t,output:[n.stdout,n.stderr,n.message].filter(Boolean).join("\n")};if("start"===e||"restart"===e||"stop"===e){await cc("stop"===e?500:1800);let r=await hc(t,{includeFailureLogs:"stop"!==e,probeRestartLoop:"stop"!==e},{execFile:i});if(!("stop"!==e?r.active:!r.active)){let i="stop"===e?"停止":"启动";return{ok:!1,action:e,runtimeMode:"docker",containerName:t,active:r.active,state:r.state,output:[[n.stdout,n.stderr,n.message].filter(Boolean).join("\n").trim(),`${i}后状态校验失败：当前状态 ${r.state||"unknown"}。`,r.output].filter(Boolean).join("\n")}}return{ok:!0,action:e,runtimeMode:"docker",containerName:t,active:r.active,state:r.state,output:[[n.stdout,n.stderr,n.message].filter(Boolean).join("\n").trim(),`状态校验通过：${r.state||"unknown"}。`,r.output].filter(Boolean).join("\n")}}return{ok:!0,action:e,runtimeMode:"docker",containerName:t,output:[n.stdout,n.stderr,n.message].filter(Boolean).join("\n")}}(e,i,r)}let i=t?.openclaw?.service_name||"openclaw-gateway",n=r.platform||process.platform;if("linux"===n){let t=await dc(e,i,r);if(t.ok)return t}let s=await async function(e,{execFile:t,platform:r,serviceName:i}={}){let n=t||oc,s=r||process.platform,a=i||"openclaw-gateway",o=async t=>{let r=await lc(t,["gateway",e],n),i=[r.stdout,r.stderr,r.message].filter(Boolean).join("\n").trim();return{binary:t,result:r,output:i}},l=await o("openclaw"),c=!l.result.ok&&uc(l.result,"openclaw");if(c&&"win32"===s){let t=await o("openclaw.cmd");if(t.result.ok||!uc(t.result,"openclaw.cmd"))return{ok:t.result.ok,action:e,runtimeMode:"cli",serviceName:a,active:"status"===e?t.result.ok:void 0,output:t.output,message:t.output}}if(c){let t=function(e){return"win32"===e?"未找到 openclaw CLI。请在 Windows 安装 OpenClaw CLI，或在 WSL2/网关主机运行面板后再重试。":"未找到 openclaw CLI。请先安装 OpenClaw CLI 后再重试。"}(s);return{ok:!1,action:e,runtimeMode:"cli",serviceName:a,active:!1,missingExecutable:!0,output:[t,l.output].filter(Boolean).join("\n"),message:t}}return{ok:l.result.ok,action:e,runtimeMode:"cli",serviceName:a,active:"status"===e?l.result.ok:void 0,output:l.output,message:l.output}}(e,{execFile:r.execFile,platform:n,serviceName:i});return s.missingExecutable&&"linux"===n?dc(e,i,r):s}import mc from"node:fs/promises";import{spawn as gc}from"node:child_process";function yc(e){return String(e||"").split(/\r?\n/).map(e=>e.trimEnd()).filter(Boolean)}function vc(e,t){if(!t)return e;let r=t.toLowerCase();return e.filter(e=>e.toLowerCase().includes(r))}function bc(e,t){return new Promise((r,i)=>{let n=gc(e,t,{stdio:["ignore","pipe","pipe"]}),s="",a="";n.stdout.on("data",e=>{s+=e.toString()}),n.stderr.on("data",e=>{a+=e.toString()}),n.on("error",i),n.on("close",()=>r({stdout:s,stderr:a}))})}async function wc({panelConfig:e,lines:t=200,filter:r=""}){let i=Math.min(5e3,Pl(t,200)),n=e.log.source,s=e?.openclaw?.container_name||e?.openclaw?.service_name||"openclaw-gateway";if("docker"===n){let{stdout:e,stderr:t}=await bc("docker",["logs","--tail",String(i),s]);return vc(yc(`${e}\n${t}`),r)}if("journal"===n&&"linux"===process.platform){let{stdout:t,stderr:n}=await bc("journalctl",["-u",e.openclaw.service_name,"-n",String(i),"--no-pager","-o","short-iso"]);return vc(yc(`${t}\n${n}`),r)}return vc(await async function(e,t){try{return yc(await mc.readFile(El(e),"utf8")).slice(-t)}catch(e){if("ENOENT"===e.code)return[];throw e}}(e.log.file_path,i),r)}async function _c({panelConfig:e,count:t=20}){let r=await wc({panelConfig:e,lines:1e3,filter:""}),i=/(error|fail|exception|panic|fatal|traceback)/i;return r.filter(e=>i.test(e)).slice(-Math.min(200,Pl(t,20)))}function Sc(e,t){let r=new AbortController,i=setTimeout(()=>r.abort(),t);return{signal:r.signal,wrapped:e(r.signal).finally(()=>clearTimeout(i))}}import Ec from"node:fs/promises";import kc from"node:os";import xc from"node:path";import{spawn as Tc}from"node:child_process";var Pc="Bianshumeng/openclaw-panel-public";function Rc(e){return String(e||"").trim()}function Oc(e){return Rc(e).replace(/^v/i,"")}function $c(e){let t=Rc(e);return t?t.startsWith("v")||t.startsWith("V")?t:`v${t}`:""}function Cc(e,t){let r=Rc(e);if(!r)return t;if(!/^[A-Za-z0-9_.-]+\/[A-Za-z0-9_.-]+$/.test(r))throw new Error(`发布仓库格式不合法：${r}（应为 owner/repo）`);return r}function Ac(e){return`'${String(e||"").replace(/'/g,"'\\''")}'`}async function Nc(e,{fetchImpl:t=fetch,githubToken:r=""}={}){let i={accept:"application/vnd.github+json","user-agent":"openclaw-panel-updater"},n=Rc(r);n&&(i.authorization=`Bearer ${n}`);let s=await t(e,{headers:i}),a=await s.text();if(!s.ok){let e=new Error(`GitHub API 请求失败: ${s.status}`);throw e.status=s.status,e.bodyText=a,e}try{return JSON.parse(a)}catch(e){throw new Error(`GitHub API 返回了非 JSON 内容: ${e.message}`)}}function Ic(e,t){let r=Rc(e?.tag_name||e?.name),i=Rc(e?.tarball_url||e?.zipball_url);if(!r||!i)throw new Error(`发布信息不完整（repo=${t}）`);return{tag:r,tarballUrl:i,publishedAt:Rc(e?.published_at),htmlUrl:Rc(e?.html_url),releaseRepo:t}}async function jc({releaseRepo:e,fetchImpl:t=fetch,githubToken:r=""}){let i=`https://api.github.com/repos/${e}/releases/latest`;return Ic(await Nc(i,{fetchImpl:t,githubToken:r}),e)}async function Lc({runCmd:e}){let t=await e("openclaw",["--version"],15e3);if(!t.ok)throw new Error(t.stderr||t.message||"无法读取 openclaw 当前版本");return function(e){let t=Rc(e);if(!t)return"";let r=t.match(/([0-9]{4}\.[0-9]+\.[0-9]+(?:-[0-9A-Za-z._-]+)?)/);return Oc(r?r[1]:t.split(/\s+/)[0]||"")}(t.stdout)}async function Dc({runCmd:e,releaseRepo:t="openclaw/openclaw"}={}){if("function"!=typeof e)throw new Error("缺少 runCmd");let r=await Lc({runCmd:e}),i=await e("openclaw",["update","status"],3e4);if(!i.ok)return{ok:!0,currentTag:r,latestTag:"",updateAvailable:!1,warning:i.stderr||i.message||"无法检查更新状态",installMethod:"global",strategy:"package-manager",releaseRepo:t};let n=function(e=""){let t=String(e||""),r=t.match(/│\s*Install\s*│\s*([^│\n]+)\s*│/i),i=t.match(/│\s*Update\s*│\s*([^│\n]+)\s*│/i),n=Rc(r?.[1]||""),s=Rc(i?.[1]||""),a=function(e=""){let t=Rc(e).toLowerCase();return t?/(git|source|checkout|workspace|repo)/.test(t)?"source":(/(pnpm|npm|yarn|bun|global)/.test(t),"global"):"global"}(n),o="source"===a?"openclaw-update":"package-manager",l=/available/i.test(s)||/update available/i.test(t),c=/up[\s-]?to[\s-]?date/i.test(s)||/already up[\s-]?to[\s-]?date/i.test(t),u="",d=[s,t],p=[/npm update\s+([0-9][0-9A-Za-z._-]*)/i,/latest(?:\s+version)?\s*[:：]?\s*([0-9][0-9A-Za-z._-]*)/i,/available[^\n]*\b([0-9]{4}\.[0-9]+\.[0-9]+(?:-[0-9A-Za-z._-]+)?)/i,/([0-9]{4}\.[0-9]+\.[0-9]+(?:-[0-9A-Za-z._-]+)?)/i];for(let e of d)if(e){for(let t of p){let r=e.match(t);if(r&&r[1]){u=Oc(r[1]);break}}if(u)break}return{installRaw:n,updateRaw:s,installMethod:a,strategy:o,latestTag:u,updateAvailable:l&&!c}}(i.stdout),s=!!n.updateAvailable;return!s&&n.latestTag&&r&&(s=Oc(n.latestTag)!==Oc(r)),{ok:!0,currentTag:r,latestTag:n.latestTag||"",updateAvailable:s,warning:"",installMethod:n.installMethod,strategy:n.strategy,releaseRepo:t}}async function Fc({action:e="upgrade",tag:t="",runCmd:r}={}){if("function"!=typeof r)throw new Error("缺少 runCmd");let i=Rc(t);if("rollback"===e&&!i)return{ok:!1,action:e,rolledBack:!1,message:"回滚必须提供目标版本号（tag）"};let n=["update","--yes"];i&&n.push("--tag",Oc(i));let s=await r("openclaw",n,12e5);if(!s.ok)return{ok:!1,action:e,rolledBack:!1,message:Rc(s.stderr||s.message||"OpenClaw 更新失败")};let a=await Lc({runCmd:r}).catch(()=>Oc(i)),o=await async function({runCmd:e}){let t=[{name:"doctor",args:["doctor"],timeout:12e4},{name:"gateway restart",args:["gateway","restart"],timeout:12e4},{name:"health",args:["health"],timeout:12e4}],r=[];for(let i of t){let t=await e("openclaw",i.args,i.timeout);t.ok||r.push(`${i.name}: ${Rc(t.stderr||t.message||"失败")}`)}return r}({runCmd:r}),l="rollback"===e?"OpenClaw 回滚成功":"OpenClaw 更新成功",c=o.length>0?`；后置检查告警：${o.join(" | ")}`:"";return{ok:!0,action:e,targetImage:a?`openclaw:${a}`:`openclaw:${Oc(i)||"latest"}`,oldImage:"",rolledBack:!1,requiresRestart:!1,message:`${l}${c}`}}function Mc(e=""){let t=Rc(e||process.env.PANEL_APP_DIR);return t?xc.resolve(t):"linux"===process.platform?"/opt/openclaw-panel":process.cwd()}function zc(e=""){let t=Rc(e||process.env.PANEL_UPDATE_STATE_DIR);return t?xc.resolve(t):"linux"===process.platform?"/var/lib/openclaw-panel/update":xc.join(kc.tmpdir(),"openclaw-panel-update")}async function qc(e,t={}){try{let t=await Ec.readFile(e,"utf8");return JSON.parse(t)}catch{return t}}async function Uc(e){let t=xc.join(e,".panel-release.json"),r=await qc(t,{}),i=Rc(r?.tag);if(i)return i;let n=xc.join(e,"package.json"),s=await qc(n,{}),a=Rc(s?.version);return a?$c(a):""}async function Bc({releaseRepo:e=Pc,githubToken:t="",fetchImpl:r=fetch,appDir:i=""}={}){let n=Cc(e,Pc),s=Mc(i),a=await Uc(s);try{let e=await jc({releaseRepo:n,fetchImpl:r,githubToken:t}),i=!a||Oc(a)!==Oc(e.tag);return{ok:!0,currentTag:a,latestTag:e.tag,latestPublishedAt:e.publishedAt,releaseRepo:n,updateAvailable:i,warning:""}}catch(e){return{ok:!0,currentTag:a,latestTag:"",latestPublishedAt:null,releaseRepo:n,updateAvailable:!1,warning:e.message||String(e)}}}async function Hc({tag:e="",releaseRepo:t=Pc,githubToken:r="",fetchImpl:i=fetch,appDir:n="",stateDir:s=""}={}){let a=Cc(t,Pc),o=Mc(n),l=zc(s);await Ec.mkdir(l,{recursive:!0});let c=Rc(e)?await async function({releaseRepo:e,tag:t,fetchImpl:r=fetch,githubToken:i=""}){let n=Rc(t),s=[];n&&(s.push(n),n.startsWith("v")||n.startsWith("V")?s.push(n.slice(1)):s.push(`v${n}`));let a=[...new Set(s.map(e=>Rc(e)).filter(Boolean))],o=null;for(let t of a)try{let n=`https://api.github.com/repos/${e}/releases/tags/${encodeURIComponent(t)}`;return Ic(await Nc(n,{fetchImpl:r,githubToken:i}),e)}catch(e){if(404===Number(e?.status)){o=e;continue}throw e}throw o?new Error(`未找到发布版本：${n}`):new Error("缺少目标发布版本")}({releaseRepo:a,tag:e,fetchImpl:i,githubToken:r}):await jc({releaseRepo:a,fetchImpl:i,githubToken:r}),u=await Uc(o),d=`panel-${function(e){return Rc(e).replace(/[^0-9A-Za-z._-]/g,"_")}(c.tag)}.tar.gz`,p=xc.join(l,d);await async function(e,t,{fetchImpl:r=fetch,githubToken:i=""}={}){let n={"user-agent":"openclaw-panel-updater"},s=Rc(i);s&&(n.authorization=`Bearer ${s}`);let a=await r(e,{headers:n});if(!a.ok)throw new Error(`下载发布包失败: HTTP ${a.status}`);let o=Buffer.from(await a.arrayBuffer());await Ec.writeFile(t,o,{mode:384})}(c.tarballUrl,p,{fetchImpl:i,githubToken:r});let h=xc.join(l,"pending.json"),f={tag:c.tag,releaseRepo:a,appDir:o,tarballPath:p,stagedAt:(new Date).toISOString(),publishedAt:c.publishedAt};return await Ec.writeFile(h,`${JSON.stringify(f,null,2)}\n`,{mode:384}),{ok:!0,action:"stage",targetImage:`panel:${c.tag}`,oldImage:u?`panel:${u}`:"",rolledBack:!1,requiresRestart:!0,message:`已准备版本包 ${c.tag}，请点击“应用更新并重启”生效。`}}import Vc,{randomUUID as Gc}from"node:crypto";import Wc from"node:fs";import Kc from"node:os";import Jc from"node:path";d(Ns(),1),d(Rs(),1),d(Os(),1);var Zc=d(As(),1),Yc=(d(js(),1),Buffer.from("302a300506032b6570032100","hex"));function Xc(e,t){let r=Number(e);return!Number.isFinite(r)||r<=0?t:Math.floor(r)}function Qc(e){return new Promise(t=>{setTimeout(t,e)})}function eu(e){return String(e||"").trim()}function tu(e){let t=eu(e);return t&&("~"===t?Kc.homedir():t.startsWith("~/")||t.startsWith("~\\")?Jc.join(Kc.homedir(),t.slice(2)):t)}function ru(e){try{if(!e||!Wc.existsSync(e))return null;let t=Wc.readFileSync(e,"utf8");return JSON.parse(t)}catch{return null}}function iu(e,t){try{Wc.mkdirSync(Jc.dirname(e),{recursive:!0}),Wc.writeFileSync(e,`${JSON.stringify(t,null,2)}\n`,{mode:384});try{Wc.chmodSync(e,384)}catch{}}catch{}}function nu(e){return Buffer.from(e).toString("base64").replaceAll("+","-").replaceAll("/","_").replace(/=+$/g,"")}function su(e){let t=Vc.createPublicKey(e).export({type:"spki",format:"der"});return Buffer.isBuffer(t)&&t.length===Yc.length+32&&t.subarray(0,Yc.length).equals(Yc)?t.subarray(Yc.length):Buffer.from(t)}function au(e){return nu(su(e))}function ou(e){return Vc.createHash("sha256").update(su(e)).digest("hex")}function lu(e){let t=ru(e);if(1===t?.version&&"string"==typeof t.deviceId&&"string"==typeof t.publicKeyPem&&"string"==typeof t.privateKeyPem){let r=ou(t.publicKeyPem),i={version:1,deviceId:r,publicKeyPem:t.publicKeyPem,privateKeyPem:t.privateKeyPem,createdAtMs:Xc(t.createdAtMs,Date.now())};return t.deviceId!==r&&iu(e,i),i}let r=function(){let{publicKey:e,privateKey:t}=Vc.generateKeyPairSync("ed25519"),r=e.export({type:"spki",format:"pem"}).toString(),i=t.export({type:"pkcs8",format:"pem"}).toString();return{deviceId:ou(r),publicKeyPem:r,privateKeyPem:i}}(),i={version:1,...r,createdAtMs:Date.now()};return iu(e,i),i}function cu(e,t){let r=ru(function(e){return Jc.join(Jc.dirname(e),"device-auth.json")}(e))?.tokens?.[t]?.token;return"string"==typeof r?eu(r):""}function uu(e,t){let r=Vc.createPrivateKey(e);return nu(Vc.sign(null,Buffer.from(String(t||""),"utf8"),r))}function du({deviceIdentity:e,token:t,role:r,scopes:i,nonce:n}){if(!(e&&e.deviceId&&e.publicKeyPem&&e.privateKeyPem))return;let s=Date.now();try{let a=function({deviceId:e,clientId:t,clientMode:r,role:i,scopes:n,signedAtMs:s,token:a,nonce:o}){let l=o?"v2":"v1",c=Array.isArray(n)?n.map(e=>eu(e)).filter(Boolean):[],u=[l,eu(e),eu(t),eu(r),eu(i),c.join(","),String(Xc(s,Date.now())),eu(a)];return"v2"===l&&u.push(eu(o)),u.join("|")}({deviceId:e.deviceId,clientId:"cli",clientMode:"cli",role:r,scopes:i,signedAtMs:s,token:t,nonce:n});return{id:e.deviceId,publicKey:au(e.publicKeyPem),signature:uu(e.privateKeyPem,a),signedAt:s,...n?{nonce:n}:{}}}catch{return}}var pu=class extends Error{constructor(e,t={}){super(String(e||"gateway rpc error")),this.name="GatewayRpcError",this.type=t.type||"unknown",this.method=t.method||"",this.code=t.code||"",this.attempt=Xc(t.attempt,1),this.details=t.details||{},this.cause=t.cause}};function hu(e,t=process.env){let r=eu(t.OPENCLAW_GATEWAY_WS_URL);if(r)return r;let i=eu(e?.openclaw?.gateway_ws_url);if(i)return i;let n=eu(e?.runtime?.mode)||"systemd";return`ws://${"docker"===n?eu(e?.openclaw?.container_name)||eu(e?.openclaw?.service_name)||"openclaw-gateway":"127.0.0.1"}:${Xc(eu("docker"===n?t.OPENCLAW_GATEWAY_CONTAINER_PORT:t.OPENCLAW_GATEWAY_PORT),0)||Xc(e?.openclaw?.gateway_port,0)||18789}/ws`}function fu(e,t){let r=String(e||"").toLowerCase(),i=String(t?.code||"").toLowerCase();return r.includes("unauthorized")||r.includes("forbidden")||r.includes("auth")||i.includes("unauthorized")||i.includes("forbidden")?"auth":t?"remote":r.includes("timeout")?"timeout":r.includes("closed")||r.includes("connect")||r.includes("socket")||r.includes("network")||r.includes("econn")?"network":r.includes("parse")||r.includes("json")||r.includes("protocol")?"protocol":"unknown"}function mu(e,t={}){if(e instanceof pu)return e;let r=String(e?.message||e||"gateway rpc error"),i=t.remoteError;return new pu(r,{type:fu(r,i),code:eu(i?.code),method:eu(t.method),attempt:Xc(t.attempt,1),details:{url:eu(t.url),closeCode:t.closeCode,closeReason:eu(t.closeReason),remoteError:i},cause:e})}function gu(e){let t=e instanceof pu?e.type:"unknown";return"timeout"===t||"network"===t||"protocol"===t}function yu({token:e,password:t,nonce:r,role:i,scopes:n,deviceIdentity:s}){let a={};eu(e)&&(a.token=eu(e)),eu(t)&&(a.password=eu(t));let o=Object.keys(a).length>0;return{minProtocol:3,maxProtocol:3,client:{id:"cli",displayName:"openclaw-panel",version:"0.1.1",platform:process.platform,mode:"cli",instanceId:Gc()},caps:[],role:i,scopes:n,device:du({deviceIdentity:s,token:e,role:i,scopes:n,nonce:r}),...o?{auth:a}:{}}}function vu(e,t,r){let i=function(e,t=process.env){return tu(eu(t.OPENCLAW_DEVICE_IDENTITY_PATH))||Jc.join(function(e,t=process.env){let r=tu(eu(t.OPENCLAW_CONFIG_PATH)||eu(e?.openclaw?.config_path));return r?Jc.dirname(r):Jc.join(Kc.homedir(),".openclaw")}(e,t),"identity","device.json")}(e);return{identityPath:i,deviceIdentity:lu(i),tokenWithFallback:eu(t)||cu(i,r)}}async function bu({url:e,method:t,params:r,expectFinal:i,timeoutMs:n,token:s,password:a,role:o,scopes:l,deviceIdentity:c,attempt:u}){return await new Promise((d,p)=>{let h=new Zc.default(e),f=new Set,m="",g=!1,y=!1,v=!1,b=null,w=null,_=Math.min(750,Math.max(0,Math.floor(n/5))),S=()=>{b&&clearTimeout(b),b=null,w&&clearTimeout(w),w=null},E=(r,i={})=>{if(!g){g=!0,S();try{h.close()}catch{}p(mu(r,{method:t,url:e,attempt:u,...i}))}},k=(e="")=>{if(g||y||v||h.readyState!==Zc.default.OPEN)return;v=!0;let t=Gc();f.add(t),h.send(JSON.stringify({type:"req",id:t,method:"connect",params:yu({token:s,password:a,nonce:e,role:o,scopes:l,deviceIdentity:c})}))};b=setTimeout(()=>{E(new Error(`gateway rpc timeout after ${n}ms`))},n),h.on("open",()=>{w=setTimeout(()=>{k("")},_)}),h.on("error",e=>{E(new Error(`gateway socket error: ${e.message||String(e)}`))}),h.on("close",(e,t)=>{g||E(new Error(`gateway closed (${e}): ${String(t||"").trim()||"no reason"}`),{closeCode:e,closeReason:String(t||"")})}),h.on("message",e=>{if(g)return;let n;try{n=JSON.parse(String(e||""))}catch(e){return void E(new Error(`gateway protocol parse error: ${e.message||String(e)}`))}let s=eu(n?.type).toLowerCase();if("evt"!==s&&"event"!==s){if("res"===s){if(!y&&f.has(n.id))return n.ok?(y=!0,f.clear(),void(g||!y||h.readyState!==Zc.default.OPEN||(m=Gc(),h.send(JSON.stringify({type:"req",id:m,method:t,params:r??{}}))))):void E(new Error(n?.error?.message||"gateway connect rejected"),{remoteError:n?.error||{}});if(m&&n.id===m){if(!n.ok)return void E(new Error(n?.error?.message||"gateway rpc failed"),{remoteError:n?.error||{}});i&&"accepted"===n?.payload?.status||((e,t)=>{if(!g){g=!0,S();try{h.close()}catch{}d(t)}})(0,n.payload)}}}else if("connect.challenge"===n?.event){let e=eu(n?.payload?.nonce);k(e)}})})}async function wu({panelConfig:e,url:t,method:r,params:i={},expectFinal:n=!1,timeoutMs:s=1e4,retries:a=0,retryDelayMs:o=1e3,token:l="",password:c="",role:u="operator",scopes:d=["operator.admin","operator.approvals","operator.pairing"]}){let p,h=eu(t)||hu(e),{deviceIdentity:f,tokenWithFallback:m}=vu(e,l,u),g=Math.max(1,Xc(a,0)+1),y=Xc(s,1e4),v=Xc(o,1e3);for(let e=1;e<=g;e++)try{return await bu({url:h,method:r,params:i,expectFinal:!!n,timeoutMs:y,token:m,password:c,role:u,scopes:d,deviceIdentity:f,attempt:e})}catch(t){let i=mu(t,{method:r,url:h,attempt:e});if(p=i,e>=g||!gu(i))throw i;await Qc(v)}throw p||new pu("gateway rpc failed",{type:"unknown",method:r})}function _u({panelConfig:e,url:t,token:r="",password:i="",role:n="operator",scopes:s=["operator.admin","operator.approvals","operator.pairing"],connectDelayMs:a=750,onEvent:o,onError:l,onClose:c}){let u,d,p=eu(t)||hu(e),{deviceIdentity:h,tokenWithFallback:f}=vu(e,r,n),m=new Set,g=null,y=!1,v=!1,b=!1,w=null,_=!1,S=new Promise((e,t)=>{u=e,d=t}),E=e=>{if(!_){if(_=!0,e)return void d(e);u({url:p})}},k=()=>{w&&(clearTimeout(w),w=null)},x=(e,t={})=>{let r=mu(e,{url:p,method:"connect",...t});l?.(r),E(r)},T=(e="")=>{if(y||v||b||!g||g.readyState!==Zc.default.OPEN)return;b=!0;let t=Gc();m.add(t),g.send(JSON.stringify({type:"req",id:t,method:"connect",params:yu({token:f,password:i,nonce:e,role:n,scopes:s,deviceIdentity:h})}))},P=()=>{if(!y){y=!0,k();try{g?.close()}catch{}}};return g=new Zc.default(p),g.on("open",()=>{if(y)return;let e=Math.max(0,Math.min(5e3,Xc(a,750)));w=setTimeout(()=>{T("")},e)}),g.on("error",e=>{x(new Error(`gateway socket error: ${e.message||String(e)}`))}),g.on("close",(e,t)=>{k();let r=String(t||"").trim()||"no reason";!v&&!y&&E(mu(new Error(`gateway closed (${e}): ${r}`),{url:p,method:"connect",closeCode:e,closeReason:r})),c?.({code:e,reason:r})}),g.on("message",e=>{if(y)return;let t;try{t=JSON.parse(String(e||""))}catch(e){return void x(new Error(`gateway protocol parse error: ${e.message||String(e)}`))}let r=eu(t?.type).toLowerCase();if("evt"!==r&&"event"!==r){if("res"===r&&m.has(t.id)){if(m.delete(t.id),!t.ok)return x(new Error(t?.error?.message||"gateway connect rejected"),{remoteError:t?.error||{}}),void P();v=!0,E(null)}}else{if("connect.challenge"===t?.event){let e=eu(t?.payload?.nonce);return b=!1,void T(e)}v&&o?.(t)}}),{ready:S,close:P,get connected(){return v}}}function Su(e){return String(e||"").trim()}function Eu(e){return!0===e}function ku(e={}){let t=(Array.isArray(e?.catalog?.providers)?e.catalog.providers:[]).map(e=>{let t=Array.isArray(e?.models)?e.models:[];return{id:Su(e?.id),api:Su(e?.api),baseUrl:Su(e?.baseUrl),modelCount:t.length,models:t.map(e=>({id:Su(e?.id),name:Su(e?.name||e?.id),contextWindow:Number(e?.contextWindow||0)||null,maxTokens:Number(e?.maxTokens||0)||null,thinkingStrength:Su(e?.thinkingStrength)||"无"}))}}),r=t.reduce((e,t)=>e+t.modelCount,0);return{primaryRef:Su(e?.primary),current:{providerId:Su(e?.providerId),modelId:Su(e?.modelId),modelName:Su(e?.modelName||e?.modelId),contextWindow:Number(e?.contextWindow||0)||null,maxTokens:Number(e?.maxTokens||0)||null,thinkingStrength:Su(e?.thinkingStrength)||"无"},counts:{providers:t.length,models:r},providers:t}}function xu(e={}){let t=["telegram","feishu","discord","slack"].map(t=>{let r=e?.[t]&&"object"==typeof e[t]?e[t]:{};return{id:t,enabled:Eu(r.enabled),dmPolicy:Su(r.dmPolicy),groupPolicy:Su(r.groupPolicy)}}),r=t.filter(e=>e.enabled).length;return{total:t.length,enabled:r,disabled:t.length-r,items:t}}function Tu(e){return e&&Su(e.message||e)||"gateway rpc failed"}async function Pu({panelConfig:e,openclawConfig:t,deps:r={}}){let i=r.extractSettings||Yl,n=r.runServiceAction||fc,s=r.callGatewayRpc||wu,a=Su(r.gatewayToken??process.env.OPENCLAW_GATEWAY_TOKEN),o=i(t),l=await async function(e,t){try{let r=await t("status",e);return{ok:Eu(r?.ok),active:Eu(r?.active),mode:Su(e?.runtime?.mode)||"systemd",message:Su(r?.message||r?.output)}}catch(t){return{ok:!1,active:!1,mode:Su(e?.runtime?.mode)||"systemd",message:Su(t?.message||t)}}}(e,n),c=await async function(e,t,r){let[i,n]=await Promise.allSettled([r({panelConfig:e,method:"channels.status",params:{},timeoutMs:1e3,retries:6,retryDelayMs:1e3,token:t}),r({panelConfig:e,method:"skills.status",params:{},timeoutMs:1e3,retries:6,retryDelayMs:1e3,token:t})]),s="fulfilled"===i.status?function(e){let t=e?.channels&&"object"==typeof e.channels?e.channels:{},r=Array.isArray(e?.channelOrder)?e.channelOrder:Object.keys(t),i=e?.channelLabels&&"object"==typeof e.channelLabels?e.channelLabels:{},n=r.map(e=>{let r=t[e]&&"object"==typeof t[e]?t[e]:{};return{id:e,label:Su(i[e]||e),configured:Eu(r.configured),running:Eu(r.running),lastError:Su(r.lastError),lastProbeAt:r.lastProbeAt??null}}),s=n.filter(e=>e.running).length;return{ok:!0,total:n.length,running:s,stopped:n.length-s,items:n}}(i.value):{ok:!1,total:0,running:0,stopped:0,items:[],message:Tu(i.reason)},a="fulfilled"===n.status?function(e){let t=(Array.isArray(e?.skills)?e.skills:[]).map(e=>({key:Su(e?.skillKey||e?.name),name:Su(e?.name),enabled:!Eu(e?.disabled),eligible:Eu(e?.eligible),blocked:Eu(e?.blockedByAllowlist),source:Su(e?.source),updatedAt:e?.updatedAt??null})),r=t.filter(e=>e.enabled).length,i=t.filter(e=>e.eligible).length,n=t.filter(e=>e.blocked).length;return{ok:!0,total:t.length,enabled:r,disabled:t.length-r,eligible:i,blocked:n,items:t}}(n.value):{ok:!1,total:0,enabled:0,disabled:0,eligible:0,blocked:0,items:[],message:Tu(n.reason)};return{channels:s,skills:a}}(e,a,s);return{generatedAt:(new Date).toISOString(),model:ku(o.model),channels:{configured:xu(o.channels),runtime:c.channels},skills:c.skills,runtime:l}}function Ru(e){return String(e||"").trim()}function Ou(e){return new Map(e.map(e=>[e.key,e]))}async function $u(e,t,r={}){let i=r.callGatewayRpc||wu,n=Ru(r.gatewayToken??process.env.OPENCLAW_GATEWAY_TOKEN);return await i({panelConfig:e,method:t.method,params:t.payload||{},timeoutMs:1e3,retries:6,retryDelayMs:1e3,token:n})}function Cu(e,t){if(!e.has(t))throw new Error(`未知技能：${t}`)}async function Au({panelConfig:e,deps:t={}}){return function(e){let t=Ru(e?.workspaceDir),r=Ru(e?.managedSkillsDir),i=(Array.isArray(e?.skills)?e.skills:[]).map(e=>function(e={}){let t=Ru(e?.updatedAt||e?.updated_at||e?.lastUpdatedAt||e?.last_updated_at||e?.mtime);return{key:Ru(e?.skillKey||e?.name),name:Ru(e?.name),description:Ru(e?.description),updatedAt:t,enabled:!0!==e?.disabled,eligible:!0===e?.eligible,blocked:!0===e?.blockedByAllowlist,source:Ru(e?.source),bundled:!0===e?.bundled,missing:e?.missing&&"object"==typeof e.missing?e.missing:{},requirements:e?.requirements&&"object"==typeof e.requirements?e.requirements:{}}}(e)).filter(e=>e.key),n=i.filter(e=>e.enabled).length;return{workspaceDir:t,managedSkillsDir:r,total:i.length,enabled:n,disabled:i.length-n,skills:i}}(await $u(e,{method:"skills.status",payload:{}},t))}async function Nu({panelConfig:e,skillKey:t,deps:r={}}){let i=Ru(t);if(!i)throw new Error("skillKey 不能为空");let n=(await(r.loadOpenClawConfig||Ll)(e?.openclaw?.config_path))?.skills?.entries?.[i];return function(e,t){let r=t&&"object"==typeof t?t:{},i=Object.fromEntries(Object.entries(r.env&&"object"==typeof r.env?r.env:{}).map(([e,t])=>[e,Tl(Ru(t))]));return{skillKey:e,enabled:"boolean"==typeof r.enabled?r.enabled:null,hasApiKey:!!Ru(r.apiKey),apiKeyMasked:Tl(Ru(r.apiKey)),env:i}}(i,n)}async function Iu({panelConfig:e,skillKey:t,enabled:r,deps:i={}}){let n=Ru(t);if(!n)throw new Error("skillKey 不能为空");return Cu(Ou((await Au({panelConfig:e,deps:i})).skills),n),await $u(e,{method:"skills.update",payload:{skillKey:n,enabled:!0===r}},i),{skillKey:n,enabled:!0===r,config:await Nu({panelConfig:e,skillKey:n,deps:i})}}import{execFile as ju}from"node:child_process";import Lu from"node:fs/promises";import Du from"node:os";import Fu from"node:path";var Mu=[["openclaw"],["node","/app/openclaw.mjs"]];function zu(e){return String(e||"").trim()}function qu(e,t){let r=Number(e);return!Number.isFinite(r)||r<=0?t:Math.floor(r)}function Uu(e){return zu(e?.openclaw?.container_name||e?.openclaw?.service_name||"openclaw-gateway")}function Bu(e){return Array.isArray(e)?e.map(e=>zu(e)).filter(Boolean):[]}function Hu(e,t,r=[]){let i=zu(e?.runtime?.mode)||"systemd";if("docker"===i){let n=Uu(e),s=Bu(r),a=s.length>0?s:[...Mu[0]];return{runtimeMode:i,containerName:n,dockerCliPrefix:a,command:"docker",args:["exec",n,...a,...t],openclawArgStartIndex:2+a.length}}return{runtimeMode:i,containerName:"",dockerCliPrefix:[],command:"openclaw",args:[...t],openclawArgStartIndex:0}}function Vu(e,t=[]){let r=String(e||"");return r?t.map(e=>zu(e)).filter(Boolean).reduce((e,t)=>e.split(t).join("***"),r):""}function Gu(e,t=[]){let r=new Set((Array.isArray(t)?t:[]).map(e=>Number(e)).filter(e=>Number.isInteger(e)&&e>=0)),i=e.args.map((t,i)=>{let n=i-e.openclawArgStartIndex;return n>=0&&r.has(n)?"***":function(e){let t=String(e??"");return t?/^[A-Za-z0-9_./:=-]+$/.test(t)?t:`'${t.replace(/'/g,"'\\''")}'`:"''"}(t)});return[e.command,...i].join(" ")}async function Wu(e,t,r,i={},n=ju){return await new Promise(s=>{n(e,t,{...i,timeout:r,maxBuffer:10485760},(e,t,r)=>{s({ok:!e,code:e?.code??0,stdout:String(t||""),stderr:String(r||""),message:String(e?.message||"")})})})}function Ku(e,t,{secrets:r=[],redactOpenclawArgIndices:i=[]}={}){let n=Vu(zu(e?.stdout),r),s=Vu(zu(e?.stderr),r),a=Vu(zu(e?.message),r),o=[n,s,a].filter(Boolean).join("\n").trim();return{ok:!!e?.ok,code:Number.isFinite(Number(e?.code))?Number(e.code):0,runtimeMode:t.runtimeMode,containerName:t.containerName,command:Gu(t,i),stdout:n,stderr:s,message:a,output:o}}function Ju(e){let t=String(e||"").toLowerCase();return t.includes("already enabled")||t.includes("已经启用")||t.includes("已启用")}function Zu(e,t){let r=zu(t).toLowerCase();if(!r)return!1;let i=[zu(e?.stdout),zu(e?.stderr),zu(e?.message)].filter(Boolean).join("\n").toLowerCase();return!(!i||!i.includes(`exec: "${r}"`)&&!i.includes(`exec: ${r}`))&&(i.includes("executable file not found")||i.includes("not found in $path")||i.includes("no such file or directory"))}function Yu(e,t,r){return[`检测到容器内未找到 '${t.join(" ")}'，已自动改用 '${r.join(" ")}'。`,zu(e)].filter(Boolean).join("\n")}function Xu(e,t="命令"){let r=zu(e);if(!r)throw new Error(`${t} 返回为空，无法解析 JSON`);try{return JSON.parse(r)}catch(e){let i=r.split(/\r?\n/).map(e=>zu(e));for(let e=0;e<i.length;e+=1){let t=i.slice(e).join("\n").trim();if(t&&(t.startsWith("{")||t.startsWith("[")))try{return JSON.parse(t)}catch{}}throw new Error(`${t} 返回非 JSON：${e.message||String(e)}`)}}function Qu(e={}){let t=[e.requestId,e.request,e.id,e.request_id];for(let e of t){let t=zu(e);if(t)return t}return""}async function ed({panelConfig:e,openclawArgs:t,dockerCliPrefix:r=[],timeoutMs:i=3e4,commandEnv:n=null,redactOpenclawArgIndices:s=[],secrets:a=[],deps:o={}}){let l=Array.isArray(t)?t.map(e=>String(e)):[];if(0===l.length)throw new Error("openclawArgs 不能为空");let c=o.runCommand||Wu,u=n&&"object"==typeof n?Object.entries(n).filter(([e,t])=>zu(e)&&null!=t):[],d=u.length>0?{env:{...process.env,...Object.fromEntries(u)}}:{};if("docker"!==(zu(e?.runtime?.mode)||"systemd")){let t=Hu(e,l,r);return{...Ku(await c(t.command,t.args,i,d),t,{secrets:a,redactOpenclawArgIndices:s}),dockerCliPrefix:[]}}let p=Bu(r),h=p.length>0?[p]:Mu,f=[];for(let t=0;t<h.length;t+=1){let r=h[t],n=Hu(e,l,r),o=await c(n.command,n.args,i,d),u=Ku(o,n,{secrets:a,redactOpenclawArgIndices:s}),p=t<h.length-1;if(u.ok||!Zu(o,r[0])||!p)return f.length>0&&(u.output=Yu(u.output,f,r)),{...u,dockerCliPrefix:[...r]};f=r}let m=Bu(r);return{ok:!1,code:1,runtimeMode:"docker",containerName:Uu(e),command:Gu(Hu(e,l,m.length>0?m:["openclaw"])),output:"未找到可用的 OpenClaw CLI 入口。请检查容器内 openclaw 可执行文件或 /app/openclaw.mjs 是否存在。",dockerCliPrefix:m}}async function td({panelConfig:e,deps:t={}}){let r=[],{dockerCliPrefix:i,...n}=await ed({panelConfig:e,openclawArgs:["devices","list","--json"],deps:t}),s=Array.isArray(i)&&i.length>0?[...i]:[];r.push({...n,label:"读取待处理设备配对列表"});let a=zu(e?.runtime?.mode)||"systemd",o=n,l=null,c=null,u=s;try{if("docker"!==a&&!o.ok&&function(e){return[e?.stdout,e?.stderr,e?.message,e?.output].map(e=>zu(e)).filter(Boolean).join("\n").toLowerCase().includes("pairing required")}(o))try{let i=await async function(e,t={}){let r=t.readJsonFile||kl,i=t.writeJsonFileAtomic||xl,n=t.makeTempDir||Lu.mkdtemp,s=t.removeDir||Lu.rm,a=El(zu(e?.openclaw?.config_path||"~/.openclaw/openclaw.json")),o=function(e={}){let t=JSON.parse(JSON.stringify(e&&"object"==typeof e?e:{})),r=t.gateway&&"object"==typeof t.gateway&&!Array.isArray(t.gateway)?{...t.gateway}:{};return r.mode="local",r.remote={},t.gateway=r,t}(await r(a,{})),l=zu(t.tempBaseDir)||Du.tmpdir(),c=await n(Fu.join(l,"openclaw-panel-gateway-local-")),u=Fu.join(c,"openclaw.json");return await i(u,o,384),{tempConfigPath:u,cleanup:async()=>{try{await s(c,{recursive:!0,force:!0})}catch{}}}}(e,t);l=i.cleanup,c={OPENCLAW_CONFIG_PATH:i.tempConfigPath};let{dockerCliPrefix:n,...s}=await ed({panelConfig:e,openclawArgs:["devices","list","--json"],dockerCliPrefix:u,commandEnv:c,deps:t});Array.isArray(n)&&n.length>0&&(u=[...n]),r.push({...s,label:"读取待处理设备配对列表（本地模式回退）"}),s.ok&&(o=s)}catch(e){let t=e?.message||String(e);r.push({ok:!1,code:1,runtimeMode:a,containerName:"",command:"prepare temporary local gateway config",stdout:"",stderr:"",message:t,output:t,label:"准备本地模式回退配置"})}if(!o.ok)return{ok:!1,message:"读取待处理设备配对列表失败",pendingCount:0,approvedCount:0,failedCount:0,pending:[],approvals:[],steps:r};let i;try{let e=function(e,t){let r=[e?.stdout,e?.output],i=null;for(let e of r){let r=zu(e);if(r)try{return Xu(r,t)}catch(e){i=e}}throw i||new Error(`${t} 返回为空，无法解析 JSON`)}(o,"openclaw devices list --json");i=(Array.isArray(e?.pending)?e.pending:[]).map(e=>function(e={}){return{requestId:Qu(e),deviceId:zu(e.deviceId||e.device),role:zu(e.role||(Array.isArray(e.roles)?e.roles[0]:"")),clientId:zu(e.clientId),clientMode:zu(e.clientMode)}}(e))}catch(e){let t=e.message||String(e);return r.push({ok:!1,code:1,runtimeMode:o.runtimeMode,containerName:o.containerName,command:o.command,stdout:"",stderr:"",message:t,output:t,label:"解析待处理设备配对列表"}),{ok:!1,message:t,pendingCount:0,approvedCount:0,failedCount:0,pending:[],approvals:[],steps:r}}if(0===i.length)return{ok:!0,message:"当前没有待批准的设备配对请求",pendingCount:0,approvedCount:0,failedCount:0,pending:[],approvals:[],steps:r};let n=[];for(let s of i){let i=zu(s.requestId);if(!i){let e="待处理项缺少 requestId，无法批准",t={ok:!1,code:1,runtimeMode:o.runtimeMode,containerName:o.containerName,command:"openclaw devices approve <missing-requestId>",stdout:"",stderr:"",message:e,output:e,label:"批准待处理设备配对"};n.push({requestId:"",deviceId:s.deviceId,role:s.role,ok:!1,output:e}),r.push(t);continue}let{dockerCliPrefix:a,...l}=await ed({panelConfig:e,openclawArgs:["devices","approve",i],dockerCliPrefix:u,commandEnv:c,deps:t});Array.isArray(a)&&a.length>0&&(u=[...a]),n.push({requestId:i,deviceId:s.deviceId,role:s.role,ok:l.ok,output:l.output}),r.push({...l,label:`批准待处理设备配对 ${i}`})}let s=n.filter(e=>e.ok).length,d=n.length-s,p=0===d;return{ok:p,message:p?`已批准 ${s} 个待处理设备配对请求`:`待处理设备配对共 ${i.length} 个，成功 ${s} 个，失败 ${d} 个`,pendingCount:i.length,approvedCount:s,failedCount:d,pending:i,approvals:n,steps:r}}finally{"function"==typeof l&&await l()}}import{randomUUID as rd}from"node:crypto";import{existsSync as id,readFileSync as nd}from"node:fs";import{mkdir as sd,writeFile as ad}from"node:fs/promises";import od from"node:path";var ld=new Set(["image/png","image/jpeg","image/jpg","image/bmp","image/webp","image/gif"]),cd=Object.freeze({"image/png":".png","image/jpeg":".jpg","image/jpg":".jpg","image/webp":".webp","image/gif":".gif","image/bmp":".bmp","application/pdf":".pdf","application/json":".json","text/plain":".txt","text/markdown":".md"});function ud(e){return String(e||"").trim()}function dd(e,t){let r=Number(e);return!Number.isFinite(r)||r<=0?t:Math.floor(r)}function pd(e,t="file"){let r=String(e||"").trim();return r&&od.basename(r).replace(/[<>:"/\\|?*\u0000-\u001F]/g,"_")||t}function hd(e){let t=El(String(e?.openclaw?.config_path||"~/.openclaw/openclaw.json")),r=od.dirname(t);return od.join(r,"media","outbound")}function fd(e){return String(e||"").replace(/\\/g,"/")}async function md(e,t,r,i={},n={}){let s=i.callGatewayRpc||wu,a=ud(i.gatewayToken??process.env.OPENCLAW_GATEWAY_TOKEN);return await s({panelConfig:e,method:t,params:r||{},expectFinal:!0===n.expectFinal,timeoutMs:dd(n.timeoutMs,1e3),retries:dd(n.retries,6),retryDelayMs:dd(n.retryDelayMs,1e3),token:a})}function gd(e){let t=ud(e).replace(/:+$/,"");return t?t.includes(":")?t:`agent:${t}`:""}async function yd({panelConfig:e,deps:t={}}){let r=await md(e,"sessions.list",{},t),i=Array.isArray(r?.sessions)?r.sessions.map(e=>function(e){return{key:ud(e?.key),displayName:ud(e?.displayName||e?.key),kind:ud(e?.kind),updatedAt:Number(e?.updatedAt||0)||0,sessionId:ud(e?.sessionId),modelProvider:ud(e?.modelProvider),model:ud(e?.model),contextTokens:Number(e?.contextTokens||0)||null,totalTokens:Number(e?.totalTokens||0)||null,abortedLastRun:!0===e?.abortedLastRun}}(e)):[];return{total:Number(r?.count||i.length)||i.length,sessions:i}}async function vd({panelConfig:e,sessionKey:t,limit:r=200,deps:i={}}){let n=ud(t);if(!n)throw new Error("sessionKey 不能为空");let s=await md(e,"chat.history",{sessionKey:n,limit:dd(r,200)},i);return{sessionKey:n,sessionId:ud(s?.sessionId),thinkingLevel:ud(s?.thinkingLevel),verboseLevel:ud(s?.verboseLevel),messages:Array.isArray(s?.messages)?s.messages:[]}}async function bd({panelConfig:e,sessionKey:t,message:r,thinking:i="",attachments:n=[],idempotencyKey:s="",timeoutMs:a,deps:o={}}){let l=ud(t),c=ud(r);if(!l)throw new Error("sessionKey 不能为空");if(!(c||Array.isArray(n)&&0!==n.length))throw new Error("message 或 attachments 至少填一个");let u=ud(s)||rd(),{imageAttachments:d,fileReferences:p}=function(e,t=[],r={}){let i=Array.isArray(t)?t:[];if(0===i.length)return{imageAttachments:[],fileReferences:[]};let n=r.existsSync||id,s=r.readFileSync||nd,a=od.resolve(hd(e)),o=[],l=[];return i.forEach((t,r)=>{if(!t||"object"!=typeof t)throw new Error(`附件 #${r+1} 格式错误`);let i=ud(t.stagedPath||t.filePath),c=pd(t.fileName,`file-${r+1}`),u=ud(t.mimeType).toLowerCase()||"application/octet-stream";if(!i)throw new Error(`附件缺少 stagedPath：${c}`);let d=od.resolve(i),p="win32"===process.platform?a.toLowerCase():a,h="win32"===process.platform?d.toLowerCase():d;if(h!==p&&!h.startsWith(`${p}${od.sep}`))throw new Error(`附件路径非法：${c}`);if(!n(d))throw new Error(`附件文件不存在：${c}`);let f=function(e,t){let r=od.resolve(od.dirname(El(String(e?.openclaw?.config_path||"~/.openclaw/openclaw.json")))),i=od.relative(r,t);if(!i||i.startsWith("..")||od.isAbsolute(i))return fd(t);let n=fd(function(e){let t=ud(e?.openclaw?.gateway_media_root||process.env.OPENCLAW_GATEWAY_MEDIA_ROOT||"");if(t)return t;let r=El(String(e?.openclaw?.config_path||"~/.openclaw/openclaw.json"));return od.dirname(r)}(e)).replace(/\/+$/,"");return`${n}/${fd(i).replace(/^\/+/,"")}`}(e,d);if(l.push(`[media attached: ${f} (${u}) | ${f}]`),!ld.has(u))return;let m=s(d);o.push({content:m.toString("base64"),mimeType:u,fileName:c})}),{imageAttachments:o,fileReferences:l}}(e,n,o),h=p.join("\n"),f=h?c?`${c}\n\n${h}`:h:c,m=dd(a,d.length>0?12e4:1e3),g=await md(e,"chat.send",{sessionKey:l,message:f,thinking:ud(i),attachments:d,idempotencyKey:u},o,{timeoutMs:m});return{sessionKey:l,runId:ud(g?.runId),status:ud(g?.status),idempotencyKey:u}}async function wd({panelConfig:e,fileName:t,mimeType:r="application/octet-stream",base64:i,deps:n={}}){let s,a=function(e){let t=String(e||"").trim();if(!t)return"";let r=t.match(/^data:[^;]+;base64,(.+)$/i);return r?r[1].trim():t}(i);if(!a)throw new Error("base64 不能为空");try{s=Buffer.from(a,"base64")}catch{throw new Error("base64 格式无效")}if(!s||0===s.length)throw new Error("附件内容为空");let o=pd(t),l=ud(r).toLowerCase()||"application/octet-stream",c=function(e,t){return od.extname(String(e||"").trim())||cd[String(t||"").trim().toLowerCase()]||""}(o,l),u=rd(),d=hd(e),p=od.join(d,`${u}${c}`),h=n.mkdir||sd,f=n.writeFile||ad;await h(d,{recursive:!0}),await f(p,s,{mode:420});let m=l.startsWith("image/")&&s.length<=2097152?`data:${l};base64,${a}`:null;return{id:u,fileName:o,mimeType:l,fileSize:s.length,stagedPath:p,preview:m}}async function _d({panelConfig:e,keyPrefix:t="",deps:r={}}){let i=gd(t);if(!i)try{let t=await yd({panelConfig:e,deps:r});i=function(e){let t=(Array.isArray(e)?e:[]).find(e=>ud(e?.key).startsWith("agent:"));if(!t)return"";let r=ud(t.key).split(":");return r.length<2?"":`${r[0]}:${r[1]}`}(t?.sessions)}catch{i=""}let n=function(e){return`${gd(e)||"agent:main"}:session-${Date.now()}-${rd().slice(0,8)}`}(i||"agent:main"),s=await Ed({panelConfig:e,sessionKey:n,reason:"new",deps:r});return{key:ud(s?.key||n),entry:s?.entry&&"object"==typeof s.entry?s.entry:{}}}async function Sd({panelConfig:e,sessionKey:t,runId:r="",deps:i={}}){let n=ud(t);if(!n)throw new Error("sessionKey 不能为空");let s=await md(e,"chat.abort",{sessionKey:n,...ud(r)?{runId:ud(r)}:{}},i);return{sessionKey:n,aborted:!0===s?.aborted,runIds:Array.isArray(s?.runIds)?s.runIds:[]}}async function Ed({panelConfig:e,sessionKey:t,reason:r="new",deps:i={}}){let n=ud(t);if(!n)throw new Error("sessionKey 不能为空");let s=await md(e,"sessions.reset",{key:n,reason:"reset"===r?"reset":"new"},i);return{key:ud(s?.key||n),entry:s?.entry&&"object"==typeof s.entry?s.entry:{}}}import{randomBytes as kd}from"node:crypto";function xd(e){return String(e||"").trim()}function Td(){return kd(32).toString("hex")}function Pd(e,t=Td){let r=e&&"object"==typeof e&&!Array.isArray(e)?e:{},i=xd(r?.gateway?.auth?.mode),n=xd(r?.gateway?.auth?.token),s=function(e,t){let r=xd(e);for(let e=0;e<5;e+=1){let e=xd(t());if(e&&e!==r)return e}throw new Error("Gateway Token 生成失败，请重试")}(n,t),a=r?.gateway&&"object"==typeof r.gateway&&!Array.isArray(r.gateway)?{...r.gateway}:{},o=a?.auth&&"object"==typeof a.auth&&!Array.isArray(a.auth)?{...a.auth}:{};return o.mode="token",o.token=s,a.auth=o,{nextConfig:{...r,gateway:a},token:s,source:"generated-rotate",changed:"token"!==i||n!==s}}var Rd=qs(import.meta.url),Od=Fs.dirname(Rd),$d=(0,Ls.default)({logger:!1});await $d.register(Ds.default,{root:Fs.join(Od,"..","public"),prefix:"/"}),await $d.register(Ds.default,{root:Fs.join(Od,"..","node_modules","@shoelace-style","shoelace","cdn"),prefix:"/shoelace/",decorateReply:!1});var Cd=Hs.enum(["start","stop","restart","status"]),Ad=Hs.enum(["bot","panel"]),Nd=Hs.object({target:Ad.optional().default("bot")}),Id=Hs.object({tag:Hs.string().optional().default(""),target:Ad.optional().default("bot")}),jd=Hs.object({enabled:Hs.boolean()}),Ld=Hs.object({enabled:Hs.boolean().optional(),apiKey:Hs.string().optional(),clearApiKey:Hs.boolean().optional().default(!1),env:Hs.record(Hs.string()).optional()}).superRefine((e,t)=>{let r="boolean"==typeof e.enabled,i=String(e.apiKey||"").trim(),n=!0===e.clearApiKey,s=Object.keys(e.env&&"object"==typeof e.env?e.env:{}).some(e=>String(e||"").trim());!r&&!i&&!n&&!s&&t.addIssue({code:Hs.ZodIssueCode.custom,message:"至少提供一个可写入字段（enabled/apiKey/clearApiKey/env）"}),n&&i&&t.addIssue({code:Hs.ZodIssueCode.custom,message:"clearApiKey=true 时不能同时提供 apiKey"})}),Dd=Hs.object({sessionKey:Hs.string().min(1,"sessionKey 不能为空"),limit:Hs.coerce.number().int().positive().max(1e3).optional()}),Fd=Hs.object({sessionKey:Hs.string().min(1,"sessionKey 不能为空"),includeAgent:Hs.coerce.boolean().optional().default(!0)}),Md=Hs.object({sessionKey:Hs.string().min(1,"sessionKey 不能为空"),message:Hs.string().optional().default(""),thinking:Hs.string().optional().default(""),attachments:Hs.array(Hs.any()).optional().default([]),idempotencyKey:Hs.string().optional().default(""),timeoutMs:Hs.number().int().positive().max(12e4).optional()}),zd=Hs.object({sessionKey:Hs.string().min(1,"sessionKey 不能为空"),runId:Hs.string().optional().default("")}),qd=Hs.object({sessionKey:Hs.string().min(1,"sessionKey 不能为空"),reason:Hs.enum(["new","reset"]).optional().default("new")}),Ud=Hs.object({keyPrefix:Hs.string().optional().default("")}),Bd=Hs.object({fileName:Hs.string().min(1,"fileName 不能为空"),mimeType:Hs.string().optional().default("application/octet-stream"),base64:Hs.string().min(1,"base64 不能为空")}),Hd=Hs.object({botToken:Hs.string().min(1,"Bot Token 不能为空")}),Vd=Hs.object({code:Hs.string().min(1,"验证码不能为空")}),Gd=Hs.object({providerId:Hs.string().min(1,"providerId 不能为空")}),Wd=Hs.object({providerId:Hs.string().min(1,"providerId 不能为空"),modelId:Hs.string().min(1,"modelId 不能为空")}),Kd=Hs.object({nextProviderId:Hs.string().min(1,"供应商名称不能为空"),api:Hs.string().min(1,"API 模式不能为空"),baseUrl:Hs.string().min(1,"API 地址不能为空"),apiKey:Hs.string().optional()}),Jd=Hs.object({nextModelId:Hs.string().min(1,"模型 ID 不能为空"),name:Hs.string().optional(),contextWindow:Hs.number().int().positive().optional(),maxTokens:Hs.number().int().positive().optional()}),Zd=Hs.object({rawText:Hs.string().min(1,"配置 JSON 不能为空"),expectedMtimeMs:Hs.number().nonnegative().optional()});function Yd(e){let t=String(e||"").trim();return t?t.replace(/\/+$/,""):""}function Xd({scheme:e,host:t,port:r}){let i=String(t||"").trim(),n=Number(r);return!i||!Number.isFinite(n)||n<=0?"":`${"https"===String(e||"http").trim().toLowerCase()?"https":"http"}://${i}:${Math.floor(n)}`}function Qd(e){let t=e?.reverse_proxy||{},r=String(e?.panel?.listen_host||"127.0.0.1").trim(),i="0.0.0.0"===r?"127.0.0.1":r,n=Number(e?.panel?.listen_port||0),s=Number.isFinite(n)&&n>0?`http://${i}:${Math.floor(n)}`:"",a=Yd(t.panel_public_base_url)||Xd({scheme:t.public_scheme,host:t.public_host,port:t.panel_public_port}),o=Xd({scheme:t.public_scheme,host:t.public_host,port:t.gateway_public_port}),l=Yd(t.webhook_public_base_url)||o;return{panelLocalUrl:s,panelPublicUrl:a,gatewayPublicUrl:o,webhookBaseUrl:l,hasPublicEndpoint:!!a,hasWebhookEndpoint:!!l}}function ep(e){return String(e||"").trim()}function tp(e,t,r=15e3,i={}){let n=i?.env&&"object"==typeof i.env&&!Array.isArray(i.env)?i.env:{},s={...process.env,...n};return new Promise(i=>{zs(e,t,{timeout:r,maxBuffer:5242880,env:s},(e,t,r)=>{i({ok:!e,stdout:String(t||"").trim(),stderr:String(r||"").trim(),message:e?.message||""})})})}function rp(e){let t=ep(e);return t?t.length<=8?"*".repeat(t.length):`${t.slice(0,4)}***${t.slice(-4)}`:""}function ip(e,t="bot"){let r=Ad.parse(t);return"panel"===r?{target:r,releaseRepo:ep(e?.update?.panel_release_repo),panelServiceName:ep(e?.update?.panel_service_name)||"openclaw-panel",panelAppDir:ep(e?.update?.panel_app_dir),upgradeMode:"staged-apply"}:{target:r,releaseRepo:ep(e?.update?.bot_release_repo),upgradeMode:"direct"}}$d.get("/api/health",async()=>({ok:!0,service:"openclaw-panel",timestamp:(new Date).toISOString()})),$d.get("/api/panel-config",async()=>{let{config:e,filePath:t}=await Al();return{ok:!0,filePath:t,config:e,deployment:Qd(e)}}),$d.put("/api/panel-config",async(e,t)=>{try{let t=e.body||{},r={...$l,...t,panel:{...$l.panel,...t.panel||{}},runtime:{...$l.runtime,...t.runtime||{}},reverse_proxy:{...$l.reverse_proxy,...t.reverse_proxy||{}},openclaw:{...$l.openclaw,...t.openclaw||{}},docker:{...$l.docker,...t.docker||{}},update:{...$l.update,...t.update||{}},log:{...$l.log,...t.log||{}}},i=await async function(e){let t=Ol.parse(e),r=Cl();return await xl(r,t,384),{filePath:r,config:t}}(r);return{ok:!0,filePath:i.filePath,config:i.config}}catch(e){return t.code(400),{ok:!1,message:e.message}}}),$d.get("/api/settings",async()=>{let{config:e}=await Al();return{ok:!0,panelConfig:e,settings:Yl(await Ll(e.openclaw.config_path))}}),$d.get("/api/dashboard/summary",async(e,t)=>{try{let{config:e}=await Al(),t=await Ll(e.openclaw.config_path);return{ok:!0,summary:await Pu({panelConfig:e,openclawConfig:t})}}catch(e){return t.code(400),{ok:!1,message:e.message}}}),$d.put("/api/settings",async(e,t)=>{try{let{config:t}=await Al(),r=ec.parse(e.body||{}),i=function(e,t){let r=Ql.parse(t),i=r.model.providerId.trim(),n=r.model.modelId.trim(),s=String(r.model.primary||"").trim()||`${i}/${n}`,a=structuredClone(e||{});a.models||(a.models={}),a.models.providers||(a.models.providers={}),a.models.providers[i]||(a.models.providers[i]={});let o=a.models.providers[i];o.baseUrl=r.model.providerBaseUrl,o.api=r.model.providerApi,o.apiKey=Gl(r.model.providerApiKey,o.apiKey);let l=Array.isArray(o.models)?[...o.models]:[],c=Array.isArray(r.model.providerModels)?r.model.providerModels.map(e=>({...e,id:String(e.id||"").trim()})):[];if(c.length>0){let e=new Map(l.map(e=>[String(e?.id||"").trim(),e]).filter(([e])=>!!e)),t=new Set,r=c.filter(e=>e.id).map(r=>(t.add(r.id),Kl(r,e.get(r.id)||{}))),i=l.filter(e=>{let r=String(e?.id||"").trim();return r&&!t.has(r)});o.models=[...r,...i]}else{let e=l.findIndex(e=>String(e?.id||"")===n),t=Kl({id:n,name:r.model.modelName.trim(),contextWindow:r.model.contextWindow,maxTokens:r.model.maxTokens},e>=0?l[e]:{});e>=0?l[e]=t:l.unshift(t),o.models=l}if(a.models.mode||(a.models.mode="merge"),a.agents||(a.agents={}),a.agents.defaults||(a.agents.defaults={}),a.agents.defaults.model||(a.agents.defaults.model={}),a.agents.defaults.model.primary=s,r.channels){a.channels||(a.channels={}),a.channels.telegram||(a.channels.telegram={});let e=a.channels.telegram;e.enabled=r.channels.telegram.enabled,e.dmPolicy=r.channels.telegram.dmPolicy,e.groupPolicy=r.channels.telegram.groupPolicy,e.allowFrom=zl(r.channels.telegram.allowFrom),e.groupAllowFrom=zl(r.channels.telegram.groupAllowFrom),e.streamMode=r.channels.telegram.streamMode,e.chunkMode=r.channels.telegram.chunkMode,e.replyToMode=r.channels.telegram.replyToMode,e.linkPreview=r.channels.telegram.linkPreview,e.blockStreaming=r.channels.telegram.blockStreaming,e.configWrites=r.channels.telegram.configWrites,e.reactionLevel=r.channels.telegram.reactionLevel,e.reactionNotifications=r.channels.telegram.reactionNotifications,Jl(e,"tokenFile",r.channels.telegram.tokenFile),Jl(e,"webhookUrl",r.channels.telegram.webhookUrl),Jl(e,"webhookPath",r.channels.telegram.webhookPath),Jl(e,"proxy",r.channels.telegram.proxy),Zl(e,"textChunkLimit",r.channels.telegram.textChunkLimit),Zl(e,"timeoutSeconds",r.channels.telegram.timeoutSeconds),Zl(e,"mediaMaxMb",r.channels.telegram.mediaMaxMb),Zl(e,"dmHistoryLimit",r.channels.telegram.dmHistoryLimit,{allowZero:!0}),Zl(e,"historyLimit",r.channels.telegram.historyLimit,{allowZero:!0});let t=Hl(r.channels.telegram.groupsJson,"groupsJson","object");null!==t&&(e.groups=t);let i=Hl(r.channels.telegram.accountsJson,"accountsJson","object");null!==i?e.accounts=i:delete e.accounts;let n=Hl(r.channels.telegram.customCommandsJson,"customCommandsJson","array");null!==n?e.customCommands=n:delete e.customCommands;let s=Hl(r.channels.telegram.draftChunkJson,"draftChunkJson","object");if(null!==s?e.draftChunk=s:delete e.draftChunk,"open"===e.dmPolicy&&!(e.allowFrom||[]).includes("*"))throw new Error('telegram 开放模式要求 allowFrom 至少包含 "*"');(!e.groups||"object"!=typeof e.groups||Array.isArray(e.groups))&&(e.groups={}),(!e.groups["*"]||"object"!=typeof e.groups["*"])&&(e.groups["*"]={}),e.groups["*"].requireMention=r.channels.telegram.requireMention,(!e.capabilities||"object"!=typeof e.capabilities||Array.isArray(e.capabilities))&&(e.capabilities={}),e.capabilities.inlineButtons=r.channels.telegram.inlineButtons,(!e.actions||"object"!=typeof e.actions)&&(e.actions={}),e.actions.sendMessage=r.channels.telegram.actionSendMessage,e.actions.reactions=r.channels.telegram.actionReactions,e.actions.deleteMessage=r.channels.telegram.actionDeleteMessage,e.actions.sticker=r.channels.telegram.actionSticker,(!e.commands||"object"!=typeof e.commands)&&(e.commands={}),"default"===r.channels.telegram.commandsNative?delete e.commands.native:e.commands.native="auto"===r.channels.telegram.commandsNative?"auto":"true"===r.channels.telegram.commandsNative,0===Object.keys(e.commands).length&&delete e.commands,(!e.network||"object"!=typeof e.network)&&(e.network={}),null===r.channels.telegram.networkAutoSelectFamily?delete e.network.autoSelectFamily:e.network.autoSelectFamily=r.channels.telegram.networkAutoSelectFamily,0===Object.keys(e.network).length&&delete e.network,(!e.retry||"object"!=typeof e.retry)&&(e.retry={}),Zl(e.retry,"attempts",r.channels.telegram.retryAttempts),Zl(e.retry,"minDelayMs",r.channels.telegram.retryMinDelayMs),Zl(e.retry,"maxDelayMs",r.channels.telegram.retryMaxDelayMs),"number"==typeof r.channels.telegram.retryJitter&&Number.isFinite(r.channels.telegram.retryJitter)&&r.channels.telegram.retryJitter>=0&&r.channels.telegram.retryJitter<=1?e.retry.jitter=r.channels.telegram.retryJitter:delete e.retry.jitter;let o=Gl(r.channels.telegram.webhookSecret,e.webhookSecret||"");o?e.webhookSecret=o:delete e.webhookSecret;let l=Gl(r.channels.telegram.botToken,e.botToken||e.token||"");l?(e.botToken=l,e.token=l):(delete e.botToken,delete e.token),(!a.channels.feishu||"object"!=typeof a.channels.feishu)&&(a.channels.feishu={});let c=a.channels.feishu;if(c.enabled=r.channels.feishu.enabled,c.appId=r.channels.feishu.appId,c.appSecret=Gl(r.channels.feishu.appSecret,c.appSecret),c.domain=r.channels.feishu.domain,c.connectionMode=r.channels.feishu.connectionMode,c.dmPolicy=r.channels.feishu.dmPolicy,c.groupPolicy=r.channels.feishu.groupPolicy,c.allowFrom=zl(r.channels.feishu.allowFrom),c.groupAllowFrom=zl(r.channels.feishu.groupAllowFrom),c.requireMention=r.channels.feishu.requireMention,"open"===c.dmPolicy&&!(c.allowFrom||[]).includes("*"))throw new Error('feishu 开放模式要求 allowFrom 至少包含 "*"');if(c.accounts&&"object"==typeof c.accounts){let e=c.accounts.main?"main":Object.keys(c.accounts)[0]||"main";(!c.accounts[e]||"object"!=typeof c.accounts[e])&&(c.accounts[e]={});let t=c.accounts[e];t.enabled=r.channels.feishu.enabled,t.appId=r.channels.feishu.appId,t.appSecret=Gl(r.channels.feishu.appSecret,t.appSecret),t.domain=r.channels.feishu.domain,t.connectionMode=r.channels.feishu.connectionMode,t.dmPolicy=r.channels.feishu.dmPolicy,t.groupPolicy=r.channels.feishu.groupPolicy,t.allowFrom=zl(r.channels.feishu.allowFrom),t.groupAllowFrom=zl(r.channels.feishu.groupAllowFrom),t.requireMention=r.channels.feishu.requireMention}a.channels["feishu-china"]&&"object"==typeof a.channels["feishu-china"]&&(a.channels["feishu-china"].enabled=r.channels.feishu.enabled,a.channels["feishu-china"].appId=r.channels.feishu.appId,a.channels["feishu-china"].appSecret=Gl(r.channels.feishu.appSecret,a.channels["feishu-china"].appSecret)),(!a.channels.discord||"object"!=typeof a.channels.discord)&&(a.channels.discord={});let u=a.channels.discord,d=zl(r.channels.discord.allowFrom);if(u.enabled=r.channels.discord.enabled,u.dmPolicy=r.channels.discord.dmPolicy,u.allowFrom=d,u.groupPolicy=r.channels.discord.groupPolicy,u.allowBots=r.channels.discord.allowBots,(!u.dm||"object"!=typeof u.dm)&&(u.dm={}),u.dm.policy=r.channels.discord.dmPolicy,u.dm.allowFrom=d,"open"===u.dmPolicy&&!d.includes("*"))throw new Error('discord 开放模式要求 allowFrom 至少包含 "*"');if((!u.guilds||"object"!=typeof u.guilds)&&(u.guilds={}),(!u.guilds["*"]||"object"!=typeof u.guilds["*"])&&(u.guilds["*"]={}),u.guilds["*"].requireMention=r.channels.discord.requireMention,u.token=Gl(r.channels.discord.token,u.token),u.accounts&&"object"==typeof u.accounts){let e=u.accounts.main?"main":Object.keys(u.accounts)[0]||"main";(!u.accounts[e]||"object"!=typeof u.accounts[e])&&(u.accounts[e]={});let t=u.accounts[e];t.enabled=r.channels.discord.enabled,t.dmPolicy=r.channels.discord.dmPolicy,t.allowFrom=d,t.groupPolicy=r.channels.discord.groupPolicy,t.allowBots=r.channels.discord.allowBots,(!t.dm||"object"!=typeof t.dm)&&(t.dm={}),t.dm.policy=r.channels.discord.dmPolicy,t.dm.allowFrom=d,(!t.guilds||"object"!=typeof t.guilds)&&(t.guilds={}),(!t.guilds["*"]||"object"!=typeof t.guilds["*"])&&(t.guilds["*"]={}),t.guilds["*"].requireMention=r.channels.discord.requireMention,t.token=Gl(r.channels.discord.token,t.token)}(!a.channels.slack||"object"!=typeof a.channels.slack)&&(a.channels.slack={});let p=a.channels.slack,h=zl(r.channels.slack.allowFrom);if(p.enabled=r.channels.slack.enabled,p.mode=r.channels.slack.mode,p.dmPolicy=r.channels.slack.dmPolicy,p.allowFrom=h,p.groupPolicy=r.channels.slack.groupPolicy,p.allowBots=r.channels.slack.allowBots,p.requireMention=r.channels.slack.requireMention,(!p.dm||"object"!=typeof p.dm)&&(p.dm={}),p.dm.policy=r.channels.slack.dmPolicy,p.dm.allowFrom=h,"open"===p.dmPolicy&&!h.includes("*"))throw new Error('slack 开放模式要求 allowFrom 至少包含 "*"');if(p.botToken=Gl(r.channels.slack.botToken,p.botToken),p.appToken=Gl(r.channels.slack.appToken,p.appToken),p.signingSecret=Gl(r.channels.slack.signingSecret,p.signingSecret),"http"===p.mode&&!p.signingSecret)throw new Error("slack HTTP 模式要求 signingSecret 不能为空");if(p.accounts&&"object"==typeof p.accounts){let e=p.accounts.main?"main":Object.keys(p.accounts)[0]||"main";(!p.accounts[e]||"object"!=typeof p.accounts[e])&&(p.accounts[e]={});let t=p.accounts[e];if(t.enabled=r.channels.slack.enabled,t.mode=r.channels.slack.mode,t.dmPolicy=r.channels.slack.dmPolicy,t.allowFrom=h,t.groupPolicy=r.channels.slack.groupPolicy,t.allowBots=r.channels.slack.allowBots,t.requireMention=r.channels.slack.requireMention,(!t.dm||"object"!=typeof t.dm)&&(t.dm={}),t.dm.policy=r.channels.slack.dmPolicy,t.dm.allowFrom=h,t.botToken=Gl(r.channels.slack.botToken,t.botToken),t.appToken=Gl(r.channels.slack.appToken,t.appToken),t.signingSecret=Gl(r.channels.slack.signingSecret,t.signingSecret),"http"===t.mode&&!t.signingSecret&&!p.signingSecret)throw new Error(`slack 账号 ${e} 的 HTTP 模式需要 signingSecret`)}}return a}(await Ll(t.openclaw.config_path),r),n=await Dl(t.openclaw.config_path,i);return{ok:!0,message:"配置写入成功",path:n.path,backupPath:n.backupPath}}catch(e){return t.code(400),{ok:!1,message:e.message}}}),$d.post("/api/gateway/token/sync",async(e,t)=>{try{let{config:e}=await Al(),t=await Ll(e.openclaw.config_path),r=await async function({openclawConfig:e,panelConfig:t,configPath:r,saveConfig:i,approvePendingPairings:n}){let s,a=Pd(e),o=await i(r,a.nextConfig);try{s=await n({panelConfig:t})}catch(e){s=function(e){let t=xd(e?.message||e);return{ok:!1,message:t?`自动批准待处理配对失败：${t}`:"自动批准待处理配对失败",pendingCount:0,approvedCount:0,failedCount:0,pending:[],approvals:[],steps:[]}}(e)}return{tokenResult:a,saved:o,autoApprove:s}}({openclawConfig:t,panelConfig:e,configPath:e.openclaw.config_path,saveConfig:Dl,approvePendingPairings:td}),{tokenResult:i,saved:n,autoApprove:s}=r;return{ok:!0,result:{changed:i.changed,source:i.source,token:i.token,tokenMasked:rp(i.token),message:"Gateway Token 已重新生成并写入真实配置文件，已自动尝试批准待处理配对",autoApprove:s,path:n.path,backupPath:n.backupPath}}}catch(e){return t.code(400),{ok:!1,message:e.message}}}),$d.get("/api/gateway/token/current",async(e,t)=>{try{let{config:e}=await Al(),t=function(e){return ep(e?.gateway?.auth?.token)}(await Ll(e.openclaw.config_path));return{ok:!0,result:{exists:!!t,source:"openclaw-config",token:t,tokenMasked:rp(t)}}}catch(e){return t.code(400),{ok:!1,message:e.message}}}),$d.post("/api/gateway/pairing/approve-pending",async(e,t)=>{try{let{config:e}=await Al(),t=await td({panelConfig:e});return{ok:t.ok,result:t}}catch(e){return t.code(400),{ok:!1,message:e.message}}}),$d.get("/api/openclaw-config/raw",async(e,t)=>{try{let{config:e}=await Al(),t=e?.openclaw?.config_path,r=El(t),i="",n=0,s=0,a=!0;try{i=await Ms.readFile(r,"utf8");let e=await Ms.stat(r);n=Number(e.mtimeMs||0),s=Number(e.size||Buffer.byteLength(i,"utf8"))}catch(e){if("ENOENT"!==e.code)throw e;a=!1}return{ok:!0,exists:a,path:r,rawText:i,mtimeMs:n,size:s}}catch(e){return t.code(400),{ok:!1,message:e.message}}}),$d.put("/api/openclaw-config/raw",async(e,t)=>{try{let t,r=Zd.parse(e.body||{}),i=String(r.rawText||""),n=Number(r.expectedMtimeMs);try{t=JSON.parse(i)}catch(e){throw new Error(`配置 JSON 解析失败：${e.message}`)}let{config:s}=await Al();if(Number.isFinite(n)&&n>0){let e=El(s.openclaw.config_path),t=0;try{let r=await Ms.stat(e);t=Number(r.mtimeMs||0)}catch(e){if("ENOENT"!==e.code)throw e}if(!Number.isFinite(t)||Math.abs(t-n)>1){let e=new Error("配置文件已被其他进程更新，请先点“刷新真实配置”再保存。");throw e.statusCode=409,e}}let a=await Dl(s.openclaw.config_path,t),o=await Ms.readFile(a.path,"utf8"),l=await Ms.stat(a.path),c=await Ll(s.openclaw.config_path);return{ok:!0,message:"配置文件写入成功",path:a.path,backupPath:a.backupPath,rawText:o,mtimeMs:Number(l.mtimeMs||0),size:Number(l.size||Buffer.byteLength(o,"utf8")),settings:Yl(c)}}catch(e){return t.code(Number.isInteger(e?.statusCode)?e.statusCode:400),{ok:!1,message:e.message}}}),$d.put("/api/models/providers/:providerId",async(e,t)=>{try{let t=Gd.parse(e.params||{}),r=Kd.parse(e.body||{}),{config:i}=await Al(),n=function(e,t={}){let r=String(t.providerId||"").trim(),i=String(t.nextProviderId||r).trim(),n=String(t.api||"").trim(),s=String(t.baseUrl||"").trim();if(!r)throw new Error("providerId 不能为空");if(!i)throw new Error("nextProviderId 不能为空");if(!n)throw new Error("供应商 API 模式不能为空");if(!s)throw new Error("供应商 Base URL 不能为空");let a=ic(e),o=a.models.providers,l=o[r];if(!tc(l))throw new Error(`供应商不存在：${r}`);if(i!==r&&tc(o[i]))throw new Error(`供应商名称已存在：${i}`);let c={...l,api:n,baseUrl:s};if(Object.prototype.hasOwnProperty.call(t,"apiKey")&&(c.apiKey=String(t.apiKey||"").trim()),i!==r&&delete o[r],o[i]=c,i!==r){let e=`${r}/`,t=`${i}/`,n=String(a.agents.defaults.model.primary||"").trim();n.startsWith(e)&&(a.agents.defaults.model.primary=`${t}${n.slice(e.length)}`),nc(a,r=>r.startsWith(e)?`${t}${r.slice(e.length)}`:r)}return{nextConfig:a,providerId:i,primary:sc(a).primary}}(await Ll(i.openclaw.config_path),{providerId:t.providerId,nextProviderId:r.nextProviderId,api:r.api,baseUrl:r.baseUrl,...Object.prototype.hasOwnProperty.call(r,"apiKey")?{apiKey:r.apiKey}:{}}),s=await Dl(i.openclaw.config_path,n.nextConfig);return{ok:!0,message:"供应商更新成功",providerId:n.providerId,primary:n.primary,path:s.path,backupPath:s.backupPath}}catch(e){return t.code(400),{ok:!1,message:e.message}}}),$d.put("/api/models/providers/:providerId/models/:modelId",async(e,t)=>{try{let t=Wd.parse(e.params||{}),r=Jd.parse(e.body||{}),{config:i}=await Al(),n=function(e,t={}){let r=String(t.providerId||"").trim(),i=String(t.modelId||"").trim(),n=String(t.nextModelId||i).trim();if(!r)throw new Error("providerId 不能为空");if(!i)throw new Error("modelId 不能为空");if(!n)throw new Error("nextModelId 不能为空");let s=ic(e),a=s.models.providers[r];if(!tc(a))throw new Error(`供应商不存在：${r}`);let o=Array.isArray(a.models)?[...a.models]:[],l=o.findIndex(e=>String(e?.id||"").trim()===i);if(l<0)throw new Error(`模型不存在：${r}/${i}`);if(n!==i&&o.some((e,t)=>t!==l&&String(e?.id||"").trim()===n))throw new Error(`模型 ID 已存在：${r}/${n}`);let c={...tc(o[l])?o[l]:{},id:n};if(Object.prototype.hasOwnProperty.call(t,"name")){let e=String(t.name||"").trim();c.name=e||n}else String(c.name||"").trim()||(c.name=n);let u=ac(t.contextWindow,"contextWindow");void 0!==u&&(c.contextWindow=u);let d=ac(t.maxTokens,"maxTokens");if(void 0!==d&&(c.maxTokens=d),o[l]=c,a.models=o,n!==i){let e=rc(r,i),t=rc(r,n);if(!t)throw new Error("模型引用无效");String(s.agents.defaults.model.primary||"").trim()===e&&(s.agents.defaults.model.primary=t),nc(s,r=>r===e?t:r)}let p=sc(s);return{nextConfig:s,providerId:r,modelId:n,modelName:String(c.name||n).trim()||n,primary:p.primary}}(await Ll(i.openclaw.config_path),{providerId:t.providerId,modelId:t.modelId,nextModelId:r.nextModelId,...Object.prototype.hasOwnProperty.call(r,"name")?{name:r.name}:{},...Object.prototype.hasOwnProperty.call(r,"contextWindow")?{contextWindow:r.contextWindow}:{},...Object.prototype.hasOwnProperty.call(r,"maxTokens")?{maxTokens:r.maxTokens}:{}}),s=await Dl(i.openclaw.config_path,n.nextConfig);return{ok:!0,message:"模型更新成功",providerId:n.providerId,modelId:n.modelId,modelName:n.modelName,primary:n.primary,path:s.path,backupPath:s.backupPath}}catch(e){return t.code(400),{ok:!1,message:e.message}}}),$d.delete("/api/models/providers/:providerId/models/:modelId",async(e,t)=>{try{let t=Wd.parse(e.params||{}),{config:r}=await Al(),i=function(e,t={}){let r=String(t.providerId||"").trim(),i=String(t.modelId||"").trim();if(!r)throw new Error("providerId 不能为空");if(!i)throw new Error("modelId 不能为空");let n=ic(e),s=n.models.providers,a=s[r];if(!tc(a))throw new Error(`供应商不存在：${r}`);let o=Array.isArray(a.models)?[...a.models]:[],l=o.filter(e=>String(e?.id||"").trim()!==i);if(l.length===o.length)throw new Error(`模型不存在：${r}/${i}`);let c=rc(r,i),u=String(n.agents.defaults.model.primary||"").trim(),d=!1;if(l.length>0)a.models=l,nc(n,e=>e===c?"":e);else{delete s[r],d=!0;let e=`${r}/`;nc(n,t=>t.startsWith(e)?"":t)}(u===c||d&&u.startsWith(`${r}/`))&&(n.agents.defaults.model.primary="");let p=sc(n);return{nextConfig:n,providerId:r,modelId:i,providerRemoved:d,primary:p.primary}}(await Ll(r.openclaw.config_path),{providerId:t.providerId,modelId:t.modelId}),n=await Dl(r.openclaw.config_path,i.nextConfig);return{ok:!0,message:"模型删除成功",providerId:i.providerId,modelId:i.modelId,providerRemoved:i.providerRemoved,primary:i.primary,path:n.path,backupPath:n.backupPath}}catch(e){return t.code(400),{ok:!1,message:e.message}}}),$d.delete("/api/models/providers/:providerId",async(e,t)=>{try{let t=Gd.parse(e.params||{}),{config:r}=await Al(),i=function(e,t={}){let r=String(t.providerId||"").trim();if(!r)throw new Error("providerId 不能为空");let i=ic(e),n=i.models.providers;if(!tc(n[r]))throw new Error(`供应商不存在：${r}`);delete n[r];let s=`${r}/`;return String(i.agents.defaults.model.primary||"").trim().startsWith(s)&&(i.agents.defaults.model.primary=""),nc(i,e=>e.startsWith(s)?"":e),{nextConfig:i,providerId:r,primary:sc(i).primary}}(await Ll(r.openclaw.config_path),{providerId:t.providerId}),n=await Dl(r.openclaw.config_path,i.nextConfig);return{ok:!0,message:"供应商删除成功",providerId:i.providerId,primary:i.primary,path:n.path,backupPath:n.backupPath}}catch(e){return t.code(400),{ok:!1,message:e.message}}}),$d.get("/api/skills/status",async(e,t)=>{try{let{config:e}=await Al();return{ok:!0,result:await Au({panelConfig:e})}}catch(e){return t.code(400),{ok:!1,message:e.message}}}),$d.get("/api/skills/:skillKey/config",async(e,t)=>{try{let t=String(e.params?.skillKey||"").trim(),{config:r}=await Al();return{ok:!0,result:await Nu({panelConfig:r,skillKey:t})}}catch(e){return t.code(400),{ok:!1,message:e.message}}}),$d.put("/api/skills/:skillKey/config",async(e,t)=>{try{let t=String(e.params?.skillKey||"").trim(),r=function(e={}){let t={};"boolean"==typeof e.enabled&&(t.enabled=e.enabled);let r=ep(e.apiKey);if(r&&(t.apiKey=r),!0===e.clearApiKey&&(t.clearApiKey=!0),e.env&&"object"==typeof e.env&&!Array.isArray(e.env)){let r={};for(let[t,i]of Object.entries(e.env)){let e=ep(t);e&&(r[e]=ep(i))}Object.keys(r).length>0&&(t.env=r)}return t}(Ld.parse(e.body||{})),{config:i}=await Al(),n=await async function({panelConfig:e,skillKey:t,patch:r={},deps:i={}}){let n=Ru(t);if(!n)throw new Error("skillKey 不能为空");Cu(Ou((await Au({panelConfig:e,deps:i})).skills),n);let s=await(i.loadOpenClawConfig||Ll)(e?.openclaw?.config_path),a=structuredClone(s||{});(!a.skills||"object"!=typeof a.skills)&&(a.skills={}),(!a.skills.entries||"object"!=typeof a.skills.entries)&&(a.skills.entries={});let o=a.skills.entries[n],l=o&&"object"==typeof o?structuredClone(o):{},c=l&&"object"==typeof l?{...l}:{};"boolean"==typeof r.enabled&&(c.enabled=r.enabled);let u=!0===r.clearApiKey,d=Ru(r.apiKey);u?delete c.apiKey:d&&(c.apiKey=d);let p=function(e){return!e||"object"!=typeof e||Array.isArray(e)?{}:Object.fromEntries(Object.entries(e).map(([e,t])=>[Ru(e),Ru(t)]).filter(([e])=>!!e))}(r.env);if(Object.keys(p).length>0){let e=c.env&&"object"==typeof c.env&&!Array.isArray(c.env)?{...c.env}:{};for(let[t,r]of Object.entries(p))r?e[t]=r:delete e[t];Object.keys(e).length>0?c.env=e:delete c.env}return a.skills.entries[n]=c,{skillKey:n,nextConfig:a,previousEntry:l,nextEntry:c}}({panelConfig:i,skillKey:t,patch:r}),s=await Dl(i.openclaw.config_path,n.nextConfig);try{let e=await Nu({panelConfig:i,skillKey:n.skillKey});return function({patch:e={},config:t={}}){if("boolean"==typeof e.enabled&&t.enabled!==e.enabled)throw new Error("enabled 写回校验失败");if(!0===e.clearApiKey&&t.hasApiKey)throw new Error("apiKey 清除校验失败");if(e.apiKey&&!t.hasApiKey)throw new Error("apiKey 写回校验失败");if(e.env&&"object"==typeof e.env){let r=t.env&&"object"==typeof t.env?t.env:{};for(let[t,i]of Object.entries(e.env)){let e=!!ep(i),n=Object.prototype.hasOwnProperty.call(r,t);if(e&&!n)throw new Error(`环境变量写回校验失败：${t}`);if(!e&&n)throw new Error(`环境变量删除校验失败：${t}`)}}}({patch:r,config:e}),{ok:!0,result:{skillKey:n.skillKey,config:e,path:s.path,backupPath:s.backupPath}}}catch(e){let t=await async function(e,t){if(!e||!t)return{ok:!1,message:"缺少回滚路径"};try{return await Ms.copyFile(t,e),{ok:!0,message:"已自动回滚到备份配置"}}catch(e){return{ok:!1,message:e.message||String(e)}}}(s.path,s.backupPath),r=t.ok?"已自动回滚到写入前版本。":`自动回滚失败：${t.message}`;throw new Error(`Skill 配置写入后校验失败：${e.message}。${r}`)}}catch(e){return t.code(400),{ok:!1,message:e.message}}}),$d.post("/api/skills/:skillKey/enabled",async(e,t)=>{try{let t=String(e.params?.skillKey||"").trim(),r=jd.parse(e.body||{}),{config:i}=await Al();return{ok:!0,result:await Iu({panelConfig:i,skillKey:t,enabled:r.enabled})}}catch(e){return t.code(400),{ok:!1,message:e.message}}}),$d.get("/api/chat/sessions",async(e,t)=>{try{let{config:e}=await Al();return{ok:!0,result:await yd({panelConfig:e})}}catch(e){return t.code(400),{ok:!1,message:e.message}}}),$d.get("/api/chat/history",async(e,t)=>{try{let t=Dd.parse(e.query||{}),{config:r}=await Al();return{ok:!0,result:await vd({panelConfig:r,sessionKey:t.sessionKey,limit:t.limit})}}catch(e){return t.code(400),{ok:!1,message:e.message}}}),$d.post("/api/chat/send",async(e,t)=>{try{let t=Md.parse(e.body||{}),{config:r}=await Al();return{ok:!0,result:await bd({panelConfig:r,sessionKey:t.sessionKey,message:t.message,thinking:t.thinking,attachments:t.attachments,idempotencyKey:t.idempotencyKey,timeoutMs:t.timeoutMs})}}catch(e){return t.code(400),{ok:!1,message:e.message}}}),$d.post("/api/chat/abort",async(e,t)=>{try{let t=zd.parse(e.body||{}),{config:r}=await Al();return{ok:!0,result:await Sd({panelConfig:r,sessionKey:t.sessionKey,runId:t.runId})}}catch(e){return t.code(400),{ok:!1,message:e.message}}}),$d.post("/api/chat/session/reset",async(e,t)=>{try{let t=qd.parse(e.body||{}),{config:r}=await Al();return{ok:!0,result:await Ed({panelConfig:r,sessionKey:t.sessionKey,reason:t.reason})}}catch(e){return t.code(400),{ok:!1,message:e.message}}}),$d.post("/api/chat/session/new",async(e,t)=>{try{let t=Ud.parse(e.body||{}),{config:r}=await Al();return{ok:!0,result:await _d({panelConfig:r,keyPrefix:t.keyPrefix})}}catch(e){return t.code(400),{ok:!1,message:e.message}}}),$d.post("/api/chat/attachments/stage",async(e,t)=>{try{let t=Bd.parse(e.body||{}),{config:r}=await Al();return{ok:!0,result:await wd({panelConfig:r,fileName:t.fileName,mimeType:t.mimeType,base64:t.base64})}}catch(e){return t.code(400),{ok:!1,message:e.message}}}),$d.get("/api/chat/stream",async(e,t)=>{let r;try{r=Fd.parse(e.query||{})}catch(e){return t.code(400),{ok:!1,message:e.message}}let{config:i}=await Al(),n=String(r.sessionKey||"").trim(),s=!1!==r.includeAgent,a=!1,o=null,l=null,c=null,u=0,d=(e,r)=>{a||(t.raw.write(`event: ${e}\n`),t.raw.write(`data: ${JSON.stringify(r)}\n\n`))},p=()=>{if(c){try{c.close()}catch{}c=null}},h=(e="")=>{if(a)return;u+=1;let t=Math.min(1e4,Math.max(1e3,1e3*u));d("status",{state:"reconnecting",sessionKey:n,attempt:u,delayMs:t,reason:String(e||"").trim()||"gateway disconnected"}),o=setTimeout(()=>{o=null,f()},t)},f=()=>{a||(p(),c=function({panelConfig:e,sessionKey:t,includeAgent:r=!0,deps:i={},onEvent:n,onError:s,onClose:a}){let o=i.subscribeGatewayEvents||_u,l=ud(i.gatewayToken??process.env.OPENCLAW_GATEWAY_TOKEN),c=ud(t);if(!c)throw new Error("sessionKey 不能为空");return o({panelConfig:e,token:l,onEvent:e=>{let t=ud(e?.event);if(t){if("chat"===t){let t=function(e){let t=e?.payload&&"object"==typeof e.payload?e.payload:{};return{type:"chat",event:"chat",seq:Number(e?.seq||0)||null,at:Date.now(),runId:ud(t?.runId),sessionKey:ud(t?.sessionKey),state:ud(t?.state),stopReason:ud(t?.stopReason),errorMessage:ud(t?.errorMessage),message:t?.message&&"object"==typeof t.message?t.message:t?.message??null}}(e);if(t.sessionKey!==c)return;return n?.(t),void(function(e){return"final"===e||"error"===e||"aborted"===e}(t.state)&&n?.({type:"terminal",event:"terminal",at:Date.now(),runId:t.runId,sessionKey:t.sessionKey,state:t.state}))}if(r&&"agent"===t){let t=function(e){let t=e?.payload&&"object"==typeof e.payload?e.payload:{},r=t?.data&&"object"==typeof t.data?t.data:{};return{type:"agent",event:"agent",seq:Number(e?.seq||0)||null,at:Date.now(),runId:ud(t?.runId),sessionKey:ud(t?.sessionKey),stream:ud(t?.stream),phase:ud(r?.phase),data:r}}(e);if(t.sessionKey!==c)return;n?.(t)}}},onError:s,onClose:a})}({panelConfig:i,sessionKey:n,includeAgent:s,onEvent:e=>{d(e.type||"message",e)},onError:e=>{d("stream-error",{sessionKey:n,message:e?.message||String(e)})},onClose:({code:e,reason:t})=>{a||(d("status",{state:"gateway-closed",sessionKey:n,code:e,reason:String(t||"")}),h(t))}}),c.ready.then(()=>{a||(u=0,d("status",{state:"connected",sessionKey:n,includeAgent:s,at:(new Date).toISOString()}))}).catch(e=>{a||(d("status",{state:"connect-failed",sessionKey:n,message:e?.message||String(e)}),h(e?.message||String(e)))}))};t.raw.writeHead(200,{"content-type":"text/event-stream","cache-control":"no-cache",connection:"keep-alive"}),d("ready",{sessionKey:n,includeAgent:s,at:(new Date).toISOString()}),l=setInterval(()=>{d("heartbeat",{sessionKey:n,ts:Date.now()})},15e3),f(),e.raw.on("close",()=>{a=!0,l&&(clearInterval(l),l=null),o&&(clearTimeout(o),o=null),p()})}),$d.post("/api/service/:action",async(e,t)=>{try{let t=Cd.parse(e.params.action),{config:r}=await Al(),i=await fc(t,r);return{ok:i.ok,result:i}}catch(e){return t.code(400),{ok:!1,message:e.message}}}),$d.get("/api/logs/tail",async(e,t)=>{try{let t=Pl(e.query?.lines,200),r=String(e.query?.filter||""),{config:i}=await Al();return{ok:!0,lines:await wc({panelConfig:i,lines:t,filter:r})}}catch(e){return t.code(400),{ok:!1,message:e.message}}}),$d.get("/api/logs/errors",async(e,t)=>{try{let t=Pl(e.query?.count,20),{config:r}=await Al();return{ok:!0,lines:await _c({panelConfig:r,count:t})}}catch(e){return t.code(400),{ok:!1,message:e.message}}}),$d.get("/api/logs/stream",async(e,t)=>{let r=String(e.query?.filter||"").toLowerCase(),{config:i}=await Al();t.raw.writeHead(200,{"content-type":"text/event-stream","cache-control":"no-cache",connection:"keep-alive"});let n=(e,r)=>{t.raw.write(`event: ${e}\n`),t.raw.write(`data: ${JSON.stringify(r)}\n\n`)},s=function({panelConfig:e,onLine:t,onError:r}){let i,n=e.log.source;return i="docker"===n?gc("docker",["logs","-f","--tail","20",e?.openclaw?.container_name||e?.openclaw?.service_name||"openclaw-gateway"]):"journal"===n&&"linux"===process.platform?gc("journalctl",["-u",e.openclaw.service_name,"-f","-n","20","--no-pager","-o","short-iso"]):gc("tail",["-n","20","-F",El(e.log.file_path)]),i.stdout.on("data",e=>{let r=yc(e.toString());for(let e of r)t(e)}),i.stderr.on("data",e=>{let t=yc(e.toString());for(let e of t)r(e)}),i.on("error",e=>{r(e.message)}),()=>{i.killed||i.kill("SIGTERM")}}({panelConfig:i,onLine:e=>{(e=>!r||e.toLowerCase().includes(r))(e)&&n("line",{line:e})},onError:e=>{n("error",{line:e})}}),a=setInterval(()=>{n("heartbeat",{ts:Date.now()})},15e3);e.raw.on("close",()=>{clearInterval(a),s()})}),$d.post("/api/test/telegram",async(e,t)=>{let r=e.body||{},i=await async function(e){if(!e)return{ok:!1,message:"botToken 不能为空"};try{let t=`https://api.telegram.org/bot${e}/getMe`,{wrapped:r}=Sc(e=>fetch(t,{method:"GET",signal:e}),8e3),i=await r,n=await i.json();return i.ok&&n.ok?{ok:!0,message:`连接成功，机器人：${n.result?.username||"unknown"}`}:{ok:!1,message:n?.description||`请求失败（${i.status}）`}}catch(e){return{ok:!1,message:`连接失败：${e.message}`}}}(r.botToken||"");return{ok:i.ok,message:i.message}}),$d.post("/api/channels/telegram/setup",async(e,t)=>{try{let r=Hd.safeParse(e.body||{});if(!r.success)return t.code(400),{ok:!1,message:r.error.issues?.[0]?.message||"请求参数错误"};let{config:i}=await Al(),n=await async function({panelConfig:e,botToken:t,deps:r={}}){let i=zu(t);if(!i)throw new Error("Bot Token 不能为空");let n=qu(r.setupStepRetryAttempts,3),s=qu(r.setupStepRetryDelayMs,400),a="function"==typeof r.sleep?r.sleep:async e=>await new Promise(t=>{setTimeout(t,e)}),o=[],l=[{label:"启用 Telegram 插件",openclawArgs:["plugins","enable","telegram"],allowAlreadyEnabled:!0},{label:"启用 Telegram 渠道",openclawArgs:["config","set","channels.telegram.enabled","true"]},{label:"写入 Telegram Bot Token",openclawArgs:["config","set","channels.telegram.botToken",i],redactOpenclawArgIndices:[3],secrets:[i]}],c=[];for(let t of l){let i=!1;for(let l=1;l<=n;l+=1){let{dockerCliPrefix:u,...d}=await ed({panelConfig:e,openclawArgs:t.openclawArgs,dockerCliPrefix:o,redactOpenclawArgIndices:t.redactOpenclawArgIndices||[],secrets:t.secrets||[],deps:r});Array.isArray(u)&&u.length>0&&(o=[...u]),i=!!d.ok||!0===t.allowAlreadyEnabled&&Ju(d.output);let p=s*l,h=!i&&l<n,f=h?[d.output,`步骤失败，${p}ms 后自动重试`].filter(Boolean).join("\n"):d.output,m={...d,ok:i,label:n>1?`${t.label}（尝试 ${l}/${n}）`:t.label,output:f};if(c.push(m),i)break;h&&await a(p)}if(!i)return{ok:!1,failedStep:t.label,message:`${t.label}失败（已重试 ${n} 次）`,steps:c}}return{ok:!0,message:"Telegram 已保存并启用，可继续验证码配对",steps:c}}({panelConfig:i,botToken:r.data.botToken});return{ok:n.ok,result:n}}catch(e){return t.code(400),{ok:!1,message:e.message}}}),$d.post("/api/channels/telegram/pairing/approve",async(e,t)=>{try{let r=Vd.safeParse(e.body||{});if(!r.success)return t.code(400),{ok:!1,message:r.error.issues?.[0]?.message||"请求参数错误"};let{config:i}=await Al(),n=await async function({panelConfig:e,code:t,deps:r={}}){let i=zu(t);if(!i)throw new Error("验证码不能为空");let{dockerCliPrefix:n,...s}=await ed({panelConfig:e,openclawArgs:["pairing","approve","telegram",i],redactOpenclawArgIndices:[3],secrets:[i],deps:r});return s.ok?{ok:!0,message:"验证码验证成功，Telegram 已完成配对",step:{...s,label:"验证码验证"}}:{ok:!1,message:"验证码验证失败",step:{...s,label:"验证码验证"}}}({panelConfig:i,code:r.data.code});return{ok:n.ok,result:n}}catch(e){return t.code(400),{ok:!1,message:e.message}}}),$d.post("/api/test/feishu",async e=>{let t=e.body||{},r=await async function(e,t){if(!e||!t)return{ok:!1,message:"appId 和 appSecret 不能为空"};try{let{wrapped:r}=Sc(r=>fetch("https://open.feishu.cn/open-apis/auth/v3/tenant_access_token/internal",{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({app_id:e,app_secret:t}),signal:r}),8e3),i=await r,n=await i.json();return i.ok&&0===n.code&&n.tenant_access_token?{ok:!0,message:"飞书连接成功，凭证可用"}:{ok:!1,message:n?.msg||`请求失败（${i.status}）`}}catch(e){return{ok:!1,message:`连接失败：${e.message}`}}}(t.appId||"",t.appSecret||"");return{ok:r.ok,message:r.message}}),$d.post("/api/test/discord",async e=>{let t=e.body||{},r=await async function(e){if(!e)return{ok:!1,message:"token 不能为空"};try{let{wrapped:t}=Sc(t=>fetch("https://discord.com/api/v10/users/@me",{method:"GET",headers:{authorization:`Bot ${e}`},signal:t}),8e3),r=await t,i=await r.json();return r.ok&&i?.id?{ok:!0,message:`连接成功，机器人：${i.username||i.global_name||i.id}`}:{ok:!1,message:i?.message||i?.error||`请求失败（${r.status}）`}}catch(e){return{ok:!1,message:`连接失败：${e.message}`}}}(t.token||"");return{ok:r.ok,message:r.message}}),$d.post("/api/test/slack",async e=>{let t=e.body||{},r=await async function({mode:e,botToken:t,appToken:r,signingSecret:i}){if(!t)return{ok:!1,message:"botToken 不能为空"};if("http"===e&&!i)return{ok:!1,message:"HTTP 模式需要 signingSecret"};try{let i=await async function(e){let{wrapped:t}=Sc(t=>fetch("https://slack.com/api/auth.test",{method:"POST",headers:{authorization:`Bearer ${e}`,"content-type":"application/x-www-form-urlencoded"},body:"",signal:t}),8e3),r=await t,i=await r.json();return r.ok&&i.ok?{ok:!0,message:`Bot Token 可用，团队：${i.team||"unknown"}`}:{ok:!1,message:i?.error||`Bot Token 校验失败（${r.status}）`}}(t);if(!i.ok)return i;if("socket"===e){if(!r)return{ok:!1,message:"Socket 模式需要 appToken"};let e=await async function(e){let{wrapped:t}=Sc(t=>fetch("https://slack.com/api/apps.connections.open",{method:"POST",headers:{authorization:`Bearer ${e}`,"content-type":"application/x-www-form-urlencoded"},body:"",signal:t}),8e3),r=await t,i=await r.json();return r.ok&&i.ok?{ok:!0,message:"App Token 可用（Socket 链接可建立）"}:{ok:!1,message:i?.error||`App Token 校验失败（${r.status}）`}}(r);return e.ok?{ok:!0,message:"Slack Socket 模式校验通过（Bot Token + App Token 均可用）"}:e}return{ok:!0,message:"Slack HTTP 模式基础校验通过（Bot Token 可用，Signing Secret 已填写）"}}catch(e){return{ok:!1,message:`连接失败：${e.message}`}}}({mode:t.mode||"socket",botToken:t.botToken||"",appToken:t.appToken||"",signingSecret:t.signingSecret||""});return{ok:r.ok,message:r.message}}),$d.get("/api/update/check",async(e,t)=>{try{let t=Nd.parse(e.query||{}),{config:r}=await Al(),i=ip(r,t.target),n=ep(r?.update?.github_token);return{ok:!0,result:{..."panel"===i.target?await Bc({releaseRepo:i.releaseRepo,githubToken:n,appDir:i.panelAppDir}):await Dc({runCmd:tp,releaseRepo:i.releaseRepo}),target:i.target,upgradeMode:i.upgradeMode}}}catch(e){return t.code(400),{ok:!1,message:e.message}}}),$d.post("/api/update/upgrade",async(e,t)=>{try{let t,r=Id.parse(e.body||{}),{config:i}=await Al(),n=ip(i,r.target),s=ep(i?.update?.github_token);return t="panel"===n.target?await Hc({tag:r.tag,releaseRepo:n.releaseRepo,githubToken:s,appDir:n.panelAppDir}):await Fc({action:"upgrade",tag:r.tag,runCmd:tp}),{ok:t.ok,result:{...t,target:n.target,upgradeMode:n.upgradeMode}}}catch(e){return t.code(400),{ok:!1,message:e.message}}}),$d.post("/api/update/rollback",async(e,t)=>{try{let t,r=Id.parse(e.body||{}),{config:i}=await Al(),n=ip(i,r.target),s=ep(i?.update?.github_token);if("panel"===n.target){if(!ep(r.tag))throw new Error("回滚必须填写目标版本号");t=await Hc({tag:r.tag,releaseRepo:n.releaseRepo,githubToken:s,appDir:n.panelAppDir}),t.action="rollback-stage",t.message=t.ok?`已准备回滚版本包 ${ep(r.tag)}，请点击“应用更新并重启”完成回滚。`:t.message}else t=await Fc({action:"rollback",tag:r.tag,runCmd:tp});return{ok:t.ok,result:{...t,target:n.target,upgradeMode:n.upgradeMode}}}catch(e){return t.code(400),{ok:!1,message:e.message}}}),$d.post("/api/update/apply",async(e,t)=>{try{let t,r=Id.parse(e.body||{}),{config:i}=await Al(),n=ip(i,r.target),s=ep(i?.update?.github_token);return t="panel"===n.target?await async function({tag:e="",releaseRepo:t=Pc,githubToken:r="",fetchImpl:i=fetch,appDir:n="",stateDir:s="",panelServiceName:a=""}={}){if("linux"!==process.platform)return{ok:!1,action:"apply",rolledBack:!1,requiresReconnect:!1,message:"控制台自更新仅支持 Linux 服务器环境执行"};let o=zc(s);await Ec.mkdir(o,{recursive:!0});let l=xc.join(o,"pending.json"),c=await qc(l,null);if(!c||!Rc(c?.tarballPath)){if(!Rc(e))return{ok:!1,action:"apply",rolledBack:!1,requiresReconnect:!1,message:"未找到待应用的版本包，请先执行“检查新版本/准备更新包”"};await Hc({tag:e,releaseRepo:t,githubToken:r,fetchImpl:i,appDir:n,stateDir:o}),c=await qc(l,null)}if(!c||!Rc(c?.tarballPath))return{ok:!1,action:"apply",rolledBack:!1,requiresReconnect:!1,message:"未找到待应用的版本包"};let u=Mc(Rc(c?.appDir)||n),d=function(e=""){return Rc(e||process.env.PANEL_SERVICE_NAME)||"openclaw-panel"}(a),p=Rc(c?.tag)||$c(e)||"unknown",h=Cc(Rc(c?.releaseRepo)||t,Pc),f=function({appDir:e,serviceName:t,tarballPath:r,tag:i,releaseRepo:n,pendingPath:s}){let a=xc.join(e,".panel-release.json"),o=JSON.stringify({tag:i,releaseRepo:n,appliedAt:(new Date).toISOString()},null,2);return["set -euo pipefail",`APP_DIR=${Ac(e)}`,`SERVICE_NAME=${Ac(t)}`,`TARBALL=${Ac(r)}`,`PENDING=${Ac(s)}`,"TMP_DIR=$(mktemp -d)",'cleanup(){ rm -rf "$TMP_DIR"; }',"trap cleanup EXIT",'tar -xzf "$TARBALL" -C "$TMP_DIR"','SRC_DIR=$(find "$TMP_DIR" -mindepth 1 -maxdepth 1 -type d | head -n 1)',"if [ -z \"$SRC_DIR\" ]; then echo 'release unpack failed'; exit 1; fi",'mkdir -p "$APP_DIR"',"if command -v rsync >/dev/null 2>&1; then","  rsync -a --delete --exclude '.git' --exclude 'node_modules' --exclude '.runtime' \"$SRC_DIR\"/ \"$APP_DIR\"/","else","  find \"$APP_DIR\" -mindepth 1 -maxdepth 1 ! -name '.runtime' -exec rm -rf {} +",'  cp -a "$SRC_DIR"/. "$APP_DIR"/',"fi",'cd "$APP_DIR"',"npm install --omit=dev",`cat > ${Ac(a)} <<'JSON'`,o,"JSON",'rm -f "$PENDING"',"systemctl daemon-reload || true",'systemctl restart "$SERVICE_NAME"'].join("\n")}({appDir:u,serviceName:d,tarballPath:Rc(c.tarballPath),tag:p,releaseRepo:h,pendingPath:l}),m=xc.join(o,`apply-${Date.now()}.log`);Tc("bash",["-lc",`(${f}\n) > ${Ac(m)} 2>&1`],{detached:!0,stdio:"ignore"}).unref();let g=await Uc(u);return{ok:!0,action:"apply",targetImage:`panel:${p}`,oldImage:g?`panel:${g}`:"",rolledBack:!1,requiresReconnect:!0,reconnectAfterMs:12e3,message:`已开始应用 ${p} 并重启控制台服务，页面将短暂断开后恢复。`,logPath:m}}({tag:r.tag,releaseRepo:n.releaseRepo,githubToken:s,appDir:n.panelAppDir,panelServiceName:n.panelServiceName}):await Fc({action:"upgrade",tag:r.tag,runCmd:tp}),{ok:t.ok,result:{...t,target:n.target,upgradeMode:n.upgradeMode}}}catch(e){return t.code(400),{ok:!1,message:e.message}}});var np={"/":"pages/dashboard.html","/dashboard":"pages/dashboard.html","/status-overview":"pages/dashboard.html","/skills":"pages/skills.html","/model":"pages/model.html","/model/add":"pages/model-add.html","/config-generator":"pages/config-generator.html","/channels":"pages/channels.html","/channels/telegram":"pages/channels-telegram.html","/channels/feishu":"pages/channels-feishu.html","/channels/discord":"pages/channels-discord.html","/channels/slack":"pages/channels-slack.html","/update":"pages/update.html","/service":"pages/service.html","/logs":"pages/logs.html"};$d.get("/",async(e,t)=>t.sendFile("pages/dashboard.html")),$d.setNotFoundHandler(async(e,t)=>{if(e.raw.url?.startsWith("/api/"))return t.code(404),{ok:!1,message:"API not found"};let r=String(e.raw.url||"/").split("?")[0]||"/";return t.sendFile(np[r]||"index.html")}),async function(){let{config:e}=await Al();try{let t=await jl(e.openclaw.config_path);t.changed&&console.log(`[openclaw-config] permission normalized: ownerFixed=${t.ownerFixed} modeFixed=${t.modeFixed} path=${t.path}`)}catch(e){console.warn(`[openclaw-config] failed to normalize config file permission: ${e?.message||String(e)}`)}let t=e.panel.listen_host,r=e.panel.listen_port;await $d.listen({host:t,port:r}),console.log(`OpenClaw panel listening on http://${t}:${r}`)}().catch(e=>{console.error(e),process.exit(1)});