import{requestJson as e}from"../../app-api.js";import{PANEL_ROUTES as t,isKnownPanelPath as n,panelByPath as a}from"../../app-routes.js";import{AICODECAT_PROVIDER as o,resolveAicodecatBaseUrl as r,resolveProviderId as i}from"../../config-generator.js";const s="openclaw-panel-theme",d="openclaw-panel-dashboard-context-tokens",l={"aicodecat-gpt":{title:"GPT 系列模板",providerId:"aicodecat-gpt",api:"openai-responses",baseUrl:"https://aicode.cat/v1",models:[{id:"gpt-5.2",name:"GPT-5.2",reasoning:!0,input:["text","image"],contextWindow:4e5,maxTokens:128e3},{id:"gpt-5.2-codex",name:"GPT-5.2 Codex",reasoning:!0,input:["text","image"],contextWindow:4e5,maxTokens:128e3},{id:"gpt-5.3-codex",name:"GPT-5.3 Codex",reasoning:!0,input:["text","image"],contextWindow:4e5,maxTokens:128e3}]},"aicodecat-claude":{title:"Claude 系列模板",providerId:"aicodecat-claude",api:"anthropic-messages",baseUrl:"https://aicode.cat",models:[{id:"claude-opus-4-6",name:"Claude Opus 4.6",reasoning:!0,input:["text","image"],contextWindow:2e5,maxTokens:64e3},{id:"claude-sonnet-4-5-20250929",name:"Claude Sonnet 4.5",reasoning:!0,input:["text","image"],contextWindow:2e5,maxTokens:64e3},{id:"claude-haiku-4-5",name:"Claude Haiku 4.5",reasoning:!0,input:["text","image"],contextWindow:2e5,maxTokens:64e3}]},"aicodecat-gemini":{title:"Gemini 系列模板",providerId:"aicodecat-gemini",api:"google-generative-ai",baseUrl:"https://aicode.cat/v1beta",models:[{id:"gemini-3-pro-preview",name:"Gemini 3 Pro Preview",reasoning:!1,input:["text","image"],contextWindow:1048576,maxTokens:65536},{id:"gemini-3-flash-preview",name:"Gemini 3 Flash Preview",reasoning:!1,input:["text","image"],contextWindow:1048576,maxTokens:65536}]}},c=Object.freeze({gpt:{apiMode:"openai-responses",contextWindow:4e5,maxTokens:128e3},claude:{apiMode:"anthropic-messages",contextWindow:2e5,maxTokens:64e3},gemini:{apiMode:"google-generative-ai",contextWindow:1048576,maxTokens:65536}}),u=Object.freeze(Object.values(l).flatMap(e=>e.models||[]).reduce((e,t)=>{const n=String(t?.id||"").trim();return!n||e.some(e=>e.id===n)||e.push({id:n,name:String(t?.name||n).trim()||n}),e},[])),m={modelCatalog:{providers:[],modelRefs:[]},defaultModelRefs:[],currentModelSettings:null,currentModelPayload:null,providerMode:"template",dashboardBound:!1},p={errorCount:null,latestError:"",currentTag:"",latestTag:"",updateAvailable:!1,updateWarning:""},g={bound:!1,selectedSkillKey:"",selectedSkillConfig:null,skills:[]},h={bound:!1,selectedSessionKey:"",sessions:[],lastRunId:"",streamSource:null,streamSessionKey:"",streamLines:[],streamDeltasByRunId:{},streamThinkingByRunId:{},historyMessages:[],sending:!1,attachments:[],staging:!1},S={settings:null},f={messages:document.querySelector("#messages"),serviceOutput:document.querySelector("#service_output"),logOutput:document.querySelector("#log_output"),errorSummary:document.querySelector("#error_summary"),runtimeState:document.querySelector("#runtime_state"),metaServiceName:document.querySelector("#meta_service_name"),metaLogSource:document.querySelector("#meta_log_source"),dashboardPublicHint:document.querySelector("#dashboard_public_hint"),serviceState:document.querySelector("#service_state"),serviceHint:document.querySelector("#service_hint"),themeToggle:document.querySelector("#theme_toggle"),updateState:document.querySelector("#update_state"),updateHint:document.querySelector("#update_hint"),updateCurrentTag:document.querySelector("#update_current_tag"),updateLatestTag:document.querySelector("#update_latest_tag")};function x(e,t="info"){if(!f.messages)return;const n=`[${(new Date).toLocaleTimeString()}][${t}] ${e}`;f.messages.textContent=`${n}\n${f.messages.textContent}`.slice(0,12e3)}function y(e,t){const n=document.querySelector(`#${e}`);if(n){if("checkbox"===n.type)return void(n.checked=!!t);n.value=t??""}}function v(e,t){const n=document.querySelector(`#${e}`);n&&(n.textContent=t??"")}function T(e){const t=document.querySelector(`#${e}`);return t?"checkbox"===t.type?t.checked:t.value:""}async function w(t,n={}){return e(fetch,t,n)}function k(){const e=Array.from(document.querySelectorAll(".tab")),o=Array.from(document.querySelectorAll(".panel")),r=e=>o.some(t=>t.dataset.panel===e),i=(n,{push:a=!1,replace:r=!1}={})=>{e.forEach(e=>{e.classList.toggle("is-active",e.dataset.tabTarget===n)}),o.forEach(e=>{e.classList.toggle("is-visible",e.dataset.panel===n)});const i=t[n]||"/model";a&&window.location.pathname!==i?window.history.pushState({panel:n},"",i):r&&window.location.pathname!==i&&window.history.replaceState({panel:n},"",i)};e.forEach(e=>{e.addEventListener("click",t=>{const n=String(e.dataset.tabTarget||"").trim();!n||!r(n)||(t.preventDefault(),i(n,{push:!0}))})}),window.addEventListener("popstate",()=>{i(a(window.location.pathname))});const s=a(window.location.pathname),d=!n(window.location.pathname);r(s)?i(s,{replace:d}):o.length>0&&i(o[0].dataset.panel,{replace:d})}function b(e){const t="dark"===e?"dark":"light";document.documentElement.dataset.theme=t,document.body.dataset.theme=t,document.documentElement.classList.toggle("sl-theme-dark","dark"===t),document.documentElement.classList.toggle("sl-theme-light","dark"!==t),f.themeToggle&&(f.themeToggle.textContent="dark"===t?"切换到白色模式":"切换到深夜模式")}function E(){b(localStorage.getItem(s)||"light"),f.themeToggle?.addEventListener("click",()=>{const e="dark"===document.body.dataset.theme?"light":"dark";localStorage.setItem(s,e),b(e),x("界面已切换到"+("dark"===e?"深夜模式":"白色模式"),"info")})}function A(e,t){const n=Number(e);return!Number.isFinite(n)||n<=0?t:Math.floor(n)}function I(e,t={}){const n=String(e?.id||t?.id||"").trim(),a=String(e?.name||t?.name||n).trim()||n;if(!n)return null;const o=A(t?.contextWindow,2e5),r=A(t?.maxTokens,8192),i={...e,id:n,name:a,contextWindow:A(e?.contextWindow,o),maxTokens:A(e?.maxTokens,r)},s=Array.isArray(e?.input)?e.input:Array.isArray(t?.input)?t.input:[];return Array.isArray(s)&&s.length>0&&(i.input=[...new Set(s.map(e=>String(e).trim()).filter(Boolean))]),void 0!==e?.reasoning?i.reasoning=!!e.reasoning:void 0!==t?.reasoning&&(i.reasoning=!!t.reasoning),i}function _({primary:e,providerId:t,providerApi:n,providerBaseUrl:a,providerApiKey:o="",modelId:r,modelName:i,contextWindow:s,maxTokens:d,providerModels:l=[]}){return{primary:String(e||"").trim(),providerId:String(t||"").trim(),providerApi:String(n||"").trim(),providerBaseUrl:String(a||"").trim(),providerApiKey:String(o||"").trim(),modelId:String(r||"").trim(),modelName:String(i||r||"").trim(),contextWindow:A(s,2e5),maxTokens:A(d,8192),providerModels:Array.isArray(l)?l.map(e=>I(e)).filter(Boolean):[]}}function C(e){const t=String(e||"").trim().toLowerCase();return t.startsWith("claude-")?"claude":t.startsWith("gemini-")?"gemini":"gpt"}function M(e,t=""){const n=String(e||"").trim();if(!n)return null;const a=C(n),s=c[a]||c.gpt,d=s.apiMode,l=i(o,d);return{ref:`${l}/${n}`,providerId:l,providerApi:d,providerBaseUrl:r(d),modelId:n,modelName:String(t||n).trim()||n,contextWindow:s.contextWindow,maxTokens:s.maxTokens}}function P(e,{includeCustom:t=!1,selectedValue:n=""}={}){if(!(e instanceof HTMLSelectElement))return"";const a=String(n||e.value||"").trim();if(e.innerHTML="",u.forEach(t=>{const n=document.createElement("option");n.value=t.id,n.textContent=t.id,e.appendChild(n)}),t){const t=document.createElement("option");t.value="custom",t.textContent="自定义",e.appendChild(t)}return e.value=u.some(e=>e.id===a)?a:t&&"custom"===a?"custom":u[0]?.id||(t?"custom":""),String(e.value||"").trim()}function L(e){const t=Number(e);return!Number.isFinite(t)||t<0?null:Math.floor(t)}function q(e){const t=String(e||"").trim();if(!t.includes("/"))return{providerId:"",modelId:t};const[n,a]=t.split("/",2);return{providerId:String(n||"").trim(),modelId:String(a||"").trim()}}function W(){const e=Array.from(document.querySelectorAll("[data-dashboard-context-input]"));for(const t of e){const e=L(t?.value||"");if(null!==e)return e}return L(localStorage.getItem(d)||"")}function O(e){const t=Number(e);return!Number.isFinite(t)||t<=0?"-":new Date(t).toLocaleString()}function D(e,t){if(!e)return;e.innerHTML="";const n=document.createElement("p");n.className="dashboard-list-empty",n.textContent=t,e.appendChild(n)}function N(e,t="neutral"){const n=document.createElement("sl-tag");return n.size="small",n.pill=!0,n.variant=t,n.textContent=e,n}const B=e=>!!document.querySelector(`.panel[data-panel="${e}"]`);export{o as AICODECAT_PROVIDER,d as DASHBOARD_CONTEXT_KEY,u as DEFAULT_MODEL_OPTIONS,c as MODEL_PROFILE_BY_FAMILY,l as MODEL_TEMPLATE_MAP,s as THEME_KEY,w as api,b as applyTheme,M as buildDefaultModelEntry,_ as buildModelPayload,S as channelSettingsSnapshot,h as chatConsoleState,N as createDashboardStatusTag,p as dashboardSummaryState,f as els,P as fillDefaultModelOptions,O as formatLocalTime,W as getDashboardContextTokens,T as getInputValue,B as hasPanel,n as isKnownPanelPath,m as modelEditorState,C as modelFamilyById,I as normalizeModelDraft,a as panelByPath,q as parseModelRef,y as setInput,x as setMessage,D as setStackListEmpty,v as setText,k as setupTabs,E as setupTheme,g as skillsPageState,L as toNonNegativeInt,A as toPositiveInt};